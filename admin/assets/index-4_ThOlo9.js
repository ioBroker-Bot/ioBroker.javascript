import{i as p_,a as kI}from"./iobroker_javascript__mf_v__runtimeInit__mf_v__-CBQgOKij.js";import{j as f,c as Er,g as L0,r as B0,_ as g_,i as zC,P as Ge}from"./createSvgIcon-BQT-7-GS.js";import{i as P0,y as EI,_ as II,a as xI,m as DI,S as UC,T as WC}from"./inheritsLoose--KnFDOw1.js";import{R as We,i as ve}from"./iobroker_javascript__loadShare__react__loadShare__-BiJPUKBK.js";import{i as D,I as Va,a as Jo,b as AI,C as OI,c as f_,M as vf,d as V$,e as A$,f as j0,F as RI,g as MI,h as G$,j as m_,k as NI,l as nw,m as uf,n as LI,o as Xl,p as BI,q as Ev,r as PI,s as jI,t as FI,u as zI,v as UI,w as WI,x as F0,y as z0,z as HI,_ as VI,A as GI,D as U0,B as Iv,E as W0,S as KI,L as JI,G as qI,H as b_,J as H0,K as YI,N as XI,O as ZI,P as QI,Q as ex,R as tx,T as nx,U as HC,V as sx,W as VC,X as rx,Y as ix,Z as ox,$ as ax,a0 as lx,a1 as cx,a2 as ux,a3 as dx,a4 as hx}from"./index-CuCs5aLs.js";import{g as Ga,c as Vo}from"./_commonjsHelpers-Cpj98o6Y.js";import{_ as px}from"./preload-helper-Dp1pzeXC.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const h of c.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&i(h)}).observe(document,{childList:!0,subtree:!0});function s(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(a){if(a.ep)return;a.ep=!0;const c=s(a);fetch(a.href,c)}})();var V0,GC=P0;V0=GC.createRoot,GC.hydrateRoot;var G0={exports:{}},Nn={};/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xv=60103,Dv=60106,Nf=60107,Lf=60108,Bf=60114,Pf=60109,jf=60110,Ff=60112,zf=60113,sw=60120,Uf=60115,Wf=60116,K0=60121,J0=60122,q0=60117,Y0=60129,X0=60131;if(typeof Symbol=="function"&&Symbol.for){var Us=Symbol.for;xv=Us("react.element"),Dv=Us("react.portal"),Nf=Us("react.fragment"),Lf=Us("react.strict_mode"),Bf=Us("react.profiler"),Pf=Us("react.provider"),jf=Us("react.context"),Ff=Us("react.forward_ref"),zf=Us("react.suspense"),sw=Us("react.suspense_list"),Uf=Us("react.memo"),Wf=Us("react.lazy"),K0=Us("react.block"),J0=Us("react.server.block"),q0=Us("react.fundamental"),Y0=Us("react.debug_trace_mode"),X0=Us("react.legacy_hidden")}function co(o){if(typeof o=="object"&&o!==null){var n=o.$$typeof;switch(n){case xv:switch(o=o.type,o){case Nf:case Bf:case Lf:case zf:case sw:return o;default:switch(o=o&&o.$$typeof,o){case jf:case Ff:case Wf:case Uf:case Pf:return o;default:return n}}case Dv:return n}}}var gx=Pf,fx=xv,mx=Ff,bx=Nf,$x=Wf,vx=Uf,yx=Dv,_x=Bf,wx=Lf,Cx=zf;Nn.ContextConsumer=jf;Nn.ContextProvider=gx;Nn.Element=fx;Nn.ForwardRef=mx;Nn.Fragment=bx;Nn.Lazy=$x;Nn.Memo=vx;Nn.Portal=yx;Nn.Profiler=_x;Nn.StrictMode=wx;Nn.Suspense=Cx;Nn.isAsyncMode=function(){return!1};Nn.isConcurrentMode=function(){return!1};Nn.isContextConsumer=function(o){return co(o)===jf};Nn.isContextProvider=function(o){return co(o)===Pf};Nn.isElement=function(o){return typeof o=="object"&&o!==null&&o.$$typeof===xv};Nn.isForwardRef=function(o){return co(o)===Ff};Nn.isFragment=function(o){return co(o)===Nf};Nn.isLazy=function(o){return co(o)===Wf};Nn.isMemo=function(o){return co(o)===Uf};Nn.isPortal=function(o){return co(o)===Dv};Nn.isProfiler=function(o){return co(o)===Bf};Nn.isStrictMode=function(o){return co(o)===Lf};Nn.isSuspense=function(o){return co(o)===zf};Nn.isValidElementType=function(o){return typeof o=="string"||typeof o=="function"||o===Nf||o===Bf||o===Y0||o===Lf||o===zf||o===sw||o===X0||typeof o=="object"&&o!==null&&(o.$$typeof===Wf||o.$$typeof===Uf||o.$$typeof===Pf||o.$$typeof===jf||o.$$typeof===Ff||o.$$typeof===q0||o.$$typeof===K0||o[0]===J0)};Nn.typeOf=co;G0.exports=Nn;var Sx=G0.exports;function K$(o,n){const s=getComputedStyle(n);if(!s)return;let i=o===Bn.Horizontal?n.clientWidth:n.clientHeight;return i!==0?(o===Bn.Horizontal?i-=parseFloat(s.paddingLeft)+parseFloat(s.paddingRight):i-=parseFloat(s.paddingTop)+parseFloat(s.paddingBottom),i):void 0}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function p$(o,n,s=[],i={condition:!0}){const{condition:a}=i,c=function(h,g){var b={};for(var $ in h)Object.prototype.hasOwnProperty.call(h,$)&&g.indexOf($)<0&&(b[$]=h[$]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function"){var y=0;for($=Object.getOwnPropertySymbols(h);y<$.length;y++)g.indexOf($[y])<0&&Object.prototype.propertyIsEnumerable.call(h,$[y])&&(b[$[y]]=h[$[y]])}return b}(i,["condition"]);ve.useEffect(()=>(a&&window.addEventListener(o,n,c),()=>{a&&window.removeEventListener(o,n)}),[o,n,a,...s])}(function(o,n){n===void 0&&(n={});var s=n.insertAt;if(typeof document<"u"){var i=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",s==="top"&&i.firstChild?i.insertBefore(a,i.firstChild):i.appendChild(a),a.styleSheet?a.styleSheet.cssText=o:a.appendChild(document.createTextNode(o))}})(`/* === Main Container === */
.__dbk__container {
  height: 100%;
  width: 100%;

  display: flex;
  overflow: hidden;
}

.__dbk__container.Horizontal {
  flex-direction: row;
}

.__dbk__container.Vertical {
  flex-direction: column;
}
/* ====== */

/* === Wrapper for each child element === */
.__dbk__child-wrapper {
  height: 100%;
  width: 100%;
}
/* ====== */

/* === Gutter === */
.__dbk__gutter {
  display: flex;
  align-items: center;
  justify-content: center;
}
/* .__dbk__gutter > div {
  background: red;
} */
.__dbk__gutter.Horizontal {
  height: 100%;
  padding: 0 2px;
  flex-direction: column;
}
.__dbk__gutter.Horizontal:hover {
  cursor: col-resize;
}

.__dbk__gutter.Vertical {
  width: 100%;
  padding: 2px 0;
  flex-direction: row;
}
.__dbk__gutter.Vertical:hover {
  cursor: row-resize;
}

.__dbk__gutter.Light {
  background: #EDF0EF;
}
.__dbk__gutter.Light:hover > .__dbk__dragger {
  background: #76747B;
}

.__dbk__gutter.Dark {
  background: #020203;
}
.__dbk__gutter.Dark:hover > .__dbk__dragger {
  background: #9995A3;
}
/* ====== */

/* === Gutter's Dragger === */
.__dbk__dragger {
  border-radius: 2px;
}

.__dbk__dragger.Horizontal {
  width: 4px;
  height: 24px;  
}

.__dbk__dragger.Vertical {
  width: 24px;
  height: 4px;  
}

.__dbk__dragger.Light {
  background: #A6ACB5;
}

.__dbk__dragger.Dark {
  background: #434252;
}
/* ====== */`);const Tx=We.forwardRef(({className:o,theme:n,draggerClassName:s,direction:i=Bn.Vertical,onDragging:a},c)=>{const h=`__dbk__gutter ${i} ${o||n}`,g=`__dbk__dragger ${i} ${s||n}`;return f.jsx("div",Object.assign({className:h,ref:c,dir:i,onMouseDown:a,onTouchStart:O$?a:void 0},{children:f.jsx("div",{className:g},void 0)}),void 0)});var Ii;function $_(o,n,s){let i,a;return n?(i=o/2,a=o):s?(i=o,a=o/2):(i=o,a=o),{aGutterSize:i,bGutterSize:a}}function kx(o,n){switch(n.type){case Ii.SetIsReadyToCompute:return Object.assign(Object.assign({},o),{isReady:n.payload.isReady});case Ii.CreatePairs:{const{direction:s,children:i,gutters:a}=n.payload,c=i[0].parentNode;if(!c)throw new Error("Cannot create pairs - parent is undefined.");const h=K$(s,c);if(h===void 0)throw new Error(`Cannot create pairs - parent has undefined or zero size: ${h}.`);const g=[];return i.forEach((b,$)=>{if($>0){const y=i[$-1],w=i[$],T=a[$-1],C=s===Bn.Horizontal?y.getBoundingClientRect().left:y.getBoundingClientRect().top,E=s===Bn.Horizontal?w.getBoundingClientRect().right:w.getBoundingClientRect().bottom,k=s===Bn.Horizontal?y.getBoundingClientRect().width+T.getBoundingClientRect().width+w.getBoundingClientRect().width:y.getBoundingClientRect().height+T.getBoundingClientRect().height+w.getBoundingClientRect().height,A=s===Bn.Horizontal?T.getBoundingClientRect().width:T.getBoundingClientRect().height,P={idx:$-1,a:y,b:w,gutter:T,parent:c,start:C,end:E,size:k,gutterSize:A,aSizePct:100/i.length,bSizePct:100/i.length};g.push(P)}}),Object.assign(Object.assign({},o),{pairs:g})}case Ii.StartDragging:{const{gutterIdx:s}=n.payload;return Object.assign(Object.assign({},o),{isDragging:!0,draggingIdx:s})}case Ii.StopDragging:return Object.assign(Object.assign({},o),{isDragging:!1});case Ii.CalculateSizes:{const{direction:s,gutterIdx:i}=n.payload,a=o.pairs[i],c=K$(s,a.parent);if(!c)throw new Error("Cannot calculate sizes - 'pair.parent' has undefined or zero size.");const h=a.gutter[s===Bn.Horizontal?"clientWidth":"clientHeight"],g=i===0,b=i===o.pairs.length-1,{aGutterSize:$,bGutterSize:y}=$_(h,g,b);let w,T,C,E,k;return s===Bn.Horizontal?(w=a.a.getBoundingClientRect().left,T=a.b.getBoundingClientRect().right,E=(a.a.getBoundingClientRect().width+$)/c*100,k=(a.b.getBoundingClientRect().width+y)/c*100,C=a.a.getBoundingClientRect().width+$+y+a.b.getBoundingClientRect().width):(w=a.a.getBoundingClientRect().top,T=a.b.getBoundingClientRect().bottom,E=(a.a.getBoundingClientRect().height+$)/c*100,k=(a.b.getBoundingClientRect().height+y)/c*100,C=a.a.getBoundingClientRect().height+$+y+a.b.getBoundingClientRect().height),o.pairs[i]=Object.assign(Object.assign({},a),{start:w,end:T,size:C,aSizePct:E,bSizePct:k,gutterSize:h}),Object.assign({},o)}default:return o}}function Z0(o,n=0,s=[]){return ve.Children.toArray(o).reduce((i,a,c)=>(Sx.isFragment(a)?i.push.apply(i,Z0(a.props.children,n+1,s.concat(a.key||c))):ve.isValidElement(a)?i.push(ve.cloneElement(a,{key:s.concat(String(a.key)).join(".")})):typeof a!="string"&&typeof a!="number"||i.push(a),i),[])}(function(o){o[o.SetIsReadyToCompute=0]="SetIsReadyToCompute",o[o.CreatePairs=1]="CreatePairs",o[o.CalculateSizes=2]="CalculateSizes",o[o.StartDragging=3]="StartDragging",o[o.StopDragging=4]="StopDragging"})(Ii||(Ii={}));const KC=o=>"changedTouches"in o;var Bn,v_;(function(o){o.Horizontal="Horizontal",o.Vertical="Vertical"})(Bn||(Bn={})),function(o){o.Light="Light",o.Dark="Dark"}(v_||(v_={}));const O$=typeof window<"u"&&"ontouchstart"in window;function Sy(o){return o===Bn.Horizontal?"col-resize":"row-resize"}const Ex={isReady:!1,isDragging:!1,pairs:[]};function J$({direction:o=Bn.Horizontal,minWidths:n=[],minHeights:s=[],initialSizes:i,gutterTheme:a=v_.Dark,gutterClassName:c,draggerClassName:h,children:g,onResizeStarted:b,onResizeFinished:$,classes:y=[]}){const w=Z0(g),[T,C]=ve.useReducer(kx,Ex),E=ve.useRef(null),k=ve.useRef([]),A=ve.useRef([]);k.current=[],A.current=[];const P=We.useCallback(ce=>{C({type:Ii.SetIsReadyToCompute,payload:{isReady:ce}})},[]),N=We.useCallback((ce,W)=>{C({type:Ii.StartDragging,payload:{gutterIdx:W}});const te=T.pairs[W];b==null||b(te.idx),te.a.style.userSelect="none",te.b.style.userSelect="none",te.gutter.style.cursor=Sy(ce),te.parent.style.cursor=Sy(ce),document.body.style.cursor=Sy(ce)},[T.pairs]),B=We.useCallback(()=>{C({type:Ii.StopDragging});const ce=[];for(let te=0;te<T.pairs.length;te++){const ke=T.pairs[te],Z=K$(o,ke.parent);if(Z===void 0)throw new Error("Cannot call the 'onResizeFinished' callback - parentSize is undefined");if(ke.gutterSize===void 0)throw new Error("Cannot call 'onResizeFinished' callback - gutterSize is undefined");const ze=te===0,Ce=te===T.pairs.length-1,at=ke.a.getBoundingClientRect()[o===Bn.Horizontal?"width":"height"],{aGutterSize:he,bGutterSize:Ae}=$_(ke.gutterSize,ze,Ce),de=(at+he)/Z*100;if(ce.push(de),Ce){const Se=(ke.b.getBoundingClientRect()[o===Bn.Horizontal?"width":"height"]+Ae)/Z*100;ce.push(Se)}}if(T.draggingIdx===void 0)throw new Error("Could not reset cursor and user-select because 'state.draggingIdx' is undefined");const W=T.pairs[T.draggingIdx];$==null||$(W.idx,ce),W.a.style.userSelect="",W.b.style.userSelect="",W.gutter.style.cursor="",W.parent.style.cursor="",document.body.style.cursor=""},[T.draggingIdx,T.pairs,o]),S=We.useCallback((ce,W)=>{C({type:Ii.CalculateSizes,payload:{direction:ce,gutterIdx:W}})},[]),H=We.useCallback((ce,W,te)=>{C({type:Ii.CreatePairs,payload:{direction:ce,children:W,gutters:te}})},[]),q=We.useCallback((ce,W,te,ke)=>{const Z=W[0].parentNode;if(!Z)throw new Error("Cannot set initial sizes - parent is undefined");if(K$(ce,Z)===void 0)throw new Error("Cannot set initial sizes - parent has undefined size");W.forEach((ze,Ce)=>{const at=Ce===0,he=Ce===W.length-1;let Ae,de=0;W.length>1&&(de=te[he?Ce-1:Ce].getBoundingClientRect()[ce===Bn.Horizontal?"width":"height"],de=at||he?de/2:de),Ae=ke&&Ce<ke.length?`calc(${ke[Ce]}% - ${de}px)`:`calc(${100/W.length}% - ${de}px)`,ce===Bn.Horizontal?(ze.style.width=Ae,ze.style.height="100%"):(ze.style.height=Ae,ze.style.width="100%")})},[]),se=We.useCallback((ce,W)=>{if(T.draggingIdx===void 0)throw new Error("Cannot adjust size - 'draggingIdx' is undefined");const te=T.pairs[T.draggingIdx];if(te.size===void 0)throw new Error("Cannot adjust size - 'pair.size' is undefined");if(te.gutterSize===void 0)throw new Error("Cannot adjust size - 'pair.gutterSize' is undefined");const ke=te.aSizePct+te.bSizePct,Z=W/te.size*ke,ze=ke-W/te.size*ke,Ce=T.draggingIdx===0,at=T.draggingIdx===T.pairs.length-1,{aGutterSize:he,bGutterSize:Ae}=$_(te.gutterSize,Ce,at),de=`calc(${Z}% - ${he}px)`,Se=`calc(${ze}% - ${Ae}px)`;ce===Bn.Horizontal?(te.a.style.width=de,te.b.style.width=Se):(te.a.style.height=de,te.b.style.height=Se)},[T.draggingIdx,T.pairs,o]),ee=We.useCallback((ce,W,te)=>{if(!T.isDragging)return;if(T.draggingIdx===void 0)throw new Error("Cannot drag - 'draggingIdx' is undefined");const ke=T.pairs[T.draggingIdx];if(ke.start===void 0)throw new Error("Cannot drag - 'pair.start' is undefined");if(ke.size===void 0)throw new Error("Cannot drag - 'pair.size' is undefined");if(ke.gutterSize===void 0)throw new Error("Cannot drag - 'pair.gutterSize' is undefined");let Z=function(at,he){const Ae=KC(he)?he.changedTouches[0]:he;return at===Bn.Horizontal?Ae.clientX:Ae.clientY}(W,ce)-ke.start,ze=16,Ce=16;te.length>T.draggingIdx&&(ze=te[T.draggingIdx]),te.length>=T.draggingIdx+1&&(Ce=te[T.draggingIdx+1]),Z<ke.gutterSize+ze&&(Z=ke.gutterSize+ze),Z>=ke.size-(ke.gutterSize+Ce)&&(Z=ke.size-(ke.gutterSize+Ce)),se(W,Z)},[T.isDragging,T.draggingIdx,T.pairs,se]),K=()=>{if(T.isDragging){if(T.draggingIdx===void 0)throw new Error("Cannot calculate sizes after dragging = 'state.draggingIdx' is undefined");S(o,T.draggingIdx),B()}},Y=ce=>{T.isDragging&&(KC(ce)&&ce.preventDefault(),ee(ce,o,o===Bn.Horizontal?n:s))};function X(ce,W){if(!ce.current)throw new Error("Can't add element to ref object - ref isn't initialized");W&&!ce.current.includes(W)&&ce.current.push(W)}return p$("mouseup",K,[T.isDragging,B]),p$("mousemove",Y,[o,T.isDragging,ee,n,s]),p$("touchend",K,[T.isDragging,B],{condition:O$}),p$("touchmove",Y,[o,T.isDragging,ee,n,s],{condition:O$,passive:!O$}),ve.useEffect(function(){if(!E.current)return;const ce=E.current.parentElement;if(!ce)return;const W=new ResizeObserver(()=>{const te=getComputedStyle(ce),ke=o===Bn.Horizontal?ce.clientWidth:ce.clientHeight;P(!!te&&!!ke)});return W.observe(ce),()=>{W.disconnect()}},[E.current,o]),ve.useEffect(function(){if(T.isReady&&(!k.current||k.current[0].offsetParent)){if(!k.current||!A.current)throw new Error("Cannot create pairs - either variable 'childRefs' or 'gutterRefs' is undefined");w.length<=1?q(o,k.current,A.current,i):(q(o,k.current,A.current,i),H(o,k.current,A.current))}},[g,T.isReady,o,q,H,i]),f.jsx("div",Object.assign({className:`__dbk__container ${o}`,ref:E},{children:T.isReady&&w.map((ce,W)=>f.jsxs(We.Fragment,{children:[f.jsx("div",Object.assign({ref:te=>X(k,te),className:"__dbk__child-wrapper "+(W<y.length?y[W]:"")},{children:ce}),void 0),W<w.length-1&&f.jsx(Tx,{ref:te=>X(A,te),className:c,theme:a,draggerClassName:h,direction:o,onDragging:()=>{return S(o,te=W),void N(o,te);var te}},void 0)]},W))}),void 0)}const{loadShare:Ix}=p_,{initPromise:xx}=kI,Dx=xx.then(o=>Ix("@iobroker/adapter-react-v5",{customShareInfo:{shareConfig:{singleton:!0,strictVersion:!1,requiredVersion:"*"}}})),Ax=await Dx.then(o=>o());var I=Ax;const Q0=ve.createContext({dragDropManager:void 0});function xf(o){"@babel/helpers - typeof";return xf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},xf(o)}function Ox(o,n){if(xf(o)!="object"||!o)return o;var s=o[Symbol.toPrimitive];if(s!==void 0){var i=s.call(o,n);if(xf(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(o)}function Rx(o){var n=Ox(o,"string");return xf(n)=="symbol"?n:n+""}function Mx(o,n,s){return(n=Rx(n))in o?Object.defineProperty(o,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[n]=s,o}function Si(o){return"Minified Redux error #"+o+"; visit https://redux.js.org/Errors?code="+o+" for the full message or use the non-minified dev environment for full errors. "}var JC=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),qC=function(){return Math.random().toString(36).substring(7).split("").join(".")},YC={INIT:"@@redux/INIT"+qC(),REPLACE:"@@redux/REPLACE"+qC()};function Nx(o){if(typeof o!="object"||o===null)return!1;for(var n=o;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(o)===n}function eT(o,n,s){var i;if(typeof n=="function"&&typeof s=="function"||typeof s=="function"&&typeof arguments[3]=="function")throw new Error(Si(0));if(typeof n=="function"&&typeof s>"u"&&(s=n,n=void 0),typeof s<"u"){if(typeof s!="function")throw new Error(Si(1));return s(eT)(o,n)}if(typeof o!="function")throw new Error(Si(2));var a=o,c=n,h=[],g=h,b=!1;function $(){g===h&&(g=h.slice())}function y(){if(b)throw new Error(Si(3));return c}function w(k){if(typeof k!="function")throw new Error(Si(4));if(b)throw new Error(Si(5));var A=!0;return $(),g.push(k),function(){if(A){if(b)throw new Error(Si(6));A=!1,$();var N=g.indexOf(k);g.splice(N,1),h=null}}}function T(k){if(!Nx(k))throw new Error(Si(7));if(typeof k.type>"u")throw new Error(Si(8));if(b)throw new Error(Si(9));try{b=!0,c=a(c,k)}finally{b=!1}for(var A=h=g,P=0;P<A.length;P++){var N=A[P];N()}return k}function C(k){if(typeof k!="function")throw new Error(Si(10));a=k,T({type:YC.REPLACE})}function E(){var k,A=w;return k={subscribe:function(N){if(typeof N!="object"||N===null)throw new Error(Si(11));function B(){N.next&&N.next(y())}B();var S=A(B);return{unsubscribe:S}}},k[JC]=function(){return this},k}return T({type:YC.INIT}),i={dispatch:T,subscribe:w,getState:y,replaceReducer:C},i[JC]=E,i}function Gt(o,n,...s){if(Lx()&&n===void 0)throw new Error("invariant requires an error message argument");if(!o){let i;if(n===void 0)i=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let a=0;i=new Error(n.replace(/%s/g,function(){return s[a++]})),i.name="Invariant Violation"}throw i.framesToPop=1,i}}function Lx(){return typeof process<"u"&&!0}function Bx(o,n,s){return n.split(".").reduce((i,a)=>i&&i[a]?i[a]:s||null,o)}function Px(o,n){return o.filter(s=>s!==n)}function tT(o){return typeof o=="object"}function jx(o,n){const s=new Map,i=c=>{s.set(c,s.has(c)?s.get(c)+1:1)};o.forEach(i),n.forEach(i);const a=[];return s.forEach((c,h)=>{c===1&&a.push(h)}),a}function Fx(o,n){return o.filter(s=>n.indexOf(s)>-1)}const rw="dnd-core/INIT_COORDS",Av="dnd-core/BEGIN_DRAG",iw="dnd-core/PUBLISH_DRAG_SOURCE",Ov="dnd-core/HOVER",Rv="dnd-core/DROP",Mv="dnd-core/END_DRAG";function XC(o,n){return{type:rw,payload:{sourceClientOffset:n||null,clientOffset:o||null}}}const zx={type:rw,payload:{clientOffset:null,sourceClientOffset:null}};function Ux(o){return function(s=[],i={publishSource:!0}){const{publishSource:a=!0,clientOffset:c,getSourceClientOffset:h}=i,g=o.getMonitor(),b=o.getRegistry();o.dispatch(XC(c)),Wx(s,g,b);const $=Gx(s,g);if($==null){o.dispatch(zx);return}let y=null;if(c){if(!h)throw new Error("getSourceClientOffset must be defined");Hx(h),y=h($)}o.dispatch(XC(c,y));const T=b.getSource($).beginDrag(g,$);if(T==null)return;Vx(T),b.pinSource($);const C=b.getSourceType($);return{type:Av,payload:{itemType:C,item:T,sourceId:$,clientOffset:c||null,sourceClientOffset:y||null,isSourcePublic:!!a}}}}function Wx(o,n,s){Gt(!n.isDragging(),"Cannot call beginDrag while dragging."),o.forEach(function(i){Gt(s.getSource(i),"Expected sourceIds to be registered.")})}function Hx(o){Gt(typeof o=="function","When clientOffset is provided, getSourceClientOffset must be a function.")}function Vx(o){Gt(tT(o),"Item must be an object.")}function Gx(o,n){let s=null;for(let i=o.length-1;i>=0;i--)if(n.canDragSource(o[i])){s=o[i];break}return s}function Kx(o,n,s){return n in o?Object.defineProperty(o,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[n]=s,o}function Jx(o){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{},i=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),i.forEach(function(a){Kx(o,a,s[a])})}return o}function qx(o){return function(s={}){const i=o.getMonitor(),a=o.getRegistry();Yx(i),Qx(i).forEach((h,g)=>{const b=Xx(h,g,a,i),$={type:Rv,payload:{dropResult:Jx({},s,b)}};o.dispatch($)})}}function Yx(o){Gt(o.isDragging(),"Cannot call drop while not dragging."),Gt(!o.didDrop(),"Cannot call drop twice during one drag operation.")}function Xx(o,n,s,i){const a=s.getTarget(o);let c=a?a.drop(i,o):void 0;return Zx(c),typeof c>"u"&&(c=n===0?{}:i.getDropResult()),c}function Zx(o){Gt(typeof o>"u"||tT(o),"Drop result must either be an object or undefined.")}function Qx(o){const n=o.getTargetIds().filter(o.canDropOnTarget,o);return n.reverse(),n}function eD(o){return function(){const s=o.getMonitor(),i=o.getRegistry();tD(s);const a=s.getSourceId();return a!=null&&(i.getSource(a,!0).endDrag(s,a),i.unpinSource()),{type:Mv}}}function tD(o){Gt(o.isDragging(),"Cannot call endDrag while not dragging.")}function y_(o,n){return n===null?o===null:Array.isArray(o)?o.some(s=>s===n):o===n}function nD(o){return function(s,{clientOffset:i}={}){sD(s);const a=s.slice(0),c=o.getMonitor(),h=o.getRegistry(),g=c.getItemType();return iD(a,h,g),rD(a,c,h),oD(a,c,h),{type:Ov,payload:{targetIds:a,clientOffset:i||null}}}}function sD(o){Gt(Array.isArray(o),"Expected targetIds to be an array.")}function rD(o,n,s){Gt(n.isDragging(),"Cannot call hover while not dragging."),Gt(!n.didDrop(),"Cannot call hover after drop.");for(let i=0;i<o.length;i++){const a=o[i];Gt(o.lastIndexOf(a)===i,"Expected targetIds to be unique in the passed array.");const c=s.getTarget(a);Gt(c,"Expected targetIds to be registered.")}}function iD(o,n,s){for(let i=o.length-1;i>=0;i--){const a=o[i],c=n.getTargetType(a);y_(c,s)||o.splice(i,1)}}function oD(o,n,s){o.forEach(function(i){s.getTarget(i).hover(n,i)})}function aD(o){return function(){if(o.getMonitor().isDragging())return{type:iw}}}function lD(o){return{beginDrag:Ux(o),publishDragSource:aD(o),hover:nD(o),drop:qx(o),endDrag:eD(o)}}class cD{receiveBackend(n){this.backend=n}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const n=this,{dispatch:s}=this.store;function i(c){return(...h)=>{const g=c.apply(n,h);typeof g<"u"&&s(g)}}const a=lD(this);return Object.keys(a).reduce((c,h)=>{const g=a[h];return c[h]=i(g),c},{})}dispatch(n){this.store.dispatch(n)}constructor(n,s){this.isSetUp=!1,this.handleRefCountChange=()=>{const i=this.store.getState().refCount>0;this.backend&&(i&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!i&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=n,this.monitor=s,n.subscribe(this.handleRefCountChange)}}function uD(o,n){return{x:o.x+n.x,y:o.y+n.y}}function nT(o,n){return{x:o.x-n.x,y:o.y-n.y}}function dD(o){const{clientOffset:n,initialClientOffset:s,initialSourceClientOffset:i}=o;return!n||!s||!i?null:nT(uD(n,i),s)}function hD(o){const{clientOffset:n,initialClientOffset:s}=o;return!n||!s?null:nT(n,s)}const yf=[],ow=[];yf.__IS_NONE__=!0;ow.__IS_ALL__=!0;function pD(o,n){return o===yf?!1:o===ow||typeof n>"u"?!0:Fx(n,o).length>0}class gD{subscribeToStateChange(n,s={}){const{handlerIds:i}=s;Gt(typeof n=="function","listener must be a function."),Gt(typeof i>"u"||Array.isArray(i),"handlerIds, when specified, must be an array of strings.");let a=this.store.getState().stateId;const c=()=>{const h=this.store.getState(),g=h.stateId;try{g===a||g===a+1&&!pD(h.dirtyHandlerIds,i)||n()}finally{a=g}};return this.store.subscribe(c)}subscribeToOffsetChange(n){Gt(typeof n=="function","listener must be a function.");let s=this.store.getState().dragOffset;const i=()=>{const a=this.store.getState().dragOffset;a!==s&&(s=a,n())};return this.store.subscribe(i)}canDragSource(n){if(!n)return!1;const s=this.registry.getSource(n);return Gt(s,`Expected to find a valid source. sourceId=${n}`),this.isDragging()?!1:s.canDrag(this,n)}canDropOnTarget(n){if(!n)return!1;const s=this.registry.getTarget(n);if(Gt(s,`Expected to find a valid target. targetId=${n}`),!this.isDragging()||this.didDrop())return!1;const i=this.registry.getTargetType(n),a=this.getItemType();return y_(i,a)&&s.canDrop(this,n)}isDragging(){return!!this.getItemType()}isDraggingSource(n){if(!n)return!1;const s=this.registry.getSource(n,!0);if(Gt(s,`Expected to find a valid source. sourceId=${n}`),!this.isDragging()||!this.isSourcePublic())return!1;const i=this.registry.getSourceType(n),a=this.getItemType();return i!==a?!1:s.isDragging(this,n)}isOverTarget(n,s={shallow:!1}){if(!n)return!1;const{shallow:i}=s;if(!this.isDragging())return!1;const a=this.registry.getTargetType(n),c=this.getItemType();if(c&&!y_(a,c))return!1;const h=this.getTargetIds();if(!h.length)return!1;const g=h.indexOf(n);return i?g===h.length-1:g>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return!!this.store.getState().dragOperation.isSourcePublic}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return dD(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return hD(this.store.getState().dragOffset)}constructor(n,s){this.store=n,this.registry=s}}const ZC=typeof global<"u"?global:self,sT=ZC.MutationObserver||ZC.WebKitMutationObserver;function rT(o){return function(){const s=setTimeout(a,0),i=setInterval(a,50);function a(){clearTimeout(s),clearInterval(i),o()}}}function fD(o){let n=1;const s=new sT(o),i=document.createTextNode("");return s.observe(i,{characterData:!0}),function(){n=-n,i.data=n}}const mD=typeof sT=="function"?fD:rT;class bD{enqueueTask(n){const{queue:s,requestFlush:i}=this;s.length||(i(),this.flushing=!0),s[s.length]=n}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:n}=this;for(;this.index<n.length;){const s=this.index;if(this.index++,n[s].call(),this.index>this.capacity){for(let i=0,a=n.length-this.index;i<a;i++)n[i]=n[i+this.index];n.length-=this.index,this.index=0}}n.length=0,this.index=0,this.flushing=!1},this.registerPendingError=n=>{this.pendingErrors.push(n),this.requestErrorThrow()},this.requestFlush=mD(this.flush),this.requestErrorThrow=rT(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}}class $D{call(){try{this.task&&this.task()}catch(n){this.onError(n)}finally{this.task=null,this.release(this)}}constructor(n,s){this.onError=n,this.release=s,this.task=null}}class vD{create(n){const s=this.freeTasks,i=s.length?s.pop():new $D(this.onError,a=>s[s.length]=a);return i.task=n,i}constructor(n){this.onError=n,this.freeTasks=[]}}const iT=new bD,yD=new vD(iT.registerPendingError);function _D(o){iT.enqueueTask(yD.create(o))}const aw="dnd-core/ADD_SOURCE",lw="dnd-core/ADD_TARGET",cw="dnd-core/REMOVE_SOURCE",Nv="dnd-core/REMOVE_TARGET";function wD(o){return{type:aw,payload:{sourceId:o}}}function CD(o){return{type:lw,payload:{targetId:o}}}function SD(o){return{type:cw,payload:{sourceId:o}}}function TD(o){return{type:Nv,payload:{targetId:o}}}function kD(o){Gt(typeof o.canDrag=="function","Expected canDrag to be a function."),Gt(typeof o.beginDrag=="function","Expected beginDrag to be a function."),Gt(typeof o.endDrag=="function","Expected endDrag to be a function.")}function ED(o){Gt(typeof o.canDrop=="function","Expected canDrop to be a function."),Gt(typeof o.hover=="function","Expected hover to be a function."),Gt(typeof o.drop=="function","Expected beginDrag to be a function.")}function __(o,n){if(n&&Array.isArray(o)){o.forEach(s=>__(s,!1));return}Gt(typeof o=="string"||typeof o=="symbol",n?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var Ei;(function(o){o.SOURCE="SOURCE",o.TARGET="TARGET"})(Ei||(Ei={}));let ID=0;function xD(){return ID++}function DD(o){const n=xD().toString();switch(o){case Ei.SOURCE:return`S${n}`;case Ei.TARGET:return`T${n}`;default:throw new Error(`Unknown Handler Role: ${o}`)}}function QC(o){switch(o[0]){case"S":return Ei.SOURCE;case"T":return Ei.TARGET;default:throw new Error(`Cannot parse handler ID: ${o}`)}}function eS(o,n){const s=o.entries();let i=!1;do{const{done:a,value:[,c]}=s.next();if(c===n)return!0;i=!!a}while(!i);return!1}class AD{addSource(n,s){__(n),kD(s);const i=this.addHandler(Ei.SOURCE,n,s);return this.store.dispatch(wD(i)),i}addTarget(n,s){__(n,!0),ED(s);const i=this.addHandler(Ei.TARGET,n,s);return this.store.dispatch(CD(i)),i}containsHandler(n){return eS(this.dragSources,n)||eS(this.dropTargets,n)}getSource(n,s=!1){return Gt(this.isSourceId(n),"Expected a valid source ID."),s&&n===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(n)}getTarget(n){return Gt(this.isTargetId(n),"Expected a valid target ID."),this.dropTargets.get(n)}getSourceType(n){return Gt(this.isSourceId(n),"Expected a valid source ID."),this.types.get(n)}getTargetType(n){return Gt(this.isTargetId(n),"Expected a valid target ID."),this.types.get(n)}isSourceId(n){return QC(n)===Ei.SOURCE}isTargetId(n){return QC(n)===Ei.TARGET}removeSource(n){Gt(this.getSource(n),"Expected an existing source."),this.store.dispatch(SD(n)),_D(()=>{this.dragSources.delete(n),this.types.delete(n)})}removeTarget(n){Gt(this.getTarget(n),"Expected an existing target."),this.store.dispatch(TD(n)),this.dropTargets.delete(n),this.types.delete(n)}pinSource(n){const s=this.getSource(n);Gt(s,"Expected an existing source."),this.pinnedSourceId=n,this.pinnedSource=s}unpinSource(){Gt(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(n,s,i){const a=DD(n);return this.types.set(a,s),n===Ei.SOURCE?this.dragSources.set(a,i):n===Ei.TARGET&&this.dropTargets.set(a,i),a}constructor(n){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=n}}const OD=(o,n)=>o===n;function RD(o,n){return!o&&!n?!0:!o||!n?!1:o.x===n.x&&o.y===n.y}function MD(o,n,s=OD){if(o.length!==n.length)return!1;for(let i=0;i<o.length;++i)if(!s(o[i],n[i]))return!1;return!0}function ND(o=yf,n){switch(n.type){case Ov:break;case aw:case lw:case Nv:case cw:return yf;case Av:case iw:case Mv:case Rv:default:return ow}const{targetIds:s=[],prevTargetIds:i=[]}=n.payload,a=jx(s,i);if(!(a.length>0||!MD(s,i)))return yf;const h=i[i.length-1],g=s[s.length-1];return h!==g&&(h&&a.push(h),g&&a.push(g)),a}function LD(o,n,s){return n in o?Object.defineProperty(o,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[n]=s,o}function BD(o){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{},i=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),i.forEach(function(a){LD(o,a,s[a])})}return o}const tS={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function PD(o=tS,n){const{payload:s}=n;switch(n.type){case rw:case Av:return{initialSourceClientOffset:s.sourceClientOffset,initialClientOffset:s.clientOffset,clientOffset:s.clientOffset};case Ov:return RD(o.clientOffset,s.clientOffset)?o:BD({},o,{clientOffset:s.clientOffset});case Mv:case Rv:return tS;default:return o}}function jD(o,n,s){return n in o?Object.defineProperty(o,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[n]=s,o}function dh(o){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{},i=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),i.forEach(function(a){jD(o,a,s[a])})}return o}const FD={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function zD(o=FD,n){const{payload:s}=n;switch(n.type){case Av:return dh({},o,{itemType:s.itemType,item:s.item,sourceId:s.sourceId,isSourcePublic:s.isSourcePublic,dropResult:null,didDrop:!1});case iw:return dh({},o,{isSourcePublic:!0});case Ov:return dh({},o,{targetIds:s.targetIds});case Nv:return o.targetIds.indexOf(s.targetId)===-1?o:dh({},o,{targetIds:Px(o.targetIds,s.targetId)});case Rv:return dh({},o,{dropResult:s.dropResult,didDrop:!0,targetIds:[]});case Mv:return dh({},o,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return o}}function UD(o=0,n){switch(n.type){case aw:case lw:return o+1;case cw:case Nv:return o-1;default:return o}}function WD(o=0){return o+1}function HD(o,n,s){return n in o?Object.defineProperty(o,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[n]=s,o}function VD(o){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{},i=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),i.forEach(function(a){HD(o,a,s[a])})}return o}function GD(o={},n){return{dirtyHandlerIds:ND(o.dirtyHandlerIds,{type:n.type,payload:VD({},n.payload,{prevTargetIds:Bx(o,"dragOperation.targetIds",[])})}),dragOffset:PD(o.dragOffset,n),refCount:UD(o.refCount,n),dragOperation:zD(o.dragOperation,n),stateId:WD(o.stateId)}}function KD(o,n=void 0,s={},i=!1){const a=JD(i),c=new gD(a,new AD(a)),h=new cD(a,c),g=o(h,n,s);return h.receiveBackend(g),h}function JD(o){const n=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__;return eT(GD,o&&n&&n({name:"dnd-core",instanceId:"dnd-core"}))}function qD(o,n){if(o==null)return{};var s=YD(o,n),i,a;if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(o);for(a=0;a<c.length;a++)i=c[a],!(n.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(o,i)&&(s[i]=o[i])}return s}function YD(o,n){if(o==null)return{};var s={},i=Object.keys(o),a,c;for(c=0;c<i.length;c++)a=i[c],!(n.indexOf(a)>=0)&&(s[a]=o[a]);return s}let nS=0;const R$=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var oT=ve.memo(function(n){var{children:s}=n,i=qD(n,["children"]);const[a,c]=XD(i);return ve.useEffect(()=>{if(c){const h=aT();return++nS,()=>{--nS===0&&(h[R$]=null)}}},[]),f.jsx(Q0.Provider,{value:a,children:s})});function XD(o){if("manager"in o)return[{dragDropManager:o.manager},!1];const n=ZD(o.backend,o.context,o.options,o.debugMode),s=!o.context;return[n,s]}function ZD(o,n=aT(),s,i){const a=n;return a[R$]||(a[R$]={dragDropManager:KD(o,n,s,i)}),a[R$]}function aT(){return typeof global<"u"?global:window}var QD=function o(n,s){if(n===s)return!0;if(n&&s&&typeof n=="object"&&typeof s=="object"){if(n.constructor!==s.constructor)return!1;var i,a,c;if(Array.isArray(n)){if(i=n.length,i!=s.length)return!1;for(a=i;a--!==0;)if(!o(n[a],s[a]))return!1;return!0}if(n.constructor===RegExp)return n.source===s.source&&n.flags===s.flags;if(n.valueOf!==Object.prototype.valueOf)return n.valueOf()===s.valueOf();if(n.toString!==Object.prototype.toString)return n.toString()===s.toString();if(c=Object.keys(n),i=c.length,i!==Object.keys(s).length)return!1;for(a=i;a--!==0;)if(!Object.prototype.hasOwnProperty.call(s,c[a]))return!1;for(a=i;a--!==0;){var h=c[a];if(!o(n[h],s[h]))return!1}return!0}return n!==n&&s!==s};const eA=Ga(QD),vu=typeof window<"u"?ve.useLayoutEffect:ve.useEffect;function lT(o,n,s){const[i,a]=ve.useState(()=>n(o)),c=ve.useCallback(()=>{const h=n(o);eA(i,h)||(a(h),s&&s())},[i,o,s]);return vu(c),[i,c]}function tA(o,n,s){const[i,a]=lT(o,n,s);return vu(function(){const h=o.getHandlerId();if(h!=null)return o.subscribeToStateChange(a,{handlerIds:[h]})},[o,a]),i}function cT(o,n,s){return tA(n,o||(()=>({})),()=>s.reconnect())}function uT(o,n){const s=[];return typeof o!="function"&&s.push(o),ve.useMemo(()=>typeof o=="function"?o():o,s)}function nA(o){return ve.useMemo(()=>o.hooks.dragSource(),[o])}function sA(o){return ve.useMemo(()=>o.hooks.dragPreview(),[o])}let Ty=!1,ky=!1;class rA{receiveHandlerId(n){this.sourceId=n}getHandlerId(){return this.sourceId}canDrag(){Gt(!Ty,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return Ty=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{Ty=!1}}isDragging(){if(!this.sourceId)return!1;Gt(!ky,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return ky=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{ky=!1}}subscribeToStateChange(n,s){return this.internalMonitor.subscribeToStateChange(n,s)}isDraggingSource(n){return this.internalMonitor.isDraggingSource(n)}isOverTarget(n,s){return this.internalMonitor.isOverTarget(n,s)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(n){return this.internalMonitor.subscribeToOffsetChange(n)}canDragSource(n){return this.internalMonitor.canDragSource(n)}canDropOnTarget(n){return this.internalMonitor.canDropOnTarget(n)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(n){this.sourceId=null,this.internalMonitor=n.getMonitor()}}let Ey=!1;class iA{receiveHandlerId(n){this.targetId=n}getHandlerId(){return this.targetId}subscribeToStateChange(n,s){return this.internalMonitor.subscribeToStateChange(n,s)}canDrop(){if(!this.targetId)return!1;Gt(!Ey,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return Ey=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{Ey=!1}}isOver(n){return this.targetId?this.internalMonitor.isOverTarget(this.targetId,n):!1}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(n){this.targetId=null,this.internalMonitor=n.getMonitor()}}function oA(o,n,s){const i=s.getRegistry(),a=i.addTarget(o,n);return[a,()=>i.removeTarget(a)]}function aA(o,n,s){const i=s.getRegistry(),a=i.addSource(o,n);return[a,()=>i.removeSource(a)]}function w_(o,n,s,i){let a;if(a!==void 0)return!!a;if(o===n)return!0;if(typeof o!="object"||!o||typeof n!="object"||!n)return!1;const c=Object.keys(o),h=Object.keys(n);if(c.length!==h.length)return!1;const g=Object.prototype.hasOwnProperty.bind(n);for(let b=0;b<c.length;b++){const $=c[b];if(!g($))return!1;const y=o[$],w=n[$];if(a=void 0,a===!1||a===void 0&&y!==w)return!1}return!0}function C_(o){return o!==null&&typeof o=="object"&&Object.prototype.hasOwnProperty.call(o,"current")}function lA(o){if(typeof o.type=="string")return;const n=o.type.displayName||o.type.name||"the component";throw new Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${n} into a <div>, or turn it into a drag source or a drop target itself.`)}function cA(o){return(n=null,s=null)=>{if(!ve.isValidElement(n)){const c=n;return o(c,s),c}const i=n;return lA(i),uA(i,s?c=>o(c,s):o)}}function dT(o){const n={};return Object.keys(o).forEach(s=>{const i=o[s];if(s.endsWith("Ref"))n[s]=o[s];else{const a=cA(i);n[s]=()=>a}}),n}function sS(o,n){typeof o=="function"?o(n):o.current=n}function uA(o,n){const s=o.ref;return Gt(typeof s!="string","Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),s?ve.cloneElement(o,{ref:i=>{sS(s,i),sS(n,i)}}):ve.cloneElement(o,{ref:n})}class dA{receiveHandlerId(n){this.handlerId!==n&&(this.handlerId=n,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(n){this.dragSourceOptionsInternal=n}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(n){this.dragPreviewOptionsInternal=n}reconnect(){const n=this.reconnectDragSource();this.reconnectDragPreview(n)}reconnectDragSource(){const n=this.dragSource,s=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return s&&this.disconnectDragSource(),this.handlerId?n?(s&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=n,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,n,this.dragSourceOptions)),s):(this.lastConnectedDragSource=n,s):s}reconnectDragPreview(n=!1){const s=this.dragPreview,i=n||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(i&&this.disconnectDragPreview(),!!this.handlerId){if(!s){this.lastConnectedDragPreview=s;return}i&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=s,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,s,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!w_(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!w_(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(n){this.hooks=dT({dragSource:(s,i)=>{this.clearDragSource(),this.dragSourceOptions=i||null,C_(s)?this.dragSourceRef=s:this.dragSourceNode=s,this.reconnectDragSource()},dragPreview:(s,i)=>{this.clearDragPreview(),this.dragPreviewOptions=i||null,C_(s)?this.dragPreviewRef=s:this.dragPreviewNode=s,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=n}}class hA{get connectTarget(){return this.dropTarget}reconnect(){const n=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();n&&this.disconnectDropTarget();const s=this.dropTarget;if(this.handlerId){if(!s){this.lastConnectedDropTarget=s;return}n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=s,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,s,this.dropTargetOptions))}}receiveHandlerId(n){n!==this.handlerId&&(this.handlerId=n,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(n){this.dropTargetOptionsInternal=n}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!w_(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(n){this.hooks=dT({dropTarget:(s,i)=>{this.clearDropTarget(),this.dropTargetOptions=i,C_(s)?this.dropTargetRef=s:this.dropTargetNode=s,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=n}}function Cu(){const{dragDropManager:o}=ve.useContext(Q0);return Gt(o!=null,"Expected drag drop context"),o}function pA(o,n){const s=Cu(),i=ve.useMemo(()=>new dA(s.getBackend()),[s]);return vu(()=>(i.dragSourceOptions=o||null,i.reconnect(),()=>i.disconnectDragSource()),[i,o]),vu(()=>(i.dragPreviewOptions=n||null,i.reconnect(),()=>i.disconnectDragPreview()),[i,n]),i}function gA(){const o=Cu();return ve.useMemo(()=>new rA(o),[o])}class fA{beginDrag(){const n=this.spec,s=this.monitor;let i=null;return typeof n.item=="object"?i=n.item:typeof n.item=="function"?i=n.item(s):i={},i??null}canDrag(){const n=this.spec,s=this.monitor;return typeof n.canDrag=="boolean"?n.canDrag:typeof n.canDrag=="function"?n.canDrag(s):!0}isDragging(n,s){const i=this.spec,a=this.monitor,{isDragging:c}=i;return c?c(a):s===n.getSourceId()}endDrag(){const n=this.spec,s=this.monitor,i=this.connector,{end:a}=n;a&&a(s.getItem(),s),i.reconnect()}constructor(n,s,i){this.spec=n,this.monitor=s,this.connector=i}}function mA(o,n,s){const i=ve.useMemo(()=>new fA(o,n,s),[n,s]);return ve.useEffect(()=>{i.spec=o},[o]),i}function bA(o){return ve.useMemo(()=>{const n=o.type;return Gt(n!=null,"spec.type must be defined"),n},[o])}function $A(o,n,s){const i=Cu(),a=mA(o,n,s),c=bA(o);vu(function(){if(c!=null){const[g,b]=aA(c,a,i);return n.receiveHandlerId(g),s.receiveHandlerId(g),b}},[i,n,s,a,c])}function hT(o,n){const s=uT(o);Gt(!s.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const i=gA(),a=pA(s.options,s.previewOptions);return $A(s,i,a),[cT(s.collect,i,a),nA(a),sA(a)]}function vA(o){const s=Cu().getMonitor(),[i,a]=lT(s,o);return ve.useEffect(()=>s.subscribeToOffsetChange(a)),ve.useEffect(()=>s.subscribeToStateChange(a)),i}function yA(o){return ve.useMemo(()=>o.hooks.dropTarget(),[o])}function _A(o){const n=Cu(),s=ve.useMemo(()=>new hA(n.getBackend()),[n]);return vu(()=>(s.dropTargetOptions=o||null,s.reconnect(),()=>s.disconnectDropTarget()),[o]),s}function wA(){const o=Cu();return ve.useMemo(()=>new iA(o),[o])}function CA(o){const{accept:n}=o;return ve.useMemo(()=>(Gt(o.accept!=null,"accept must be defined"),Array.isArray(n)?n:[n]),[n])}class SA{canDrop(){const n=this.spec,s=this.monitor;return n.canDrop?n.canDrop(s.getItem(),s):!0}hover(){const n=this.spec,s=this.monitor;n.hover&&n.hover(s.getItem(),s)}drop(){const n=this.spec,s=this.monitor;if(n.drop)return n.drop(s.getItem(),s)}constructor(n,s){this.spec=n,this.monitor=s}}function TA(o,n){const s=ve.useMemo(()=>new SA(o,n),[n]);return ve.useEffect(()=>{s.spec=o},[o]),s}function kA(o,n,s){const i=Cu(),a=TA(o,n),c=CA(o);vu(function(){const[g,b]=oA(c,a,i);return n.receiveHandlerId(g),s.receiveHandlerId(g),b},[i,n,a,s,c.map(h=>h.toString()).join("|")])}function uw(o,n){const s=uT(o),i=wA(),a=_A(s.options);return kA(s,i,a),[cT(s.collect,i,a),yA(a)]}function pT(o){let n=null;return()=>(n==null&&(n=o()),n)}function EA(o,n){return o.filter(s=>s!==n)}function IA(o,n){const s=new Set,i=c=>s.add(c);o.forEach(i),n.forEach(i);const a=[];return s.forEach(c=>a.push(c)),a}class xA{enter(n){const s=this.entered.length,i=a=>this.isNodeInDocument(a)&&(!a.contains||a.contains(n));return this.entered=IA(this.entered.filter(i),[n]),s===0&&this.entered.length>0}leave(n){const s=this.entered.length;return this.entered=EA(this.entered.filter(this.isNodeInDocument),n),s>0&&this.entered.length===0}reset(){this.entered=[]}constructor(n){this.entered=[],this.isNodeInDocument=n}}class DA{initializeExposedProperties(){Object.keys(this.config.exposeProperties).forEach(n=>{Object.defineProperty(this.item,n,{configurable:!0,enumerable:!0,get(){return console.warn(`Browser doesn't allow reading "${n}" until the drop event.`),null}})})}loadDataTransfer(n){if(n){const s={};Object.keys(this.config.exposeProperties).forEach(i=>{const a=this.config.exposeProperties[i];a!=null&&(s[i]={value:a(n,this.config.matchesTypes),configurable:!0,enumerable:!0})}),Object.defineProperties(this.item,s)}}canDrag(){return!0}beginDrag(){return this.item}isDragging(n,s){return s===n.getSourceId()}endDrag(){}constructor(n){this.config=n,this.item={},this.initializeExposedProperties()}}const gT="__NATIVE_FILE__",fT="__NATIVE_URL__",mT="__NATIVE_TEXT__",bT="__NATIVE_HTML__",rS=Object.freeze(Object.defineProperty({__proto__:null,FILE:gT,HTML:bT,TEXT:mT,URL:fT},Symbol.toStringTag,{value:"Module"}));function Iy(o,n,s){const i=n.reduce((a,c)=>a||o.getData(c),"");return i??s}const S_={[gT]:{exposeProperties:{files:o=>Array.prototype.slice.call(o.files),items:o=>o.items,dataTransfer:o=>o},matchesTypes:["Files"]},[bT]:{exposeProperties:{html:(o,n)=>Iy(o,n,""),dataTransfer:o=>o},matchesTypes:["Html","text/html"]},[fT]:{exposeProperties:{urls:(o,n)=>Iy(o,n,"").split(`
`),dataTransfer:o=>o},matchesTypes:["Url","text/uri-list"]},[mT]:{exposeProperties:{text:(o,n)=>Iy(o,n,""),dataTransfer:o=>o},matchesTypes:["Text","text/plain"]}};function AA(o,n){const s=S_[o];if(!s)throw new Error(`native type ${o} has no configuration`);const i=new DA(s);return i.loadDataTransfer(n),i}function xy(o){if(!o)return null;const n=Array.prototype.slice.call(o.types||[]);return Object.keys(S_).filter(s=>{const i=S_[s];return i!=null&&i.matchesTypes?i.matchesTypes.some(a=>n.indexOf(a)>-1):!1})[0]||null}const OA=pT(()=>/firefox/i.test(navigator.userAgent)),$T=pT(()=>!!window.safari);class iS{interpolate(n){const{xs:s,ys:i,c1s:a,c2s:c,c3s:h}=this;let g=s.length-1;if(n===s[g])return i[g];let b=0,$=h.length-1,y;for(;b<=$;){y=Math.floor(.5*(b+$));const C=s[y];if(C<n)b=y+1;else if(C>n)$=y-1;else return i[y]}g=Math.max(0,$);const w=n-s[g],T=w*w;return i[g]+a[g]*w+c[g]*T+h[g]*w*T}constructor(n,s){const{length:i}=n,a=[];for(let C=0;C<i;C++)a.push(C);a.sort((C,E)=>n[C]<n[E]?-1:1);const c=[],h=[];let g,b;for(let C=0;C<i-1;C++)g=n[C+1]-n[C],b=s[C+1]-s[C],c.push(g),h.push(b/g);const $=[h[0]];for(let C=0;C<c.length-1;C++){const E=h[C],k=h[C+1];if(E*k<=0)$.push(0);else{g=c[C];const A=c[C+1],P=g+A;$.push(3*P/((P+A)/E+(P+g)/k))}}$.push(h[h.length-1]);const y=[],w=[];let T;for(let C=0;C<$.length-1;C++){T=h[C];const E=$[C],k=1/c[C],A=E+$[C+1]-T-T;y.push((T-E-A)*k),w.push(A*k*k)}this.xs=n,this.ys=s,this.c1s=$,this.c2s=y,this.c3s=w}}const RA=1;function vT(o){const n=o.nodeType===RA?o:o.parentElement;if(!n)return null;const{top:s,left:i}=n.getBoundingClientRect();return{x:i,y:s}}function g$(o){return{x:o.clientX,y:o.clientY}}function MA(o){var n;return o.nodeName==="IMG"&&(OA()||!(!((n=document.documentElement)===null||n===void 0)&&n.contains(o)))}function NA(o,n,s,i){let a=o?n.width:s,c=o?n.height:i;return $T()&&o&&(c/=window.devicePixelRatio,a/=window.devicePixelRatio),{dragPreviewWidth:a,dragPreviewHeight:c}}function LA(o,n,s,i,a){const c=MA(n),g=vT(c?o:n),b={x:s.x-g.x,y:s.y-g.y},{offsetWidth:$,offsetHeight:y}=o,{anchorX:w,anchorY:T}=i,{dragPreviewWidth:C,dragPreviewHeight:E}=NA(c,n,$,y),k=()=>{let q=new iS([0,.5,1],[b.y,b.y/y*E,b.y+E-y]).interpolate(T);return $T()&&c&&(q+=(window.devicePixelRatio-1)*E),q},A=()=>new iS([0,.5,1],[b.x,b.x/$*C,b.x+C-$]).interpolate(w),{offsetX:P,offsetY:N}=a,B=P===0||P,S=N===0||N;return{x:B?P:A(),y:S?N:k()}}let BA=class{get window(){if(this.globalContext)return this.globalContext;if(typeof window<"u")return window}get document(){var n;return!((n=this.globalContext)===null||n===void 0)&&n.document?this.globalContext.document:this.window?this.window.document:void 0}get rootElement(){var n;return((n=this.optionsArgs)===null||n===void 0?void 0:n.rootElement)||this.window}constructor(n,s){this.ownerDocument=null,this.globalContext=n,this.optionsArgs=s}};function PA(o,n,s){return n in o?Object.defineProperty(o,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[n]=s,o}function oS(o){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{},i=Object.keys(s);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(s).filter(function(a){return Object.getOwnPropertyDescriptor(s,a).enumerable}))),i.forEach(function(a){PA(o,a,s[a])})}return o}class jA{profile(){var n,s;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:((n=this.dragStartSourceIds)===null||n===void 0?void 0:n.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:((s=this.dragOverTargetIds)===null||s===void 0?void 0:s.length)||0}}get window(){return this.options.window}get document(){return this.options.document}get rootElement(){return this.options.rootElement}setup(){const n=this.rootElement;if(n!==void 0){if(n.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");n.__isReactDndBackendSetUp=!0,this.addEventListeners(n)}}teardown(){const n=this.rootElement;if(n!==void 0&&(n.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId)){var s;(s=this.window)===null||s===void 0||s.cancelAnimationFrame(this.asyncEndDragFrameId)}}connectDragPreview(n,s,i){return this.sourcePreviewNodeOptions.set(n,i),this.sourcePreviewNodes.set(n,s),()=>{this.sourcePreviewNodes.delete(n),this.sourcePreviewNodeOptions.delete(n)}}connectDragSource(n,s,i){this.sourceNodes.set(n,s),this.sourceNodeOptions.set(n,i);const a=h=>this.handleDragStart(h,n),c=h=>this.handleSelectStart(h);return s.setAttribute("draggable","true"),s.addEventListener("dragstart",a),s.addEventListener("selectstart",c),()=>{this.sourceNodes.delete(n),this.sourceNodeOptions.delete(n),s.removeEventListener("dragstart",a),s.removeEventListener("selectstart",c),s.setAttribute("draggable","false")}}connectDropTarget(n,s){const i=h=>this.handleDragEnter(h,n),a=h=>this.handleDragOver(h,n),c=h=>this.handleDrop(h,n);return s.addEventListener("dragenter",i),s.addEventListener("dragover",a),s.addEventListener("drop",c),()=>{s.removeEventListener("dragenter",i),s.removeEventListener("dragover",a),s.removeEventListener("drop",c)}}addEventListeners(n){n.addEventListener&&(n.addEventListener("dragstart",this.handleTopDragStart),n.addEventListener("dragstart",this.handleTopDragStartCapture,!0),n.addEventListener("dragend",this.handleTopDragEndCapture,!0),n.addEventListener("dragenter",this.handleTopDragEnter),n.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),n.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),n.addEventListener("dragover",this.handleTopDragOver),n.addEventListener("dragover",this.handleTopDragOverCapture,!0),n.addEventListener("drop",this.handleTopDrop),n.addEventListener("drop",this.handleTopDropCapture,!0))}removeEventListeners(n){n.removeEventListener&&(n.removeEventListener("dragstart",this.handleTopDragStart),n.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),n.removeEventListener("dragend",this.handleTopDragEndCapture,!0),n.removeEventListener("dragenter",this.handleTopDragEnter),n.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),n.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),n.removeEventListener("dragover",this.handleTopDragOver),n.removeEventListener("dragover",this.handleTopDragOverCapture,!0),n.removeEventListener("drop",this.handleTopDrop),n.removeEventListener("drop",this.handleTopDropCapture,!0))}getCurrentSourceNodeOptions(){const n=this.monitor.getSourceId(),s=this.sourceNodeOptions.get(n);return oS({dropEffect:this.altKeyPressed?"copy":"move"},s||{})}getCurrentDropEffect(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}getCurrentSourcePreviewNodeOptions(){const n=this.monitor.getSourceId(),s=this.sourcePreviewNodeOptions.get(n);return oS({anchorX:.5,anchorY:.5,captureDraggingState:!1},s||{})}isDraggingNativeItem(){const n=this.monitor.getItemType();return Object.keys(rS).some(s=>rS[s]===n)}beginDragNativeItem(n,s){this.clearCurrentDragSourceNode(),this.currentNativeSource=AA(n,s),this.currentNativeHandle=this.registry.addSource(n,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}setCurrentDragSourceNode(n){this.clearCurrentDragSourceNode(),this.currentDragSourceNode=n;const s=1e3;this.mouseMoveTimeoutTimer=setTimeout(()=>{var i;return(i=this.rootElement)===null||i===void 0?void 0:i.addEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)},s)}clearCurrentDragSourceNode(){if(this.currentDragSourceNode){if(this.currentDragSourceNode=null,this.rootElement){var n;(n=this.window)===null||n===void 0||n.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)}return this.mouseMoveTimeoutTimer=null,!0}return!1}handleDragStart(n,s){n.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(s))}handleDragEnter(n,s){this.dragEnterTargetIds.unshift(s)}handleDragOver(n,s){this.dragOverTargetIds===null&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(s)}handleDrop(n,s){this.dropTargetIds.unshift(s)}constructor(n,s,i){this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=a=>{const c=this.sourceNodes.get(a);return c&&vT(c)||null},this.endDragNativeItem=()=>{this.isDraggingNativeItem()&&(this.actions.endDrag(),this.currentNativeHandle&&this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)},this.isNodeInDocument=a=>!!(a&&this.document&&this.document.body&&this.document.body.contains(a)),this.endDragIfSourceWasRemovedFromDOM=()=>{const a=this.currentDragSourceNode;a==null||this.isNodeInDocument(a)||(this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover())},this.scheduleHover=a=>{this.hoverRafId===null&&typeof requestAnimationFrame<"u"&&(this.hoverRafId=requestAnimationFrame(()=>{this.monitor.isDragging()&&this.actions.hover(a||[],{clientOffset:this.lastClientOffset}),this.hoverRafId=null}))},this.cancelHover=()=>{this.hoverRafId!==null&&typeof cancelAnimationFrame<"u"&&(cancelAnimationFrame(this.hoverRafId),this.hoverRafId=null)},this.handleTopDragStartCapture=()=>{this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]},this.handleTopDragStart=a=>{if(a.defaultPrevented)return;const{dragStartSourceIds:c}=this;this.dragStartSourceIds=null;const h=g$(a);this.monitor.isDragging()&&(this.actions.endDrag(),this.cancelHover()),this.actions.beginDrag(c||[],{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:h});const{dataTransfer:g}=a,b=xy(g);if(this.monitor.isDragging()){if(g&&typeof g.setDragImage=="function"){const y=this.monitor.getSourceId(),w=this.sourceNodes.get(y),T=this.sourcePreviewNodes.get(y)||w;if(T){const{anchorX:C,anchorY:E,offsetX:k,offsetY:A}=this.getCurrentSourcePreviewNodeOptions(),B=LA(w,T,h,{anchorX:C,anchorY:E},{offsetX:k,offsetY:A});g.setDragImage(T,B.x,B.y)}}try{g==null||g.setData("application/json",{})}catch{}this.setCurrentDragSourceNode(a.target);const{captureDraggingState:$}=this.getCurrentSourcePreviewNodeOptions();$?this.actions.publishDragSource():setTimeout(()=>this.actions.publishDragSource(),0)}else if(b)this.beginDragNativeItem(b);else{if(g&&!g.types&&(a.target&&!a.target.hasAttribute||!a.target.hasAttribute("draggable")))return;a.preventDefault()}},this.handleTopDragEndCapture=()=>{this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleTopDragEnterCapture=a=>{if(this.dragEnterTargetIds=[],this.isDraggingNativeItem()){var c;(c=this.currentNativeSource)===null||c===void 0||c.loadDataTransfer(a.dataTransfer)}if(!this.enterLeaveCounter.enter(a.target)||this.monitor.isDragging())return;const{dataTransfer:g}=a,b=xy(g);b&&this.beginDragNativeItem(b,g)},this.handleTopDragEnter=a=>{const{dragEnterTargetIds:c}=this;if(this.dragEnterTargetIds=[],!this.monitor.isDragging())return;this.altKeyPressed=a.altKey,c.length>0&&this.actions.hover(c,{clientOffset:g$(a)}),c.some(g=>this.monitor.canDropOnTarget(g))&&(a.preventDefault(),a.dataTransfer&&(a.dataTransfer.dropEffect=this.getCurrentDropEffect()))},this.handleTopDragOverCapture=a=>{if(this.dragOverTargetIds=[],this.isDraggingNativeItem()){var c;(c=this.currentNativeSource)===null||c===void 0||c.loadDataTransfer(a.dataTransfer)}},this.handleTopDragOver=a=>{const{dragOverTargetIds:c}=this;if(this.dragOverTargetIds=[],!this.monitor.isDragging()){a.preventDefault(),a.dataTransfer&&(a.dataTransfer.dropEffect="none");return}this.altKeyPressed=a.altKey,this.lastClientOffset=g$(a),this.scheduleHover(c),(c||[]).some(g=>this.monitor.canDropOnTarget(g))?(a.preventDefault(),a.dataTransfer&&(a.dataTransfer.dropEffect=this.getCurrentDropEffect())):this.isDraggingNativeItem()?a.preventDefault():(a.preventDefault(),a.dataTransfer&&(a.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=a=>{this.isDraggingNativeItem()&&a.preventDefault(),this.enterLeaveCounter.leave(a.target)&&(this.isDraggingNativeItem()&&setTimeout(()=>this.endDragNativeItem(),0),this.cancelHover())},this.handleTopDropCapture=a=>{if(this.dropTargetIds=[],this.isDraggingNativeItem()){var c;a.preventDefault(),(c=this.currentNativeSource)===null||c===void 0||c.loadDataTransfer(a.dataTransfer)}else xy(a.dataTransfer)&&a.preventDefault();this.enterLeaveCounter.reset()},this.handleTopDrop=a=>{const{dropTargetIds:c}=this;this.dropTargetIds=[],this.actions.hover(c,{clientOffset:g$(a)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleSelectStart=a=>{const c=a.target;typeof c.dragDrop=="function"&&(c.tagName==="INPUT"||c.tagName==="SELECT"||c.tagName==="TEXTAREA"||c.isContentEditable||(a.preventDefault(),c.dragDrop()))},this.options=new BA(s,i),this.actions=n.getActions(),this.monitor=n.getMonitor(),this.registry=n.getRegistry(),this.enterLeaveCounter=new xA(this.isNodeInDocument)}}let f$;function FA(){return f$||(f$=new Image,f$.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),f$}const yT=function(n,s,i){return new jA(n,s,i)},q$="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='512'%20height='512'%20shape-rendering='geometricPrecision'%20image-rendering='optimizeQuality'%20fill-rule='evenodd'%20xmlns:v='https://vecta.io/nano'%3e%3cpath%20fill='%23efda4e'%20d='M-.5-.5h512v512H-.5V-.5z'/%3e%3cpath%20fill='%23020100'%20d='M308.5%20287.5c1.777-3.005%202.777-6.338%203-10%209.147-21.963%2025.48-35.463%2049-40.5%2021.999-4.173%2043.666-2.84%2065%204%2014.575%205.411%2025.575%2014.911%2033%2028.5l-1%202c-12.413%205.624-24.58%2011.624-36.5%2018-5.321-8.25-12.821-13.417-22.5-15.5-13.957-3.122-27.29-1.455-40%205-8.125%205.36-10.958%2012.86-8.5%2022.5%203.223%206.223%208.057%2010.723%2014.5%2013.5l64%2020c38.459%2016.085%2052.626%2044.585%2042.5%2085.5-7.572%2026.208-24.738%2042.041-51.5%2047.5-25.102%205.733-49.768%204.4-74-4-19.291-8.625-32.291-22.958-39-43%2011.266-8.887%2023.433-16.387%2036.5-22.5%203.117%206.896%206.784%2013.563%2011%2020%2012.705%2012.307%2027.872%2016.807%2045.5%2013.5%2022.189-3.504%2032.355-16.338%2030.5-38.5-2.833-6.833-7.667-11.667-14.5-14.5l-57-17c-36.004-11.84-52.67-36.673-50-74.5z'/%3e%3cpath%20fill='%23020200'%20d='M222.5%20238.5h43l-.5%20159c-2.688%2052.355-30.188%2076.855-82.5%2073.5-24.871-3.543-41.204-17.21-49-41l.5-2.5a12.14%2012.14%200%200%200%204.5-3.5c10.653-5.825%2021.32-11.325%2032-16.5%204.763%2021.72%2017.763%2028.887%2039%2021.5%204.616-2.618%207.783-6.451%209.5-11.5%201.163-5.968%202.163-11.968%203-18l.5-161z'/%3e%3cpath%20fill='%23615820'%20d='M311.5%20277.5c-.223%203.662-1.223%206.995-3%2010%20.223-3.662%201.223-6.995%203-10z'/%3e%3c/svg%3e",_T="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20500%20500'%3e%3cpath%20fill='%234285f4'%20d='M44.271%2027.275l206.5%201v170l-58.5-36.5c-7.005-.916-12.505%201.584-16.5%207.5v147c4.625%204.412%2010.125%206.245%2016.5%205.5l57.5-35.5c.833%2054.003%201.356%20108.003.189%20162-1.272.546-45.599-.242-48.689%201.121-3.674%207.844-4.79%2011.207-13%2023.879-4.372%205.527-2.19%204.097-10.689%2012.258-5.166%202.748-4.191%203.45-14.311%206.242-17.67%201.983-35.336%201.983-53%200-9.535-3.774-10.879-4.163-18.526-11.22-5.562-4.39-11.131-11.803-11.974-15.28-4.068-7.881-3.42-9.116-5.5-13.5-3.672-1.503-35.798.203-40.746-1.335-5.823-2.314-2.946-.422-7.954-3.689-2.888-2.668-2.255-3.221-2.421-9.904L20.771%2050.275c.36-2.108-.41-5.806%202.522-11.615%204.343-5.852%205.374-7%2010.061-9.146%206.083-2.73%208.677-1.475%2010.917-2.239z'/%3e%3cpath%20d='M258.271%2030.275l154.63.407c5.654.559%2010.783%203.17%2014.37%207.093%204.907%204.408%206.204%208.723%207.5%2013.5v373c-.208%205.716-.297%207.982-4.848%2015.404-7.078%206.393-9.879%206.39-15.652%206.692-24.804%201.296-50.079%201.189-74.96%201.041-24.516-.014-68.46.89-81.5.391l-2.512-172.528c-20.083%2012.625-42.777%2025.125-63.028%2037.5-4.127%201.292-7.294.125-9.5-3.5l1-137c1.864-2.707%204.364-3.541%207.5-2.5%2020.366%2013.427%2064.35%2038.947%2065.581%2038.339l1.419-177.839z'%20fill='%23DDD'/%3e%3c/svg%3e",wT="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'%20width='32'%20height='32'%3e%3cpath%20fill='%23007acc'%20d='M-.5-.5h503l-1%20179h10v333h-421v-7h-91V-.5z'/%3e%3cpath%20fill='%230f81cf'%20d='M502.5-.5h9v179h-10l1-179z'/%3e%3cpath%20fill='%23fdfefe'%20d='M470.5%20227.5c.33%2017.508-.003%2034.841-1%2052-23.486-15.709-48.82-19.875-76-12.5-15.89%208.078-19.39%2019.911-10.5%2035.5%204.673%205.577%2010.173%2010.077%2016.5%2013.5l38%2019c17.945%209.278%2031.112%2023.112%2039.5%2041.5%201.352%203.22%202.186%206.553%202.5%2010a305.16%20305.16%200%200%201%201%2026c-3.553%2033.726-21.886%2054.559-55%2062.5-34.769%207.363-68.435%204.196-101-9.5-.167-19.003%200-38.003.5-57%2022.903%2021.314%2049.736%2029.147%2080.5%2023.5%2019.435-5.701%2025.268-17.868%2017.5-36.5-4.718-6.44-10.552-11.606-17.5-15.5a1552.42%201552.42%200%200%201-47-24c-27.679-19.331-38.846-45.831-33.5-79.5%206.43-26.433%2022.597-43.933%2048.5-52.5%2026.131-6.625%2052.464-7.292%2079-2a565.56%20565.56%200%200%201%2018%205.5z'/%3e%3cpath%20fill='%23fefefe'%20d='M122.5%20222.5h182v46h-65v206h-52v-206h-65v-46z'/%3e%3cpath%20fill='%2370b3e1'%20d='M470.5%20227.5c1.327%2017.505%201.327%2035.171%200%2053-.607-.124-.94-.457-1-1%20.997-17.159%201.33-34.492%201-52z'/%3e%3cpath%20fill='%236cafe0'%20d='M479.5%20386.5c1.465%205.09%202.132%2010.423%202%2016-.002%203.518-.335%206.851-1%2010a305.16%20305.16%200%200%200-1-26z'/%3e%3cpath%20fill='%231283cf'%20d='M-.5%20504.5h91v7h-91v-7z'/%3e%3c/svg%3e",CT="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIj4KICAgIDxyYWRpYWxHcmFkaWVudCBpZD0ibXlHcmFkaWVudCI+CiAgICAgICAgPHN0b3Agb2Zmc2V0PSIxMCUiIHN0b3AtY29sb3I9IiMxQzJENUYiIC8+CiAgICAgICAgPHN0b3Agb2Zmc2V0PSI5NSUiIHN0b3AtY29sb3I9IiMwQjFENTMiIC8+CiAgICA8L3JhZGlhbEdyYWRpZW50PgogICAgPHBhdGggZmlsbD0idXJsKCcjbXlHcmFkaWVudCcpIiBkPSJNLS4xLS4xaDUxMnY1MTJILS4xVi0uMXoiLz4KICAgIDxwYXRoIGZpbGw9IiNmOGY4ZmEiCiAgICAgICAgICBkPSJNNDgyLjUgMjMxLjV2NmgtMjVjLS45NzItOC4xNy01LjYzOS0xMi4xNy0xNC0xMi05LjUzMS4wMjktMTMuMzY1IDQuNjk1LTExLjUgMTRsNC41IDQuNSAzMyA4YzE5LjM4OCA5LjYzNCAyMy4zODggMjMuODAxIDEyIDQyLjVhMzUuMDYgMzUuMDYgMCAwIDAtOCA2Yy0xMy45MjUgNC43NjEtMjguMjU4IDYuMjYxLTQzIDQuNS0xMC42MDEtMS4wMjQtMTguOTM1LTUuODU3LTI1LTE0LjUtMS4wNzctMi4yMjktMS43NDQtNC41NjMtMi03di04aDI1YzEuNDk1IDQuMjc5IDMuODI4IDguMTEzIDcgMTEuNSA3LjQ3OCAyLjI1OCAxNC44MTEgMS45MjUgMjItMSAyLjg5NC0yLjkwOSAzLjcyNy02LjQwOSAyLjUtMTAuNWEzNi44IDM2LjggMCAwIDAtMTIuNS01LjUgNTM5Ljc5IDUzOS43OSAwIDAgMS0yOC04Yy0xMi44NzQtNi41NjItMTcuNzA3LTE3LjA2Mi0xNC41LTMxLjUgMy41Ny0xMC41NjkgMTAuNzM3LTE3LjQwMyAyMS41LTIwLjUgMTYuMTQ4LTQuNTM5IDMxLjQ4Mi0yLjcwNiA0NiA1LjUgMiAyLjY2NyA0LjMzMyA1IDcgNyAxLjg3MSAyLjczNCAyLjg3MSA1LjczNCAzIDl6Ii8+CiAgICA8cGF0aCBmaWxsPSIjYTRhYmJmIiBkPSJNMTUzLjUgMjA5LjVjLjA2LS41NDMuMzkzLS44NzYgMS0xYTEwMjQuNjMgMTAyNC42MyAwIDAgMSAxIDY0bC0yLTYzeiIvPgogICAgPHBhdGggZmlsbD0iI2ZhZmJmYyIKICAgICAgICAgIGQ9Ik0xNTMuNSAyMDkuNWwyIDYzYzEuMjc4IDExLjQ0NCA3LjYxMSAxNi4yNzcgMTkgMTQuNSA4LjcwNC0xLjM3OCAxMy4yMDQtNi41NDQgMTMuNS0xNS41LjUtMjAuNjY0LjY2Ny00MS4zMzEuNS02MiA5Ljc0My0uMjE5IDE5LjQwOS0uMjE5IDI5IDAgLjQwMSAyMy4zNjItLjA5OSA0Ni42OTYtMS41IDcwLTQuMjk4IDE0Ljk2OC0xNC4xMzEgMjMuNDY4LTI5LjUgMjUuNWEyMjUuMTQgMjI1LjE0IDAgMCAxLTMwIDBjLTE1LjgyMi0yLjE1NS0yNS42NTUtMTAuOTg4LTI5LjUtMjYuNWwtLjUtNjloMjd6Ii8+CiAgICA8cGF0aCBmaWxsPSIjZmVmZWZlIgogICAgICAgICAgZD0iTTIzMy41IDIwOS41aDI3Yy0uMzMxIDI1LjE3Mi4wMDIgNTAuMTcyIDEgNzUgMCAuNjY3LjMzMyAxIDEgMSAxMy4xNTYuOTk2IDI2LjQ5IDEuMzI5IDQwIDF2MTdoLTY5di05NHoiLz4KICAgIDxwYXRoIGZpbGw9IiNhNWFjYmYiIGQ9Ik0yMzMuNSAyMDkuNWM5LjE1Mi0uOTk0IDE4LjQ4NS0xLjMyNyAyOC0xdjc2Yy0uOTk4LTI0LjgyOC0xLjMzMS00OS44MjgtMS03NWgtMjd6Ii8+CiAgICA8cGF0aCBmaWxsPSIjYTdhZWMxIiBkPSJNMzE2LjUgMjA5LjVoNzNjLjMyMyA2LjE5LS4wMSAxMi4xOS0xIDE4di0xN2MtMjQuMTcyLjMzMS00OC4xNzItLjAwMi03Mi0xeiIvPgogICAgPHBhdGggZmlsbD0iI2E1YWNjMCIgZD0iTTg1LjUgMjEwLjVoLTU5djkzaDI3Yy0uMzI4LTExLjE3OS4wMDUtMjIuMTc5IDEtMzN2MzRoLTI5di05NWE5MDAuOTggOTAwLjk4IDAgMCAxIDYwIDF6Ii8+CiAgICA8cGF0aCBmaWxsPSIjZmNmY2ZjIgogICAgICAgICAgZD0iTTg1LjUgMjEwLjVjMjIuMjIzIDMuNzU4IDI5LjU1NiAxNi40MjUgMjIgMzgtNC4yMjggNS4zOTctOS4yMjggOS44OTctMTUgMTMuNS0xLjMwNS44MDQtMS45NzEgMS45NzEtMiAzLjVsMjMgMzZjLTQuNDUxIDEuMzI3LTkuMjg0IDEuOTk0LTE0LjUgMmExMjguMTkgMTI4LjE5IDAgMCAxLTE1LjUtMWMtNi45NTUtMTAuMzI2LTEzLjQ1NS0yMC45OTItMTkuNS0zMi0zLjI2OS0xLjMxOC02LjQzNS0xLjMxOC05LjUgMC0uOTk1IDEwLjgyMS0xLjMyOCAyMS44MjEtMSAzM2gtMjd2LTkzaDU5eiIvPgogICAgPHBhdGggZmlsbD0iI2ZlZmVmZSIKICAgICAgICAgIGQ9Ik0zMTYuNSAyMDkuNWMyMy44MjguOTk4IDQ3LjgyOCAxLjMzMSA3MiAxdjE3Yy0xNC42Ny0uMTY3LTI5LjMzNyAwLTQ0IC41LTEuMzI2IDYuNTk5LTEuMzI2IDEzLjA5OSAwIDE5LjUgMTQuNDkuOTk2IDI5LjE1NyAxLjMyOSA0NCAxdjE2Yy0xNC44NDMtLjMyOS0yOS41MS4wMDQtNDQgMWE1MC41MSA1MC41MSAwIDAgMCAwIDIwYzE0LjQ5Ljk5NiAyOS4xNTcgMS4zMjkgNDQgMXYxN2gtNzNjLS4zMzItMzEuNTA0LjAwMi02Mi44MzggMS05NHoiLz4KICAgIDxwYXRoIGZpbGw9IiMxODI3NWIiCiAgICAgICAgICBkPSJNNTUuNSAyMjkuNWM3LjA4OS0uMzg0IDE0LjA4OS4xMTYgMjEgMS41IDMuNDAxIDEuMzIgNC43MzUgMy44MiA0IDcuNWwtLjUgNWMtMS43NzEuODA0LTMuMjcxIDEuOTcxLTQuNSAzLjUtNi41OTIgMS4zMjktMTMuMjU5IDEuODI5LTIwIDEuNXYtMTl6Ii8+CiAgICA8cGF0aCBmaWxsPSIjYTVhY2MwIiBkPSJNNDgyLjUgMjMxLjVjLjk2OCAyLjEwNyAxLjMwMiA0LjQ0MSAxIDctOC44NDkuMzI2LTE3LjUxNi0uMDA3LTI2LTFoMjV2LTZ6Ii8+CiAgICA8cGF0aCBmaWxsPSIjYTZhZGMwIiBkPSJNMzQ0LjUgMjQ3LjVoNDV2MThoLTQ1YzE0LjQ5LS45OTYgMjkuMTU3LTEuMzI5IDQ0LTF2LTE2Yy0xNC44NDMuMzI5LTI5LjUxLS4wMDQtNDQtMXoiLz4KICAgIDxwYXRoIGZpbGw9IiNhMmE5YmUiIGQ9Ik00MjguNSAyNzUuNWgtMjV2OGMtLjk3Ny0yLjc4Ny0xLjMxLTUuNzg3LTEtOSA4Ljg0OS0uMzI2IDE3LjUxNi4wMDcgMjYgMXoiLz4KICAgIDxwYXRoIGZpbGw9IiNhNWFjYmYiCiAgICAgICAgICBkPSJNMTEzLjUgMzAxLjVjLjk3OC4zMTEgMS42NDUuOTc4IDIgMmwtMTYgMWMtNS43MTEtLjAwNS0xMS4wNDQtLjY3Mi0xNi0yYTEyOC4xOSAxMjguMTkgMCAwIDAgMTUuNSAxYzUuMjE2LS4wMDYgMTAuMDQ5LS42NzMgMTQuNS0yeiIvPgogICAgPHBhdGggZmlsbD0iI2E1YWNjMCIgZD0iTTIzMy41IDIwOS41djk0aDY5di0xN2MtMTMuNTEuMzI5LTI2Ljg0NC0uMDA0LTQwLTFoNDF2MTloLTcxYTIyNTYuNDEgMjI1Ni40MSAwIDAgMSAxLTk1eiIvPgogICAgPHBhdGggZmlsbD0iI2E2YWNjMCIKICAgICAgICAgIGQ9Ik0zMTYuNSAyMDkuNWMtLjk5OCAzMS4xNjItMS4zMzIgNjIuNDk2LTEgOTRoNzN2LTE3Yy0xNC44NDMuMzI5LTI5LjUxLS4wMDQtNDQtMWg0NXYxOWgtNzVhMjMwNC45NSAyMzA0Ljk1IDAgMCAxIDEtOTZjLjYwNy4xMjQuOTQuNDU3IDEgMXoiLz4KPC9zdmc+",zA=Er([f.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8"},"0"),f.jsx("path",{d:"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z"},"1")],"AccessTime"),UA=Er(f.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4z"}),"AddBox"),WA=Er(f.jsx("path",{d:"M4 8h4V4H4zm6 12h4v-4h-4zm-6 0h4v-4H4zm0-6h4v-4H4zm6 0h4v-4h-4zm6-10v4h4V4zm-6 4h4V4h-4zm6 6h4v-4h-4zm0 6h4v-4h-4z"}),"Apps"),HA=Er(f.jsx("path",{d:"M9 2c-1.05 0-2.05.16-3 .46 4.06 1.27 7 5.06 7 9.54s-2.94 8.27-7 9.54c.95.3 1.95.46 3 .46 5.52 0 10-4.48 10-10S14.52 2 9 2"}),"Brightness3"),ST=Er(f.jsx("path",{d:"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12zm-1 4 6 6v10c0 1.1-.9 2-2 2H7.99C6.89 23 6 22.1 6 21l.01-14c0-1.1.89-2 1.99-2zm-1 7h5.5L14 6.5z"}),"FileCopy"),VA=Er(f.jsx("path",{d:"M7 2v11h3v9l7-12h-4l4-8z"}),"FlashOn"),GA=Er(f.jsx("path",{d:"M18 4H6v2l6.5 6L6 18v2h12v-3h-7l5-5-5-5h7z"}),"Functions"),dw=Er(f.jsx("path",{d:"M11 18h2v-2h-2zm1-16C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m0-14c-2.21 0-4 1.79-4 4h2c0-1.1.9-2 2-2s2 .9 2 2c0 2-3 1.75-3 5h2c0-2.25 3-2.5 3-5 0-2.21-1.79-4-4-4"}),"HelpOutline"),KA=Er(f.jsx("path",{d:"M6 19h4V5H6zm8-14v14h4V5z"}),"Pause"),JA=Er(f.jsx("path",{d:"M8 5v14l11-7z"}),"PlayArrow"),qA=Er(f.jsx("path",{d:"M11 5v5.59H7.5l4.5 4.5 4.5-4.5H13V5zm-5 9c0 3.31 2.69 6 6 6s6-2.69 6-6h-2c0 2.21-1.79 4-4 4s-4-1.79-4-4z"}),"PlayForWork"),YA=Er(f.jsx("path",{d:"M11.07 12.85c.77-1.39 2.25-2.21 3.11-3.44.91-1.29.4-3.7-2.18-3.7-1.69 0-2.52 1.28-2.87 2.34L6.54 6.96C7.25 4.83 9.18 3 11.99 3c2.35 0 3.96 1.07 4.78 2.41.7 1.15 1.11 3.3.03 4.9-1.2 1.77-2.35 2.31-2.97 3.45-.25.46-.35.76-.35 2.24h-2.89c-.01-.78-.13-2.05.48-3.15M14 20c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2"}),"QuestionMark"),XA=Er(f.jsx("path",{d:"M10.59 9.17 5.41 4 4 5.41l5.17 5.17zM14.5 4l2.04 2.04L4 18.59 5.41 20 17.96 7.46 20 9.5V4zm.33 9.41-1.41 1.41 3.13 3.13L14.5 20H20v-5.5l-2.04 2.04z"}),"Shuffle"),ZA=Er(f.jsx("path",{d:"M2 20h20v-4H2zm2-3h2v2H4zM2 4v4h20V4zm4 3H4V5h2zm-4 7h20v-4H2zm2-3h2v2H4z"}),"Storage"),QA=Er(f.jsx("path",{d:"M14 17H4v2h10zm6-8H4v2h16zM4 15h16v-2H4zM4 5v2h16V5z"}),"Subject");class hw extends We.Component{isShowInstance;oldId;constructor(n){super(n),this.state={name:n.name,id:n.id,instance:n.instance||0,prefix:hw.getPrefix(n.id)},this.isShowInstance=!n.folder&&!!n.instances&&(!!n.instance||!!n.instances[0]||n.instances.length>1),this.oldId=n.id}static getPrefix(n){const s=(n||"").split(".");return s.pop(),s.join(".")}getId(n){return n=(n||"").replace(/[\\/\][*,;'"`<>?\s]/g,"_"),`${this.state.prefix}.${n}`}handleCancel=()=>{this.props.onClose()};handleOk=()=>{this.props.onRename(this.oldId,this.state.id,this.state.name,this.state.instance===0?0:this.state.instance||void 0),this.props.onClose()};handleChange=n=>{this.setState({name:n,id:this.getId(n)})};render(){return f.jsxs(D.Dialog,{onClose:()=>!1,maxWidth:"md",fullWidth:!0,open:!0,"aria-labelledby":"confirmation-dialog-title",children:[f.jsx(D.DialogTitle,{id:"confirmation-dialog-title",children:I.I18n.t("Rename")}),f.jsx(D.DialogContent,{children:f.jsxs("form",{noValidate:!0,autoComplete:"off",children:[f.jsx(D.TextField,{variant:"standard",style:{width:"100%"},id:"standard-name",autoFocus:!0,label:I.I18n.t("Name"),value:this.state.name,onKeyUp:n=>{n.key==="Enter"&&(n.preventDefault(),setTimeout(()=>this.handleOk(),200))},onChange:n=>this.handleChange(n.target.value),margin:"normal"}),f.jsx(D.TextField,{variant:"standard",id:"standard-name-id",style:{width:"100%"},label:I.I18n.t("ID"),value:this.state.id,disabled:!0,margin:"normal"}),this.isShowInstance&&f.jsxs(D.FormControl,{variant:"standard",children:[f.jsx(D.InputLabel,{htmlFor:"instance",children:I.I18n.t("Instance")}),f.jsx(D.Select,{variant:"standard",value:this.state.instance,onChange:n=>this.setState({instance:parseInt(n.target.value,10)}),inputProps:{name:"instance",id:"instance"},children:this.props.instances.map(n=>f.jsx(D.MenuItem,{value:n,children:n||"0"},n))})]})]})}),f.jsxs(D.DialogActions,{children:[f.jsx(D.Button,{variant:"contained",onClick:this.handleOk,color:"primary",startIcon:f.jsx(Va,{}),children:I.I18n.t("Ok")}),f.jsx(D.Button,{color:"grey",variant:"contained",onClick:this.handleCancel,startIcon:f.jsx(Jo,{}),children:I.I18n.t("Cancel")})]})]})}}class eO extends We.Component{constructor(n){super(n),this.state={name:n.name,id:n.id}}handleCancel=()=>{this.props.onClose()};handleOk=()=>{this.props.onDelete(this.state.id),this.props.onClose()};render(){return f.jsxs(D.Dialog,{onClose:()=>!1,maxWidth:"md",open:!0,"aria-labelledby":"confirmation-dialog-title",children:[f.jsx(D.DialogTitle,{id:"confirmation-dialog-title",children:I.I18n.t("Are you sure?")}),f.jsxs(D.DialogContent,{children:[f.jsx(AI,{}),f.jsx("span",{style:{fontSize:14,fontWeight:"bold"},children:I.I18n.t("Delete %s",this.state.name)})]}),f.jsxs(D.DialogActions,{children:[f.jsx(D.Button,{variant:"contained",onClick:this.handleOk,color:"primary",startIcon:f.jsx(Va,{}),children:I.I18n.t("Ok")}),f.jsx(D.Button,{color:"grey",variant:"contained",onClick:this.handleCancel,startIcon:f.jsx(Jo,{}),children:I.I18n.t("Cancel")})]})]})}}const tO=""+new URL("tileJS-C48gYbHw.png",import.meta.url).href,nO=""+new URL("tileTS-CsXmgy4B.png",import.meta.url).href,sO=""+new URL("tileBlockly-BMpdinN3.png",import.meta.url).href,rO=""+new URL("tileRules-BkbaFIhs.png",import.meta.url).href,lr={card:{maxWidth:345,minWidth:250,display:"inline-block",margin:"0 10px 0 10px"},media:{height:122},text:{maxWidth:218,minHeight:30},complexity:{fontWeight:"bold",fontStyle:"italic",marginBottom:8}};class Ch extends We.Component{handleCancel=()=>{this.props.onClose()};static openHtml(n){const s=I.I18n.getLanguage();!n.includes("javascript.md")&&(s==="de"||s==="ru")&&(n=n.replace(/\/en\//,`/${s}/`));const i=window.open(n,"_blank");i==null||i.focus()}getJSCard(){return f.jsxs(D.Card,{style:lr.card,children:[f.jsxs(D.CardActionArea,{onClick:()=>this.props.onClose&&this.props.onClose("Javascript/js"),children:[f.jsx(D.CardMedia,{style:lr.media,image:tO,title:"JavaScript"}),f.jsxs(D.CardContent,{children:[f.jsx("h2",{children:"JavaScript"}),f.jsx("div",{style:lr.complexity,children:I.I18n.t("for programmers")}),f.jsx("div",{style:lr.text,children:I.I18n.t("JS description")})]})]}),f.jsxs(D.CardActions,{children:[f.jsx(D.Button,{size:"small",color:"primary",variant:"contained",onClick:()=>this.props.onClose&&this.props.onClose("Javascript/js"),children:I.I18n.t("Add")}),f.jsx(D.Button,{size:"small",color:"secondary",onClick:()=>Ch.openHtml("https://github.com/ioBroker/ioBroker.javascript/blob/master/docs/en/javascript.md"),children:I.I18n.t("Learn More")})]})]})}getTSCard(){return f.jsxs(D.Card,{style:lr.card,children:[f.jsxs(D.CardActionArea,{onClick:()=>this.props.onClose&&this.props.onClose("TypeScript/ts"),children:[f.jsx(D.CardMedia,{style:lr.media,image:nO,title:"TypeScript"}),f.jsxs(D.CardContent,{children:[f.jsx("h2",{children:"TypeScript"}),f.jsx("div",{style:lr.complexity,children:I.I18n.t("for professionals")}),f.jsx("div",{style:lr.text,children:I.I18n.t("TS description")})]})]}),f.jsxs(D.CardActions,{children:[f.jsx(D.Button,{size:"small",color:"primary",variant:"contained",onClick:()=>this.props.onClose&&this.props.onClose("TypeScript/ts"),children:I.I18n.t("Add")}),f.jsx(D.Button,{size:"small",color:"secondary",onClick:()=>Ch.openHtml("https://github.com/ioBroker/ioBroker.javascript/blob/master/docs/en/javascript.md"),children:I.I18n.t("Learn More")})]})]})}getBlocklyCard(){return f.jsxs(D.Card,{style:lr.card,children:[f.jsxs(D.CardActionArea,{onClick:()=>this.props.onClose&&this.props.onClose("Blockly"),children:[f.jsx(D.CardMedia,{style:lr.media,image:sO,title:"Blockly"}),f.jsxs(D.CardContent,{children:[f.jsx("h2",{children:"Blockly"}),f.jsx("div",{style:lr.complexity,children:I.I18n.t("normal")}),f.jsx("div",{style:lr.text,children:I.I18n.t("Blockly description")})]})]}),f.jsxs(D.CardActions,{children:[f.jsx(D.Button,{size:"small",color:"primary",variant:"contained",onClick:()=>this.props.onClose&&this.props.onClose("Blockly"),children:I.I18n.t("Add")}),f.jsx(D.Button,{size:"small",color:"secondary",onClick:()=>Ch.openHtml("https://github.com/ioBroker/ioBroker.javascript/blob/master/docs/en/blockly.md"),children:I.I18n.t("Learn More")})]})]})}getRulesCard(){return f.jsxs(D.Card,{style:lr.card,children:[f.jsxs(D.CardActionArea,{onClick:()=>this.props.onClose&&this.props.onClose("Rules"),children:[f.jsx(D.CardMedia,{style:lr.media,image:rO,title:"Rules"}),f.jsxs(D.CardContent,{children:[f.jsx("h2",{children:"Rules"}),f.jsx("div",{style:lr.complexity,children:I.I18n.t("easy")}),f.jsx("div",{style:lr.text,children:I.I18n.t("Rules description")})]})]}),f.jsxs(D.CardActions,{children:[f.jsx(D.Button,{size:"small",color:"primary",variant:"contained",onClick:()=>this.props.onClose&&this.props.onClose("Rules"),children:I.I18n.t("Add")}),f.jsx(D.Button,{size:"small",color:"secondary",onClick:()=>Ch.openHtml("https://github.com/ioBroker/ioBroker.javascript/blob/master/docs/en/javascript.md"),children:I.I18n.t("Learn More")})]})]})}render(){return f.jsxs(D.Dialog,{onClose:()=>!1,maxWidth:"lg",fullWidth:!0,open:!0,"aria-labelledby":"confirmation-dialog-title",children:[f.jsx(D.DialogTitle,{id:"confirmation-dialog-title",children:I.I18n.t("Add new script")}),f.jsxs(D.DialogContent,{style:{textAlign:"center"},children:[this.getRulesCard(),this.getBlocklyCard(),this.getJSCard(),this.getTSCard()]}),f.jsx(D.DialogActions,{children:f.jsx(D.Button,{color:"grey",onClick:this.handleCancel,startIcon:f.jsx(Jo,{}),children:I.I18n.t("Cancel")})})]})}}class Dy extends We.Component{isShowInstance;constructor(n){super(n),this.state={name:n.name||"Script",instance:n.instance||0,parent:n.parent,error:"",id:""},this.isShowInstance=!n.folder&&!!n.instances&&(!!n.instance||!!n.instances[0]||n.instances.length>1)}getId(n){return n=n||this.state.name||"",n=n.replace(/[\\/\][.*,;'"`<>?\s]/g,"_").trim().replace(/\.$/,"_"),`${this.state?this.state.parent:this.props.parent}.${n}`}handleOk=()=>{this.props.onAdd(this.getId(this.state.name),this.state.name,this.state.instance,this.props.type),this.props.onClose()};render(){var n;return console.log(this.state.name),f.jsxs(D.Dialog,{onClose:()=>!1,maxWidth:"md",fullWidth:!0,open:!0,"aria-labelledby":"confirmation-dialog-title",children:[f.jsx(D.DialogTitle,{id:"confirmation-dialog-title",children:this.props.title||I.I18n.t("Create new")}),f.jsx(D.DialogContent,{children:f.jsxs("form",{noValidate:!0,autoComplete:"off",children:[f.jsx(D.TextField,{variant:"standard",style:{width:"100%"},id:"standard-name",autoFocus:!0,error:!!this.state.error,label:I.I18n.t("Name"),value:this.state.name||"",helperText:this.state.error,slotProps:{input:{endAdornment:this.state.name?f.jsx(D.IconButton,{size:"small",onClick:()=>this.setState({name:""}),children:f.jsx(OI,{})}):void 0}},onKeyUp:s=>{s.preventDefault(),s.key==="Enter"&&!this.state.error&&setTimeout(()=>this.handleOk(),200)},onChange:s=>{var c;const i=s.target.value,a=this.getId(i);i?(c=this.props.existingItems)!=null&&c.includes(a)?this.setState({name:i,id:a,error:I.I18n.t("Duplicate name")}):(console.log(`Set name: "${i}"`),this.setState({name:i,id:a,error:""})):this.setState({name:i,id:a,error:I.I18n.t("Empty name is not allowed")})},margin:"normal"}),f.jsxs(D.FormControl,{variant:"standard",style:{width:"100%"},children:[f.jsx(D.InputLabel,{htmlFor:"parent",children:I.I18n.t("Folder")}),f.jsx(D.Select,{variant:"standard",style:{width:"100%"},value:this.state.parent,onChange:s=>this.setState({parent:s.target.value}),inputProps:{name:"parent",id:"parent"},children:this.props.parents.map(s=>{const i=s.id.split(".");i.splice(0,2);const a=[];let c="script.js";return i.forEach(h=>{c+=`.${h}`;const g=this.props.parents.find(b=>b.id===c);g?a.push(g.name):a.push(h)}),a.length||a.push(s.name),f.jsx(D.MenuItem,{value:s.id,children:a.join(" / ")},s.id)})})]}),f.jsx(D.TextField,{variant:"standard",id:"standard-name-id",style:{width:"100%"},label:I.I18n.t("ID"),value:this.getId(),disabled:!0,margin:"normal"}),this.isShowInstance&&f.jsxs(D.FormControl,{variant:"standard",children:[f.jsx(D.InputLabel,{htmlFor:"instance",children:I.I18n.t("Instance")}),f.jsx(D.Select,{variant:"standard",value:this.state.instance,onChange:s=>this.setState({instance:parseInt(s.target.value,10)}),inputProps:{name:"instance",id:"instance"},children:(n=this.props.instances)==null?void 0:n.map(s=>f.jsx(D.MenuItem,{value:s,children:s||"0"},`instance${s}`))})]})]})}),f.jsxs(D.DialogActions,{children:[f.jsx(D.Button,{variant:"contained",onClick:this.handleOk,disabled:!!this.state.error,color:"primary",startIcon:f.jsx(Va,{}),children:I.I18n.t("Ok")}),f.jsx(D.Button,{color:"grey",variant:"contained",onClick:()=>this.props.onClose(),startIcon:f.jsx(Jo,{}),children:I.I18n.t("Cancel")})]})]})}}const iO={title:o=>({background:o.palette.error.main,color:o.palette.error.contrastText,"&>h2":{color:o.palette.error.contrastText}})};class Hf extends We.Component{handleOk=()=>{this.props.onClose()};render(){return f.jsxs(D.Dialog,{open:!0,maxWidth:"sm",fullWidth:!0,onClose:()=>this.handleOk(),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[f.jsx(D.DialogTitle,{sx:iO.title,id:"alert-dialog-title",children:this.props.title||I.I18n.t("Error")}),f.jsx(D.DialogContent,{children:f.jsx(D.DialogContentText,{id:"alert-dialog-description",children:this.props.text||I.I18n.t("Unknown error!")})}),f.jsx(D.DialogActions,{children:f.jsx(D.Button,{variant:"contained",onClick:()=>this.handleOk(),color:"primary",autoFocus:!0,startIcon:f.jsx(Va,{}),children:I.I18n.t("Ok")})})]})}}const nf={icon:{width:24,height:24},filterWithButton:{width:"100%"},title:{fontWeight:"bold",marginTop:16}};class oO extends We.Component{constructor(n){super(n),this.state={instances:[],filter:window.localStorage.getItem("javascript.debug.filter")||"",showAskForStop:!1,jsInstance:window.localStorage.getItem("javascript.debug.instance")||"",jsInstanceHost:"",adapterToDebug:window.localStorage.getItem("javascript.debug.adapter")||""}}componentDidMount(){this.props.socket.getAdapterInstances().then(n=>{const s=n.filter(g=>{var b;return g&&!((b=g.common)!=null&&b.onlyWWW)}).map(g=>{var y,w,T;const b=g._id.replace(/^system\.adapter\./,""),[$]=b.split(".");return{id:b,enabled:(y=g.common)==null?void 0:y.enabled,host:(w=g.common)==null?void 0:w.host,icon:(T=g.common)!=null&&T.icon?`../../adapter/${$}/${g.common.icon}`:""}});s.sort((g,b)=>g.id>b.id?1:g.id<b.id?-1:0);let i=this.state.jsInstance||"";const a=this.state.jsInstance?s.find(g=>g.id===this.state.jsInstance):null;let c;if(!this.state.jsInstance||!a){const g=s.find(b=>b.id.startsWith("javascript."));c=(g==null?void 0:g.host)||"",i=(g==null?void 0:g.id)||""}else c=(a==null?void 0:a.host)||"";let h=this.state.adapterToDebug||"";h&&!s.find(g=>g.id===h)&&(h=""),this.setState({instances:s,jsInstance:i,adapterToDebug:h,jsInstanceHost:c})})}handleOk=()=>{var n;if((n=this.state.instances.find(s=>s.id===this.state.adapterToDebug))!=null&&n.enabled){this.props.socket.getObject(`system.adapter.${this.state.adapterToDebug}`).then(s=>{s&&(s.common.enabled=!1,this.props.socket.setObject(s._id,s).then(()=>this.props.onDebug(this.state.jsInstance,this.state.adapterToDebug)))});return}this.props.onDebug(this.state.jsInstance,this.state.adapterToDebug)};renderJavascriptList(){const n=this.state.instances.filter(s=>s.id.startsWith("javascript."));return n.length<2?null:f.jsxs(D.Grid2,{children:[f.jsx("div",{style:nf.title,children:I.I18n.t("Host")}),f.jsx(D.List,{component:"nav",children:n.map(s=>f.jsxs(D.ListItemButton,{component:"div",selected:this.state.jsInstance===s.id,onClick:()=>this.setState({jsInstance:s.id,jsInstanceHost:s.host}),children:[f.jsx(D.ListItemIcon,{children:f.jsx("img",{src:s.icon,alt:s.id,style:nf.icon})}),f.jsx(D.ListItemText,{primary:s.id})]},s.id))})]})}renderInstances(){if(!this.state.jsInstance)return f.jsx(D.Grid2,{});const n=this.state.instances.filter(s=>s.id!==this.state.jsInstance&&s.host===this.state.jsInstanceHost&&(!this.state.filter||s.id.includes(this.state.filter.toLowerCase())));return f.jsxs(D.Grid2,{children:[f.jsx("div",{style:nf.title,children:I.I18n.t("Instances")}),f.jsx(D.List,{component:"nav",children:n.map(s=>f.jsxs(D.ListItemButton,{selected:this.state.adapterToDebug===s.id,onDoubleClick:()=>this.setState({adapterToDebug:s.id},()=>this.handleOk()),onClick:()=>this.setState({adapterToDebug:s.id}),children:[f.jsx(D.ListItemIcon,{children:f.jsx("img",{src:s.icon,alt:s.id,style:nf.icon})}),f.jsx(D.ListItemText,{primary:s.id})]},s.id))})]})}render(){return f.jsxs(D.Dialog,{maxWidth:"md",fullWidth:!1,open:!0,onClose:()=>!1,"aria-labelledby":"confirmation-dialog-title",children:[f.jsx(D.DialogTitle,{id:"confirmation-dialog-title",children:this.props.title||I.I18n.t("Debug instance")}),f.jsx(D.DialogContent,{children:f.jsxs(D.Grid2,{container:!0,direction:"column",children:[f.jsx(D.Grid2,{children:f.jsx(D.Input,{style:nf.filterWithButton,value:this.state.filter,placeholder:I.I18n.t("Filter"),onChange:n=>{this.setState({filter:n.target.value}),window.localStorage.setItem("javascript.debug.filter",n.target.value)},endAdornment:f.jsx(D.InputAdornment,{position:"end",children:this.state.filter?f.jsx(D.IconButton,{size:"small","aria-label":"toggle password visibility",onClick:()=>this.setState({filter:""}),children:f.jsx(f_,{})}):""})})}),f.jsx(D.Grid2,{children:f.jsxs(D.Grid2,{container:!0,children:[this.renderJavascriptList(),this.renderInstances()]})})]})}),f.jsxs(D.DialogActions,{children:[f.jsx(D.Button,{variant:"contained",onClick:this.handleOk,disabled:!this.state.jsInstance||!this.state.adapterToDebug,color:"primary",startIcon:f.jsx(Va,{}),children:I.I18n.t("Start")}),f.jsx(D.Button,{color:"grey",variant:"contained",onClick:()=>this.props.onClose(),startIcon:f.jsx(Jo,{}),children:I.I18n.t("Close")})]})]})}}const aO=48,aS=L0[400],lS=EI[400],cS=B0[400],kr="script.js",hh=`${kr}.common`,za=`${kr}.global`,sf=350,lO=16,TT={background:"#164477",color:"white"},bt={drawerPaper:{position:"relative",width:"100%",height:"100%",overflow:"hidden"},toolbar:o=>({height:o.toolbar.height}),toolbarButtons:o=>({color:o.palette.mode==="dark"?"white !important":"black !important"}),iconButtonsDisabled:{filter:"grayscale(100%)",opacity:.5},toolbarSearch:{width:"calc(100% - 105px)",lineHeight:"34px",marginLeft:5},iconButtons:{width:32,height:32,padding:2},iconDropdownMenu:{paddingRight:5},menu:{width:"100%",height:"100%"},innerMenu:{width:"100%",height:"calc(100% - 76px)",overflowX:"hidden",overflowY:"auto"},listItemIcon:{minWidth:32},scriptIcon:{width:18,height:18,borderRadius:2,marginTop:4,marginBottom:4,marginLeft:8,marginRight:4},folder:{cursor:"pointer",padding:0,userSelect:"none"},folderReorder:{opacity:.3,transitionDuration:"0.5s",transitionProperty:"opacity"},folderIcon:{width:20,height:20},folderIconReorder:{paddingTop:4,paddingBottom:4,paddingLeft:8,paddingRight:4},folderIconNoReorder:{cursor:"pointer",paddingTop:4,paddingBottom:4,paddingLeft:8,paddingRight:4},script:{cursor:"pointer",padding:0,userSelect:"none"},scriptReorder:{opacity:1,transitionDuration:"0.5s",transitionProperty:"opacity"},reorder:{},selected:TT,instances:{color:"gray",fontSize:"smaller"},childrenCount:{fontSize:10,opacity:.4},footer:{height:24,display:"flex"},footerButtons:o=>({"& img":{color:o.palette.mode==="dark"?"#ffffff":"#111111",cursor:"pointer",mt:"1px",mr:"2px",height:22,width:22,"&:hover":{backgroundColor:"#dbdbdb"}},"& svg":{color:o.palette.mode==="dark"?"#ffffff":"#111111",cursor:"pointer",mt:"1px",mr:"2px",height:22,width:22,"&:hover":{backgroundColor:"#dbdbdb"}}}),footerButtonsRight:{float:"right"}},ph={Blockly:_T,"Javascript/js":q$,def:q$,Rules:CT,"TypeScript/ts":wT};function T_(o,n,s){var i;return s=s||I.I18n.getLanguage(),(i=n==null?void 0:n.common)!=null&&i.name?typeof n.common.name=="object"?(n.common.name[s]||n.common.name.en||o.replace(/^script\.js./,"")).toString():n.common.name.toString():o.replace(/^script\.js./,"")}function uS(o){var a;const n=[{id:kr,depth:0,index:0,parent:null,title:"root",type:"folder",parentIndex:null}],s=Object.keys(o);for(let c=0;c<s.length;c++){const h=o[s[c]],g=s[c].split(".");g.pop(),h.type==="script"?n.push({id:s[c],title:T_(s[c],h),enabled:!!((a=h==null?void 0:h.common)!=null&&a.enabled),depth:g.length-1,type:h.common.engineType,parent:g.length>1?g.join("."):null,instance:h.common.engine?parseInt(h.common.engine.split(".").pop(),10)||0:null,index:0,parentIndex:0}):n.push({id:s[c],title:T_(s[c],h),depth:g.length-1,type:"folder",parent:g.length>1?g.join("."):null,index:0,parentIndex:null})}let i;do i=!1,n.forEach(c=>{if(c.parent&&!n.find(g=>g.id===c.parent)){const g=c.parent.split(".");g.pop(),n.push({id:c.parent,title:c.parent.split(".").pop()||"",depth:g.length-1,type:"folder",parent:g.length>1?g.join("."):null,index:0,parentIndex:null}),i=!0}});while(i);return n.sort((c,h)=>{const g=c.id.toLowerCase(),b=h.id.toLowerCase();return c.type==="folder"&&h.type!=="folder"?-1:h.type==="folder"&&c.type!=="folder"||g>b?1:g<b?-1:0}),n.forEach((c,h)=>c.index=h),n.forEach(c=>{if(c.parent){const h=n.find(g=>g.id===c.parent);h&&(c.parentIndex=h.index)}}),n}function cO(o){const{onDrop:n}=o,[{isOver:s,isOverAny:i},a]=uw({accept:"script",drop:c=>s?n(c):void 0,collect:c=>({isOver:c.isOver({shallow:!0}),isOverAny:c.isOver()})});return f.jsx("div",{ref:a,style:{background:s?"#40adff":void 0,opacity:i?.7:void 0},children:o.children},o.folderName)}function dS(o){const{name:n}=o,[{opacity:s},i]=hT({type:"script",item:()=>({name:n}),collect:a=>({opacity:a.isDragging()?.3:1})});return f.jsx("div",{ref:i,style:{opacity:s,transform:"translate3d(0, 0, 0)"},children:o.children},n)}class Ha extends We.Component{inputRef;filterTimer;problems;problemsTimer;onProblemUpdatedBound;parent=null;constructor(n){super(n);const s=window.localStorage?window.localStorage.getItem("SideMenu.expanded"):"[]";let i;try{i=JSON.parse(s||"[]")||[]}catch{i=[]}this.inputRef=We.createRef(),this.state={listItems:uS(n.scripts||{}),expanded:i,problems:[],reorder:!1,themeName:this.props.themeName,selected:window.localStorage&&window.localStorage.getItem("SideMenu.selected")||null,creatingScript:null,creatingFolder:!1,copingScript:"",renaming:null,deleting:null,choosingType:!1,errorText:"",instances:n.instances||[],menuOpened:!1,menuAnchorEl:null,menuAnchorFilterEl:null,searchMode:!1,expertMode:this.props.expertMode,searchText:"",width:this.props.width||300,typeFilter:window.localStorage&&window.localStorage.getItem("SideMenu.typeFilter")||"",statusFilter:window.localStorage&&window.localStorage.getItem("SideMenu.statusFilter")||"",runningInstances:this.props.runningInstances||{},scriptsHash:n.scriptsHash,showAdapterDebug:!1,isAllZeroInstances:!1};const a=this.ensureSelectedIsVisible();a&&Object.assign(this.state,{expanded:a}),this.filterTimer=null,Object.assign(this.state,{isAllZeroInstances:this.getIsAllZeroInstances()}),this.problems=null,this.problemsTimer=null,this.onProblemUpdatedBound=this.onProblemUpdated.bind(this)}readProblems(n,s){var i,a;if(s||(s=Object.keys(this.props.scripts)),!s||!s.length)n&&n();else{const c=s.shift(),h=this.props.scripts[c];if(((i=this.props.scripts)==null?void 0:i[c].type)==="script"&&((a=h.common)!=null&&a.enabled)&&!c.match(/^script\.js\.global\./)){const g=h.common.engine.split(".").pop(),b=this,$=`javascript.${g}.scriptProblem.${c.substring(kr.length+1)}`;this.props.socket.getState($).then(y=>{b.onProblemUpdated($,y),setTimeout(()=>b.readProblems(n,s),0)})}else setTimeout(()=>this.readProblems(n,s),0)}}componentDidMount(){this.readProblems(()=>{this.props.instances.forEach(n=>{this.props.socket.subscribeState(`javascript.${n}.scriptProblem.*`,this.onProblemUpdatedBound)})})}componentWillUnmount(){this.props.instances.forEach(n=>{this.props.socket.unsubscribeState(`javascript.${n}.scriptProblem.*`,this.onProblemUpdatedBound)})}onProblemUpdated(n,s){if(!s||!n)return;n=`${kr}.${n.replace(/^javascript\.\d+\.scriptProblem\./,"")}`,this.problems||(this.problems=JSON.parse(JSON.stringify(this.state.problems))||[]);let i=!1;if(s.val)this.problems.includes(n)||(this.problems.push(n),i=!0);else{const a=this.problems.indexOf(n);a!==-1&&(this.problems.splice(a,1),i=!0)}i&&!this.problemsTimer&&(this.problemsTimer=setTimeout(()=>{this.problemsTimer=null,this.setState({problems:this.problems}),this.problems=null},300))}static filterListStatic(n,s,i,a,c){s=JSON.parse(JSON.stringify(s));let h=!1;const g={listItems:s};if(n&&i&&a){const b=a.toLowerCase();if(s.forEach($=>{var C;const y=$.title.toLowerCase();$.filteredPartly=!1;let w=y.includes(b);const T=(C=c==null?void 0:c[$.id])==null?void 0:C.common;if(!w&&(T!=null&&T.source))if(T.engineType==="Blockly"){const E=T.source.lastIndexOf("//");w=T.source.substring(0,E).toLowerCase().includes(b)}else w=T.source.toLowerCase().includes(b);w?$.filtered&&($.filtered=!1,h=!0):$.filtered||($.filtered=!0,h=!0)}),h)for(let $=s.length-1;$>=0;$--){const y=s[$];if(!y.filtered||y.filteredPartly){let w=y;do w!=null&&w.parent&&s[w.parentIndex]&&(h=!0,s[w.parentIndex].filteredPartly=!0),w=w!=null&&w.parent&&s[w.parentIndex]?s[w.parentIndex]:null;while(w)}}}else s.forEach(b=>{(b.filtered||b.filteredPartly)&&(b.filtered=!1,b.filteredPartly=!1,h=!0)}),n||(g.searchText="",g.searchMode=!1,h=!0);return h?g:null}filterList(n,s){const i=Ha.filterListStatic(n,this.state.listItems,this.state.searchMode,this.state.searchText,this.props.scripts);i?this.setState(i,()=>s&&s()):s&&s()}static ensureSelectedIsVisibleStatic(n,s,i){s=JSON.parse(JSON.stringify(s));let a=!1,c=typeof n=="object"?n:i.find(h=>h.id===n);do{if(c!=null&&c.parent){const h=c.parent;c=i.find(g=>g.id===h)}else c=void 0;c&&(s.includes(c.id)||(s.push(c.id),a=!0))}while(c);return a?s:null}ensureSelectedIsVisible(n,s){return Ha.ensureSelectedIsVisibleStatic(n||this.state.selected,s||this.state.expanded,this.state.listItems)}static getDerivedStateFromProps(n,s){const i={};let a=!1;if(s.expertMode!==n.expertMode&&(a=!0,i.expertMode=n.expertMode),s.scriptsHash!==n.scriptsHash&&n.scripts){const c=uS(n.scripts||{});if(i.listItems=c,s.searchText){const b=Ha.filterListStatic(!0,c,s.searchMode,s.searchText,n.scripts);b&&Object.assign(i,b)}const h=Ha.getIsAllZeroInstancesStatic(c,n.instances||[]),g=Ha.ensureSelectedIsVisibleStatic(s.selected,s.expanded,s.listItems);i.isAllZeroInstances=h,g&&(i.expanded=g),a=!0}if(s.width!==n.width&&(a=!0,i.width=n.width),s.themeName!==n.themeName&&(a=!0,i.themeName=n.themeName),n.selectId&&s.selected!==n.selectId){const c=s.listItems.find(h=>h.id===n.selectId);if(!s.reorder&&c){const h=Ha.ensureSelectedIsVisibleStatic(c,s.expanded,s.listItems);i.selected=c.id,h&&(i.expanded=h),a=!0,window.localStorage&&window.localStorage.setItem("SideMenu.selected",c.id)}}return a?i:null}static getIsAllZeroInstancesStatic(n,s){let i=!s[0]&&s.length<=1;return i&&n.forEach(a=>{a.type!=="folder"&&a.instance!==0&&(i=!1)}),i}getIsAllZeroInstances(n,s){return n=n||this.state.listItems,s=s||this.state.instances,Ha.getIsAllZeroInstancesStatic(n||this.state.listItems,s||this.state.instances)}saveExpanded(n){window.localStorage.setItem("SideMenu.expanded",JSON.stringify(n||this.state.expanded))}showError(n){this.setState({errorText:n})}onToggle(n,s){if(s==null||s.stopPropagation(),n===kr)return;const i=[...this.state.expanded],a=i.indexOf(n);a!==-1?(i.splice(a,1),this.state.selected&&this.state.selected.startsWith(`${n}.`)&&window.localStorage&&window.localStorage.setItem("SideMenu.selected",n)):(i.push(n),i.sort()),this.setState({expanded:i}),this.saveExpanded(i)}renderItemButtonsOnEnd(n,s){if(this.state.reorder)return null;if(n.type!=="folder"){let i=n.enabled?aS:cS;return n.enabled&&this.state.problems.includes(n.id)&&(i=lS),[f.jsx(D.IconButton,{onClick:a=>{a.stopPropagation(),this.props.onEnableDisable&&this.props.onEnableDisable(n.id,!n.enabled)},title:n.enabled?I.I18n.t("Pause script"):I.I18n.t("Run script"),disabled:this.props.debugMode,style:{...bt.iconButtons,...this.props.debugMode?bt.iconButtonsDisabled:void 0,color:i},size:"medium",children:n.enabled?f.jsx(vf,{}):f.jsx(V$,{})},"startStop"),this.state.width>sf?f.jsx(D.IconButton,{style:this.props.debugMode?bt.iconButtonsDisabled:void 0,title:I.I18n.t("Delete script"),disabled:n.id===za||n.id===hh||this.props.debugMode,onClick:a=>this.onDelete(n,a),size:"medium",children:f.jsx(A$,{})},"delete"):null,f.jsx(D.IconButton,{style:this.props.debugMode?bt.iconButtonsDisabled:void 0,disabled:this.props.debugMode,title:I.I18n.t("Edit script or just double click"),onClick:a=>this.onEdit(n,a),size:"medium",children:f.jsx(j0,{})},"openInEdit")]}return this.state.width>sf&&n.id!==kr&&n.id!==hh&&n.id!==za&&s!=null&&s.length?f.jsx(D.IconButton,{style:this.props.debugMode?bt.iconButtonsDisabled:void 0,title:I.I18n.t("Delete folder"),disabled:n.id===za||n.id===hh||this.props.debugMode,onClick:i=>this.onDelete(n,i),size:"medium",children:f.jsx(A$,{})},"delete"):null}onDelete(n,s){return s==null||s.stopPropagation(),new Promise(i=>{if(!n){i();return}typeof n!="object"?this.setState({deleting:n},()=>i()):this.setState({deleting:n.id},()=>i())})}onEdit(n,s){this.onClick(n,s),this.props.onEdit&&this.props.onEdit(n.id)}getTextStyle(n){return!this.state.reorder&&n.type!=="folder"?{width:`calc(100% - ${this.state.width>sf?185:137}px)`,overflow:"hidden",whiteSpace:"nowrap",flex:"none",padding:"0 16px 0 0"}:{whiteSpace:"nowrap",padding:"0 16px 0 0"}}onClick(n,s){if(s==null||s.stopPropagation(),!this.state.reorder&&n){const i=this.ensureSelectedIsVisible(n),a={selected:n.id};i&&(a.expanded=i),this.setState(a),window.localStorage&&window.localStorage.setItem("SideMenu.selected",n.id)}}onDblClick(n,s){s==null||s.stopPropagation(),!this.state.reorder&&(n.type==="folder"?this.onToggle(n.id):this.onEdit(n))}isFilteredOut(n){return n.filtered&&!n.filteredPartly||this.state.typeFilter&&n.type!=="folder"&&n.type!==this.state.typeFilter||this.state.statusFilter&&n.type!=="folder"&&(this.state.statusFilter==="running"&&!n.enabled||this.state.statusFilter==="paused"&&n.enabled||this.state.statusFilter==="problems"&&(!n.enabled||this.state.problems.indexOf(n.id)===-1))?!0:n.id===za&&!this.state.expertMode}renderListItem(n,s,i){if(n.id===kr&&!this.state.reorder)return null;const a=(this.state.reorder?n.depth:n.depth-1)*lO;let c=n.title;if(this.state.searchText){const T=c.toLowerCase().indexOf(this.state.searchText.toLowerCase());T!==-1&&(c=[f.jsx("span",{children:c.substring(0,T)},"first"),f.jsx("span",{style:{color:"orange"},children:c.substring(T,T+this.state.searchText.length)},"second"),f.jsx("span",{children:c.substring(T+this.state.searchText.length)},"third")])}!this.state.isAllZeroInstances&&n.type!=="folder"&&(c=[f.jsx("span",{children:c},"title"),f.jsxs("span",{title:I.I18n.t("Instance"),style:bt.instances,children:["[",n.instance,"]"]},"instance")]);const h=this.state.reorder&&!this.props.debugMode,g=Object.assign({marginLeft:a,cursor:n.type==="folder"&&h?"default":"inherit",width:`calc(100% - ${a}px)`},n.id===this.state.selected&&!h?TT:void 0);h||(g.opacity=n.filteredPartly?.5:1),n.id===za&&n.id!==this.state.selected&&(g.color="#00a200");let b=n.id===kr;!b&&s&&(b=this.state.expanded.includes(n.id));let $;n.type==="folder"?$={...bt.folderIcon,...h?bt.folderIconReorder:bt.folderIconNoReorder}:$={...bt.scriptIcon},n.id===za?$.color="#356956":n.id===hh&&($.color="#4899e1");let y=null;(i&&i.length||s&&s.length)&&(y=f.jsx("span",{style:bt.childrenCount,children:i&&i.length!==s.length?`${i.length}(${s.length})`:s.length}));const w={...n.type==="folder"?bt.folder:bt.script,...h?bt.reorder:void 0,...h&&n.type!=="folder"?bt.scriptReorder:void 0,...h&&n.type==="folder"?bt.folderReorder:void 0,...g};return f.jsxs(D.ListItem,{style:w,className:I.Utils.clsx(h&&n.type==="folder"&&"folder-reorder",h&&n.type!=="folder"&&"script-reorder"),onClick:T=>this.onClick(n,T),onDoubleClick:T=>this.onDblClick(n,T),secondaryAction:this.renderItemButtonsOnEnd(n,s),children:[f.jsx(D.ListItemIcon,{style:bt.listItemIcon,children:n.type==="folder"?h||b?f.jsx(RI,{style:$,onClick:T=>!h&&this.onToggle(n.id,T)}):f.jsx(MI,{style:$,onClick:T=>!h&&this.onToggle(n.id,T)}):f.jsx("img",{style:$,alt:n.type,src:ph[n.type]||ph.def})}),f.jsx(D.ListItemText,{sx:{"& .MuiListItemText-primary":n.id===this.state.selected&&!h?bt.selected:void 0},style:this.getTextStyle(n),primary:f.jsxs("span",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[c,y]})})]},n.id)}onDragFinish(n,s){let i=`${s}.${n.split(".").pop()}`;i!==n&&(this.state.listItems.find(a=>a.id===i)&&(i+=`_${I.I18n.t("copy")}`),this.props.onRename&&this.props.onRename(n,i))}renderOneItem(n,s){const i=this.state.statusFilter||this.state.typeFilter?n.filter($=>$.parent===s.id?!this.isFilteredOut($):!1):[],a=n.filter($=>$.parent===s.id);if(this.isFilteredOut(s)||s.type==="folder"&&(this.state.statusFilter||this.state.typeFilter)&&!i.length)return null;const c=this.state.reorder&&!this.props.debugMode,h=this.renderListItem(s,a,i),g=[];let b;return a&&(c||this.state.expanded.includes(s.id)||s.id===kr)&&(b=a.map($=>this.renderOneItem(n,$))),c?s.type==="folder"?g.push(f.jsxs(cO,{onDrop:$=>this.onDragFinish($.name,s.id),folderName:s.id,children:[f.jsx(dS,{name:s.id,children:h},`draggable_${s.id}`),b||null]},`droppable_${s.id}`)):g.push(f.jsxs(dS,{name:s.id,children:[h,b||null]},`draggable_${s.id}`)):(g.push(h),b==null||b.forEach($=>g.push($))),g}renderAllItems(n){const s=n.filter(i=>!i.parent).map(i=>this.renderOneItem(n,i));return f.jsx(D.List,{dense:!0,disablePadding:!0,sx:bt.mainList,children:s})}onAddNew(n){n==null||n.stopPropagation();let s=this.state.listItems.find(a=>a.id===this.state.selected),i=kr;for(;s&&s.type!=="folder";)s=this.state.listItems[s.parentIndex];s&&(i=s.id),this.parent=i,this.setState({choosingType:!0})}onCopy(n,s){n==null||n.stopPropagation();let i=this.state.listItems.find(c=>c.id===s),a=kr;for(;i&&i.type!=="folder";)i=this.state.listItems[i.parentIndex];i&&(a=i.id),this.parent=a,this.setState({copingScript:s||""})}onAddNewFolder(n){n==null||n.stopPropagation();let s=this.state.listItems.find(a=>a.id===this.state.selected),i=kr;for(;s&&s.type!=="folder";)s=this.state.listItems[s.parentIndex];s&&(i=s.id),this.parent=i,this.setState({creatingFolder:!0})}onRename(n){n==null||n.stopPropagation(),this.setState({renaming:this.state.selected})}getUniqueName(n){let s=1,i=`${I.I18n.t("Script")} `;if(n){const a=T_(n,this.props.scripts[n]),c=a.match(/\d+$/);c?(i=a.replace(/\d+$/,""),s=parseInt(c[0],10)+1):i=a}for(;this.state.listItems.find(a=>a.id===`${this.parent}.${i.replace(/\.\s/g,"_")}${s}`);)s++;return i+s}getUniqueFolderName(){let n=1;for(;this.state.listItems.find(s=>s.id===`${this.parent}.${I.I18n.t("Folder")}_${n}`);)n++;return`${I.I18n.t("Folder")} ${n}`}onCloseMenu(n){this.setState({menuOpened:!1,menuAnchorEl:null,menuAnchorFilterEl:null},n)}getMainMenu(n,s){return f.jsxs(D.Menu,{id:"long-menu",anchorEl:this.state.menuAnchorEl,open:this.state.menuOpened,onClose:()=>this.setState({menuOpened:!1,menuAnchorEl:null}),slotProps:{paper:{style:{maxHeight:aO*7.5}}},children:[this.state.width<=sf?f.jsxs(D.MenuItem,{disabled:this.props.debugMode||!this.state.selected||this.state.selected===za||this.state.selected===hh||!!(n!=null&&n.length),onClick:i=>{if(i.stopPropagation(),i.preventDefault(),this.state.listItems.find(a=>a.parent===this.state.selected)){this.showError(I.I18n.t("Cannot delete non empty item!"));return}this.setState({menuOpened:!1,menuAnchorEl:null},()=>this.onDelete(this.state.selected).then(()=>{}))},children:[f.jsx(A$,{style:{...bt.iconDropdownMenu,color:"red"}}),I.I18n.t("Delete")]},"delete"):null,f.jsxs(D.MenuItem,{disabled:this.props.debugMode,selected:this.state.expertMode,onClick:i=>{i.stopPropagation(),i.preventDefault(),this.onCloseMenu(()=>this.props.onExpertModeChange&&this.props.onExpertModeChange(!this.state.expertMode))},children:[f.jsx(I.IconExpert,{style:{...bt.iconDropdownMenu,color:this.state.expertMode?"orange":"inherit"}}),I.I18n.t("Expert mode")]},"expertMode"),this.props.onExport&&f.jsxs(D.MenuItem,{onClick:i=>{i.stopPropagation(),i.preventDefault(),this.onCloseMenu(()=>this.props.onExport())},children:[f.jsx(G$,{style:bt.iconDropdownMenu}),I.I18n.t("Export all scripts")]},"exportAll"),this.props.onImport&&f.jsxs(D.MenuItem,{disabled:this.props.debugMode,onClick:i=>{i.stopPropagation(),i.preventDefault(),this.onCloseMenu(()=>this.props.onImport())},children:[f.jsx(m_,{style:bt.iconDropdownMenu}),I.I18n.t("Import scripts")]},"import"),this.props.onThemeChange&&f.jsxs(D.MenuItem,{onClick:()=>this.onCloseMenu(()=>{this.props.onThemeChange&&this.props.onThemeChange(I.Utils.toggleTheme(this.state.themeName))}),children:[f.jsx(NI,{style:bt.iconDropdownMenu}),I.I18n.t('Change theme (actual "%s")',this.state.themeName)]},"dark"),this.props.onAddNew&&f.jsxs(D.MenuItem,{disabled:!this.state.selected||!s||s.type==="folder",onClick:i=>{const a=this.state.selected;this.onCloseMenu(()=>this.onCopy(i,a))},children:[f.jsx(nw,{style:bt.iconDropdownMenu}),I.I18n.t("Copy script")]},"copy"),this.state.expertMode&&f.jsxs(D.MenuItem,{disabled:this.props.debugMode,onClick:i=>{i.stopPropagation(),i.preventDefault(),this.onCloseMenu(()=>this.setState({showAdapterDebug:!0}))},children:[f.jsx(uf,{style:bt.iconDropdownMenu}),I.I18n.t("Debug instance")]},"debugInstance")]},"menu")}getToolbarButtons(){const n=[],s=this.state.reorder&&!this.props.debugMode;if(this.state.searchMode&&!this.props.debugMode)n.push(f.jsx(D.Input,{value:this.state.searchText,style:bt.toolbarSearch,ref:this.inputRef,autoFocus:!0,placeholder:I.I18n.t("Search..."),onChange:i=>{this.setState({searchText:i.target.value}),this.filterTimer&&clearTimeout(this.filterTimer),this.filterTimer=setTimeout(()=>{this.filterTimer=null,this.filterList(!0),this.props.onSearch&&this.props.onSearch(this.state.searchText)},400)}},"searchInput")),n.push(f.jsx(D.IconButton,{sx:bt.toolbarButtons,style:{float:"right"},title:I.I18n.t("End search mode"),onClick:i=>{i.stopPropagation(),this.filterList(!1,()=>this.props.onSearch&&this.props.onSearch(this.state.searchText))},size:"medium",children:f.jsx(LI,{})},"disableSearch")),this.state.searchText&&n.push(f.jsx(D.IconButton,{title:I.I18n.t("Clear search input"),sx:bt.toolbarButtons,style:{marginTop:7,float:"right"},onClick:i=>{i.stopPropagation(),this.setState({searchText:""},()=>{this.filterList(!0),this.props.onSearch&&this.props.onSearch(this.state.searchText)})},size:"medium",children:f.jsx(Xl,{fontSize:"small"})},"cleanSearch"));else{if(!s){n.push(f.jsx(D.IconButton,{"aria-label":"More","aria-owns":this.state.menuOpened?"long-menu":void 0,title:I.I18n.t("Menu"),"aria-haspopup":"true",onClick:c=>{c.stopPropagation(),c.preventDefault(),this.setState({menuOpened:!0,menuAnchorEl:c.currentTarget})},size:"medium",children:f.jsx(BI,{})},"menuButton"));const i=this.state.listItems.find(c=>c.id===this.state.selected);let a;i&&this.state.width<=sf&&i.type==="folder"&&(a=this.state.listItems.filter(c=>c.parent===this.state.selected)),n.push(this.getMainMenu(a,i)),n.push(f.jsx(D.IconButton,{disabled:this.props.debugMode,title:I.I18n.t("Create new script"),sx:{...bt.toolbarButtons,...this.props.debugMode?bt.iconButtonsDisabled:void 0},style:{color:s?"red":"inherit"},onClick:c=>this.onAddNew(c),size:"medium",children:f.jsx(Ev,{})},"new-script")),n.push(f.jsx(D.IconButton,{disabled:this.props.debugMode,title:I.I18n.t("Create new folder"),sx:{...bt.toolbarButtons,...this.props.debugMode?bt.iconButtonsDisabled:void 0},style:{color:s?"red":"inherit"},onClick:c=>this.onAddNewFolder(c),size:"medium",children:f.jsx(PI,{})},"new-folder"))}n.push(f.jsx(D.IconButton,{disabled:s||this.props.debugMode,sx:{...bt.toolbarButtons,...this.props.debugMode?bt.iconButtonsDisabled:void 0},title:I.I18n.t("Search in scripts"),style:{float:"right",opacity:this.props.debugMode?.5:s?0:1},onClick:i=>{i.stopPropagation(),this.setState({searchMode:!0})},size:"medium",children:f.jsx(jI,{})},"search")),n.push(f.jsx(D.IconButton,{disabled:this.props.debugMode,title:I.I18n.t("Reorder scripts in folders"),sx:{...bt.toolbarButtons,...this.props.debugMode?bt.iconButtonsDisabled:void 0},style:{color:s?"red":"inherit",float:"right"},onClick:i=>{i.stopPropagation(),this.setState({reorder:!this.state.reorder})},size:"medium",children:f.jsx(FI,{})},"reorder")),!s&&this.state.selected&&this.state.selected!==za&&this.state.selected!==hh&&n.push(f.jsx(D.IconButton,{sx:{...bt.toolbarButtons,...this.props.debugMode?bt.iconButtonsDisabled:void 0},disabled:this.props.debugMode,title:I.I18n.t("Rename"),onClick:i=>this.onRename(i),size:"medium",children:f.jsx(zI,{})},"rename")),n.push(f.jsxs("span",{style:{opacity:.5,fontSize:10},children:["v",this.props.version]},"version"))}return n}getFolders(){const n=[{id:kr,name:I.I18n.t("Root folder")}];return this.state.listItems.forEach(s=>{s.type==="folder"&&s.id!==kr&&(!s.id.startsWith(za)||this.state.expertMode)&&n.push({id:s.id,name:s.title})}),n}onCollapseAll(){this.setState({expanded:[]}),this.saveExpanded([])}onExpandAll(){const n=[];this.state.listItems.forEach(s=>this.state.listItems.find(i=>i.parent===s.id)&&n.push(s.id)),this.setState({expanded:n}),this.saveExpanded(n)}getBottomButtons(){return this.state.reorder||this.props.debugMode?null:[f.jsx(D.Box,{sx:bt.footerButtons,children:f.jsx(vf,{style:{color:aS,opacity:this.state.statusFilter==="running"?1:.3,background:this.state.statusFilter==="running"?"gray":"inherit"},title:I.I18n.t("Show only running scripts"),onClick:n=>{n.stopPropagation(),n.preventDefault();const s=this.state.statusFilter==="running"?"":"running";window.localStorage&&window.localStorage.setItem("SideMenu.statusFilter",s),this.setState({statusFilter:s})}})},"filterByRunning"),f.jsx(D.Box,{sx:bt.footerButtons,children:f.jsx(V$,{title:I.I18n.t("Show only paused scripts"),style:{color:cS,opacity:this.state.statusFilter==="paused"?1:.3,background:this.state.statusFilter==="paused"?"gray":"inherit"},onClick:()=>{const n=this.state.statusFilter==="paused"?"":"paused";window.localStorage&&window.localStorage.setItem("SideMenu.statusFilter",n),this.setState({statusFilter:n})}})},"filterByPaused"),f.jsx(D.Box,{sx:bt.footerButtons,style:{marginRight:16},children:f.jsx(vf,{title:I.I18n.t("Show only scripts with problems"),style:{color:lS,opacity:this.state.statusFilter==="problems"?1:.3,background:this.state.statusFilter==="problems"?"gray":"inherit"},onClick:()=>{const n=this.state.statusFilter==="problems"?"":"problems";window.localStorage&&window.localStorage.setItem("SideMenu.statusFilter",n),this.setState({statusFilter:n})}})},"filterByProblem"),f.jsx(D.Box,{sx:bt.footerButtons,children:f.jsx("img",{alt:"Blockly",style:{opacity:this.state.typeFilter==="Blockly"?1:.3,background:this.state.typeFilter==="Blockly"?"gray":"inherit"},src:ph.Blockly,onClick:()=>{const n=this.state.typeFilter==="Blockly"?"":"Blockly";window.localStorage&&window.localStorage.setItem("SideMenu.typeFilter",n),this.setState({typeFilter:n})}})},"filterBlockly"),f.jsx(D.Box,{sx:bt.footerButtons,children:f.jsx("img",{alt:"Javascript",style:{opacity:this.state.typeFilter==="Javascript/js"?1:.3,background:this.state.typeFilter==="Javascript/js"?"gray":"inherit"},src:ph["Javascript/js"],onClick:()=>{const n=this.state.typeFilter==="Javascript/js"?"":"Javascript/js";window.localStorage&&window.localStorage.setItem("SideMenu.typeFilter",n),this.setState({typeFilter:n})}})},"filterJS"),f.jsx(D.Box,{sx:bt.footerButtons,children:f.jsx("img",{alt:"TypeScript",style:{opacity:this.state.typeFilter==="TypeScript/ts"?1:.3,background:this.state.typeFilter==="TypeScript/ts"?"gray":"inherit"},src:ph["TypeScript/ts"],onClick:()=>{const n=this.state.typeFilter==="TypeScript/ts"?"":"TypeScript/ts";window.localStorage&&window.localStorage.setItem("SideMenu.typeFilter",n),this.setState({typeFilter:n})}})},"filterTS"),f.jsx(D.Box,{sx:bt.footerButtons,children:f.jsx("img",{alt:"Rules",style:{opacity:this.state.typeFilter==="Rules"?1:.3,background:this.state.typeFilter==="Rules"?"gray":"inherit"},src:ph.Rules,onClick:()=>{const n=this.state.typeFilter==="Rules"?"":"Rules";window.localStorage&&window.localStorage.setItem("SideMenu.typeFilter",n),this.setState({typeFilter:n})}})},"filterRules"),f.jsx("div",{style:{flexGrow:1}},"padding"),f.jsx(D.Box,{sx:bt.footerButtons,children:f.jsx(UI,{style:bt.footerButtonsRight,title:I.I18n.t("Expand all"),onClick:()=>this.onExpandAll()})},"expandAll"),this.state.expanded.length?f.jsx(D.Box,{sx:bt.footerButtons,children:f.jsx(WI,{style:bt.footerButtonsRight,title:I.I18n.t("Collapse all"),onClick:()=>this.onCollapseAll()})},"collapseAll"):f.jsx("div",{style:{height:22,width:24}})]}getAdapterDebugDialog(){return this.state.showAdapterDebug?f.jsx(oO,{socket:this.props.socket,onClose:()=>this.setState({showAdapterDebug:!1}),onDebug:(n,s)=>this.setState({showAdapterDebug:!1},()=>this.props.onDebugInstance({instance:n,adapter:s}))},"debug"):null}render(){var i,a,c;const n=this.state.renaming?this.state.listItems.find(h=>h.id===this.state.renaming):void 0,s=this.state.copingScript&&this.props.scripts[this.state.copingScript].type==="script"?this.props.scripts[this.state.copingScript]:void 0;return[f.jsxs(D.Drawer,{variant:"permanent",style:bt.menu,sx:{"& .MuiDrawer-paper":bt.drawerPaper},anchor:"left",onClick:()=>this.onClick({id:""}),children:[f.jsx(D.Box,{sx:bt.toolbar,children:this.getToolbarButtons()}),f.jsx(D.Divider,{}),f.jsx(oT,{backend:yT,children:f.jsx("div",{style:bt.innerMenu,children:this.renderAllItems(this.state.listItems)})}),f.jsx(D.Divider,{}),f.jsx("div",{style:bt.footer,children:this.getBottomButtons()})]},"drawer"),n?f.jsx(hw,{name:n.title,id:this.state.renaming||"",folder:n.type==="folder",instance:n.instance,instances:this.props.instances,onClose:()=>this.setState({renaming:null}),onRename:(h,g,b,$)=>this.props.onRename&&this.props.onRename(h,g,b,$)},"dialog-rename"):null,this.state.deleting?f.jsx(eO,{name:this.state.listItems.find(h=>h.id===this.state.deleting).title,id:this.state.deleting,onClose:()=>this.setState({deleting:null}),onDelete:h=>this.props.onDelete&&this.props.onDelete(h)},"dialog-delete"):null,this.state.choosingType?f.jsx(Ch,{onClose:h=>{const g={choosingType:!1};h&&(g.creatingScript=h),this.setState(g)}},"dialog-script-type"):null,this.state.creatingScript?f.jsx(Dy,{onClose:()=>this.setState({creatingScript:null}),title:I.I18n.t("Create new script"),name:this.getUniqueName(),parents:this.getFolders(),folder:!1,existingItems:this.state.listItems.map(h=>h.id),instance:this.props.instances[0]||0,instances:this.props.instances,type:this.state.creatingScript,parent:this.parent,onAdd:(h,g,b,$)=>this.props.onAddNew&&this.props.onAddNew(h,g,!1,b,$)},"dialog-new-script"):null,this.state.copingScript?f.jsx(Dy,{onClose:()=>this.setState({copingScript:""}),title:I.I18n.t("Copy script"),name:this.getUniqueName(this.state.copingScript),parents:this.getFolders(),folder:!1,instance:parseInt((a=(i=s==null?void 0:s.common)==null?void 0:i.engine)==null?void 0:a.split(".").pop(),10)||0,instances:this.props.instances,type:((c=s==null?void 0:s.common)==null?void 0:c.engineType)||"Javascript/js",parent:this.parent,onAdd:(h,g,b,$)=>{var w;const y=this.state.copingScript&&this.props.scripts[this.state.copingScript].type==="script"?this.props.scripts[this.state.copingScript]:void 0;y!=null&&y.common&&(y.common.enabled=!1),this.props.onAddNew&&this.props.onAddNew(h,g,!1,b,$,(w=y==null?void 0:y.common)==null?void 0:w.source)}},"dialog-copy-script"):null,this.state.creatingFolder?f.jsx(Dy,{onClose:()=>this.setState({creatingFolder:!1}),title:I.I18n.t("Create new folder"),parents:this.getFolders(),name:this.getUniqueFolderName(),parent:this.parent,onAdd:(h,g)=>this.props.onAddNew&&this.props.onAddNew(h,g,!0)},"dialog-new-folder"):null,this.state.errorText?f.jsx(Hf,{onClose:()=>this.setState({errorText:""}),text:this.state.errorText},"error"):null,this.getAdapterDebugDialog()]}}const uO="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgAQMAAADYVuV7AAAABlBMVEUAAAAzMzPI8eYgAAAAAXRSTlMAQObYZgAAACFJREFUeAFjAIJRwP////8PYIKWHCigNQdKj/pn1D+jAABTG16wVQqVpQAAAABJRU5ErkJggg==",dO="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgAQMAAADYVuV7AAAABlBMVEUAAAAzMzPI8eYgAAAAAXRSTlMAQObYZgAAABtJREFUeAFjAIJRwP8fCj7QkENn/4z6Z5QzCgBjbWaoyx1PqQAAAABJRU5ErkJggg==";function hO(o){let n,s=o.getHours();return s<10&&(s=`0${s.toString()}`),n=`${s}:`,s=o.getMinutes(),s<10&&(s=`0${s.toString()}`),n+=`${s}:`,s=o.getSeconds(),s<10&&(s=`0${s.toString()}`),n+=`${s}.`,s=o.getMilliseconds(),s<10?s=`00${s.toString()}`:s<100&&(s=`0${s.toString()}`),n+=s,n}const hS=34,cr={logBox:{width:"100%",height:"100%",position:"relative",overflow:"hidden"},logBoxInner:o=>({display:"inline-block",color:o.palette.mode==="dark"?"white":"black",width:`calc(100% - ${hS}px)`,height:"100%",overflow:"auto",position:"relative",verticalAlign:"top"}),info:o=>({background:o.palette.mode==="dark"?"darkgrey":"lightgrey",color:(o.palette.mode==="dark","black")}),error:o=>({background:"#FF0000",color:o.palette.mode==="dark"?"black":"white"}),warn:o=>({background:"#FF8000",color:o.palette.mode==="dark"?"black":"white"}),debug:o=>({background:"gray",opacity:.8,color:o.palette.mode==="dark"?"black":"white"}),silly:o=>({background:"gray",opacity:.6,color:o.palette.mode==="dark"?"black":"white"}),table:{fontFamily:"monospace",width:"100%"},toolbox:{width:hS,height:"100%",boxShadow:"2px 0px 4px -1px rgba(0, 0, 0, 0.2), 4px 0px 5px 0px rgba(0, 0, 0, 0.14), 1px 0px 10px 0px rgba(0, 0, 0, 0.12)",display:"inline-block",verticalAlign:"top",overflow:"hidden"},trFrom:{width:90},trTime:{width:90},trSeverity:{width:40,fontWeight:"bold"},trPreMessage:{padding:0,margin:0},iconButtons:{width:32,height:32,padding:4},layoutIcon:o=>({"& img":{width:24,height:24,background:o.palette.mode==="dark"?"#9d9d9d":void 0,borderRadius:o.palette.mode==="dark"?"30px":void 0}})};function pO(o){return o<10?`00${o}`:o<100?`0${o}`:o.toString()}const Fo={};class pw extends We.Component{messagesEnd;constructor(n){super(n),this.state={lines:{},goBottom:!0,selected:null,editing:this.props.editing||[]},this.messagesEnd=We.createRef()}static generateLine(n,s){let i=n.message||"";if(typeof i!="object"){const a=new RegExp(`${n.from.replace(".","\\.").replace(")","\\)").replace("(","\\(")} \\(\\d+\\) `,"g"),c=i.match(a);c?i=i.replace(c[0],""):i=i.replace(`${n.from} `,"")}return i.startsWith(`${s}: `)&&(i=i.substring(s.length+2)),f.jsxs(D.Box,{component:"tr",sx:cr[n.severity],children:[f.jsx("td",{style:cr.trFrom,children:n.from}),f.jsx("td",{style:cr.trTime,children:hO(new Date(n.ts))}),f.jsx("td",{style:cr.trSeverity,children:n.severity}),f.jsx("td",{children:f.jsx("pre",{style:cr.trPreMessage,children:i})})]},`tr_${n.ts}_${n.message.substring(n.message.length-10)}`)}scrollToBottom(){var n,s;(s=(n=this.messagesEnd)==null?void 0:n.current)==null||s.scrollIntoView({behavior:"smooth"})}logHandler=n=>{const s=this.state.lines,i=this.state.editing.filter($=>n.message.includes($));let a=null;if(!i.length||(i.length===1?a=i[0]:(i.sort(),a=i[i.length-1]),!a))return;const c=s[a]||[],h=Fo[a]||[];c.push(pw.generateLine(n,a));let g=n.severity;(g==="info"||g==="warn")&&(g+=" ");const b=new Date(n.ts);h.push(`${b.toLocaleString()}.${pO(b.getMilliseconds())}	[${g}]: ${n.message}`),c.length>300&&(c.splice(0,c.length-300),h.splice(0,c.length-300)),Fo[a]=h,s[a]=c,this.setState({lines:s})};componentDidMount(){this.props.socket.registerLogHandler(this.logHandler)}componentWillUnmount(){this.props.socket.unregisterLogHandler(this.logHandler)}componentDidUpdate(){this.state.goBottom&&this.scrollToBottom()}static getDerivedStateFromProps(n,s){let i=!1;const a={};if(n.selected!==s.selected){const c=n.selected,h=s.lines;c&&(h[c]=h[c]||[],Fo[c]=Fo[c]||[]),a.selected=c,i=!0}if(JSON.stringify(n.editing)!==JSON.stringify(s.editing)){const c=JSON.parse(JSON.stringify(n.editing));i=!0;const h=s.lines;for(const g in Fo)Object.prototype.hasOwnProperty.call(Fo,g)&&(c.includes(g)||(delete Fo[g],delete h[g]));a.editing=c}return i?a:null}onCopy(){I.Utils.copyToClipboard((Fo[this.state.selected]||[]).join(`
`))}clearLog(){const n=this.state.lines;n[this.state.selected]&&(n[this.state.selected]=[]),Fo[this.state.selected]&&(Fo[this.state.selected]=[]),this.setState({lines:n})}renderLogList(n){return this.state.selected&&(n!=null&&n.length)?f.jsxs(D.Box,{sx:cr.logBoxInner,children:[f.jsx("table",{style:cr.table,children:f.jsx("tbody",{children:n})},"logTable"),f.jsx("div",{ref:this.messagesEnd,style:{float:"left",clear:"both"}},"logScrollPoint")]},"logList"):f.jsx(D.Box,{sx:cr.logBoxInner,style:{paddingLeft:10},children:I.I18n.t("Log outputs")},"logList")}render(){const n=this.state.selected?this.state.lines[this.state.selected]:null;return f.jsxs("div",{style:cr.logBox,children:[f.jsxs("div",{style:cr.toolbox,children:[f.jsx(D.IconButton,{style:cr.iconButtons,onClick:()=>this.setState({goBottom:!this.state.goBottom}),color:this.state.goBottom?"secondary":void 0,size:"medium",children:f.jsx(F0,{})}),n!=null&&n.length?f.jsx(D.IconButton,{style:cr.iconButtons,onClick:()=>this.clearLog(),size:"medium",children:f.jsx(z0,{})}):null,n!=null&&n.length?f.jsx(D.IconButton,{style:cr.iconButtons,onClick:()=>this.onCopy(),size:"medium",children:f.jsx(nw,{})}):null,this.props.onLayoutChange?f.jsx(D.IconButton,{style:cr.iconButtons,onClick:()=>this.props.onLayoutChange&&this.props.onLayoutChange(),title:I.I18n.t("Change layout"),size:"medium",sx:cr.layoutIcon,children:f.jsx("img",{alt:"split",src:this.props.verticalLayout?uO:dO})}):null,f.jsx(D.IconButton,{style:cr.iconButtons,onClick:()=>this.props.onHideLog(),title:I.I18n.t("Hide logs"),size:"medium",children:f.jsx(HI,{})})]},"toolbox"),this.renderLogList(n)]})}}var pS="focus-outline-hidden";function kT(){var o=this;document.addEventListener("keydown",function(n){o.focusByKeyboard=!0},!0),document.addEventListener("mousedown",function(n){o.focusByKeyboard=!1},!0),document.addEventListener("focus",function(n){o.updateVisibility()},!0),document.addEventListener("focusout",function(n){window.setTimeout(function(){document.hasFocus()||(o.focusByKeyboard=!0,o.updateVisibility())},0)}),this.updateVisibility()}kT.prototype={focusByKeyboard:!0,updateVisibility:function(){this.hidden=!this.focusByKeyboard},set hidden(o){document.documentElement.classList.toggle(pS,o)},get hidden(){return document.documentElement.classList.contains(pS)}};new kT;var ET={exports:{}};/*!
  Copyright (c) 2018 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(o){(function(){var n={}.hasOwnProperty;function s(){for(var i=[],a=0;a<arguments.length;a++){var c=arguments[a];if(c){var h=typeof c;if(h==="string"||h==="number")i.push(c);else if(Array.isArray(c)){if(c.length){var g=s.apply(null,c);g&&i.push(g)}}else if(h==="object")if(c.toString===Object.prototype.toString)for(var b in c)n.call(c,b)&&c[b]&&i.push(b);else i.push(c.toString())}}return i.join(" ")}o.exports?(s.default=s,o.exports=s):window.classNames=s})()})(ET);var gO=ET.exports;const gS=Ga(gO);var k_={exports:{}},E_={exports:{}},Su={};Object.defineProperty(Su,"__esModule",{value:!0});var fO=Su.easeFunctions={linear:function(n){return n},easeInQuad:function(n){return n*n},easeOutQuad:function(n){return n*(2-n)},easeInOutQuad:function(n){return n<.5?2*n*n:-1+(4-2*n)*n},easeInCubic:function(n){return n*n*n},easeOutCubic:function(n){return--n*n*n+1},easeInOutCubic:function(n){return n<.5?4*n*n*n:(n-1)*(2*n-2)*(2*n-2)+1},easeInQuart:function(n){return n*n*n*n},easeOutQuart:function(n){return 1- --n*n*n*n},easeInOutQuart:function(n){return n<.5?8*n*n*n*n:1-8*--n*n*n*n},easeInQuint:function(n){return n*n*n*n*n},easeOutQuint:function(n){return 1+--n*n*n*n*n},easeInOutQuint:function(n){return n<.5?16*n*n*n*n*n:1+16*--n*n*n*n*n}},mO=Su.isNumeric=function(n){return!isNaN(parseFloat(n))&&isFinite(n)};Su.setPosition=function(n,s,i,a){var c=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"easeInOutCubic";return i>a?s:n+(s-n)*fO[c](i/a)};Su.calcEndPoint=function(n){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(mO(n))return parseInt(n)+i;var a=s===window||s===document.documentElement?window.pageYOffset:s.scrollTop-s.getBoundingClientRect().top,c=n.nodeName.toLowerCase()==="html"?-a:n.getBoundingClientRect().top+a;return c+i};(function(o,n){Object.defineProperty(n,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol=="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},i=Su;n.default=function(a){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=c.duration,g=h===void 0?500:h,b=c.context,$=b===void 0?window:b,y=c.offset,w=y===void 0?0:y,T=c.ease,C=T===void 0?"easeInOutCubic":T,E=c.callback;if((typeof window>"u"?"undefined":s(window))==="object"){var k=$.scrollTop!==null&&$.scrollTop!==void 0?$.scrollTop:window.pageYOffset,A=(0,i.calcEndPoint)(a,$,w),P=performance.now(),N=window.requestAnimationFrame,B=function S(){var H=performance.now()-P,q=(0,i.setPosition)(k,A,H,g,C);$!==window?$.scrollTop=q:window.scroll(0,q),H>g?typeof E=="function"&&E(a):N(S)};B()}},o.exports=n.default})(E_,E_.exports);var IT=E_.exports,I_={exports:{}};(function(o,n){Object.defineProperty(n,"__esModule",{value:!0});var s=Object.assign||function(h){for(var g=1;g<arguments.length;g++){var b=arguments[g];for(var $ in b)Object.prototype.hasOwnProperty.call(b,$)&&(h[$]=b[$])}return h},i=IT,a=c(i);function c(h){return h&&h.__esModule?h:{default:h}}n.default=function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},g=h.query,b=g===void 0?'[href^="#"]:not([href="#"]':g,$=h.match,y=$===void 0?function(A){return document.getElementById(A.hash.substring(1))}:$,w=h.hashChange,T=w===void 0?!0:w,C=h.scrollSmoothConfig,E=document.querySelectorAll(b),k=function(P){P.preventDefault();var N=y(P.target);N&&(T&&history.replaceState(null,null,"#"+N.id),(0,a.default)(N,s({},C)))};Array.from(E).map(function(A){A.addEventListener("click",k,!1)})},o.exports=n.default})(I_,I_.exports);var bO=I_.exports,x_={exports:{}};(function(o,n){Object.defineProperty(n,"__esModule",{value:!0});function s(i){if(Array.isArray(i)){for(var a=0,c=Array(i.length);a<i.length;a++)c[a]=i[a];return c}else return Array.from(i)}n.default=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},a=i.activeClass,c=a===void 0?"active":a,h=i.query,g=h===void 0?'[href^="#"]:not([href="#"]):not([href="#0"])':h,b=i.threshold,$=b===void 0?[.25,.5,.75]:b,y=i.detectType,w=y===void 0?"max":y,T={threshold:$},C=function(q){return q.classList.remove(c)},E=function(q){return q.classList.add(c)},k=function(){document.querySelectorAll("."+c).forEach(C)},A=function(q){k(),E(document.querySelector('a[href="#'+q.id+'"]'))},P=function(q){q.forEach(function(se){se.intersectionRatio>=Math[w].apply(Math,s($))&&A(se.target)})},N=document.querySelectorAll(g),B=new IntersectionObserver(P,T),S=function(q){var se=document.querySelector("#"+q.hash.slice(1));B.observe(se)};N.forEach(S)},o.exports=n.default})(x_,x_.exports);var $O=x_.exports;(function(o,n){Object.defineProperty(n,"__esModule",{value:!0});var s=IT,i=$(s),a=Su,c=bO,h=$(c),g=$O,b=$(g);function $(y){return y&&y.__esModule?y:{default:y}}n.default={to:i.default,calcEndPoint:a.calcEndPoint,anchorScroll:h.default,observe:b.default},o.exports=n.default})(k_,k_.exports);var vO=k_.exports;const yO=Ga(vO);var gw={exports:{}},_O=gw.exports;(function(o){(function(n,s){o.exports?o.exports=s():n.Scrollparent=s()})(_O,function(){var n=/(auto|scroll)/,s=function(g,b){return g.parentNode===null?b:s(g.parentNode,b.concat([g]))},i=function(g,b){return getComputedStyle(g,null).getPropertyValue(b)},a=function(g){return i(g,"overflow")+i(g,"overflow-y")+i(g,"overflow-x")},c=function(g){return n.test(a(g))},h=function(g){if(g instanceof HTMLElement||g instanceof SVGElement){for(var b=s(g.parentNode,[]),$=0;$<b.length;$+=1)if(c(b[$]))return b[$];return document.scrollingElement||document.documentElement}};return h})})(gw);var wO=gw.exports;const CO=Ga(wO);var SO="Expected a function",fS=NaN,TO="[object Symbol]",kO=/^\s+|\s+$/g,EO=/^[-+]0x[0-9a-f]+$/i,IO=/^0b[01]+$/i,xO=/^0o[0-7]+$/i,DO=parseInt,AO=typeof Vo=="object"&&Vo&&Vo.Object===Object&&Vo,OO=typeof self=="object"&&self&&self.Object===Object&&self,RO=AO||OO||Function("return this")(),MO=Object.prototype,NO=MO.toString,LO=Math.max,BO=Math.min,Ay=function(){return RO.Date.now()};function PO(o,n,s){var i,a,c,h,g,b,$=0,y=!1,w=!1,T=!0;if(typeof o!="function")throw new TypeError(SO);n=mS(n)||0,D_(s)&&(y=!!s.leading,w="maxWait"in s,c=w?LO(mS(s.maxWait)||0,n):c,T="trailing"in s?!!s.trailing:T);function C(q){var se=i,ee=a;return i=a=void 0,$=q,h=o.apply(ee,se),h}function E(q){return $=q,g=setTimeout(P,n),y?C(q):h}function k(q){var se=q-b,ee=q-$,K=n-se;return w?BO(K,c-ee):K}function A(q){var se=q-b,ee=q-$;return b===void 0||se>=n||se<0||w&&ee>=c}function P(){var q=Ay();if(A(q))return N(q);g=setTimeout(P,k(q))}function N(q){return g=void 0,T&&i?C(q):(i=a=void 0,h)}function B(){g!==void 0&&clearTimeout(g),$=0,i=b=a=g=void 0}function S(){return g===void 0?h:N(Ay())}function H(){var q=Ay(),se=A(q);if(i=arguments,a=this,b=q,se){if(g===void 0)return E(b);if(w)return g=setTimeout(P,n),C(b)}return g===void 0&&(g=setTimeout(P,n)),h}return H.cancel=B,H.flush=S,H}function D_(o){var n=typeof o;return!!o&&(n=="object"||n=="function")}function jO(o){return!!o&&typeof o=="object"}function FO(o){return typeof o=="symbol"||jO(o)&&NO.call(o)==TO}function mS(o){if(typeof o=="number")return o;if(FO(o))return fS;if(D_(o)){var n=typeof o.valueOf=="function"?o.valueOf():o;o=D_(n)?n+"":n}if(typeof o!="string")return o===0?o:+o;o=o.replace(kO,"");var s=IO.test(o);return s||xO.test(o)?DO(o.slice(2),s?2:8):EO.test(o)?fS:+o}var zO=PO;const UO=Ga(zO);var A_="data-focus-lock",xT="data-focus-lock-disabled",WO="data-no-focus-lock",HO="data-autofocus-inside",VO="data-no-autofocus";function Oy(o,n){return typeof o=="function"?o(n):o&&(o.current=n),o}function GO(o,n){var s=ve.useState(function(){return{value:o,callback:n,facade:{get current(){return s.value},set current(i){var a=s.value;a!==i&&(s.value=i,s.callback(i,a))}}}})[0];return s.callback=n,s.facade}var KO=typeof window<"u"?ve.useLayoutEffect:ve.useEffect,bS=new WeakMap;function JO(o,n){var s=GO(null,function(i){return o.forEach(function(a){return Oy(a,i)})});return KO(function(){var i=bS.get(s);if(i){var a=new Set(i),c=new Set(o),h=s.current;a.forEach(function(g){c.has(g)||Oy(g,null)}),c.forEach(function(g){a.has(g)||Oy(g,h)})}bS.set(s,o)},[o]),s}var Ry={width:"1px",height:"0px",padding:0,overflow:"hidden",position:"fixed",top:"1px",left:"1px"};function DT(o){return o}function AT(o,n){n===void 0&&(n=DT);var s=[],i=!1,a={read:function(){if(i)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return s.length?s[s.length-1]:o},useMedium:function(c){var h=n(c,i);return s.push(h),function(){s=s.filter(function(g){return g!==h})}},assignSyncMedium:function(c){for(i=!0;s.length;){var h=s;s=[],h.forEach(c)}s={push:function(g){return c(g)},filter:function(){return s}}},assignMedium:function(c){i=!0;var h=[];if(s.length){var g=s;s=[],g.forEach(c),h=s}var b=function(){var y=h;h=[],y.forEach(c)},$=function(){return Promise.resolve().then(b)};$(),s={push:function(y){h.push(y),$()},filter:function(y){return h=h.filter(y),s}}}};return a}function fw(o,n){return n===void 0&&(n=DT),AT(o,n)}function qO(o){o===void 0&&(o={});var n=AT(null);return n.options=VI({async:!0,ssr:!1},o),n}var OT=fw({},function(o){var n=o.target,s=o.currentTarget;return{target:n,currentTarget:s}}),RT=fw(),YO=fw(),XO=qO({async:!0,ssr:typeof document<"u"}),ZO=ve.createContext(void 0),QO=[],mw=ve.forwardRef(function(n,s){var i,a=ve.useState(),c=a[0],h=a[1],g=ve.useRef(),b=ve.useRef(!1),$=ve.useRef(null),y=ve.useState({}),w=y[1],T=n.children,C=n.disabled,E=C===void 0?!1:C,k=n.noFocusGuards,A=k===void 0?!1:k,P=n.persistentFocus,N=P===void 0?!1:P,B=n.crossFrame,S=B===void 0?!0:B,H=n.autoFocus,q=H===void 0?!0:H;n.allowTextSelection;var se=n.group,ee=n.className,K=n.whiteList,Y=n.hasPositiveIndices,X=n.shards,ce=X===void 0?QO:X,W=n.as,te=W===void 0?"div":W,ke=n.lockProps,Z=ke===void 0?{}:ke,ze=n.sideCar,Ce=n.returnFocus,at=Ce===void 0?!1:Ce,he=n.focusOptions,Ae=n.onActivation,de=n.onDeactivation,Se=ve.useState({}),xe=Se[0],He=ve.useCallback(function(ft){var st=ft.captureFocusRestore;if(!$.current){var At,mn=(At=document)==null?void 0:At.activeElement;$.current=mn,mn!==document.body&&($.current=st(mn))}g.current&&Ae&&Ae(g.current),b.current=!0,w()},[Ae]),ne=ve.useCallback(function(){b.current=!1,de&&de(g.current),w()},[de]),Ke=ve.useCallback(function(ft){var st=$.current;if(st){var At=(typeof st=="function"?st():st)||document.body,mn=typeof at=="function"?at(At):at;if(mn){var Ue=typeof mn=="object"?mn:void 0;$.current=null,ft?Promise.resolve().then(function(){return At.focus(Ue)}):At.focus(Ue)}}},[at]),Te=ve.useCallback(function(ft){b.current&&OT.useMedium(ft)},[]),Je=RT.useMedium,rt=ve.useCallback(function(ft){g.current!==ft&&(g.current=ft,h(ft))},[]),ht=g_((i={},i[xT]=E&&"disabled",i[A_]=se,i),Z),nt=A!==!0,Wt=nt&&A!=="tail",St=JO([s,rt]),lt=ve.useMemo(function(){return{observed:g,shards:ce,enabled:!E,active:b.current}},[E,b.current,ce,c]);return We.createElement(ve.Fragment,null,nt&&[We.createElement("div",{key:"guard-first","data-focus-guard":!0,tabIndex:E?-1:0,style:Ry}),Y?We.createElement("div",{key:"guard-nearest","data-focus-guard":!0,tabIndex:E?-1:1,style:Ry}):null],!E&&We.createElement(ze,{id:xe,sideCar:XO,observed:c,disabled:E,persistentFocus:N,crossFrame:S,autoFocus:q,whiteList:K,shards:ce,onActivation:He,onDeactivation:ne,returnFocus:Ke,focusOptions:he,noFocusGuards:A}),We.createElement(te,g_({ref:St},ht,{className:ee,onBlur:Je,onFocus:Te}),We.createElement(ZO.Provider,{value:lt},T)),Wt&&We.createElement("div",{"data-focus-guard":!0,tabIndex:E?-1:0,style:Ry}))});mw.propTypes={};function e1(o,n){function s(i){return i.displayName||i.name||"Component"}return function(a){var c=[],h;function g(){h=o(c.map(function($){return $.props})),n(h)}var b=function($){II(y,$);function y(){return $.apply(this,arguments)||this}y.peek=function(){return h};var w=y.prototype;return w.componentDidMount=function(){c.push(this),g()},w.componentDidUpdate=function(){g()},w.componentWillUnmount=function(){var C=c.indexOf(this);c.splice(C,1),g()},w.render=function(){return We.createElement(a,this.props)},y}(ve.PureComponent);return Mx(b,"displayName","SideEffect("+s(a)+")"),b}}var qo=function(o){for(var n=Array(o.length),s=0;s<o.length;++s)n[s]=o[s];return n},yu=function(o){return Array.isArray(o)?o:[o]},MT=function(o){return Array.isArray(o)?o[0]:o},t1=function(o){if(o.nodeType!==Node.ELEMENT_NODE)return!1;var n=window.getComputedStyle(o,null);return!n||!n.getPropertyValue?!1:n.getPropertyValue("display")==="none"||n.getPropertyValue("visibility")==="hidden"},NT=function(o){return o.parentNode&&o.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE?o.parentNode.host:o.parentNode},LT=function(o){return o===document||o&&o.nodeType===Node.DOCUMENT_NODE},n1=function(o){return o.hasAttribute("inert")},s1=function(o,n){return!o||LT(o)||!t1(o)&&!n1(o)&&n(NT(o))},BT=function(o,n){var s=o.get(n);if(s!==void 0)return s;var i=s1(n,BT.bind(void 0,o));return o.set(n,i),i},r1=function(o,n){return o&&!LT(o)?a1(o)?n(NT(o)):!1:!0},PT=function(o,n){var s=o.get(n);if(s!==void 0)return s;var i=r1(n,PT.bind(void 0,o));return o.set(n,i),i},jT=function(o){return o.dataset},i1=function(o){return o.tagName==="BUTTON"},FT=function(o){return o.tagName==="INPUT"},zT=function(o){return FT(o)&&o.type==="radio"},o1=function(o){return!((FT(o)||i1(o))&&(o.type==="hidden"||o.disabled))},a1=function(o){var n=o.getAttribute(VO);return![!0,"true",""].includes(n)},bw=function(o){var n;return!!(o&&(!((n=jT(o))===null||n===void 0)&&n.focusGuard))},O_=function(o){return!bw(o)},l1=function(o){return!!o},c1=function(o,n){var s=Math.max(0,o.tabIndex),i=Math.max(0,n.tabIndex),a=s-i,c=o.index-n.index;if(a){if(!s)return 1;if(!i)return-1}return a||c},u1=function(o){return o.tabIndex<0&&!o.hasAttribute("tabindex")?0:o.tabIndex},$w=function(o,n,s){return qo(o).map(function(i,a){var c=u1(i);return{node:i,index:a,tabIndex:s&&c===-1?(i.dataset||{}).focusGuard?0:-1:c}}).filter(function(i){return!n||i.tabIndex>=0}).sort(c1)},d1=["button:enabled","select:enabled","textarea:enabled","input:enabled","a[href]","area[href]","summary","iframe","object","embed","audio[controls]","video[controls]","[tabindex]","[contenteditable]","[autofocus]"],vw=d1.join(","),h1="".concat(vw,", [data-focus-guard]"),UT=function(o,n){return qo((o.shadowRoot||o).children).reduce(function(s,i){return s.concat(i.matches(n?h1:vw)?[i]:[],UT(i))},[])},p1=function(o,n){var s;return o instanceof HTMLIFrameElement&&(!((s=o.contentDocument)===null||s===void 0)&&s.body)?Ah([o.contentDocument.body],n):[o]},Ah=function(o,n){return o.reduce(function(s,i){var a,c=UT(i,n),h=(a=[]).concat.apply(a,c.map(function(g){return p1(g,n)}));return s.concat(h,i.parentNode?qo(i.parentNode.querySelectorAll(vw)).filter(function(g){return g===i}):[])},[])},g1=function(o){var n=o.querySelectorAll("[".concat(HO,"]"));return qo(n).map(function(s){return Ah([s])}).reduce(function(s,i){return s.concat(i)},[])},yw=function(o,n){return qo(o).filter(function(s){return BT(n,s)}).filter(function(s){return o1(s)})},$S=function(o,n){return n===void 0&&(n=new Map),qo(o).filter(function(s){return PT(n,s)})},_w=function(o,n,s){return $w(yw(Ah(o,s),n),!0,s)},Df=function(o,n){return $w(yw(Ah(o),n),!1)},f1=function(o,n){return yw(g1(o),n)},bu=function(o,n){return o.shadowRoot?bu(o.shadowRoot,n):Object.getPrototypeOf(o).contains!==void 0&&Object.getPrototypeOf(o).contains.call(o,n)?!0:qo(o.children).some(function(s){var i;if(s instanceof HTMLIFrameElement){var a=(i=s.contentDocument)===null||i===void 0?void 0:i.body;return a?bu(a,n):!1}return bu(s,n)})},m1=function(o){for(var n=new Set,s=o.length,i=0;i<s;i+=1)for(var a=i+1;a<s;a+=1){var c=o[i].compareDocumentPosition(o[a]);(c&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&n.add(a),(c&Node.DOCUMENT_POSITION_CONTAINS)>0&&n.add(i)}return o.filter(function(h,g){return!n.has(g)})},WT=function(o){return o.parentNode?WT(o.parentNode):o},ww=function(o){var n=yu(o);return n.filter(Boolean).reduce(function(s,i){var a=i.getAttribute(A_);return s.push.apply(s,a?m1(qo(WT(i).querySelectorAll("[".concat(A_,'="').concat(a,'"]:not([').concat(xT,'="disabled"])')))):[i]),s},[])},b1=function(o){try{return o()}catch{return}},Af=function(o){if(o===void 0&&(o=document),!(!o||!o.activeElement)){var n=o.activeElement;return n.shadowRoot?Af(n.shadowRoot):n instanceof HTMLIFrameElement&&b1(function(){return n.contentWindow.document})?Af(n.contentWindow.document):n}},$1=function(o,n){return o===n},v1=function(o,n){return!!qo(o.querySelectorAll("iframe")).some(function(s){return $1(s,n)})},HT=function(o,n){return n===void 0&&(n=Af(MT(o).ownerDocument)),!n||n.dataset&&n.dataset.focusGuard?!1:ww(o).some(function(s){return bu(s,n)||v1(s,n)})},y1=function(o){o===void 0&&(o=document);var n=Af(o);return n?qo(o.querySelectorAll("[".concat(WO,"]"))).some(function(s){return bu(s,n)}):!1},_1=function(o,n){return n.filter(zT).filter(function(s){return s.name===o.name}).filter(function(s){return s.checked})[0]||o},Cw=function(o,n){return zT(o)&&o.name?_1(o,n):o},w1=function(o){var n=new Set;return o.forEach(function(s){return n.add(Cw(s,o))}),o.filter(function(s){return n.has(s)})},vS=function(o){return o[0]&&o.length>1?Cw(o[0],o):o[0]},yS=function(o,n){return o.indexOf(Cw(n,o))},R_="NEW_FOCUS",C1=function(o,n,s,i,a){var c=o.length,h=o[0],g=o[c-1],b=bw(i);if(!(i&&o.indexOf(i)>=0)){var $=i!==void 0?s.indexOf(i):-1,y=a?s.indexOf(a):$,w=a?o.indexOf(a):-1;if($===-1)return w!==-1?w:R_;if(w===-1)return R_;var T=$-y,C=s.indexOf(h),E=s.indexOf(g),k=w1(s),A=i!==void 0?k.indexOf(i):-1,P=a?k.indexOf(a):A,N=k.filter(function(ee){return ee.tabIndex>=0}),B=i!==void 0?N.indexOf(i):-1,S=a?N.indexOf(a):B,H=B>=0&&S>=0?S-B:P-A;if(!T&&w>=0||n.length===0)return w;var q=yS(o,n[0]),se=yS(o,n[n.length-1]);if($<=C&&b&&Math.abs(T)>1)return se;if($>=E&&b&&Math.abs(T)>1)return q;if(T&&Math.abs(H)>1)return w;if($<=C)return se;if($>E)return q;if(T)return Math.abs(T)>1?w:(c+w+T)%c}},S1=function(o){return function(n){var s,i=(s=jT(n))===null||s===void 0?void 0:s.autofocus;return n.autofocus||i!==void 0&&i!=="false"||o.indexOf(n)>=0}},_S=function(o,n,s){var i=o.map(function(c){var h=c.node;return h}),a=$S(i.filter(S1(s)));return a&&a.length?vS(a):vS($S(n))},M_=function(o,n){return n===void 0&&(n=[]),n.push(o),o.parentNode&&M_(o.parentNode.host||o.parentNode,n),n},My=function(o,n){for(var s=M_(o),i=M_(n),a=0;a<s.length;a+=1){var c=s[a];if(i.indexOf(c)>=0)return c}return!1},VT=function(o,n,s){var i=yu(o),a=yu(n),c=i[0],h=!1;return a.filter(Boolean).forEach(function(g){h=My(h||g,g)||h,s.filter(Boolean).forEach(function(b){var $=My(c,b);$&&(!h||bu($,h)?h=$:h=My($,h))})}),h},wS=function(o,n){return o.reduce(function(s,i){return s.concat(f1(i,n))},[])},T1=function(o,n){var s=new Map;return n.forEach(function(i){return s.set(i.node,i)}),o.map(function(i){return s.get(i)}).filter(l1)},k1=function(o,n){var s=Af(yu(o).length>0?document:MT(o).ownerDocument),i=ww(o).filter(O_),a=VT(s||o,o,i),c=new Map,h=Df(i,c),g=h.filter(function(E){var k=E.node;return O_(k)});if(g[0]){var b=Df([a],c).map(function(E){var k=E.node;return k}),$=T1(b,g),y=$.map(function(E){var k=E.node;return k}),w=$.filter(function(E){var k=E.tabIndex;return k>=0}).map(function(E){var k=E.node;return k}),T=C1(y,w,b,s,n);if(T===R_){var C=_S(h,w,wS(i,c))||_S(h,y,wS(i,c));if(C)return{node:C};console.warn("focus-lock: cannot find any node to move focus into");return}return T===void 0?T:$[T]}},E1=function(o){var n=ww(o).filter(O_),s=VT(o,o,n),i=$w(Ah([s],!0),!0,!0),a=Ah(n,!1);return i.map(function(c){var h=c.node,g=c.index;return{node:h,index:g,lockItem:a.indexOf(h)>=0,guard:bw(h)}})},Sw=function(o,n){o&&("focus"in o&&o.focus(n),"contentWindow"in o&&o.contentWindow&&o.contentWindow.focus())},Ny=0,Ly=!1,GT=function(o,n,s){s===void 0&&(s={});var i=k1(o,n);if(!Ly&&i){if(Ny>2){console.error("FocusLock: focus-fighting detected. Only one focus management system could be active. See https://github.com/theKashey/focus-lock/#focus-fighting"),Ly=!0,setTimeout(function(){Ly=!1},1);return}Ny++,Sw(i.node,s.focusOptions),Ny--}};function rf(o){if(!o)return null;if(typeof WeakRef>"u")return function(){return o||null};var n=o?new WeakRef(o):null;return function(){return(n==null?void 0:n.deref())||null}}var I1=function(o){if(!o)return null;for(var n=[],s=o;s&&s!==document.body;)n.push({current:rf(s),parent:rf(s.parentElement),left:rf(s.previousElementSibling),right:rf(s.nextElementSibling)}),s=s.parentElement;return{element:rf(o),stack:n,ownerDocument:o.ownerDocument}},x1=function(o){var n,s,i,a,c;if(o)for(var h=o.stack,g=o.ownerDocument,b=new Map,$=0,y=h;$<y.length;$++){var w=y[$],T=(n=w.parent)===null||n===void 0?void 0:n.call(w);if(T&&g.contains(T)){for(var C=(s=w.left)===null||s===void 0?void 0:s.call(w),E=w.current(),k=T.contains(E)?E:void 0,A=(i=w.right)===null||i===void 0?void 0:i.call(w),P=_w([T],b),N=(c=(a=k??(C==null?void 0:C.nextElementSibling))!==null&&a!==void 0?a:A)!==null&&c!==void 0?c:C;N;){for(var B=0,S=P;B<S.length;B++){var H=S[B];if(N!=null&&N.contains(H.node))return H.node}N=N.nextElementSibling}if(P.length)return P[0].node}}},KT=function(o){var n=I1(o);return function(){return x1(n)}},D1=function(o,n,s){if(!o||!n)return console.error("no element or scope given"),{};var i=yu(n);if(i.every(function(h){return!bu(h,o)}))return console.error("Active element is not contained in the scope"),{};var a=s?_w(i,new Map):Df(i,new Map),c=a.findIndex(function(h){var g=h.node;return g===o});if(c!==-1)return{prev:a[c-1],next:a[c+1],first:a[0],last:a[a.length-1]}},A1=function(o,n){var s=n?_w(yu(o),new Map):Df(yu(o),new Map);return{first:s[0],last:s[s.length-1]}},O1=function(o){return Object.assign({scope:document.body,cycle:!0,onlyTabbable:!0},o)},JT=function(o,n,s){n===void 0&&(n={});var i=O1(n),a=D1(o,i.scope,i.onlyTabbable);if(a){var c=s(a,i.cycle);c&&Sw(c.node,i.focusOptions)}},R1=function(o,n){n===void 0&&(n={}),JT(o,n,function(s,i){var a=s.next,c=s.first;return a||i&&c})},M1=function(o,n){n===void 0&&(n={}),JT(o,n,function(s,i){var a=s.prev,c=s.last;return a||i&&c})},qT=function(o,n,s){var i,a=A1(o,(i=n.onlyTabbable)!==null&&i!==void 0?i:!0),c=a[s];c&&Sw(c.node,n.focusOptions)},N1=function(o,n){n===void 0&&(n={}),qT(o,n,"first")},L1=function(o,n){n===void 0&&(n={}),qT(o,n,"last")};function Tw(o){setTimeout(o,1)}var B1=function(n){return n&&"current"in n?n.current:n},YT=function(){return document&&document.activeElement===document.body},P1=function(){return YT()||y1()},Eh=null,Gr=null,CS=function(){return null},Ih=null,Of=!1,kw=!1,j1=function(){return!0},F1=function(n){return(Eh.whiteList||j1)(n)},z1=function(n,s){Ih={observerNode:n,portaledElement:s}},U1=function(n){return Ih&&Ih.portaledElement===n};function SS(o,n,s,i){var a=null,c=o;do{var h=i[c];if(h.guard)h.node.dataset.focusAutoGuard&&(a=h);else if(h.lockItem){if(c!==o)return;a=null}else break}while((c+=s)!==n);a&&(a.node.tabIndex=0)}var W1=function(n){return n?!!Of:Of==="meanwhile"},H1=function o(n,s,i){return s&&(s.host===n&&(!s.activeElement||i.contains(s.activeElement))||s.parentNode&&o(n,s.parentNode,i))},V1=function(n,s){return s.some(function(i){return H1(n,i,i)})},XT=function(n){return Df(n,new Map)},G1=function(n){return!XT([n.parentNode]).some(function(s){return s.node===n})},Y$=function(){var n=!1;if(Eh){var s=Eh,i=s.observed,a=s.persistentFocus,c=s.autoFocus,h=s.shards,g=s.crossFrame,b=s.focusOptions,$=s.noFocusGuards,y=i||Ih&&Ih.portaledElement;if(YT()&&Gr&&Gr!==document.body&&(!document.body.contains(Gr)||G1(Gr))){var w=CS();w&&w.focus()}var T=document&&document.activeElement;if(y){var C=[y].concat(h.map(B1).filter(Boolean)),E=function(){if(!W1(g)||!$||!Gr||kw)return!1;var B=XT(C),S=B.findIndex(function(H){var q=H.node;return q===Gr});return S===0||S===B.length-1};if((!T||F1(T))&&(a||E()||!P1()||!Gr&&c)&&(y&&!(HT(C)||T&&V1(T,C)||U1(T))&&(document&&!Gr&&T&&!c?(T.blur&&T.blur(),document.body.focus()):(n=GT(C,Gr,{focusOptions:b}),Ih={})),Gr=document&&document.activeElement,Gr!==document.body&&(CS=KT(Gr)),Of=!1),document&&T!==document.activeElement&&document.querySelector("[data-focus-auto-guard]")){var k=document&&document.activeElement,A=E1(C),P=A.map(function(N){var B=N.node;return B}).indexOf(k);P>-1&&(A.filter(function(N){var B=N.guard,S=N.node;return B&&S.dataset.focusAutoGuard}).forEach(function(N){var B=N.node;return B.removeAttribute("tabIndex")}),SS(P,A.length,1,A),SS(P,-1,-1,A))}}}return n},ZT=function(n){Y$()&&n&&(n.stopPropagation(),n.preventDefault())},Ew=function(){return Tw(Y$)},K1=function(n){var s=n.target,i=n.currentTarget;i.contains(s)||z1(i,s)},J1=function(){return null},QT=function(){kw=!0},ek=function(){kw=!1,Of="just",Tw(function(){Of="meanwhile"})},q1=function(){document.addEventListener("focusin",ZT),document.addEventListener("focusout",Ew),window.addEventListener("focus",QT),window.addEventListener("blur",ek)},Y1=function(){document.removeEventListener("focusin",ZT),document.removeEventListener("focusout",Ew),window.removeEventListener("focus",QT),window.removeEventListener("blur",ek)};function X1(o){return o.filter(function(n){var s=n.disabled;return!s})}var tk={moveFocusInside:GT,focusInside:HT,focusNextElement:R1,focusPrevElement:M1,focusFirstElement:N1,focusLastElement:L1,captureFocusRestore:KT};function Z1(o){var n=o.slice(-1)[0];n&&!Eh&&q1();var s=Eh,i=s&&n&&n.id===s.id;Eh=n,s&&!i&&(s.onDeactivation(),o.filter(function(a){var c=a.id;return c===s.id}).length||s.returnFocus(!n)),n?(Gr=null,(!i||s.observed!==n.observed)&&n.onActivation(tk),Y$(),Tw(Y$)):(Y1(),Gr=null)}OT.assignSyncMedium(K1);RT.assignMedium(Ew);YO.assignMedium(function(o){return o(tk)});const Q1=e1(X1,Z1)(J1);var nk=ve.forwardRef(function(n,s){return We.createElement(mw,g_({sideCar:Q1,ref:s},n))}),sk=mw.propTypes||{};sk.sideCar;xI(sk,["sideCar"]);nk.propTypes={};var rk={exports:{}},kn={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iw=Symbol.for("react.element"),xw=Symbol.for("react.portal"),Lv=Symbol.for("react.fragment"),Bv=Symbol.for("react.strict_mode"),Pv=Symbol.for("react.profiler"),jv=Symbol.for("react.provider"),Fv=Symbol.for("react.context"),eR=Symbol.for("react.server_context"),zv=Symbol.for("react.forward_ref"),Uv=Symbol.for("react.suspense"),Wv=Symbol.for("react.suspense_list"),Hv=Symbol.for("react.memo"),Vv=Symbol.for("react.lazy"),tR=Symbol.for("react.offscreen"),ik;ik=Symbol.for("react.module.reference");function Ai(o){if(typeof o=="object"&&o!==null){var n=o.$$typeof;switch(n){case Iw:switch(o=o.type,o){case Lv:case Pv:case Bv:case Uv:case Wv:return o;default:switch(o=o&&o.$$typeof,o){case eR:case Fv:case zv:case Vv:case Hv:case jv:return o;default:return n}}case xw:return n}}}kn.ContextConsumer=Fv;kn.ContextProvider=jv;kn.Element=Iw;kn.ForwardRef=zv;kn.Fragment=Lv;kn.Lazy=Vv;kn.Memo=Hv;kn.Portal=xw;kn.Profiler=Pv;kn.StrictMode=Bv;kn.Suspense=Uv;kn.SuspenseList=Wv;kn.isAsyncMode=function(){return!1};kn.isConcurrentMode=function(){return!1};kn.isContextConsumer=function(o){return Ai(o)===Fv};kn.isContextProvider=function(o){return Ai(o)===jv};kn.isElement=function(o){return typeof o=="object"&&o!==null&&o.$$typeof===Iw};kn.isForwardRef=function(o){return Ai(o)===zv};kn.isFragment=function(o){return Ai(o)===Lv};kn.isLazy=function(o){return Ai(o)===Vv};kn.isMemo=function(o){return Ai(o)===Hv};kn.isPortal=function(o){return Ai(o)===xw};kn.isProfiler=function(o){return Ai(o)===Pv};kn.isStrictMode=function(o){return Ai(o)===Bv};kn.isSuspense=function(o){return Ai(o)===Uv};kn.isSuspenseList=function(o){return Ai(o)===Wv};kn.isValidElementType=function(o){return typeof o=="string"||typeof o=="function"||o===Lv||o===Pv||o===Bv||o===Uv||o===Wv||o===tR||typeof o=="object"&&o!==null&&(o.$$typeof===Vv||o.$$typeof===Hv||o.$$typeof===jv||o.$$typeof===Fv||o.$$typeof===zv||o.$$typeof===ik||o.getModuleId!==void 0)};kn.typeOf=Ai;rk.exports=kn;var ok=rk.exports;function nR(o){function n(de,Se,xe,He,ne){for(var Ke=0,Te=0,Je=0,rt=0,ht,nt,Wt=0,St=0,lt,ft=lt=ht=0,st=0,At=0,mn=0,Ue=0,Nt=xe.length,wt=Nt-1,qt,ct="",me="",ge="",ue="",we;st<Nt;){if(nt=xe.charCodeAt(st),st===wt&&Te+rt+Je+Ke!==0&&(Te!==0&&(nt=Te===47?10:47),rt=Je=Ke=0,Nt++,wt++),Te+rt+Je+Ke===0){if(st===wt&&(0<At&&(ct=ct.replace(T,"")),0<ct.trim().length)){switch(nt){case 32:case 9:case 59:case 13:case 10:break;default:ct+=xe.charAt(st)}nt=59}switch(nt){case 123:for(ct=ct.trim(),ht=ct.charCodeAt(0),lt=1,Ue=++st;st<Nt;){switch(nt=xe.charCodeAt(st)){case 123:lt++;break;case 125:lt--;break;case 47:switch(nt=xe.charCodeAt(st+1)){case 42:case 47:e:{for(ft=st+1;ft<wt;++ft)switch(xe.charCodeAt(ft)){case 47:if(nt===42&&xe.charCodeAt(ft-1)===42&&st+2!==ft){st=ft+1;break e}break;case 10:if(nt===47){st=ft+1;break e}}st=ft}}break;case 91:nt++;case 40:nt++;case 34:case 39:for(;st++<wt&&xe.charCodeAt(st)!==nt;);}if(lt===0)break;st++}switch(lt=xe.substring(Ue,st),ht===0&&(ht=(ct=ct.replace(w,"").trim()).charCodeAt(0)),ht){case 64:switch(0<At&&(ct=ct.replace(T,"")),nt=ct.charCodeAt(1),nt){case 100:case 109:case 115:case 45:At=Se;break;default:At=Z}if(lt=n(Se,At,lt,nt,ne+1),Ue=lt.length,0<Ce&&(At=s(Z,ct,mn),we=g(3,lt,At,Se,W,ce,Ue,nt,ne,He),ct=At.join(""),we!==void 0&&(Ue=(lt=we.trim()).length)===0&&(nt=0,lt="")),0<Ue)switch(nt){case 115:ct=ct.replace(q,h);case 100:case 109:case 45:lt=ct+"{"+lt+"}";break;case 107:ct=ct.replace(N,"$1 $2"),lt=ct+"{"+lt+"}",lt=ke===1||ke===2&&c("@"+lt,3)?"@-webkit-"+lt+"@"+lt:"@"+lt;break;default:lt=ct+lt,He===112&&(lt=(me+=lt,""))}else lt="";break;default:lt=n(Se,s(Se,ct,mn),lt,He,ne+1)}ge+=lt,lt=mn=At=ft=ht=0,ct="",nt=xe.charCodeAt(++st);break;case 125:case 59:if(ct=(0<At?ct.replace(T,""):ct).trim(),1<(Ue=ct.length))switch(ft===0&&(ht=ct.charCodeAt(0),ht===45||96<ht&&123>ht)&&(Ue=(ct=ct.replace(" ",":")).length),0<Ce&&(we=g(1,ct,Se,de,W,ce,me.length,He,ne,He))!==void 0&&(Ue=(ct=we.trim()).length)===0&&(ct="\0\0"),ht=ct.charCodeAt(0),nt=ct.charCodeAt(1),ht){case 0:break;case 64:if(nt===105||nt===99){ue+=ct+xe.charAt(st);break}default:ct.charCodeAt(Ue-1)!==58&&(me+=a(ct,ht,nt,ct.charCodeAt(2)))}mn=At=ft=ht=0,ct="",nt=xe.charCodeAt(++st)}}switch(nt){case 13:case 10:Te===47?Te=0:1+ht===0&&He!==107&&0<ct.length&&(At=1,ct+="\0"),0<Ce*he&&g(0,ct,Se,de,W,ce,me.length,He,ne,He),ce=1,W++;break;case 59:case 125:if(Te+rt+Je+Ke===0){ce++;break}default:switch(ce++,qt=xe.charAt(st),nt){case 9:case 32:if(rt+Ke+Te===0)switch(Wt){case 44:case 58:case 9:case 32:qt="";break;default:nt!==32&&(qt=" ")}break;case 0:qt="\\0";break;case 12:qt="\\f";break;case 11:qt="\\v";break;case 38:rt+Te+Ke===0&&(At=mn=1,qt="\f"+qt);break;case 108:if(rt+Te+Ke+te===0&&0<ft)switch(st-ft){case 2:Wt===112&&xe.charCodeAt(st-3)===58&&(te=Wt);case 8:St===111&&(te=St)}break;case 58:rt+Te+Ke===0&&(ft=st);break;case 44:Te+Je+rt+Ke===0&&(At=1,qt+="\r");break;case 34:case 39:Te===0&&(rt=rt===nt?0:rt===0?nt:rt);break;case 91:rt+Te+Je===0&&Ke++;break;case 93:rt+Te+Je===0&&Ke--;break;case 41:rt+Te+Ke===0&&Je--;break;case 40:if(rt+Te+Ke===0){if(ht===0)switch(2*Wt+3*St){case 533:break;default:ht=1}Je++}break;case 64:Te+Je+rt+Ke+ft+lt===0&&(lt=1);break;case 42:case 47:if(!(0<rt+Ke+Je))switch(Te){case 0:switch(2*nt+3*xe.charCodeAt(st+1)){case 235:Te=47;break;case 220:Ue=st,Te=42}break;case 42:nt===47&&Wt===42&&Ue+2!==st&&(xe.charCodeAt(Ue+2)===33&&(me+=xe.substring(Ue,st+1)),qt="",Te=0)}}Te===0&&(ct+=qt)}St=Wt,Wt=nt,st++}if(Ue=me.length,0<Ue){if(At=Se,0<Ce&&(we=g(2,me,At,de,W,ce,Ue,He,ne,He),we!==void 0&&(me=we).length===0))return ue+me+ge;if(me=At.join(",")+"{"+me+"}",ke*te!==0){switch(ke!==2||c(me,2)||(te=0),te){case 111:me=me.replace(S,":-moz-$1")+me;break;case 112:me=me.replace(B,"::-webkit-input-$1")+me.replace(B,"::-moz-$1")+me.replace(B,":-ms-input-$1")+me}te=0}}return ue+me+ge}function s(de,Se,xe){var He=Se.trim().split(A);Se=He;var ne=He.length,Ke=de.length;switch(Ke){case 0:case 1:var Te=0;for(de=Ke===0?"":de[0]+" ";Te<ne;++Te)Se[Te]=i(de,Se[Te],xe).trim();break;default:var Je=Te=0;for(Se=[];Te<ne;++Te)for(var rt=0;rt<Ke;++rt)Se[Je++]=i(de[rt]+" ",He[Te],xe).trim()}return Se}function i(de,Se,xe){var He=Se.charCodeAt(0);switch(33>He&&(He=(Se=Se.trim()).charCodeAt(0)),He){case 38:return Se.replace(P,"$1"+de.trim());case 58:return de.trim()+Se.replace(P,"$1"+de.trim());default:if(0<1*xe&&0<Se.indexOf("\f"))return Se.replace(P,(de.charCodeAt(0)===58?"":"$1")+de.trim())}return de+Se}function a(de,Se,xe,He){var ne=de+";",Ke=2*Se+3*xe+4*He;if(Ke===944){de=ne.indexOf(":",9)+1;var Te=ne.substring(de,ne.length-1).trim();return Te=ne.substring(0,de).trim()+Te+";",ke===1||ke===2&&c(Te,1)?"-webkit-"+Te+Te:Te}if(ke===0||ke===2&&!c(ne,1))return ne;switch(Ke){case 1015:return ne.charCodeAt(10)===97?"-webkit-"+ne+ne:ne;case 951:return ne.charCodeAt(3)===116?"-webkit-"+ne+ne:ne;case 963:return ne.charCodeAt(5)===110?"-webkit-"+ne+ne:ne;case 1009:if(ne.charCodeAt(4)!==100)break;case 969:case 942:return"-webkit-"+ne+ne;case 978:return"-webkit-"+ne+"-moz-"+ne+ne;case 1019:case 983:return"-webkit-"+ne+"-moz-"+ne+"-ms-"+ne+ne;case 883:if(ne.charCodeAt(8)===45)return"-webkit-"+ne+ne;if(0<ne.indexOf("image-set(",11))return ne.replace(X,"$1-webkit-$2")+ne;break;case 932:if(ne.charCodeAt(4)===45)switch(ne.charCodeAt(5)){case 103:return"-webkit-box-"+ne.replace("-grow","")+"-webkit-"+ne+"-ms-"+ne.replace("grow","positive")+ne;case 115:return"-webkit-"+ne+"-ms-"+ne.replace("shrink","negative")+ne;case 98:return"-webkit-"+ne+"-ms-"+ne.replace("basis","preferred-size")+ne}return"-webkit-"+ne+"-ms-"+ne+ne;case 964:return"-webkit-"+ne+"-ms-flex-"+ne+ne;case 1023:if(ne.charCodeAt(8)!==99)break;return Te=ne.substring(ne.indexOf(":",15)).replace("flex-","").replace("space-between","justify"),"-webkit-box-pack"+Te+"-webkit-"+ne+"-ms-flex-pack"+Te+ne;case 1005:return E.test(ne)?ne.replace(C,":-webkit-")+ne.replace(C,":-moz-")+ne:ne;case 1e3:switch(Te=ne.substring(13).trim(),Se=Te.indexOf("-")+1,Te.charCodeAt(0)+Te.charCodeAt(Se)){case 226:Te=ne.replace(H,"tb");break;case 232:Te=ne.replace(H,"tb-rl");break;case 220:Te=ne.replace(H,"lr");break;default:return ne}return"-webkit-"+ne+"-ms-"+Te+ne;case 1017:if(ne.indexOf("sticky",9)===-1)break;case 975:switch(Se=(ne=de).length-10,Te=(ne.charCodeAt(Se)===33?ne.substring(0,Se):ne).substring(de.indexOf(":",7)+1).trim(),Ke=Te.charCodeAt(0)+(Te.charCodeAt(7)|0)){case 203:if(111>Te.charCodeAt(8))break;case 115:ne=ne.replace(Te,"-webkit-"+Te)+";"+ne;break;case 207:case 102:ne=ne.replace(Te,"-webkit-"+(102<Ke?"inline-":"")+"box")+";"+ne.replace(Te,"-webkit-"+Te)+";"+ne.replace(Te,"-ms-"+Te+"box")+";"+ne}return ne+";";case 938:if(ne.charCodeAt(5)===45)switch(ne.charCodeAt(6)){case 105:return Te=ne.replace("-items",""),"-webkit-"+ne+"-webkit-box-"+Te+"-ms-flex-"+Te+ne;case 115:return"-webkit-"+ne+"-ms-flex-item-"+ne.replace(ee,"")+ne;default:return"-webkit-"+ne+"-ms-flex-line-pack"+ne.replace("align-content","").replace(ee,"")+ne}break;case 973:case 989:if(ne.charCodeAt(3)!==45||ne.charCodeAt(4)===122)break;case 931:case 953:if(Y.test(de)===!0)return(Te=de.substring(de.indexOf(":")+1)).charCodeAt(0)===115?a(de.replace("stretch","fill-available"),Se,xe,He).replace(":fill-available",":stretch"):ne.replace(Te,"-webkit-"+Te)+ne.replace(Te,"-moz-"+Te.replace("fill-",""))+ne;break;case 962:if(ne="-webkit-"+ne+(ne.charCodeAt(5)===102?"-ms-"+ne:"")+ne,xe+He===211&&ne.charCodeAt(13)===105&&0<ne.indexOf("transform",10))return ne.substring(0,ne.indexOf(";",27)+1).replace(k,"$1-webkit-$2")+ne}return ne}function c(de,Se){var xe=de.indexOf(Se===1?":":"{"),He=de.substring(0,Se!==3?xe:10);return xe=de.substring(xe+1,de.length-1),at(Se!==2?He:He.replace(K,"$1"),xe,Se)}function h(de,Se){var xe=a(Se,Se.charCodeAt(0),Se.charCodeAt(1),Se.charCodeAt(2));return xe!==Se+";"?xe.replace(se," or ($1)").substring(4):"("+Se+")"}function g(de,Se,xe,He,ne,Ke,Te,Je,rt,ht){for(var nt=0,Wt=Se,St;nt<Ce;++nt)switch(St=ze[nt].call(y,de,Wt,xe,He,ne,Ke,Te,Je,rt,ht)){case void 0:case!1:case!0:case null:break;default:Wt=St}if(Wt!==Se)return Wt}function b(de){switch(de){case void 0:case null:Ce=ze.length=0;break;default:if(typeof de=="function")ze[Ce++]=de;else if(typeof de=="object")for(var Se=0,xe=de.length;Se<xe;++Se)b(de[Se]);else he=!!de|0}return b}function $(de){return de=de.prefix,de!==void 0&&(at=null,de?typeof de!="function"?ke=1:(ke=2,at=de):ke=0),$}function y(de,Se){var xe=de;if(33>xe.charCodeAt(0)&&(xe=xe.trim()),Ae=xe,xe=[Ae],0<Ce){var He=g(-1,Se,xe,xe,W,ce,0,0,0,0);He!==void 0&&typeof He=="string"&&(Se=He)}var ne=n(Z,xe,Se,0,0);return 0<Ce&&(He=g(-2,ne,xe,xe,W,ce,ne.length,0,0,0),He!==void 0&&(ne=He)),Ae="",te=0,ce=W=1,ne}var w=/^\0+/g,T=/[\0\r\f]/g,C=/: */g,E=/zoo|gra/,k=/([,: ])(transform)/g,A=/,\r+?/g,P=/([\t\r\n ])*\f?&/g,N=/@(k\w+)\s*(\S*)\s*/,B=/::(place)/g,S=/:(read-only)/g,H=/[svh]\w+-[tblr]{2}/,q=/\(\s*(.*)\s*\)/g,se=/([\s\S]*?);/g,ee=/-self|flex-/g,K=/[^]*?(:[rp][el]a[\w-]+)[^]*/,Y=/stretch|:\s*\w+\-(?:conte|avail)/,X=/([^-])(image-set\()/,ce=1,W=1,te=0,ke=1,Z=[],ze=[],Ce=0,at=null,he=0,Ae="";return y.use=b,y.set=$,o!==void 0&&$(o),y}var sR={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},ki={};function Go(){return(Go=Object.assign||function(o){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(o[i]=s[i])}return o}).apply(this,arguments)}var TS=function(o,n){for(var s=[o[0]],i=0,a=n.length;i<a;i+=1)s.push(n[i],o[i+1]);return s},N_=function(o){return o!==null&&typeof o=="object"&&(o.toString?o.toString():Object.prototype.toString.call(o))==="[object Object]"&&!ok.typeOf(o)},X$=Object.freeze([]),Zl=Object.freeze({});function Rf(o){return typeof o=="function"}function kS(o){return o.displayName||o.name||"Component"}function Dw(o){return o&&typeof o.styledComponentId=="string"}var Oh=typeof process<"u"&&ki!==void 0&&(ki.REACT_APP_SC_ATTR||ki.SC_ATTR)||"data-styled",Aw=typeof window<"u"&&"HTMLElement"in window,rR=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&ki!==void 0&&(ki.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&ki.REACT_APP_SC_DISABLE_SPEEDY!==""?ki.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&ki.REACT_APP_SC_DISABLE_SPEEDY:ki.SC_DISABLE_SPEEDY!==void 0&&ki.SC_DISABLE_SPEEDY!==""&&ki.SC_DISABLE_SPEEDY!=="false"&&ki.SC_DISABLE_SPEEDY)),iR={};function Vf(o){for(var n=arguments.length,s=new Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];throw new Error("An error occurred. See https://git.io/JUIaE#"+o+" for more information."+(s.length>0?" Args: "+s.join(", "):""))}var oR=function(){function o(s){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=s}var n=o.prototype;return n.indexOfGroup=function(s){for(var i=0,a=0;a<s;a++)i+=this.groupSizes[a];return i},n.insertRules=function(s,i){if(s>=this.groupSizes.length){for(var a=this.groupSizes,c=a.length,h=c;s>=h;)(h<<=1)<0&&Vf(16,""+s);this.groupSizes=new Uint32Array(h),this.groupSizes.set(a),this.length=h;for(var g=c;g<h;g++)this.groupSizes[g]=0}for(var b=this.indexOfGroup(s+1),$=0,y=i.length;$<y;$++)this.tag.insertRule(b,i[$])&&(this.groupSizes[s]++,b++)},n.clearGroup=function(s){if(s<this.length){var i=this.groupSizes[s],a=this.indexOfGroup(s),c=a+i;this.groupSizes[s]=0;for(var h=a;h<c;h++)this.tag.deleteRule(a)}},n.getGroup=function(s){var i="";if(s>=this.length||this.groupSizes[s]===0)return i;for(var a=this.groupSizes[s],c=this.indexOfGroup(s),h=c+a,g=c;g<h;g++)i+=this.tag.getRule(g)+`/*!sc*/
`;return i},o}(),M$=new Map,Z$=new Map,_f=1,m$=function(o){if(M$.has(o))return M$.get(o);for(;Z$.has(_f);)_f++;var n=_f++;return M$.set(o,n),Z$.set(n,o),n},aR=function(o){return Z$.get(o)},lR=function(o,n){n>=_f&&(_f=n+1),M$.set(o,n),Z$.set(n,o)},cR="style["+Oh+'][data-styled-version="5.3.11"]',uR=new RegExp("^"+Oh+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),dR=function(o,n,s){for(var i,a=s.split(","),c=0,h=a.length;c<h;c++)(i=a[c])&&o.registerName(n,i)},hR=function(o,n){for(var s=(n.textContent||"").split(`/*!sc*/
`),i=[],a=0,c=s.length;a<c;a++){var h=s[a].trim();if(h){var g=h.match(uR);if(g){var b=0|parseInt(g[1],10),$=g[2];b!==0&&(lR($,b),dR(o,$,g[3]),o.getTag().insertRules(b,i)),i.length=0}else i.push(h)}}},pR=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null},ak=function(o){var n=document.head,s=o||n,i=document.createElement("style"),a=function(g){for(var b=g.childNodes,$=b.length;$>=0;$--){var y=b[$];if(y&&y.nodeType===1&&y.hasAttribute(Oh))return y}}(s),c=a!==void 0?a.nextSibling:null;i.setAttribute(Oh,"active"),i.setAttribute("data-styled-version","5.3.11");var h=pR();return h&&i.setAttribute("nonce",h),s.insertBefore(i,c),i},gR=function(){function o(s){var i=this.element=ak(s);i.appendChild(document.createTextNode("")),this.sheet=function(a){if(a.sheet)return a.sheet;for(var c=document.styleSheets,h=0,g=c.length;h<g;h++){var b=c[h];if(b.ownerNode===a)return b}Vf(17)}(i),this.length=0}var n=o.prototype;return n.insertRule=function(s,i){try{return this.sheet.insertRule(i,s),this.length++,!0}catch{return!1}},n.deleteRule=function(s){this.sheet.deleteRule(s),this.length--},n.getRule=function(s){var i=this.sheet.cssRules[s];return i!==void 0&&typeof i.cssText=="string"?i.cssText:""},o}(),fR=function(){function o(s){var i=this.element=ak(s);this.nodes=i.childNodes,this.length=0}var n=o.prototype;return n.insertRule=function(s,i){if(s<=this.length&&s>=0){var a=document.createTextNode(i),c=this.nodes[s];return this.element.insertBefore(a,c||null),this.length++,!0}return!1},n.deleteRule=function(s){this.element.removeChild(this.nodes[s]),this.length--},n.getRule=function(s){return s<this.length?this.nodes[s].textContent:""},o}(),mR=function(){function o(s){this.rules=[],this.length=0}var n=o.prototype;return n.insertRule=function(s,i){return s<=this.length&&(this.rules.splice(s,0,i),this.length++,!0)},n.deleteRule=function(s){this.rules.splice(s,1),this.length--},n.getRule=function(s){return s<this.length?this.rules[s]:""},o}(),ES=Aw,bR={isServer:!Aw,useCSSOMInjection:!rR},Q$=function(){function o(s,i,a){s===void 0&&(s=Zl),i===void 0&&(i={}),this.options=Go({},bR,{},s),this.gs=i,this.names=new Map(a),this.server=!!s.isServer,!this.server&&Aw&&ES&&(ES=!1,function(c){for(var h=document.querySelectorAll(cR),g=0,b=h.length;g<b;g++){var $=h[g];$&&$.getAttribute(Oh)!=="active"&&(hR(c,$),$.parentNode&&$.parentNode.removeChild($))}}(this))}o.registerId=function(s){return m$(s)};var n=o.prototype;return n.reconstructWithOptions=function(s,i){return i===void 0&&(i=!0),new o(Go({},this.options,{},s),this.gs,i&&this.names||void 0)},n.allocateGSInstance=function(s){return this.gs[s]=(this.gs[s]||0)+1},n.getTag=function(){return this.tag||(this.tag=(a=(i=this.options).isServer,c=i.useCSSOMInjection,h=i.target,s=a?new mR(h):c?new gR(h):new fR(h),new oR(s)));var s,i,a,c,h},n.hasNameForId=function(s,i){return this.names.has(s)&&this.names.get(s).has(i)},n.registerName=function(s,i){if(m$(s),this.names.has(s))this.names.get(s).add(i);else{var a=new Set;a.add(i),this.names.set(s,a)}},n.insertRules=function(s,i,a){this.registerName(s,i),this.getTag().insertRules(m$(s),a)},n.clearNames=function(s){this.names.has(s)&&this.names.get(s).clear()},n.clearRules=function(s){this.getTag().clearGroup(m$(s)),this.clearNames(s)},n.clearTag=function(){this.tag=void 0},n.toString=function(){return function(s){for(var i=s.getTag(),a=i.length,c="",h=0;h<a;h++){var g=aR(h);if(g!==void 0){var b=s.names.get(g),$=i.getGroup(h);if(b&&$&&b.size){var y=Oh+".g"+h+'[id="'+g+'"]',w="";b!==void 0&&b.forEach(function(T){T.length>0&&(w+=T+",")}),c+=""+$+y+'{content:"'+w+`"}/*!sc*/
`}}}return c}(this)},o}(),$R=/(a)(d)/gi,IS=function(o){return String.fromCharCode(o+(o>25?39:97))};function L_(o){var n,s="";for(n=Math.abs(o);n>52;n=n/52|0)s=IS(n%52)+s;return(IS(n%52)+s).replace($R,"$1-$2")}var Sh=function(o,n){for(var s=n.length;s;)o=33*o^n.charCodeAt(--s);return o},lk=function(o){return Sh(5381,o)};function ck(o){for(var n=0;n<o.length;n+=1){var s=o[n];if(Rf(s)&&!Dw(s))return!1}return!0}var vR=lk("5.3.11"),yR=function(){function o(n,s,i){this.rules=n,this.staticRulesId="",this.isStatic=(i===void 0||i.isStatic)&&ck(n),this.componentId=s,this.baseHash=Sh(vR,s),this.baseStyle=i,Q$.registerId(s)}return o.prototype.generateAndInjectStyles=function(n,s,i){var a=this.componentId,c=[];if(this.baseStyle&&c.push(this.baseStyle.generateAndInjectStyles(n,s,i)),this.isStatic&&!i.hash)if(this.staticRulesId&&s.hasNameForId(a,this.staticRulesId))c.push(this.staticRulesId);else{var h=_u(this.rules,n,s,i).join(""),g=L_(Sh(this.baseHash,h)>>>0);if(!s.hasNameForId(a,g)){var b=i(h,"."+g,void 0,a);s.insertRules(a,g,b)}c.push(g),this.staticRulesId=g}else{for(var $=this.rules.length,y=Sh(this.baseHash,i.hash),w="",T=0;T<$;T++){var C=this.rules[T];if(typeof C=="string")w+=C;else if(C){var E=_u(C,n,s,i),k=Array.isArray(E)?E.join(""):E;y=Sh(y,k+T),w+=k}}if(w){var A=L_(y>>>0);if(!s.hasNameForId(a,A)){var P=i(w,"."+A,void 0,a);s.insertRules(a,A,P)}c.push(A)}}return c.join(" ")},o}(),_R=/^\s*\/\/.*$/gm,wR=[":","[",".","#"];function CR(o){var n,s,i,a,c=Zl,h=c.options,g=h===void 0?Zl:h,b=c.plugins,$=b===void 0?X$:b,y=new nR(g),w=[],T=function(k){function A(P){if(P)try{k(P+"}")}catch{}}return function(P,N,B,S,H,q,se,ee,K,Y){switch(P){case 1:if(K===0&&N.charCodeAt(0)===64)return k(N+";"),"";break;case 2:if(ee===0)return N+"/*|*/";break;case 3:switch(ee){case 102:case 112:return k(B[0]+N),"";default:return N+(Y===0?"/*|*/":"")}case-2:N.split("/*|*/}").forEach(A)}}}(function(k){w.push(k)}),C=function(k,A,P){return A===0&&wR.indexOf(P[s.length])!==-1||P.match(a)?k:"."+n};function E(k,A,P,N){N===void 0&&(N="&");var B=k.replace(_R,""),S=A&&P?P+" "+A+" { "+B+" }":B;return n=N,s=A,i=new RegExp("\\"+s+"\\b","g"),a=new RegExp("(\\"+s+"\\b){2,}"),y(P||!A?"":A,S)}return y.use([].concat($,[function(k,A,P){k===2&&P.length&&P[0].lastIndexOf(s)>0&&(P[0]=P[0].replace(i,C))},T,function(k){if(k===-2){var A=w;return w=[],A}}])),E.hash=$.length?$.reduce(function(k,A){return A.name||Vf(15),Sh(k,A.name)},5381).toString():"",E}var uk=We.createContext();uk.Consumer;var dk=We.createContext(),SR=(dk.Consumer,new Q$),B_=CR();function hk(){return ve.useContext(uk)||SR}function pk(){return ve.useContext(dk)||B_}var TR=function(){function o(n,s){var i=this;this.inject=function(a,c){c===void 0&&(c=B_);var h=i.name+c.hash;a.hasNameForId(i.id,h)||a.insertRules(i.id,h,c(i.rules,h,"@keyframes"))},this.toString=function(){return Vf(12,String(i.name))},this.name=n,this.id="sc-keyframes-"+n,this.rules=s}return o.prototype.getName=function(n){return n===void 0&&(n=B_),this.name+n.hash},o}(),kR=/([A-Z])/,ER=/([A-Z])/g,IR=/^ms-/,xR=function(o){return"-"+o.toLowerCase()};function xS(o){return kR.test(o)?o.replace(ER,xR).replace(IR,"-ms-"):o}var DS=function(o){return o==null||o===!1||o===""};function _u(o,n,s,i){if(Array.isArray(o)){for(var a,c=[],h=0,g=o.length;h<g;h+=1)(a=_u(o[h],n,s,i))!==""&&(Array.isArray(a)?c.push.apply(c,a):c.push(a));return c}if(DS(o))return"";if(Dw(o))return"."+o.styledComponentId;if(Rf(o)){if(typeof($=o)!="function"||$.prototype&&$.prototype.isReactComponent||!n)return o;var b=o(n);return _u(b,n,s,i)}var $;return o instanceof TR?s?(o.inject(s,i),o.getName(i)):o:N_(o)?function y(w,T){var C,E,k=[];for(var A in w)w.hasOwnProperty(A)&&!DS(w[A])&&(Array.isArray(w[A])&&w[A].isCss||Rf(w[A])?k.push(xS(A)+":",w[A],";"):N_(w[A])?k.push.apply(k,y(w[A],A)):k.push(xS(A)+": "+(C=A,(E=w[A])==null||typeof E=="boolean"||E===""?"":typeof E!="number"||E===0||C in sR||C.startsWith("--")?String(E).trim():E+"px")+";"));return T?[T+" {"].concat(k,["}"]):k}(o):o.toString()}var AS=function(o){return Array.isArray(o)&&(o.isCss=!0),o};function gk(o){for(var n=arguments.length,s=new Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];return Rf(o)||N_(o)?AS(_u(TS(X$,[o].concat(s)))):s.length===0&&o.length===1&&typeof o[0]=="string"?o:AS(_u(TS(o,s)))}var fk=function(o,n,s){return s===void 0&&(s=Zl),o.theme!==s.theme&&o.theme||n||s.theme},DR=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,AR=/(^-|-$)/g;function By(o){return o.replace(DR,"-").replace(AR,"")}var mk=function(o){return L_(lk(o)>>>0)};function b$(o){return typeof o=="string"&&!0}var P_=function(o){return typeof o=="function"||typeof o=="object"&&o!==null&&!Array.isArray(o)},OR=function(o){return o!=="__proto__"&&o!=="constructor"&&o!=="prototype"};function RR(o,n,s){var i=o[s];P_(n)&&P_(i)?bk(i,n):o[s]=n}function bk(o){for(var n=arguments.length,s=new Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];for(var a=0,c=s;a<c.length;a++){var h=c[a];if(P_(h))for(var g in h)OR(g)&&RR(o,h[g],g)}return o}var Ow=We.createContext();Ow.Consumer;var Py={};function $k(o,n,s){var i=Dw(o),a=!b$(o),c=n.attrs,h=c===void 0?X$:c,g=n.componentId,b=g===void 0?function(N,B){var S=typeof N!="string"?"sc":By(N);Py[S]=(Py[S]||0)+1;var H=S+"-"+mk("5.3.11"+S+Py[S]);return B?B+"-"+H:H}(n.displayName,n.parentComponentId):g,$=n.displayName,y=$===void 0?function(N){return b$(N)?"styled."+N:"Styled("+kS(N)+")"}(o):$,w=n.displayName&&n.componentId?By(n.displayName)+"-"+n.componentId:n.componentId||b,T=i&&o.attrs?Array.prototype.concat(o.attrs,h).filter(Boolean):h,C=n.shouldForwardProp;i&&o.shouldForwardProp&&(C=n.shouldForwardProp?function(N,B,S){return o.shouldForwardProp(N,B,S)&&n.shouldForwardProp(N,B,S)}:o.shouldForwardProp);var E,k=new yR(s,w,i?o.componentStyle:void 0),A=k.isStatic&&h.length===0,P=function(N,B){return function(S,H,q,se){var ee=S.attrs,K=S.componentStyle,Y=S.defaultProps,X=S.foldedComponentIds,ce=S.shouldForwardProp,W=S.styledComponentId,te=S.target,ke=function(He,ne,Ke){He===void 0&&(He=Zl);var Te=Go({},ne,{theme:He}),Je={};return Ke.forEach(function(rt){var ht,nt,Wt,St=rt;for(ht in Rf(St)&&(St=St(Te)),St)Te[ht]=Je[ht]=ht==="className"?(nt=Je[ht],Wt=St[ht],nt&&Wt?nt+" "+Wt:nt||Wt):St[ht]}),[Te,Je]}(fk(H,ve.useContext(Ow),Y)||Zl,H,ee),Z=ke[0],ze=ke[1],Ce=function(He,ne,Ke,Te){var Je=hk(),rt=pk(),ht=ne?He.generateAndInjectStyles(Zl,Je,rt):He.generateAndInjectStyles(Ke,Je,rt);return ht}(K,se,Z),at=q,he=ze.$as||H.$as||ze.as||H.as||te,Ae=b$(he),de=ze!==H?Go({},H,{},ze):H,Se={};for(var xe in de)xe[0]!=="$"&&xe!=="as"&&(xe==="forwardedAs"?Se.as=de[xe]:(ce?ce(xe,zC,he):!Ae||zC(xe))&&(Se[xe]=de[xe]));return H.style&&ze.style!==H.style&&(Se.style=Go({},H.style,{},ze.style)),Se.className=Array.prototype.concat(X,W,Ce!==W?Ce:null,H.className,ze.className).filter(Boolean).join(" "),Se.ref=at,ve.createElement(he,Se)}(E,N,B,A)};return P.displayName=y,(E=We.forwardRef(P)).attrs=T,E.componentStyle=k,E.displayName=y,E.shouldForwardProp=C,E.foldedComponentIds=i?Array.prototype.concat(o.foldedComponentIds,o.styledComponentId):X$,E.styledComponentId=w,E.target=i?o.target:o,E.withComponent=function(N){var B=n.componentId,S=function(q,se){if(q==null)return{};var ee,K,Y={},X=Object.keys(q);for(K=0;K<X.length;K++)ee=X[K],se.indexOf(ee)>=0||(Y[ee]=q[ee]);return Y}(n,["componentId"]),H=B&&B+"-"+(b$(N)?N:By(kS(N)));return $k(N,Go({},S,{attrs:T,componentId:H}),s)},Object.defineProperty(E,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(N){this._foldedDefaultProps=i?bk({},o.defaultProps,N):N}}),Object.defineProperty(E,"toString",{value:function(){return"."+E.styledComponentId}}),a&&DI(E,o,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),E}var Di=function(o){return function n(s,i,a){if(a===void 0&&(a=Zl),!ok.isValidElementType(i))return Vf(1,String(i));var c=function(){return s(i,a,gk.apply(void 0,arguments))};return c.withConfig=function(h){return n(s,i,Go({},a,{},h))},c.attrs=function(h){return n(s,i,Go({},a,{attrs:Array.prototype.concat(a.attrs,h).filter(Boolean)}))},c}($k,o)};["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","textPath","tspan"].forEach(function(o){Di[o]=Di(o)});var MR=function(){function o(s,i){this.rules=s,this.componentId=i,this.isStatic=ck(s),Q$.registerId(this.componentId+1)}var n=o.prototype;return n.createStyles=function(s,i,a,c){var h=c(_u(this.rules,i,a,c).join(""),""),g=this.componentId+s;a.insertRules(g,g,h)},n.removeStyles=function(s,i){i.clearRules(this.componentId+s)},n.renderStyles=function(s,i,a,c){s>2&&Q$.registerId(this.componentId+s),this.removeStyles(s,a),this.createStyles(s,i,a,c)},o}();function NR(o){for(var n=arguments.length,s=new Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];var a=gk.apply(void 0,[o].concat(s)),c="sc-global-"+mk(JSON.stringify(a)),h=new MR(a,c);function g($){var y=hk(),w=pk(),T=ve.useContext(Ow),C=ve.useRef(y.allocateGSInstance(c)).current;return y.server&&b(C,$,y,T,w),ve.useLayoutEffect(function(){if(!y.server)return b(C,$,y,T,w),function(){return h.removeStyles(C,y)}},[C,$,y,T,w]),null}function b($,y,w,T,C){if(h.isStatic)h.renderStyles($,iR,w,C);else{var E=Go({},y,{theme:fk(y,T,g.defaultProps)});h.renderStyles($,E,w,C)}}return We.memo(g)}function OS(o,n){(n==null||n>o.length)&&(n=o.length);for(var s=0,i=Array(n);s<n;s++)i[s]=o[s];return i}function LR(o){if(Array.isArray(o))return o}function BR(o){if(o===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function PR(o,n,s){return n=ev(n),VR(o,vk()?Reflect.construct(n,[],ev(o).constructor):n.apply(o,s))}function jR(o,n){if(!(o instanceof n))throw new TypeError("Cannot call a class as a function")}function FR(o,n){for(var s=0;s<n.length;s++){var i=n[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(o,yk(i.key),i)}}function zR(o,n,s){return n&&FR(o.prototype,n),Object.defineProperty(o,"prototype",{writable:!1}),o}function xh(o,n){var s=typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(!s){if(Array.isArray(o)||(s=_k(o))||n){s&&(o=s);var i=0,a=function(){};return{s:a,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(b){throw b},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var c,h=!0,g=!1;return{s:function(){s=s.call(o)},n:function(){var b=s.next();return h=b.done,b},e:function(b){g=!0,c=b},f:function(){try{h||s.return==null||s.return()}finally{if(g)throw c}}}}function Ti(o,n,s){return(n=yk(n))in o?Object.defineProperty(o,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):o[n]=s,o}function ev(o){return ev=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ev(o)}function UR(o,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(n&&n.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),Object.defineProperty(o,"prototype",{writable:!1}),n&&j_(o,n)}function vk(){try{var o=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vk=function(){return!!o})()}function WR(o,n){var s=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(s!=null){var i,a,c,h,g=[],b=!0,$=!1;try{if(c=(s=s.call(o)).next,n!==0)for(;!(b=(i=c.call(s)).done)&&(g.push(i.value),g.length!==n);b=!0);}catch(y){$=!0,a=y}finally{try{if(!b&&s.return!=null&&(h=s.return(),Object(h)!==h))return}finally{if($)throw a}}return g}}function HR(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function RS(o,n){var s=Object.keys(o);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(o);n&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(o,a).enumerable})),s.push.apply(s,i)}return s}function tv(o){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?RS(Object(s),!0).forEach(function(i){Ti(o,i,s[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):RS(Object(s)).forEach(function(i){Object.defineProperty(o,i,Object.getOwnPropertyDescriptor(s,i))})}return o}function VR(o,n){if(n&&(typeof n=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BR(o)}function j_(o,n){return j_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,i){return s.__proto__=i,s},j_(o,n)}function GR(o,n){return LR(o)||WR(o,n)||_k(o,n)||HR()}function uo(o,n){return n||(n=o.slice(0)),Object.freeze(Object.defineProperties(o,{raw:{value:Object.freeze(n)}}))}function KR(o,n){if(typeof o!="object"||!o)return o;var s=o[Symbol.toPrimitive];if(s!==void 0){var i=s.call(o,n);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}function yk(o){var n=KR(o,"string");return typeof n=="symbol"?n:n+""}function _k(o,n){if(o){if(typeof o=="string")return OS(o,n);var s={}.toString.call(o).slice(8,-1);return s==="Object"&&o.constructor&&(s=o.constructor.name),s==="Map"||s==="Set"?Array.from(o):s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s)?OS(o,n):void 0}}var MS,JR=NR(MS||(MS=uo([`
  .focus-outline-hidden :focus {
      outline: none;
  }
`]))),NS,wk=Di.button(NS||(NS=uo([`
  display: block;
  padding: 0;
  border: 0;
  background: none;
  font-size: 0;
  cursor: `,`;
`])),function(o){return o.disabled?"not-allowed":"pointer"}),LS,BS,qR=Di.span(LS||(LS=uo([`
  font-size: 12px;
  line-height: 1;
`])));function Ck(o){var n=o.className,s=o.onClick,i=o.inverted,a=o.label,c=o.disabled;return We.createElement(wk,{className:n,onClick:s,"data-tour-elem":"".concat(i?"right":"left","-arrow"),disabled:c},a?We.createElement(qR,null,a):We.createElement("svg",{viewBox:"0 0 18.4 14.4"},We.createElement("path",{d:i?"M17 7.2H1M10.8 1L17 7.2l-6.2 6.2":"M1.4 7.2h16M7.6 1L1.4 7.2l6.2 6.2",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeMiterlimit:"10"})))}Ck.propTypes={className:Ge.string.isRequired,onClick:Ge.func.isRequired,inverted:Ge.bool,label:Ge.node,disabled:Ge.bool};var PS=Di(Ck)(BS||(BS=uo([`
  color: `,`;

  `,`;
  `,`;

  &:hover {
    color: `,`;
  }
`])),function(o){return o.disabled?"#caccce":"#646464"},function(o){return o.inverted?"margin-left: 24px;":"margin-right: 24px;"},function(o){return!o.label&&`
    width: 16px;
    height: 12px;
    flex: 0 0 16px;
  `},function(o){return o.disabled?"#caccce":"#000"}),jS;function Sk(o){var n=o.className,s=o.onClick,i=o.ariaLabel;return We.createElement(wk,{className:n,onClick:s,"aria-label":i},We.createElement("svg",{viewBox:"0 0 9.1 9.1","aria-hidden":!0,role:"presentation"},We.createElement("path",{fill:"currentColor",d:"M5.9 4.5l2.8-2.8c.4-.4.4-1 0-1.4-.4-.4-1-.4-1.4 0L4.5 3.1 1.7.3C1.3-.1.7-.1.3.3c-.4.4-.4 1 0 1.4l2.8 2.8L.3 7.4c-.4.4-.4 1 0 1.4.2.2.4.3.7.3s.5-.1.7-.3L4.5 6l2.8 2.8c.3.2.5.3.8.3s.5-.1.7-.3c.4-.4.4-1 0-1.4L5.9 4.5z"})))}Sk.propTypes={className:Ge.string.isRequired,onClick:Ge.func.isRequired,ariaLabel:Ge.string};var YR=Di(Sk)(jS||(jS=uo([`
  position: absolute;
  top: 22px;
  right: 22px;
  width: 9px;
  height: 9px;
  color: #5e5e5e;
  &:hover {
    color: #000;
  }
`])));function N$(o){var n=o.getBoundingClientRect(),s=n.top,i=n.right,a=n.bottom,c=n.left,h=n.width,g=n.height;return{top:s,right:i,bottom:a,left:c,width:h,height:g}}function Tk(o,n){if(!n.highlightedSelectors)return N$(o);var s=N$(o),i=xh(n.highlightedSelectors),a;try{for(i.s();!(a=i.n()).done;){var c=a.value,h=document.querySelector(c);if(!(!h||h.style.display==="none"||h.style.visibility==="hidden")){var g=N$(h);g.top<s.top&&(s.top=g.top),g.right>s.right&&(s.right=g.right),g.bottom>s.bottom&&(s.bottom=g.bottom),g.left<s.left&&(s.left=g.left)}}}catch(b){i.e(b)}finally{i.f()}return s.width=s.right-s.left,s.height=s.bottom-s.top,s}function XR(o){var n=o.top,s=o.right,i=o.bottom,a=o.left,c=o.w,h=o.h,g=o.threshold,b=g===void 0?0:g;return n>=0+b&&a>=0+b&&i<=h-b&&s<=c-b}function ZR(o){return o===document.querySelector("body")||o===document.querySelector("html")}var QR=function(n){return/(left|right)/.test(n)},jy=function(n,s){return n>s},Fy=function(n,s){return n>s},zo=function(n){return n<0?0:n};function eM(o){return Object.keys(o).map(function(n){return{position:n,value:o[n]}}).sort(function(n,s){return s.value-n.value}).map(function(n){return n.position})}var FS,tM=Di.div(FS||(FS=uo([`
  --reactour-accent: `,`;
  `,`
  position: fixed;
  transition: transform 0.3s;
  top: 0;
  left: 0;
  z-index: 1000000;

  transform: `,`;
`])),function(o){return o.accentColor},function(o){return o.defaultStyles?`
  max-width: 331px;
  min-width: 150px;
  padding-right: 40px;
  border-radius: `.concat(o.rounded,`px;
  background-color: #fff;
  padding: 24px 30px;
  box-shadow: 0 0.5em 3em rgba(0, 0, 0, 0.3);
  color: inherit;
  `):""},function(o){var n=o.targetTop,s=o.targetRight,i=o.targetBottom,a=o.targetLeft,c=o.windowWidth,h=o.windowHeight,g=o.helperWidth,b=o.helperHeight,$=o.helperPosition,y=o.padding,w={left:a,right:c-s,top:n,bottom:h-i},T=function(P){return w[P]>(QR(P)?g+y*2:b+y*2)},C=function(P){for(var N=eM(w),B=0;B<N.length;B++)if(T(N[B]))return P[N[B]];return P.center},E=function(P){if(Array.isArray(P)){var N=jy(P[0],c),B=Fy(P[1],h),S=function(X,ce){console.warn("".concat(X,":").concat(ce," is outside window, falling back to center"))};return N&&S("x",P[0]),B&&S("y",P[1]),[N?c/2-g/2:P[0],B?h/2-b/2:P[1]]}var H=jy(a+g,c)?jy(s+y,c)?s-g:s-g+y:a-y,q=H>y?H:y,se=Fy(n+b,h)?Fy(i+y,h)?i-b:i-b+y:n-y,ee=se>y?se:y,K={top:[q,n-b-y*2],right:[s+y*2,ee],bottom:[q,i+y*2],left:[a-g-y*2,ee],center:[c/2-g/2,h/2-b/2]};return P==="center"||T(P)?K[P]:C(K)},k=E($);return"translate(".concat(Math.round(k[0]),"px, ").concat(Math.round(k[1]),"px)")}),zS,nM=Di.span(zS||(zS=uo([`
  position: absolute;
  font-family: monospace;
  background: var(--reactour-accent);
  background: `,`;
  height: 1.875em;
  line-height: 2;
  padding-left: 0.8125em;
  padding-right: 0.8125em;
  font-size: 1em;
  border-radius: 1.625em;
  color: white;
  text-align: center;
  box-shadow: 0 0.25em 0.5em rgba(0, 0, 0, 0.3);
  top: -0.8125em;
  left: -0.8125em;
`])),function(o){return o.accentColor}),US,sM=Di.div(US||(US=uo([`
  display: flex;
  margin-top: 24px;
  align-items: center;
  justify-content: center;
`]))),WS,rM=Di.nav(WS||(WS=uo([`
  counter-reset: dot;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-wrap: wrap;
`]))),HS,iM=Di.button(HS||(HS=uo([`
  counter-increment: dot;
  width: 8px;
  height: 8px;
  border: `,`;

  border-radius: 100%;
  padding: 0;
  display: block;
  margin: 4px;
  transition: opacity 0.3s, transform 0.3s;
  cursor: `,`;
  transform: scale(`,`);

  color: `,`;
  background: `,`;

  color: `,`;
  background: `,`;

  &:before {
    content: counter(dot);
    position: absolute;
    bottom: calc(100% + 0.25em);
    left: 50%;
    opacity: 0;
    transform: translate(-50%, 1em);
    transition: 0.3s;
    display: `,`;
  }

  &:hover {
    background-color: currentColor;

    &:before {
      opacity: 0.5;
      transform: translate(-50%, -2px);
    }
  }
`])),function(o){return o.current===o.index?"0":"1px solid #caccce"},function(o){return o.disabled?"not-allowed":"pointer"},function(o){return o.current===o.index?1.25:1},function(o){return o.current===o.index?"var(--reactour-accent)":"#caccce"},function(o){return o.current===o.index?"var(--reactour-accent)":"none"},function(o){return o.current===o.index?o.accentColor:"#caccce"},function(o){return o.current===o.index?o.accentColor:"none"},function(o){return o.showNumber?"block":"none"}),VS,oM=Di.div(VS||(VS=uo([`
  opacity: `,`;
  color: `,`;
  width: 100%;
  left: 0;
  top: 0;
  height: 100%;
  position: fixed;
  z-index: 99999;
  pointer-events: none;
`])),function(o){return!o.maskClassName&&.7},function(o){return!o.maskClassName&&"#000"});function kk(o){var n=o.windowWidth,s=o.windowHeight,i=o.targetWidth,a=o.targetHeight,c=o.targetTop,h=o.targetLeft,g=o.padding,b=o.rounded,$=o.roundedStep,y=o.disableInteraction,w=o.disableInteractionClassName,T=o.className,C=o.onClick,E=o.highlightedBorder,k=zo(i+g*2),A=zo(a+g*2),P=zo(c-g),N=zo(h-g),B=$?Math.min(k/2,A/2):b;return We.createElement(oM,{onClick:C,maskClassName:T},We.createElement("svg",{width:n,height:s,xmlns:"http://www.w3.org/2000/svg",className:T},We.createElement("defs",null,We.createElement("mask",{id:"mask-main"},We.createElement("rect",{x:0,y:0,width:n,height:s,fill:"white"}),We.createElement("rect",{x:N,y:P,width:k,height:A,fill:"black"}),We.createElement("rect",{x:N-1,y:P-1,width:B,height:B,fill:"white"}),We.createElement("circle",{cx:N+B,cy:P+B,r:B,fill:"black"}),We.createElement("rect",{x:N+k-B+1,y:P-1,width:B,height:B,fill:"white"}),We.createElement("circle",{cx:N+k-B,cy:P+B,r:B,fill:"black"}),We.createElement("rect",{x:N-1,y:P+A-B+1,width:B,height:B,fill:"white"}),We.createElement("circle",{cx:N+B,cy:P+A-B,r:B,fill:"black"}),We.createElement("rect",{x:N+k-B+1,y:P+A-B+1,width:B,height:B,fill:"white"}),We.createElement("circle",{cx:N+k-B,cy:P+A-B,r:B,fill:"black "})),We.createElement("clipPath",{id:"clip-path"},We.createElement("rect",{x:0,y:0,width:n,height:P}),We.createElement("rect",{x:0,y:P,width:N,height:A}),We.createElement("rect",{x:h+i+g,y:P,width:zo(n-i-N),height:A}),We.createElement("rect",{x:0,y:c+a+g,width:n,height:zo(s-a-P)}))),We.createElement("rect",{x:0,y:0,width:n,height:s,fill:"currentColor",mask:"url(#mask-main)"}),We.createElement("rect",{x:0,y:0,width:n,height:s,fill:"currentColor",clipPath:"url(#clip-path)",pointerEvents:"auto"}),We.createElement("rect",{x:N,y:P,width:k,height:A,pointerEvents:"auto",fill:"transparent",display:y?"block":"none",className:w}),E&&We.createElement("rect",{x:zo(N+E.width/2),y:zo(P+E.width/2),width:zo(k-E.width),height:zo(A-E.width),pointerEvents:"auto",fill:"none",strokeWidth:E.width,stroke:E.color,rx:B-2})))}kk.propTypes={windowWidth:Ge.number.isRequired,windowHeight:Ge.number.isRequired,targetWidth:Ge.number.isRequired,targetHeight:Ge.number.isRequired,targetTop:Ge.number.isRequired,targetLeft:Ge.number.isRequired,padding:Ge.number.isRequired,rounded:Ge.number.isRequired,roundedStep:Ge.bool,disableInteraction:Ge.bool.isRequired,disableInteractionClassName:Ge.string.isRequired,highlightedBorder:Ge.shape({color:Ge.string.isRequired,width:Ge.number.isRequired})};var aM=function(o){var n=o.step,s=o.refresh,i=ve.useState(0),a=GR(i,2),c=a[0],h=a[1];return ve.useEffect(function(){if(n.resizeObservables){var g=function(T){var C=xh(T),E;try{var k=function(){var P=E.value;if(!P.attributes)return 1;var N=n.resizeObservables.find(function(B){return P.matches(B)||P.querySelector(B)!=null});N&&h(c+1)};for(C.s();!(E=C.n()).done;)k()}catch(A){C.e(A)}finally{C.f()}},b=new MutationObserver(function(w){var T=xh(w),C;try{for(T.s();!(C=T.n()).done;){var E=C.value;E.addedNodes.length!==0&&g(E.addedNodes),E.removedNodes.length!==0&&g(E.removedNodes)}}catch(k){T.e(k)}finally{T.f()}}),$=document.documentElement||document.body,y={childList:!0,subtree:!0};return b.observe($,y),function(){b.disconnect()}}},[n,c]),ve.useEffect(function(){if(n.resizeObservables){var g=new ResizeObserver(function(T){s()}),b=xh(n.resizeObservables),$;try{for(b.s();!($=b.n()).done;){var y=$.value,w=document.querySelector(y);w&&g.observe(w)}}catch(T){b.e(T)}finally{b.f()}return function(){g.disconnect()}}},[n,c]),null},lM=function(o){var n=o.step,s=o.refresh;return ve.useEffect(function(){if(n.mutationObservables){var i=function(b){var $=xh(b),y;try{var w=function(){var C=y.value;if(!C.attributes)return 1;var E=n.mutationObservables.find(function(k){return C.matches(k)||C.querySelector(k)!=null});E&&s()};for($.s();!(y=$.n()).done;)w()}catch(T){$.e(T)}finally{$.f()}},a=new MutationObserver(function(g){var b=xh(g),$;try{for(b.s();!($=b.n()).done;){var y=$.value;y.addedNodes.length!==0&&i(y.addedNodes),y.removedNodes.length!==0&&i(y.removedNodes)}}catch(w){b.e(w)}finally{b.f()}}),c=document.documentElement||document.body,h={childList:!0,subtree:!0};return a.observe(c,h),function(){a.disconnect()}}},[n]),null};function cM(o){var n=o.children,s=ve.useRef(null);return s.current===null&&(s.current=document.createElement("div"),s.current.setAttribute("id","___reactour")),ve.useEffect(function(){return document.body.appendChild(s.current),function(){document.body.removeChild(s.current)}},[s]),P0.createPortal(n,s.current)}var uM={disableFocusLock:Ge.bool,badgeContent:Ge.func,highlightedMaskClassName:Ge.string,children:Ge.oneOfType([Ge.node,Ge.element]),className:Ge.string,closeButtonAriaLabel:Ge.string,closeWithMask:Ge.bool,inViewThreshold:Ge.number,isOpen:Ge.bool.isRequired,lastStepNextButton:Ge.node,maskClassName:Ge.string,maskSpace:Ge.number,nextButton:Ge.node,onAfterOpen:Ge.func,onBeforeClose:Ge.func,onRequestClose:Ge.func,prevButton:Ge.node,scrollDuration:Ge.number,scrollOffset:Ge.number,showButtons:Ge.bool,showCloseButton:Ge.bool,showNavigation:Ge.bool,showNavigationNumber:Ge.bool,showNumber:Ge.bool,startAt:Ge.number,goToStep:Ge.number,getCurrentStep:Ge.func,nextStep:Ge.func,prevStep:Ge.func,steps:Ge.arrayOf(Ge.shape({selector:Ge.string,content:Ge.oneOfType([Ge.node,Ge.element,Ge.func]).isRequired,position:Ge.oneOfType([Ge.arrayOf(Ge.number),Ge.oneOf(["top","right","bottom","left","center"])]),action:Ge.func,style:Ge.object,stepInteraction:Ge.bool,navDotAriaLabel:Ge.string,roundedStep:Ge.bool})),update:Ge.string,updateDelay:Ge.number,disableInteraction:Ge.bool,disableDotsNavigation:Ge.bool,disableKeyboardNavigation:Ge.oneOfType([Ge.arrayOf(Ge.oneOf(["esc","right","left"])),Ge.bool]),rounded:Ge.number,accentColor:Ge.string,highlightedBorder:Ge.shape({color:Ge.string.isRequired,width:Ge.number.isRequired})},dM={disableFocusLock:!1,showNavigation:!0,showNavigationNumber:!0,showButtons:!0,showCloseButton:!0,closeButtonAriaLabel:"Close",showNumber:!0,scrollDuration:1,maskSpace:10,updateDelay:1,disableInteraction:!1,rounded:0,accentColor:"#007aff",closeWithMask:!0},gh={mask:{disableInteraction:"reactour__mask--disable-interaction"},helper:{base:"reactour__helper",isOpen:"reactour__helper--is-open"},dot:{base:"reactour__dot",active:"reactour__dot--is-active"}},Rw=function(o){function n(){var s;return jR(this,n),s=PR(this,n),Ti(s,"unlockFocus",function(i){s.setState({focusUnlocked:!0},i())}),Ti(s,"showStep",function(){if(!(!s.helper||!s.helper.current)){var i=s.props.steps,a=s.state,c=a.current,h=a.focusUnlocked;h&&s.setState({focusUnlocked:!1});var g=i[c],b=g.selector?document.querySelector(g.selector):null,$=function(E){g.action&&typeof g.action=="function"&&s.unlockFocus(function(){return g.action(E)})};if(g.observe){var y=document.querySelector(g.observe),w={attributes:!0,childList:!0,characterData:!0};s.setState(function(C){return C.observer&&setTimeout(function(){C.observer.disconnect()},0),{observer:new MutationObserver(function(E){E.forEach(function(k){if(k.type==="childList"&&k.addedNodes.length>0){var A=function(){return $(k.addedNodes[0])};setTimeout(function(){return s.calculateNode(k.addedNodes[0],g,A)},100)}else if(k.type==="childList"&&k.removedNodes.length>0){var P=function(){return $(b)};s.calculateNode(b,g,P)}})})}},function(){return s.state.observer.observe(y,w)})}else s.state.observer&&(s.state.observer.disconnect(),s.setState({observer:null}));if(b){var T=function(){return $(b)};s.calculateNode(b,g,T)}else s.setState(zy(null,g,s.helper.current),$),g.selector&&console.warn("Doesn't find a DOM node '".concat(g.selector,"'. Please check the 'steps' Tour prop Array at position ").concat(c,"."))}}),Ti(s,"calculateNode",function(i,a,c){var h=s.props,g=h.scrollDuration,b=h.inViewThreshold,$=h.scrollOffset,y=Tk(i,a),w=Math.max(document.documentElement.clientWidth,window.innerWidth||0),T=Math.max(document.documentElement.clientHeight,window.innerHeight||0);if(XR(tv(tv({},y),{},{w,h:T,threshold:b})))s.setState(zy(i,a,s.helper.current),c);else{var C=CO(i),E=$||(y.height>T?-25:-(T/2)+y.height/2);yO.to(i,{context:ZR(C)?window:C,duration:g,offset:E,callback:function(A){s.setState(zy(A,a,s.helper.current),c)}})}}),Ti(s,"recalculateNode",function(i){var a=document.querySelector(i.selector),c=function(g){i.action&&typeof i.action=="function"&&s.unlockFocus(function(){return i.action(g)})};s.calculateNode(a,i,function(){return c(a)})}),Ti(s,"maskClickHandler",function(i){var a=s.props,c=a.closeWithMask,h=a.onRequestClose;c&&!i.target.classList.contains(gh.mask.disableInteraction)&&h(i)}),Ti(s,"nextStep",function(){var i=s.props,a=i.steps,c=i.getCurrentStep;s.setState(function(h){var g=h.current<a.length-1?h.current+1:h.current;return typeof c=="function"&&c(g),{current:g}},s.showStep)}),Ti(s,"prevStep",function(){var i=s.props.getCurrentStep;s.setState(function(a){var c=a.current>0?a.current-1:a.current;return typeof i=="function"&&i(c),{current:c}},s.showStep)}),Ti(s,"gotoStep",function(i){var a=s.props,c=a.steps,h=a.getCurrentStep;s.setState(function(g){var b=c[i]?i:g.current;return typeof h=="function"&&h(b),{current:b}},s.showStep)}),Ti(s,"keyDownHandler",function(i){var a=s.props,c=a.onRequestClose,h=a.nextStep,g=a.prevStep,b=a.disableKeyboardNavigation;if(i.stopPropagation(),b!==!0){var $,y,w;b&&($=b.includes("esc"),y=b.includes("right"),w=b.includes("left")),i.keyCode===27&&!$&&(i.preventDefault(),c()),i.keyCode===39&&!y&&(i.preventDefault(),typeof h=="function"?h():s.nextStep()),i.keyCode===37&&!w&&(i.preventDefault(),typeof g=="function"?g():s.prevStep())}}),s.state={isOpen:!1,current:0,top:0,right:0,bottom:0,left:0,width:0,height:0,w:0,h:0,inDOM:!1,observer:null,focusUnlocked:!1},s.helper=ve.createRef(),s.helperElement=null,s.debouncedShowStep=UO(s.showStep,70),s}return UR(n,o),zR(n,[{key:"componentDidMount",value:function(){var i=this.props,a=i.isOpen,c=i.startAt;a&&this.open(c)}},{key:"UNSAFE_componentWillReceiveProps",value:function(i){var a=this.props,c=a.isOpen,h=a.update,g=a.updateDelay;!c&&i.isOpen?this.open(i.startAt):c&&!i.isOpen&&this.close(),c&&h!==i.update&&(i.steps[this.state.current]?setTimeout(this.showStep,g):this.props.onRequestClose()),c&&i.isOpen&&this.state.current!==i.goToStep&&this.gotoStep(i.goToStep)}},{key:"componentWillUnmount",value:function(){var i=this.props.isOpen;i&&this.close(),this.state.observer&&this.state.observer.disconnect()}},{key:"open",value:function(i){var a=this,c=this.props.onAfterOpen;this.setState(function(h){return{isOpen:!0,current:i!==void 0?i:h.current}},function(){setTimeout(a.showStep,1),a.helperElement=a.helper.current,a.props.disableFocusLock||a.helper.current.focus(),c&&c(a.helperElement)}),window.addEventListener("resize",this.debouncedShowStep,!1),window.addEventListener("keydown",this.keyDownHandler,!1)}},{key:"close",value:function(){this.setState(function(i){return i.observer&&i.observer.disconnect(),{isOpen:!1,observer:null}},this.onBeforeClose),window.removeEventListener("resize",this.debouncedShowStep),window.removeEventListener("keydown",this.keyDownHandler)}},{key:"onBeforeClose",value:function(){var i=this.props.onBeforeClose;i&&i(this.helperElement)}},{key:"render",value:function(){var i=this,a=this.props,c=a.className,h=a.steps,g=a.maskClassName,b=a.showButtons,$=a.showCloseButton,y=a.closeButtonAriaLabel,w=a.showNavigation,T=a.showNavigationNumber,C=a.showNumber,E=a.onRequestClose,k=a.maskSpace,A=a.lastStepNextButton,P=a.nextButton,N=a.prevButton,B=a.badgeContent,S=a.highlightedMaskClassName,H=a.disableInteraction,q=a.disableDotsNavigation,se=a.nextStep,ee=a.prevStep,K=a.rounded,Y=a.accentColor,X=a.CustomHelper,ce=a.disableFocusLock,W=a.highlightedBorder,te=this.state,ke=te.isOpen,Z=te.current,ze=te.inDOM,Ce=te.top,at=te.right,he=te.bottom,Ae=te.left,de=te.width,Se=te.height,xe=te.w,He=te.h,ne=te.helperWidth,Ke=te.helperHeight,Te=te.helperPosition;return ke?We.createElement(cM,null,We.createElement(JR,null),We.createElement(aM,{step:h[Z],refresh:function(){return i.recalculateNode(h[Z])}}),We.createElement(lM,{step:h[Z],refresh:function(){return i.recalculateNode(h[Z])}}),We.createElement(kk,{onClick:this.maskClickHandler,forwardRef:function(rt){return i.mask=rt},windowWidth:xe,windowHeight:He,targetWidth:de,targetHeight:Se,targetTop:Ce,targetLeft:Ae,padding:k,rounded:K,roundedStep:h[Z].roundedStep,className:g,disableInteraction:h[Z].stepInteraction===!1||H?!h[Z].stepInteraction:H,disableInteractionClassName:"".concat(gh.mask.disableInteraction," ").concat(S),highlightedBorder:W}),We.createElement(nk,{disabled:ce,autoFocus:!1},We.createElement(tM,{ref:this.helper,targetHeight:Se,targetWidth:de,targetTop:Ce,targetRight:at,targetBottom:he,targetLeft:Ae,windowWidth:xe,windowHeight:He,helperWidth:ne,helperHeight:Ke,helperPosition:Te,padding:k,tabIndex:-1,current:Z,style:h[Z].style?h[Z].style:{},rounded:K,className:gS(gh.helper.base,c,Ti({},gh.helper.isOpen,ke)),accentColor:Y,defaultStyles:!X,role:"dialog"},X?We.createElement(X,{current:Z,totalSteps:h.length,gotoStep:this.gotoStep,close:E,content:h[Z]&&(typeof h[Z].content=="function"?h[Z].content({close:E,goTo:this.gotoStep,inDOM:ze,step:Z+1}):h[Z].content)},this.props.children):We.createElement(We.Fragment,null,this.props.children,h[Z]&&(typeof h[Z].content=="function"?h[Z].content({close:E,goTo:this.gotoStep,inDOM:ze,step:Z+1}):h[Z].content),C&&We.createElement(nM,{"data-tour-elem":"badge",accentColor:Y},typeof B=="function"?B(Z+1,h.length):Z+1),(b||w)&&We.createElement(sM,{"data-tour-elem":"controls"},b&&We.createElement(PS,{onClick:typeof ee=="function"?ee:this.prevStep,disabled:Z===0,label:N||null}),w&&We.createElement(rM,{"data-tour-elem":"navigation"},h.map(function(Je,rt){return We.createElement(iM,{key:"".concat(Je.selector?Je.selector:"undef","_").concat(rt),onClick:function(){return i.gotoStep(rt)},current:Z,index:rt,accentColor:Y,disabled:Z===rt||q,showNumber:T,"data-tour-elem":"dot",className:gS(gh.dot.base,Ti({},gh.dot.active,Z===rt)),"aria-label":Je.navDotAriaLabel})})),b&&We.createElement(PS,{onClick:Z===h.length-1?A?E:function(){}:typeof se=="function"?se:this.nextStep,disabled:!A&&Z===h.length-1,inverted:!0,label:A&&Z===h.length-1?A:P||null})),$&&We.createElement(YR,{onClick:E,className:"reactour__close",ariaLabel:y}))))):null}}])}(ve.Component),zy=function(n,s,i){if(i){var a=Math.max(document.documentElement.clientWidth,window.innerWidth||0),c=Math.max(document.documentElement.clientHeight,window.innerHeight||0),h=N$(i),g=h.width,b=h.height,$={top:c+10,right:a/2+9,bottom:c/2+9,left:a/2-g/2,width:0,height:0,w:a,h:c,helperPosition:"center"};return n&&($=Tk(n,s)),function(){return tv(tv({w:a,h:c,helperWidth:g,helperHeight:b,helperPosition:s.position},$),{},{inDOM:!!n})}}};Rw.propTypes=uM;Rw.defaultProps=dM;const hM=""+new URL("blockly2js-B3Jxf2e-.svg",import.meta.url).href,pM=""+new URL("rules2js-DnYyR8mI.svg",import.meta.url).href;function gM(o){return/^script\.js\.global\./.test(o)}let fM=0;function mM(o){const n=/\x1b\[[0-9;]*m/g;return o.replace(n,"")}class Gv extends We.Component{monacoDiv=null;editor=null;monaco=window.monaco;insert="";originalCode;runningInstancesStr;monacoCounter=0;location;breakpoints;lastSearch="";typings={};decorations=[];triggerPrettier;constructor(n){super(n),this.state={name:"current",isDark:n.isDark||!1,language:n.language||"javascript",readOnly:n.readOnly||!1,alive:!0,check:!1,searchText:this.props.searchText||"",typingsLoaded:!1,showError:null},this.triggerPrettier=n.triggerPrettier,this.runningInstancesStr=JSON.stringify(this.props.runningInstances),this.originalCode=n.code||"",this.monacoDiv=We.createRef()}waitForMonaco(n){var i,a,c,h,g,b,$,y;let s=!!((h=(c=(a=(i=this.monaco)==null?void 0:i.languages)==null?void 0:a.typescript)==null?void 0:c.typescriptDefaults)!=null&&h.getCompilerOptions);if(!s||!this.props.runningInstances){if(this.monaco=window.monaco,s=!!((y=($=(b=(g=this.monaco)==null?void 0:g.languages)==null?void 0:b.typescript)==null?void 0:$.typescriptDefaults)!=null&&y.getCompilerOptions),this.monacoCounter++,!s&&this.monacoCounter<20){console.log("wait for monaco loaded"),setTimeout(()=>this.waitForMonaco(n),200);return}this.monacoCounter>=20&&console.error("Cannot load monaco!")}else n&&n()}loadTypings(n){if(!this.editor)return;n||=this.props.runningInstances;const s=n&&Object.keys(n).find(i=>n==null?void 0:n[i]);s&&this.props.socket.sendTo(s.replace("system.adapter.",""),"loadTypings",null).then(i=>{this.setState({alive:!0,check:!0,typingsLoaded:!0}),this.setTypeCheck(!0),i.typings?(this.typings=i.typings,this.setEditorTypings(this.state.name)):console.error(`failed to load typings: ${i.error}`)})}componentDidMount(){var i,a,c,h,g,b,$,y,w,T,C,E;let n=!!((h=(c=(a=(i=this.monaco)==null?void 0:i.languages)==null?void 0:a.typescript)==null?void 0:c.typescriptDefaults)!=null&&h.getCompilerOptions);if((!n||!this.props.runningInstances)&&(this.monaco=window.monaco,n=!!((y=($=(b=(g=this.monaco)==null?void 0:g.languages)==null?void 0:b.typescript)==null?void 0:$.typescriptDefaults)!=null&&y.getCompilerOptions),!n)){console.log("wait for monaco loaded..."),this.waitForMonaco(()=>this.componentDidMount());return}if(!this.editor&&n&&this.monaco){console.log("Init editor"),(T=(w=this.props).onRegisterSelect)==null||T.call(w,()=>{var A;if(this.editor){const P=this.editor.getSelection();if(P)return(A=this.editor.getModel())==null?void 0:A.getValueInRange(P)}});const k=this.monaco.languages.typescript.typescriptDefaults.getCompilerOptions();k.allowJs=!0,k.checkJs=this.props.checkJs!==!1,k.noLib=!0,k.lib=[],k.useUnknownInCatchVariables=!1,k.moduleResolution=this.monaco.languages.typescript.ModuleResolutionKind.NodeJs,k.target=this.monaco.languages.typescript.ScriptTarget.ESNext,k.module=this.monaco.languages.typescript.ModuleKind.ESNext,k.allowNonTsExtensions=!0,this.monaco.languages.typescript.typescriptDefaults.setCompilerOptions(k),this.setTypeCheck(!1),(C=this.monacoDiv)!=null&&C.current&&(this.editor=this.monaco.editor.create((E=this.monacoDiv)==null?void 0:E.current,{lineNumbers:"on",scrollBeyondLastLine:!1,automaticLayout:!0,glyphMargin:!!this.props.breakpoints,colorDecorators:!0}),this.editor.onDidChangeModelContent(()=>this.onChange()),this.loadTypings(),this.props.onForceSave&&this.editor.addCommand(this.monaco.KeyMod.CtrlCmd|this.monaco.KeyCode.KeyS,()=>this.props.onForceSave&&this.props.onForceSave()),setTimeout(()=>{this.highlightText(this.state.searchText),this.location=this.props.location||void 0,this.breakpoints=this.props.breakpoints,this.showDecorators()}))}const s={selectOnLineNumbers:!0,scrollBeyondLastLine:!1,automaticLayout:!0,readOnly:this.state.readOnly,language:this.state.language,isDark:this.state.isDark};this.setEditorOptions(s),this.editor&&(this.editor.focus(),this.editor.setValue(this.originalCode),this.props.onToggleBreakpoint?this.editor.onMouseDown(k=>{var P;const A=k.target;this.props.onToggleBreakpoint&&((P=A.detail)==null?void 0:P.glyphMarginLeft)!==void 0&&A.position&&this.props.onToggleBreakpoint(A.position.lineNumber-1)}):this.editor.onMouseDown(()=>{}))}setEditorOptions(n){var s;n&&(n.language&&this.setEditorLanguage(n.language),this.editor&&(n.readOnly!==void 0&&this.editor.updateOptions({readOnly:n.readOnly}),n.lineWrap!==void 0&&this.editor.updateOptions({wordWrap:n.lineWrap?"on":"off"})),n.typeCheck!==void 0&&this.setTypeCheck(n.typeCheck),n.isDark!==void 0&&((s=this.monaco)==null||s.editor.setTheme(n.isDark?"vs-dark":"vs")))}componentWillUnmount(){var n,s;this.editor&&((s=(n=this.props).onRegisterSelect)==null||s.call(n,null),this.editor.dispose(),this.editor=null)}async doPrettier(){var i,a,c,h;const n=this.props.runningInstances&&Object.keys(this.props.runningInstances).find(g=>{var b;return(b=this.props.runningInstances)==null?void 0:b[g]});if(!n){window.alert(I.I18n.t("No script adapter instance found to format the code"));return}const s=await this.props.socket.sendTo(n.replace("system.adapter.",""),"prettier",{code:(i=this.editor)==null?void 0:i.getValue(),type:this.state.language});s.error?this.setState({showError:{title:I.I18n.t("Error formatting code"),message:mM(s.error)}}):s.code&&((a=this.editor)==null||a.setValue(s.code),(h=(c=this.props).onChange)==null||h.call(c,s.code),this.showDecorators())}setEditorLanguage(n){var i;if(!this.editor)return;const s=this.editor.getModel();if(s){const a=s.getValue(),c=s.uri.path,h=typeof c=="string"&&c.includes(".")?c.substring(0,c.lastIndexOf(".")):"index",g=n==="javascript"?"js":n==="typescript"?"ts":n;s.dispose();const b=n==="javascript"||n==="typescript"?"typescript":n,$=(i=this.monaco)==null?void 0:i.editor.createModel(a,b,this.monaco.Uri.from({scheme:window.location.protocol.replace(":",""),path:`${h}${fM++}.${g}`}));$&&this.editor.setModel($)}}setTypeCheck(n){var i,a;const s={noSemanticValidation:!this.state.alive||!n,noSyntaxValidation:!this.state.alive};(i=this.monaco)==null||i.languages.typescript.typescriptDefaults.setDiagnosticsOptions(s),(a=this.monaco)==null||a.languages.typescript.javascriptDefaults.setDiagnosticsOptions({noSemanticValidation:!this.state.alive||!n,noSyntaxValidation:!this.state.alive})}setEditorTypings(n=""){var c,h,g,b,$,y,w,T;const s=gM(n),i=`${n}.d.ts`,a=[];for(const C of Object.keys(this.typings))s&&(C==="global.d.ts"||C.startsWith("script.js.global")&&C!==i)||a.push({filePath:C,content:this.typings[C]});if((b=(g=(h=(c=this.monaco)==null?void 0:c.languages)==null?void 0:h.typescript)==null?void 0:g.typescriptDefaults)!=null&&b.setExtraLibs)this.monaco.languages.typescript.typescriptDefaults.setExtraLibs(a);else if((T=(w=(y=($=this.monaco)==null?void 0:$.languages)==null?void 0:y.typescript)==null?void 0:w.typescriptDefaults)!=null&&T.addExtraLib){const C=this.monaco.languages.typescript.typescriptDefaults.getExtraLibs();a.forEach(E=>{!C[E.filePath]&&this.monaco&&this.monaco.languages.typescript.typescriptDefaults.addExtraLib(E.content,E.filePath)})}}insertTextIntoEditor(n){if(!this.editor||!this.monaco)return;const s=this.editor.getSelection();if(s){const i=new this.monaco.Range(s.startLineNumber,s.startColumn,s.endLineNumber,s.endColumn);this.editor.executeEdits("",[{range:i,text:n,forceMoveMarkers:!0}])}this.editor.focus()}highlightText(n){var i;if(!this.editor||!this.monaco)return;const s=n?(i=this.editor.getModel())==null?void 0:i.findMatches(n,!0,!1,!1,null,!0):void 0;if(s!=null&&s.length)s.forEach(a=>{var c;return(c=this.editor)==null?void 0:c.setSelection(a.range)}),this.editor.revealLine(s[0].range.startLineNumber);else{const a=this.editor.getPosition();if(a){const c=a.lineNumber,h=a.column;this.editor.setSelection(new this.monaco.Range(c,h,c,h))}}}showDecorators(){var s;const n=[];if(this.location&&this.monaco&&(n.push({range:new this.monaco.Range(this.location.lineNumber+1,(this.location.columnNumber||0)+1,this.location.lineNumber+1,1e3),options:{isWholeLine:!1,className:this.props.isDark?"monacoCurrentLineDark":"monacoCurrentLine"}}),n.push({range:new this.monaco.Range(this.location.lineNumber+1,0,this.location.lineNumber+1,0),options:{isWholeLine:!0,className:this.props.isDark?"monacoCurrentFullLineDark":"monacoCurrentFullLine"}})),(s=this.breakpoints)==null||s.forEach(i=>{this.monaco&&n.push({range:new this.monaco.Range(i.location.lineNumber+1,0,i.location.lineNumber+1,100),options:{isWholeLine:!0,glyphMarginClassName:this.props.isDark?"monacoBreakPointDark":"monacoBreakPoint"}})}),this.editor){const i=this.editor.getModel();i&&(this.decorations=i.deltaDecorations(this.decorations,n))}}initNewScript(n,s){var i;this.setState({name:n}),this.originalCode=s||"",(i=this.editor)==null||i.setValue(s||""),this.highlightText(this.lastSearch),this.showDecorators(),this.setEditorTypings(n)}scrollToLineIfNeeded(n){if(this.editor){const s=this.editor.getVisibleRanges();(!s||!s[0]||s[0].startLineNumber>n||n>s[0].endLineNumber)&&this.editor.revealLineInCenter(n)}}UNSAFE_componentWillReceiveProps(n){const s={};this.state.name!==n.name&&this.initNewScript(n.name,n.code),JSON.stringify(n.runningInstances)!==this.runningInstancesStr&&(this.runningInstancesStr=JSON.stringify(n.runningInstances),this.state.typingsLoaded||this.loadTypings(n.runningInstances)),this.editor&&!n.changed&&(n.code!==this.originalCode||n.code!==this.editor.getValue())&&(this.originalCode=n.code||"",this.editor.setValue(this.originalCode),this.showDecorators(),this.location&&this.scrollToLineIfNeeded(this.location.lineNumber+1)),n.searchText!==this.lastSearch&&(this.lastSearch=n.searchText||"",this.highlightText(this.lastSearch)),JSON.stringify(n.location)!==JSON.stringify(this.location)&&JSON.stringify(n.breakpoints)!==JSON.stringify(this.breakpoints)?(this.location=n.location||void 0,this.breakpoints=n.breakpoints,this.showDecorators(),this.editor&&this.location&&this.scrollToLineIfNeeded(this.location.lineNumber+1)):JSON.stringify(n.breakpoints)!==JSON.stringify(this.breakpoints)?(this.breakpoints=n.breakpoints,this.showDecorators()):JSON.stringify(n.location)!==JSON.stringify(this.location)&&(this.location=n.location||void 0,this.showDecorators(),this.editor&&this.location&&this.scrollToLineIfNeeded(this.location.lineNumber+1)),this.state.language!==(n.language||"javascript")?(this.setState({language:n.language||"javascript"}),s.language=n.language||"javascript"):this.state.readOnly!==(n.readOnly||!1)?(this.setState({readOnly:n.readOnly||!1}),s.readOnly=n.readOnly):this.state.isDark!==(n.isDark||!1)&&(this.setState({isDark:n.isDark||!1}),s.isDark=n.isDark),this.setEditorOptions(s),this.insert!==n.insert&&(this.insert=n.insert||"",this.insert&&(console.log(`Insert text: ${this.insert}`),setTimeout(i=>{this.insertTextIntoEditor(i),setTimeout(()=>this.props.onInserted&&this.props.onInserted(),100)},100,this.insert)))}onChange(){var n,s;!this.props.readOnly&&this.editor&&((s=(n=this.props).onChange)==null||s.call(n,this.editor.getValue()))}renderErrorDialog(){return this.state.showError?this.state.showError.full?f.jsxs(D.Dialog,{open:!0,maxWidth:"md",onClose:()=>this.setState({showError:null}),children:[f.jsx(D.DialogTitle,{children:this.state.showError.title||I.I18n.t("Error")}),f.jsx(D.DialogContent,{children:f.jsx("pre",{children:f.jsx("code",{children:this.state.showError.message})})}),f.jsx(D.DialogActions,{children:f.jsxs(D.Button,{variant:"contained",startIcon:f.jsx(Xl,{}),onClick:()=>this.setState({showError:null}),children:[I.I18n.t("Close")," "]})})]}):f.jsx(D.Snackbar,{open:!0,autoHideDuration:5e3,onClose:()=>this.setState({showError:null}),message:this.state.showError.title,action:f.jsxs(We.Fragment,{children:[f.jsx(D.Button,{color:"secondary",size:"small",onClick:()=>this.setState({showError:{...this.state.showError,full:!0}}),children:I.I18n.t("More")}),f.jsx(D.IconButton,{size:"small","aria-label":"close",color:"inherit",onClick:()=>this.setState({showError:null}),children:f.jsx(Xl,{fontSize:"small"})})]})}):null}render(){var n,s,i;return!((i=(s=(n=this.monaco)==null?void 0:n.languages)==null?void 0:s.typescript)!=null&&i.typescriptDefaults)||!this.props.runningInstances?(setTimeout(()=>{this.monaco=window.monaco,this.forceUpdate()},200),null):(this.props.triggerPrettier!==this.triggerPrettier&&(this.triggerPrettier=this.props.triggerPrettier,setTimeout(()=>this.doPrettier().catch(a=>console.error("Error formatting code:",a)),50)),f.jsxs("div",{ref:this.monacoDiv,style:{...this.props.style,width:"100%",height:"100%",overflow:"hidden",position:"relative"},children:[this.renderErrorDialog(),!this.state.check&&f.jsx(D.Fab,{size:"small",title:I.I18n.t("Check is not active, because javascript adapter is disabled"),style:{bottom:10,right:10,opacity:.5,position:"absolute",zIndex:1,background:"red",color:"white"},color:"secondary",children:f.jsx(GI,{})})]}))}}var Mw={exports:{}},bM=Mw.exports;(function(o,n){(function(s,i){o.exports=i()})(bM,function(){var s={},i,a,c,h,g,b,$,y,w,T,C,E,k,A,P,N,B,S,H,q,se,ee,K,Y,X,ce,W,te,ke,Z,ze,Ce,at,he,Ae,de,Se,xe,He,ne,Ke,Te,Je,rt,ht,nt,Wt,St,lt,ft,st,At,mn,Ue,Nt,wt,qt,ct,me,ge,ue,we,Ve,re,Fe,It,pt,En,mt,Cn,$n,zn,Jn,Gs,ns,Rn,Kt,Pn,cs,Ks,jn,Un,Rs,ii,Ir,ec,xr,Ka,tc,nc,Tu,Yo,z,U,R,j,F,pe,Ee,_e,ae,je,it,Ft,Yt,on,Lt,an,_n,Tt,In,ss,Js,Xo,Dr,ho,Ts,tn,qs,Oi,rs,Ms,po,Zo,Ri,go,fo,oi,Mi,ku,Ja,Qo,Nh,sc,Xf,ea,Lh,Eu,rc,Bh,Ph,Zf,ic,qa,Iu,Qf,jh,oc,em,tm,ta,nm,ac,Qt,Sn,sm,rm,im,om,am,lm,xu,Ni,Wn,lc,mo,Fh,Du,hr,zh,Uh,Wh,Hh,Vh,Au,Ys,Ya,Ns,cm,na,ai,Xa,cc,wn,Kr,uc,um,dc,Gh,Kh,Jh,Ou,Za,bo,dm,Qa,Ru,el,tl,Jr,qh,hc,sa,Yh,Mu,Xs,nl,ra,Xh,Zh,hm,pm,gm,sl,Qh,$o,rl,Nu,Lu,ep,li,il,Li,tp,np,ia,Ar,sp,fm,rp,mm,ip,bm,Or,ie,De,be,et,xt,rn,qn,kt,Bu,ol,us,pc,op,Bi,Pi,al,nn,gc,Pu,ll,$m,vm,ym,cl,ji,ul,dl,fc,ap,lp,mc,hl,oa,Fi,aa,ju,_m,bc,pl,vo,Fu,wm,zi,cp,ci,Xn,fs,up,Cm,yo,dp,zu,gl,Uu,la,fl,ca,$c,ua,Wu,Sm,Tm,hp,Hu,ml,_o,Vu,M,qr,ui,Zn,Ot,km,Em,Im,Ui,Gu,xm,Dm,Am,pp,Rr,gp,Ku,Om,Rm,Mm,di,ut,Zs,is,xn,hi,Mr,tt,Hn,pr,Nm,wo,Ju,qu,fp,mp,Yu,Xu,bp,vc,bl,$l,Lm,yc,Bm,pi,Zu,Co,gr,$p,vp,vl,Wi,Hi,Qu,yp,yl,_p,_c,os,ed,wp,Yr,So,_l,To,wc,Dn,td,ko,Cp,Pm,da,Sp,ha,nd,Tp,kp,pa,Ep,Ip,Cc,sd,jm,Fm,zm,xp,rd,Um,wl,Dp,Ap,id,Cl,Op,od,ad,Rp,ld,cd,ga,ud,dd,Mp,Sc,Ht,Np,Lp,fa,hd,Bp,Pp,Qs,Wm,Tc,pd,gd,jp,er,Vi,fd,Fp,Re;i=function(e,t,r,l){if(!(e instanceof Be)&&typeof e!="string"||`${e}`.trim()==="")throw Error('Invalid type "'+e+'". The type must be a non-empty string or a Blockly.registry.Type.');if(e=`${e}`.toLowerCase(),typeof t!="string"||t.trim()==="")throw Error('Invalid name "'+t+'". The name must be a non-empty string.');const p=t.toLowerCase();if(!r)throw Error("Can not register a null value");let v=Gi[e],O=kc[e];if(v||(v=Gi[e]=Object.create(null),O=kc[e]=Object.create(null)),a(e,r),!l&&v[p]&&v[p]!==r)throw Error('Name "'+p+'" with type "'+e+'" already registered.');v[p]=r,O[p]=t},a=function(e,t){switch(e){case String(Be.FIELD):if(typeof t.fromJson!="function")throw Error('Type "'+e+'" must have a fromJson function')}},c=function(e,t){e=`${e}`.toLowerCase(),t=t.toLowerCase();const r=Gi[e];r&&r[t]?(delete Gi[e][t],delete kc[e][t]):console.warn("Unable to unregister ["+t+"]["+e+"] from the registry.")},h=function(e,t,r){e=`${e}`.toLowerCase(),t=t.toLowerCase();const l=Gi[e];if(!l||!l[t]){if(t="Unable to find ["+t+"]["+e+"] in the registry.",r)throw Error(t+" You must require or register a "+e+" plugin.");return console.warn(t),null}return l[t]},g=function(e,t){return e=`${e}`.toLowerCase(),t=t.toLowerCase(),(e=Gi[e])?!!e[t]:!1},b=function(e,t,r){return h(e,t,r)},$=function(e,t,r){return h(e,t,r)},y=function(e,t,r){e=`${e}`.toLowerCase();var l=Gi[e];if(!l){if(l=`Unable to find [${e}] in the registry.`,r)throw Error(`${l} You must require or register a ${e} plugin.`);return console.warn(l),null}if(!t)return l;e=kc[e],r=Object.create(null);for(const p of Object.keys(l))r[e[p]]=l[p];return r},w=function(e,t,r){return t=t.plugins[String(e)]||Nr,typeof t=="function"?t:b(e,t,r)},T=function(e,t,r,l){e=e+" was deprecated in "+t+" and will be deleted in "+r+".",l&&(e+=`
Use `+l+" instead."),Wp.has(e)||(Wp.add(e),console.warn(e))},C=function(){return"blockly-"+(ty++).toString(36)},E=function(){return Vm.genUid()},k=function(e){return e.type===fe.BLOCK_CREATE},A=function(e){return e.type===fe.BLOCK_DELETE},P=function(e){return e.type===fe.BLOCK_CHANGE},N=function(e){return e.type===fe.BLOCK_FIELD_INTERMEDIATE_CHANGE},B=function(e){return e.type===fe.BLOCK_MOVE},S=function(e){return e.type===fe.CLICK},H=function(e){return e.type===fe.BUBBLE_OPEN},q=function(e){return e.type===fe.VIEWPORT_CHANGE},s.setRecordUndo$$module$build$src$core$events$utils=function(e){Ec=e},se=function(){return Ec},ee=function(e){Xr.fireInternal(e)},K=function(e){if(te()){if(!Vn.length)try{requestAnimationFrame(()=>{setTimeout(Y,0)})}catch{setTimeout(Y,0)}X(e)}},Y=function(){const e=ce(Vn,!0);Vn.length=0;for(const t of e){if(!t.workspaceId)continue;let r;(r=he(t.workspaceId))==null||r.fireChangeListener(t)}},X=function(e){if(P(e)&&e.element==="mutation"){let t;for(t=Vn.length;0<t;t--){const r=Vn[t-1];if(r.group!==e.group||r.workspaceId!==e.workspaceId||!B(r)||r.newParentId!==e.blockId)break}Vn.splice(t,0,e)}else Vn.push(e)},ce=function(e,t=!0){t||(T("filter(queue, /*forward=*/false)","v11.2","v12"),e=e.slice().reverse());const r=[];for(const l of e)if(e=r[r.length-1],!l.isNull())if(e&&e.workspaceId===l.workspaceId&&e.group===l.group)if(B(l)&&B(e)&&l.blockId===e.blockId){if(e.newParentId=l.newParentId,e.newInputName=l.newInputName,e.newCoordinate=l.newCoordinate,e.reason||l.reason){let p,v;e.reason=Array.from(new Set(((p=e.reason)!=null?p:[]).concat((v=l.reason)!=null?v:[])))}}else P(l)&&P(e)&&l.blockId===e.blockId&&l.element===e.element&&l.name===e.name?e.newValue=l.newValue:q(l)&&q(e)?(e.viewTop=l.viewTop,e.viewLeft=l.viewLeft,e.scale=l.scale,e.oldScale=l.oldScale):S(l)&&H(e)||r.push(l);else r.push(l);return e=r.filter(l=>!l.isNull()),t||e.reverse(),e},W=function(){for(let e=0,t;t=Vn[e];e++)t.recordUndo=!1},s.disable$$module$build$src$core$events$utils=function(){$d++},s.enable$$module$build$src$core$events$utils=function(){$d--},te=function(){return $d===0},s.getGroup$$module$build$src$core$events$utils=function(){return Hp},s.setGroup$$module$build$src$core$events$utils=function(e){Xr.setGroupInternal(e)},ke=function(e){Hp=typeof e=="boolean"?e?E():"":e},Z=function(e){const t=[];e=e.getDescendants(!1);for(let r=0,l;l=e[r];r++)t[r]=l.id;return t},ze=function(e,t){const r=Ce(e.type);if(!r)throw Error("Unknown event type.");return r.fromJson(e,t)},Ce=function(e){const t=b(Be.EVENT,e);if(!t)throw Error(`Event type ${e} not found in registry.`);return t},at=function(e){if((B(e)||k(e))&&e.workspaceId){var t=he(e.workspaceId);if(!e.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(e=t.getBlockById(e.blockId)){const r=Ec;try{Ec=!1;const l=e.getParent();if(l&&!l.hasDisabledReason(vd)){const p=e.getDescendants(!1);for(let v=0,O;O=p[v];v++)O.setDisabledReason(!1,vd)}else if((e.outputConnection||e.previousConnection)&&!t.isDragging())do e.setDisabledReason(!0,vd),e=e.getNextBlock();while(e)}finally{Ec=r}}}},he=function(e){return Ic[e]||null},Ae=function(){const e=[];for(const t in Ic)e.push(Ic[t]);return e},de=function(e){Ic[e.id]=e},Se=function(e){delete Ic[e.id]},xe=function(){return Gm},He=function(e){Gm=e},ne=function(){return gi},s.setSelected$$module$build$src$core$common=function(e){if(gi!==e){var t,r,l,p,v,O,G=new(Ce(fe.SELECTED))((l=(t=gi)==null?void 0:t.id)!=null?l:null,(p=e==null?void 0:e.id)!=null?p:null,(O=(v=e==null?void 0:e.workspace.id)!=null?v:(r=gi)==null?void 0:r.workspace.id)!=null?O:"");ee(G);var Ie;(Ie=gi)==null||Ie.unselect(),gi=e;var Qe;(Qe=gi)==null||Qe.select()}},Ke=function(){return ma},Te=function(e){ma=e},Je=function(e){for(;e.options.parentWorkspace;)e=e.options.parentWorkspace;const t=e.getParentSvg(),r=e.getCachedParentSvgSize();var l=t.parentElement;if(l instanceof HTMLElement){var p=l.offsetWidth;l=l.offsetHeight,r.width!==p&&(t.setAttribute("width",p+"px"),e.setCachedParentSvgSize(p,null)),r.height!==l&&(t.setAttribute("height",l+"px"),e.setCachedParentSvgSize(null,l)),e.resize()}},rt=function(e,t){const r=Object.create(null),l=e.getDescendants(!0);t&&(e=e.getNextBlock())&&(e=l.indexOf(e),l.splice(e,l.length-e));for(let p=0,v;v=l[p];p++)r[v.type]?r[v.type]++:r[v.type]=1;return r},ht=function(e){return function(){this.jsonInit(e)}},nt=function(e){Vp.defineBlocksWithJsonArrayInternal(e)},Wt=function(e){s.defineBlocks$$module$build$src$core$common(s.createBlockDefinitionsFromJsonArray$$module$build$src$core$common(e))},s.createBlockDefinitionsFromJsonArray$$module$build$src$core$common=function(e){const t={};for(let r=0;r<e.length;r++){const l=e[r];if(!l){console.warn(`Block definition #${r} in JSON array is ${l}. Skipping`);continue}const p=l.type;p?t[p]={init:ht(l)}:console.warn(`Block definition #${r} in JSON array is missing a type attribute. Skipping.`)}return t},s.defineBlocks$$module$build$src$core$common=function(e){for(const t of Object.keys(e)){const r=e[t];t in tr&&console.warn(`Block definition "${t}" overwrites previous definition.`),tr[t]=r}},St=function(e,t){lt(),ya=setTimeout(function(){t&&t.handleRightClick(e)},Km)},lt=function(){ya&&(clearTimeout(ya),ya=0)},ft=function(){va=null},st=function(e){return!e.type.startsWith("pointer")||e instanceof PointerEvent&&mn(e)},At=function(e){return`${e.pointerId}`},mn=function(e){const t=At(e);return va?va===t:e.type==="pointerdown"?(va=t,!0):!1},Ue=function(e,t,r,l,p){function v(G){(p||st(G))&&(r?l.call(r,G):l(G))}const O=[];if(t in Eo)for(let G=0;G<Eo[t].length;G++){const Ie=Eo[t][G];e.addEventListener(Ie,v,!1),O.push([e,Ie,v])}else e.addEventListener(t,v,!1),O.push([e,t,v]);return O},Nt=function(e,t,r,l){function p(O){r?l.call(r,O):l(O)}const v=[];if(t in Eo)for(let O=0;O<Eo[t].length;O++){const G=Eo[t][O];e.addEventListener(G,p,!1),v.push([e,G,p])}else e.addEventListener(t,p,!1),v.push([e,t,p]);return v},wt=function(e){const t=e[e.length-1][2];for(;e.length;){const[r,l,p]=e.pop();r.removeEventListener(l,p,!1)}return t},qt=function(e){if(e.target instanceof HTMLElement){if(e.target.isContentEditable||e.target.getAttribute("data-is-text-input")==="true")return!0;if(e.target instanceof HTMLInputElement)return e=e.target,e.type==="text"||e.type==="number"||e.type==="email"||e.type==="password"||e.type==="search"||e.type==="tel"||e.type==="url";if(e.target instanceof HTMLTextAreaElement)return!0}return!1},ct=function(e){return e.ctrlKey&&Ac?!0:e.button===2},me=function(e,t,r){const l=t.createSVGPoint();return l.x=e.clientX,l.y=e.clientY,r||(r=t.getScreenCTM().inverse()),l.matrixTransform(r)},ge=function(e){switch(e.deltaMode){default:return{x:e.deltaX,y:e.deltaY};case 1:return{x:e.deltaX*Oc,y:e.deltaY*Oc};case 2:return{x:e.deltaX*_a,y:e.deltaY*_a}}},ue=function(e,t){return t=e.indexOf(t),t===-1?!1:(e.splice(t,1),!0)},we=function(e){if(tg)throw Error("CSS already injected");Mc+=`
`+e},Ve=function(e,t){tg||(tg=!0,e&&(e=t.replace(/[\\/]$/,""),t=Mc.replace(/<<<PATH>>>/g,e),Mc="",e=document.createElement("style"),e.id="blockly-common-style",t=document.createTextNode(t),e.appendChild(t),document.head.insertBefore(e,document.head.firstChild)))},re=function(e,t,r){e=document.createElementNS(Nc,`${e}`);for(const l in t)e.setAttribute(l,`${t[l]}`);return r&&r.appendChild(e),e},Fe=function(e,t){return t=t.split(" "),t.every(r=>e.classList.contains(r))?!1:(e.classList.add(...t),!0)},It=function(e,t){e.classList.remove(...t.split(" "))},pt=function(e,t){return t=t.split(" "),t.every(r=>!e.classList.contains(r))?!1:(e.classList.remove(...t),!0)},En=function(e,t){return e.classList.contains(t)},mt=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},Cn=function(e,t){const r=t.nextSibling;if(t=t.parentNode,!t)throw Error("Reference node has no parent.");r?t.insertBefore(e,r):t.appendChild(e)},$n=function(e,t){e.style.transform=t,e.style["-webkit-transform"]=t},zn=function(){ng++,Lr||(Lr=Object.create(null))},Jn=function(){ng--,ng||(Lr=null)},Gs=function(e){const t=e.textContent+`
`+e.className.baseVal;let r;if(Lr&&(r=Lr[t]))return r;try{r=e.getComputedTextLength()}catch{return 8*e.textContent.length}return Lr&&(Lr[t]=r),r},ns=function(e,t,r,l){return Rn(e,t+"pt",r,l)},Rn=function(e,t,r,l){const p=e.textContent;e=p+`
`+e.className.baseVal;var v;return Lr&&(v=Lr[e])||(Cd||(v=document.createElement("canvas"),v.className="blocklyComputeCanvas",document.body.appendChild(v),Cd=v.getContext("2d")),Cd.font=r+" "+t+" "+l,v=p?Cd.measureText(p).width:0,Lr&&(Lr[e]=v)),v},Kt=function(e,t,r,l){const p=document.createElement("span");p.style.font=r+" "+t+" "+l,p.textContent=e,e=document.createElement("div"),e.style.width="1px",e.style.height="0",t=document.createElement("div"),t.style.display="flex",t.style.position="fixed",t.style.top="0",t.style.left="0",t.appendChild(p),t.appendChild(e),document.body.appendChild(t),r={height:0,baseline:0};try{t.style.alignItems="baseline",r.baseline=e.offsetTop-p.offsetTop,t.style.alignItems="flex-end",r.height=e.offsetTop-p.offsetTop}finally{document.body.removeChild(t)}return r},Pn=function(e){return Xm.getSizeInternal(e)},cs=function(e){if(jn(e,"display")!=="none")return Ks(e);const t=e.style,r=t.display,l=t.visibility,p=t.position;t.visibility="hidden",t.position="absolute",t.display="inline";const v=e.offsetWidth;return e=e.offsetHeight,t.display=r,t.position=p,t.visibility=l,new Jt(v,e)},Ks=function(e){return new Jt(e.offsetWidth,e.offsetHeight)},jn=function(e,t){return e=window.getComputedStyle(e),e[t]||e.getPropertyValue(t)},Un=function(e){const t=new Le(0,0);e=e.getBoundingClientRect();var r=document.documentElement;return r=new Le(window.pageXOffset||r.scrollLeft,window.pageYOffset||r.scrollTop),t.x=e.left+r.x,t.y=e.top+r.y,t},Rs=function(){const e=document.body,t=document.documentElement;return new Le(e.scrollLeft||t.scrollLeft,e.scrollTop||t.scrollTop)},ii=function(e){const t=parseFloat(jn(e,"borderLeftWidth")),r=parseFloat(jn(e,"borderRightWidth")),l=parseFloat(jn(e,"borderTopWidth"));return e=parseFloat(jn(e,"borderBottomWidth")),new Bt(l,e,t,r)},Ir=function(e,t,r){e=ec(e,t,r),t.scrollLeft=e.x,t.scrollTop=e.y},ec=function(e,t,r){var l=Un(e),p=Un(t),v=ii(t);const O=l.x-p.x-v.left;return l=l.y-p.y-v.top,p=Ks(e),e=t.clientWidth-p.width,p=t.clientHeight-p.height,v=t.scrollLeft,t=t.scrollTop,r?(v+=O-e/2,t+=l-p/2):(v+=Math.min(O,Math.max(O-e,0)),t+=Math.min(l,Math.max(l-p,0))),new Le(v,t)},xr=function(e){const t=new Le(0,0);var r=e.x&&e.getAttribute("x");const l=e.y&&e.getAttribute("y");return r&&(t.x=parseInt(r)),l&&(t.y=parseInt(l)),(r=(r=e.getAttribute("transform"))&&r.match(Zm))&&(t.x+=Number(r[1]),r[3]&&(t.y+=Number(r[3]))),(e=e.getAttribute("style"))&&e.includes("translate")&&(e=e.match(Qm))&&(t.x+=Number(e[1]),e[3]&&(t.y+=Number(e[3]))),t},Ka=function(e){let t=0,r=0;for(;e;){const l=xr(e);if(t+=l.x,r+=l.y,(" "+(e.getAttribute("class")||"")+" ").includes(" injectionDiv "))break;e=e.parentNode}return new Le(t,r)},tc=function(){const e=Rs();return new Bt(e.y,document.documentElement.clientHeight+e.y,e.x,document.documentElement.clientWidth+e.x)},nc=function(){const e=document.documentElement,t=window;return new Le(t.pageXOffset||e.scrollLeft,t.pageYOffset||e.scrollTop)},Tu=function(e,t){var r=t.x;t=t.y;const l=e.getInjectionDiv().getBoundingClientRect();return r=new Le(r-l.left,t-l.top),t=e.getOriginOffsetInPixels(),Le.difference(r,t).scale(1/e.scale)},Yo=function(e,t){var r=t.scale(e.scale);t=r.x,r=r.y;const l=e.getInjectionDiv().getBoundingClientRect();return e=e.getOriginOffsetInPixels(),new Le(t+l.left+e.x,r+l.top+e.y)},z=function(e){({document:Td=Td,DOMParser:Bc=Bc,XMLSerializer:El=El}=e),Sd=new Bc,sg=new El},s.createElement$$module$build$src$core$utils$xml=function(e){return Td.createElementNS(rg,e)},s.createTextNode$$module$build$src$core$utils$xml=function(e){return Td.createTextNode(e)},s.textToDom$$module$build$src$core$utils$xml=function(e){let t=Sd.parseFromString(e,"text/xml");if(t&&t.documentElement&&!t.getElementsByTagName("parsererror").length)return t.documentElement;if((t=Sd.parseFromString(e,"text/html"))&&t.body.firstChild&&t.body.firstChild.nodeName.toLowerCase()==="xml")return t.body.firstChild;throw Error(`DOMParser was unable to parse: ${e}`)},U=function(e){return R(sg.serializeToString(e))},R=function(e){return e.replace(ny,t=>`&#${t.charCodeAt(0)};`)},j=function(e){return e?((e instanceof Element||typeof e=="string")&&(e=Yt(e),e=je(e)),F(e),e):null},F=function(e){const t=e.kind;if(e=e.contents,t&&t!==Il&&t!==kd)throw Error("Invalid toolbox kind "+t+". Please supply either "+Il+" or "+kd);if(!e)throw Error("Toolbox must have a contents attribute.")},pe=function(e){return e?e.contents?e.contents:Array.isArray(e)&&0<e.length&&!e[0].nodeType?e:it(e):[]},Ee=function(e){return ig.hasCategoriesInternal(e)},_e=function(e){if(!e)return!1;const t=e.kind;return t?t===kd:!!e.contents.filter(r=>r.kind.toUpperCase()==="CATEGORY").length},ae=function(e){return e&&e.contents?!!e.contents.filter(function(t){return t.kind.toUpperCase()==="CATEGORY"}).length:!1},je=function(e){const t={contents:it(e)};return e instanceof Node&&Ft(e,t),t},it=function(e){const t=[];let r=e.childNodes;r||(r=e);for(let l=0,p;p=r[l];l++){if(!p.tagName)continue;e={};const v=p.tagName.toUpperCase();e.kind=v,v==="BLOCK"?e.blockxml=p:p.childNodes&&0<p.childNodes.length&&(e.contents=it(p)),Ft(p,e),t.push(e)}return t},Ft=function(e,t){for(let r=0;r<e.attributes.length;r++){const l=e.attributes[r];l.nodeName.includes("css-")?(t.cssconfig=t.cssconfig||{},t.cssconfig[l.nodeName.replace("css-","")]=l.value):t[l.nodeName]=l.value}},Yt=function(e){let t=null;if(e)if(typeof e=="string"){if(t=s.textToDom$$module$build$src$core$utils$xml(e),t.nodeName.toLowerCase()!=="xml")throw TypeError("Toolbox should be an <xml> document.")}else e instanceof Element&&(t=e);return t},on=function(e,t,r,l,p,v){const O=v.scrollbar&&v.scrollbar.canScrollVertically();return e.horizontal===wa.LEFT?(r=p.absoluteMetrics.left+r,O&&v.RTL&&(r+=Fn.scrollbarThickness)):(r=p.absoluteMetrics.left+p.viewMetrics.width-t.width-r,O&&!v.RTL&&(r-=Fn.scrollbarThickness)),e.vertical===Br.TOP?e=p.absoluteMetrics.top+l:(e=p.absoluteMetrics.top+p.viewMetrics.height-t.height-l,v.scrollbar&&v.scrollbar.canScrollHorizontally()&&(e-=Fn.scrollbarThickness)),new Bt(e,e+t.height,r,r+t.width)},Lt=function(e,t){return{horizontal:t.toolboxMetrics.position===Rt.LEFT||e.horizontalLayout&&!e.RTL?wa.RIGHT:wa.LEFT,vertical:t.toolboxMetrics.position===Rt.BOTTOM?Br.TOP:Br.BOTTOM}},an=function(e,t,r,l){const p=e.left,v=e.right-e.left,O=e.bottom-e.top;for(let G=0;G<l.length;G++){const Ie=l[G];e.intersects(Ie)&&(e=r===bs.UP?Ie.top-O-t:Ie.bottom+t,e=new Bt(e,e+O,p,p+v),G=-1)}return e},_n=function(e,t){i(Be.SERIALIZER,e,t)},Tt=function(e){c(Be.SERIALIZER,e)},In=function(e,{addCoordinates:t=!1,saveIds:r=!0}={}){const l=e.workspace,p=Object.create(null);return p.height=e.getSize().height,p.width=e.getSize().width,r&&(p.id=e.id),t&&(t=e.getRelativeToSurfaceXY(),p.x=l.RTL?l.getWidth()-t.x:t.x,p.y=t.y),e.getText()&&(p.text=e.getText()),e.isCollapsed()&&(p.collapsed=!0),e.isOwnEditable()||(p.editable=!1),e.isOwnMovable()||(p.movable=!1),e.isOwnDeletable()||(p.deletable=!1),p},ss=function(e,t,{recordUndo:r=!1}={}){const l=se();if(s.setRecordUndo$$module$build$src$core$events$utils(r),r=t.newComment(e.id),e.text!==void 0&&r.setText(e.text),e.x!==void 0||e.y!==void 0){const v=r.getRelativeToSurfaceXY();let O,G=(O=e.x)!=null?O:v.x;G=t.RTL?t.getWidth()-G:G;var p;t=(p=e.y)!=null?p:v.y,r.moveTo(new Le(G,t))}if(e.width!==void 0||e.height){p=r.getSize();let v,O;r.setSize(new Jt((v=e.width)!=null?v:p.width,(O=e.height)!=null?O:p.height))}return e.collapsed!==void 0&&r.setCollapsed(e.collapsed),e.editable!==void 0&&r.setEditable(e.editable),e.movable!==void 0&&r.setMovable(e.movable),e.deletable!==void 0&&r.setDeletable(e.deletable),s.setRecordUndo$$module$build$src$core$events$utils(l),r},Js=function(e,t){i(Be.PASTER,e,t)},Xo=function(e){c(Be.PASTER,e)},Dr=function(e){const t=e.workspace,r=e.getRelativeToSurfaceXY(),l=new Le(0,0),p=t.getTopComments(!1).filter(v=>v.id!==e.id).map(v=>v.getRelativeToSurfaceXY());for(;ho(Le.sum(r,l),p);)l.translate(t.RTL?-30:30,30);e.moveTo(Le.sum(r,l))},ho=function(e,t){return t.some(r=>1>=Math.abs(r.x-e.x)&&1>=Math.abs(r.y-e.y))},Ts=function(e,t){e.setAttribute(ob,t)},tn=function(e,t,r){Array.isArray(r)&&(r=r.join(" ")),e.setAttribute(ib+t,`${r}`)},qs=function(e){return e.saveState!==void 0&&e.loadState!==void 0},Oi=function(e){return Zo(e),po()?(Ri(),Promise.resolve()):(xl||(xl=new Promise(t=>{hg=t,ab=window.requestAnimationFrame(()=>{Ri(),t()})})),xl)},rs=function(){return xl||Promise.resolve()},Ms=function(e){e||window.cancelAnimationFrame(ab),Ri(e),!e&&hg&&hg()},po=function(){return Ym},Zo=function(e){dg.add(e),sr.set(e,s.getGroup$$module$build$src$core$events$utils());const t=e.getParent();t?Zo(t):Ad.add(e)},Ri=function(e){const t=e?new Set([e]):new Set([...Ad].map(v=>v.workspace)),r=[...Ad].filter(fo).filter(v=>t.has(v.workspace));for(var l of r)oi(l);for(const v of t)v.resizeContents();for(var p of r)l=p.getRelativeToSurfaceXY(),p.updateComponentLocations(l);for(const v of r)p=s.getGroup$$module$build$src$core$events$utils(),(l=sr.get(v))&&s.setGroup$$module$build$src$core$events$utils(l),v.bumpNeighbours(),s.setGroup$$module$build$src$core$events$utils(p);for(const v of r)go(v);e||(xl=null)},go=function(e){Ad.delete(e),dg.delete(e),sr.delete(e);for(const t of e.getChildren(!1))go(t)},fo=function(e){return!e.isDisposed()&&!e.getParent()},oi=function(e){if(dg.has(e)&&e.initialized){for(const t of e.getChildren(!1))oi(t);e.renderEfficiently()}},Mi=function(e,t){lb(e,t)},ku=function(e){lb=e},Ja=function(e,t){db.confirmInternal(e,t)},Qo=function(e,t){cb(e,t)},Nh=function(e){cb=e},sc=function(e,t,r){ub(e,t,r)},Xf=function(e){ub=e},ea=function(e){return e.getProcedureDef!==void 0},Lh=function(e){return e.getProcedureCall!==void 0&&e.renameProcedure!==void 0},Eu=function(e){return e.getVariableModel!==void 0},s.allUsedVarModels$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);const t=new Set;for(let r=0;r<e.length;r++){const l=e[r].getVarModels();if(l)for(let p=0;p<l.length;p++){const v=l[p];v.getId()&&t.add(v)}}return Array.from(t.values())},s.allDeveloperVariables$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);const t=new Set;for(let l=0,p;p=e[l];l++){var r=p.getDeveloperVariables;if(r){r=r();for(let v=0;v<r.length;v++)t.add(r[v])}}return Array.from(t.values())},rc=function(e){let t=[];const r=document.createElement("button");return r.setAttribute("text","%{BKY_NEW_VARIABLE}"),r.setAttribute("callbackKey","CREATE_VARIABLE"),e.registerButtonCallback("CREATE_VARIABLE",function(l){qa(l.getTargetWorkspace())}),t.push(r),e=Bh(e),t=t.concat(e)},Bh=function(e){e=e.getVariablesOfType("");const t=[];if(0<e.length){var r=e[e.length-1];if(tr.variables_set){var l=s.createElement$$module$build$src$core$utils$xml("block");l.setAttribute("type","variables_set"),l.setAttribute("gap",tr.math_change?"8":"24"),l.appendChild(ta(r)),t.push(l)}if(tr.math_change&&(l=s.createElement$$module$build$src$core$utils$xml("block"),l.setAttribute("type","math_change"),l.setAttribute("gap",tr.variables_get?"20":"8"),l.appendChild(ta(r)),r=s.textToDom$$module$build$src$core$utils$xml('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),l.appendChild(r),t.push(l)),tr.variables_get){e.sort(Uc.compareByName);for(let p=0,v;v=e[p];p++)r=s.createElement$$module$build$src$core$utils$xml("block"),r.setAttribute("type","variables_get"),r.setAttribute("gap","8"),r.appendChild(ta(v)),t.push(r)}}return t},Ph=function(e){return pb.generateUniqueNameInternal(e)},Zf=function(e){return ic(mg.charAt(0),e.getAllVariableNames())},ic=function(e,t){if(!t.length)return e;const r=mg;let l="",p=r.indexOf(e);for(;;){let v=!1;for(let O=0;O<t.length;O++)if(t[O].toLowerCase()===e){v=!0;break}if(!v)break;p++,p===r.length&&(p=0,l=`${Number(l)+1}`),e=r.charAt(p)+l}return e},qa=function(e,t,r){function l(v){Iu(s.Msg$$module$build$src$core$msg.NEW_VARIABLE_TITLE,v,function(O){if(O){var G=jh(O,e);if(G){if(G.type===p)var Ie=s.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS.replace("%1",G.name);else Ie=s.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE,Ie=Ie.replace("%1",G.name).replace("%2",G.type);Mi(Ie,function(){l(O)})}else e.createVariable(O,p),t&&t(O)}else t&&t(null)})}const p=r||"";l("")},s.renameVariable$$module$build$src$core$variables=function(e,t,r){function l(p){const v=s.Msg$$module$build$src$core$msg.RENAME_VARIABLE_TITLE.replace("%1",t.name);Iu(v,p,function(O){if(O){var G=Qf(O,t.type,e),Ie=oc(t.name,O,e);if(G||Ie){var Qe="";G?Qe=s.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",G.name).replace("%2",G.type):Ie&&(Qe=s.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER.replace("%1",O).replace("%2",Ie)),Mi(Qe,function(){l(O)})}else e.renameVariableById(t.getId(),O),r&&r(O)}else r&&r(null)})}l("")},Iu=function(e,t,r){sc(e,t,function(l){l&&(l=l.replace(/[\s\xa0]+/g," ").trim(),l===s.Msg$$module$build$src$core$msg.RENAME_VARIABLE||l===s.Msg$$module$build$src$core$msg.NEW_VARIABLE)&&(l=null),r(l)})},Qf=function(e,t,r){r=r.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let l=0,p;p=r[l];l++)if(p.name.toLowerCase()===e&&p.type!==t)return p;return null},jh=function(e,t){t=t.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let r=0,l;l=t[r];r++)if(l.name.toLowerCase()===e)return l;return null},oc=function(e,t,r){return r.getProcedureMap().getProcedures().length?em(e,t,r):tm(e,t,r)},em=function(e,t,r){e=e.toLowerCase(),t=t.toLowerCase(),r=r.getProcedureMap().getProcedures();for(const p of r){var l=p.getParameters().filter(Eu).map(v=>v.getVariableModel().name);if(l&&(r=l.some(v=>v.toLowerCase()===e),l=l.some(v=>v.toLowerCase()===t),r&&l))return p.getName()}return null},tm=function(e,t,r){e=e.toLowerCase(),t=t.toLowerCase(),r=r.getAllBlocks(!1);for(const p of r){if(!ea(p))continue;r=p.getProcedureDef();var l=r[1];const v=l.some(O=>O.toLowerCase()===e);if(l=l.some(O=>O.toLowerCase()===t),v&&l)return r[0]}return null},ta=function(e){const t=s.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name","VAR"),t.setAttribute("id",e.getId()),t.setAttribute("variabletype",e.type),e=s.createTextNode$$module$build$src$core$utils$xml(e.name),t.appendChild(e),t},s.getOrCreateVariablePackage$$module$build$src$core$variables=function(e,t,r,l){let p=s.getVariable$$module$build$src$core$variables(e,t,r,l);return p||(p=nm(e,t,r,l)),p},s.getVariable$$module$build$src$core$variables=function(e,t,r,l){const p=e.getPotentialVariableMap();let v=null;if(t&&(v=e.getVariableById(t),!v&&p&&(v=p.getVariableById(t)),v))return v;if(r){if(l===void 0)throw Error("Tried to look up a variable by name without a type");v=e.getVariable(r,l),!v&&p&&(v=p.getVariable(r,l))}return v},nm=function(e,t,r,l){const p=e.getPotentialVariableMap();return r||(r=Ph(e.isFlyout?e.targetWorkspace:e)),p?p.createVariable(r,l,t):e.createVariable(r,l,t)},ac=function(e,t){e=e.getAllVariables();const r=[];if(t.length!==e.length)for(let l=0;l<e.length;l++){const p=e[l];t.includes(p)||r.push(p)}return r},Qt=function(e,{addCoordinates:t=!1,addInputBlocks:r=!0,addNextBlocks:l=!0,doFullSerialization:p=!0,saveIds:v=!0}={}){if(e.isInsertionMarker())return null;const O={type:e.type,id:v?e.id:void 0};return t&&sm(e,O),Sn(e,O),rm(e,O,p),im(e,O,p),om(e,O,p),r&&am(e,O,p,v),l&&lm(e,O,p,v),O},Sn=function(e,t){e.isCollapsed()&&(t.collapsed=!0),e.isEnabled()||(t.disabledReasons=Array.from(e.getDisabledReasons())),e.isOwnDeletable()||(t.deletable=!1),e.isOwnMovable()||(t.movable=!1),e.isOwnEditable()||(t.editable=!1),e.inputsInline!==void 0&&e.inputsInline!==e.inputsInlineDefault&&(t.inline=e.inputsInline),e.data&&(t.data=e.data)},sm=function(e,t){const r=e.workspace;e=e.getRelativeToSurfaceXY(),t.x=Math.round(r.RTL?r.getWidth()-e.x:e.x),t.y=Math.round(e.y)},rm=function(e,t,r){e.saveExtraState?(e=e.saveExtraState(r),e!==null&&(t.extraState=e)):e.mutationToDom&&(e=e.mutationToDom(),e!==null&&(t.extraState=ci(e).replace(' xmlns="https://developers.google.com/blockly/xml"',"")))},im=function(e,t,r){const l=Object.create(null);for(const p of e.getIcons())qs(p)&&(e=p.saveState(r))&&(l[p.getType().toString()]=e);Object.keys(l).length&&(t.icons=l)},om=function(e,t,r){const l=Object.create(null);for(let p=0;p<e.inputList.length;p++){const v=e.inputList[p];for(let O=0;O<v.fieldRow.length;O++){const G=v.fieldRow[O];G.isSerializable()&&(l[G.name]=G.saveState(r))}}Object.keys(l).length&&(t.fields=l)},am=function(e,t,r,l){const p=Object.create(null);for(let v=0;v<e.inputList.length;v++){const O=e.inputList[v];if(!O.connection)continue;const G=xu(O.connection,r,l);G&&(p[O.name]=G)}Object.keys(p).length&&(t.inputs=p)},lm=function(e,t,r,l){e.nextConnection&&(e=xu(e.nextConnection,r,l))&&(t.next=e)},xu=function(e,t,r){const l=e.getShadowState(!0);if(e=e.targetBlock(),!l&&!e)return null;const p=Object.create(null);return l&&(p.shadow=l),e&&!e.isShadow()&&(p.block=Qt(e,{doFullSerialization:t,saveIds:r})),p},Ni=function(e,t,{recordUndo:r=!1}={}){return e=Wn(e,t,{recordUndo:r}),t.rendered&&Ms(),e},Wn=function(e,t,{parentConnection:r,isShadow:l=!1,recordUndo:p=!1}={}){const v=se();s.setRecordUndo$$module$build$src$core$events$utils(p),(p=s.getGroup$$module$build$src$core$events$utils())||s.setGroup$$module$build$src$core$events$utils(!0),s.disable$$module$build$src$core$events$utils();const O=t.getAllVariables();let G;try{G=lc(e,t,{parentConnection:r,isShadow:l})}finally{s.enable$$module$build$src$core$events$utils()}if(mo(t,O),te()&&ee(new(Ce(fe.BLOCK_CREATE))(G)),s.setGroup$$module$build$src$core$events$utils(p),s.setRecordUndo$$module$build$src$core$events$utils(v),t.rendered){const Ie=G;setTimeout(()=>{Ie.disposed||Ie.setConnectionTracking(!0)},1)}return G},lc=function(e,t,{parentConnection:r,isShadow:l=!1}={}){if(!e.type)throw new gb(e);const p=t.newBlock(e.type,e.id);return p.setShadow(l),Fh(p,e),Du(p,e),hr(p,e),zh(r,p,e),Uh(p,e),Wh(p,e),Hh(p,e),Vh(p,e),Ys(p,t.rendered),p},mo=function(e,t){if(te())for(e=ac(e,t),t=0;t<e.length;t++){const r=e[t];ee(new(Ce(fe.VAR_CREATE))(r))}},Fh=function(e,t){let r=t.x===void 0?0:t.x;t=t.y===void 0?0:t.y;const l=e.workspace;r=l.RTL?l.getWidth()-r:r,e.moveBy(r,t)},Du=function(e,t){if(t.collapsed&&e.setCollapsed(!0),t.deletable===!1&&e.setDeletable(!1),t.movable===!1&&e.setMovable(!1),t.editable===!1&&e.setEditable(!1),t.enabled===!1&&e.setDisabledReason(!0,Bs),Array.isArray(t.disabledReasons))for(const r of t.disabledReasons)e.setDisabledReason(!0,r);t.inline!==void 0&&e.setInputsInline(t.inline),t.data!==void 0&&(e.data=t.data)},hr=function(e,t){t.extraState&&(e.loadExtraState?e.loadExtraState(t.extraState):e.domToMutation&&e.domToMutation(s.textToDom$$module$build$src$core$utils$xml(t.extraState)))},zh=function(e,t,r){if(e){if(e.getSourceBlock().isShadow()&&!t.isShadow())throw new mb(r);if(e.type===s.inputTypes$$module$build$src$core$inputs$input_types.VALUE){var l=t.outputConnection;if(!l)throw new Wc("output",t,r)}else if(l=t.previousConnection,!l)throw new Wc("previous",t,r);if(!e.connect(l)){const p=t.workspace.connectionChecker;throw new fb(p.getErrorMessage(p.canConnectWithReason(l,e,!1),l,e),e.type===s.inputTypes$$module$build$src$core$inputs$input_types.VALUE?"output connection":"previous connection",t,r)}}},Uh=function(e,t){if(t.icons){var r=Object.keys(t.icons);for(const p of r){r=t.icons[p];var l=e.getIcon(p);if(!l){if(l=b(Be.ICON,p,!1),!l)throw new bb(p,e,t);l=new l(e),e.addIcon(l)}qs(l)&&l.loadState(r)}}},Wh=function(e,t){if(t.fields){var r=Object.keys(t.fields);for(let l=0;l<r.length;l++){const p=r[l],v=t.fields[p],O=e.getField(p);O?O.loadState(v):console.warn(`Ignoring non-existant field ${p} in block ${e.type}`)}}},Hh=function(e,t){if(t.inputs){var r=Object.keys(t.inputs);for(let l=0;l<r.length;l++){const p=r[l],v=e.getInput(p);if(!v||!v.connection)throw new Wc(p,e,t);Au(v.connection,t.inputs[p])}}},Vh=function(e,t){if(t.next){if(!e.nextConnection)throw new Wc("next",e,t);Au(e.nextConnection,t.next)}},Au=function(e,t){t.shadow&&e.setShadowState(t.shadow),t.block&&lc(t.block,e.getSourceBlock().workspace,{parentConnection:e})},Ys=function(e,t){if(t){e.setConnectionTracking(!1),e.initSvg(),e.queueRender();for(const r of e.getIcons())r.onLocationChange(e.getRelativeToSurfaceXY())}else e.initModel()},Ya=function(e){return e.bubbleIsVisible!==void 0&&e.setBubbleVisible!==void 0},Ns=function(e){return e*Math.PI/180},cm=function(e){return 180*e/Math.PI},na=function(e,t,r){if(r<e){const l=r;r=e,e=l}return Math.max(e,Math.min(t,r))},ai=function(){document.querySelector(".blocklyDropDownDiv")||(ln=document.createElement("div"),ln.className="blocklyDropDownDiv",(Ke()||document.body).appendChild(ln),Zi=document.createElement("div"),Zi.className="blocklyDropDownContent",ln.appendChild(Zi),Ea=document.createElement("div"),Ea.className="blocklyDropDownArrow",ln.appendChild(Ea),ln.style.opacity="0",ln.style.transition="transform "+Rd+"s, opacity "+Rd+"s",ln.addEventListener("focusin",function(){Fe(ln,"blocklyFocused")}),ln.addEventListener("focusout",function(){pt(ln,"blocklyFocused")}))},Xa=function(e){vg=e},cc=function(){return Do},wn=function(){return Zi},Kr=function(){Zi.textContent="",Zi.style.width=""},uc=function(e,t){ln.style.backgroundColor=e,ln.style.borderColor=t},um=function(e,t,r,l){return Jh(Gh(t),e,r,l)},dc=function(e,t,r){return _b=!0,Jh(Kh(e),e,t,r)},Gh=function(e){var t=e.getSvgRoot();const r=e.workspace.scale,l=e.height*r;return e=e.width*r,t=Un(t),new Bt(t.y,t.y+l,t.x,t.x+e)},Kh=function(e){return e=e.getScaledBBox(),new Bt(e.top,e.bottom,e.left,e.right)},Jh=function(e,t,r,l){const p=e.left+(e.right-e.left)/2,v=e.bottom;e=e.top,l&&(e+=l),l=t.getSourceBlock();let O=l.workspace;for(;O.options.parentWorkspace;)O=O.options.parentWorkspace;return Xa(O.getParentSvg().parentNode),Ou(t,l.RTL,p,v,p,e,r)},Ou=function(e,t,r,l,p,v,O){return Do=e,Ta=O||null,ln.style.direction=t?"rtl":"ltr",e=xe(),Al=e.getRenderer().getClassName(),ka=e.getTheme().getClassName(),Al&&Fe(ln,Al),ka&&Fe(ln,ka),qh(r,l,p,v)},Za=function(e,t,r,l){return e=Qa(e,r.left,r.right,l.width),{initialX:e.divX,initialY:t,finalX:e.divX,finalY:t+bg,arrowX:e.arrowX,arrowY:-9,arrowAtTop:!0,arrowVisible:!0}},bo=function(e,t,r,l){return e=Qa(e,r.left,r.right,l.width),{initialX:e.divX,initialY:t-l.height,finalX:e.divX,finalY:t-l.height-bg,arrowX:e.arrowX,arrowY:l.height-2*vb-Od/2,arrowAtTop:!1,arrowVisible:!0}},dm=function(e,t,r){return e=Qa(e,t.left,t.right,r.width),{initialX:e.divX,initialY:0,finalX:e.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},Qa=function(e,t,r,l){return t=na(t,e-l/2,r-l),e=e-Od/2-t,r=yb,e=na(r,e,l-r-Od),{arrowX:e,divX:t}},Ru=function(){return!!Do},el=function(e,t){return Do===e?(t?Jr():tl(),!0):!1},tl=function(){ln.style.transform="translate(0, 0)",ln.style.opacity="0",$g=setTimeout(function(){Jr()},1e3*Rd),Ta&&(Ta(),Ta=null)},Jr=function(){Ru()&&($g&&clearTimeout($g),ln.style.transform="",ln.style.left="",ln.style.top="",ln.style.opacity="0",ln.style.display="none",ln.style.backgroundColor="",ln.style.borderColor="",Ta&&(Ta(),Ta=null),Kr(),Do=null,Al&&(pt(ln,Al),Al=""),ka&&(pt(ln,ka),ka=""),xe().markFocused())},qh=function(e,t,r,l){e=yg.getPositionMetrics(e,t,r,l),e.arrowVisible?(Ea.style.display="",Ea.style.transform="translate("+e.arrowX+"px,"+e.arrowY+"px) rotate(45deg)",Ea.setAttribute("class",e.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):Ea.style.display="none",t=Math.floor(e.initialX),r=Math.floor(e.initialY),l=Math.floor(e.finalX);const p=Math.floor(e.finalY);return ln.style.left=t+"px",ln.style.top=r+"px",ln.style.display="block",ln.style.opacity="1",ln.style.transform="translate("+(l-t)+"px,"+(p-r)+"px)",!!e.arrowAtTop},hc=function(){if(Do){var e=Do.getSourceBlock();e=_b?Kh(Do):Gh(e);const t=e.left+(e.right-e.left)/2;qh(t,e.bottom,t,e.top)}else tl()},sa=function(e){return e.length?e.reduce(function(t,r){return t.length<r.length?t:r}).length:0},Yh=function(e,t){if(!e.length)return 0;if(e.length===1)return e[0].length;let r=0;t=t||sa(e);let l;for(l=0;l<t;l++){for(var p=e[0][l],v=1;v<e.length;v++)if(p!==e[v][l])return r;p===" "&&(r=l+1)}for(p=1;p<e.length;p++)if((v=e[p][l])&&v!==" ")return r;return t},Mu=function(e,t){if(!e.length)return 0;if(e.length===1)return e[0].length;let r=0;t=t||sa(e);let l;for(l=0;l<t;l++){for(var p=e[0].substr(-l-1,1),v=1;v<e.length;v++)if(p!==e[v].substr(-l-1,1))return r;p===" "&&(r=l+1)}for(p=1;p<e.length;p++)if((v=e[p].charAt(e[p].length-l-1))&&v!==" ")return r;return t},s.wrap$$module$build$src$core$utils$string=function(e,t){e=e.split(`
`);for(let r=0;r<e.length;r++)e[r]=Xs(e[r],t);return e.join(`
`)},Xs=function(e,t){if(e.length<=t)return e;const r=e.trim().split(/\s+/);for(var l=0;l<r.length;l++)r[l].length>t&&(t=r[l].length);var p=-1/0;let v,O=1;do{l=p,v=e,e=[],p=r.length/O;let G=1;for(let Ie=0;Ie<r.length-1;Ie++)G<(Ie+1.5)/p?(G++,e[Ie]=!0):e[Ie]=!1;e=ra(r,e,t),p=nl(r,e,t),e=Xh(r,e),O++}while(p>l);return v},nl=function(e,t,r){const l=[0],p=[];for(var v=0;v<e.length;v++)l[l.length-1]+=e[v].length,t[v]===!0?(l.push(0),p.push(e[v].charAt(e[v].length-1))):t[v]===!1&&l[l.length-1]++;for(e=Math.max(...l),t=0,v=0;v<l.length;v++)t-=2*Math.pow(Math.abs(r-l[v]),1.5),t-=Math.pow(e-l[v],1.5),".?!".includes(p[v])?t+=r/3:",;)]}".includes(p[v])&&(t+=r/4);return 1<l.length&&l[l.length-1]<=l[l.length-2]&&(t+=.5),t},ra=function(e,t,r){let l=nl(e,t,r),p;for(let v=0;v<t.length-1;v++){if(t[v]===t[v+1])continue;const O=[].concat(t);O[v]=!O[v],O[v+1]=!O[v+1];const G=nl(e,O,r);G>l&&(l=G,p=O)}return p?ra(e,p,r):t},Xh=function(e,t){const r=[];for(let l=0;l<e.length;l++)r.push(e[l]),t[l]!==void 0&&r.push(t[l]?`
`:" ");return r.join("")},s.isNumber$$module$build$src$core$utils$string=function(e){return/^\s*-?\d+(\.\d+)?\s*$/.test(e)},Zh=function(e){Md=e},hm=function(){return Md},pm=function(){return Kc},gm=function(){return es},sl=function(e){if(e=Qh(e)){for(e=e.tooltip;typeof e=="function";)e=e();if(typeof e!="string")throw Error("Tooltip function must return a string.");return e}return""},Qh=function(e){for(;e&&e.tooltip;){if(typeof e.tooltip=="string"||typeof e.tooltip=="function")return e;e=e.tooltip}return null},$o=function(){document.querySelector(".blocklyTooltipDiv")||(es=document.createElement("div"),es.className="blocklyTooltipDiv",(Ke()||document.body).appendChild(es))},rl=function(e){e.mouseOverWrapper_=Nt(e,"pointerover",null,Lu),e.mouseOutWrapper_=Nt(e,"pointerout",null,ep),e.addEventListener("pointermove",li,!1)},Nu=function(e){e&&(wt(e.mouseOverWrapper_),wt(e.mouseOutWrapper_),e.removeEventListener("pointermove",li))},Lu=function(e){Rl||(e=Qh(e.currentTarget),mr!==e&&(Li(),Ml=null,mr=e),clearTimeout(Cb))},ep=function(e){Rl||(Cb=setTimeout(function(){Ml=mr=null,Li()},1),clearTimeout(Ia),Ia=0)},li=function(e){if(mr&&mr.tooltip&&!Rl)if(Kc){const t=_g-e.pageX;e=wg-e.pageY,Math.sqrt(t*t+e*e)>Sb&&Li()}else Ml!==mr&&(clearTimeout(Ia),_g=e.pageX,wg=e.pageY,Ia=setTimeout(fm,Tb))},il=function(){Ml=mr=null,Li()},Li=function(){Kc&&(Kc=!1,es&&(es.style.display="none")),Ia&&(clearTimeout(Ia),Ia=0)},tp=function(){Li(),Rl=!0},np=function(){Rl=!1},ia=function(){es&&mr&&(typeof Md=="function"?Md(es,mr):Ar())},Ar=function(){var e=sl(mr);e=s.wrap$$module$build$src$core$utils$string(e,wb),e=e.split(`
`);for(let t=0;t<e.length;t++){const r=document.createElement("div");r.appendChild(document.createTextNode(e[t])),es.appendChild(r)}},sp=function(e){const t=document.documentElement.clientWidth,r=document.documentElement.clientHeight;let l=_g;l=e?l-(Cg+es.offsetWidth):l+Cg;let p=wg+Sg;return p+es.offsetHeight>r+window.scrollY&&(p-=es.offsetHeight+2*Sg),e?l=Math.max(xa-window.scrollX,l):l+es.offsetWidth>t+window.scrollX-2*xa&&(l=t-es.offsetWidth-2*xa),{x:l,y:p}},fm=function(){if(!Rl&&(Ml=mr,es)){es.textContent="",ia();var e=mr.RTL;es.style.direction=e?"rtl":"ltr",es.style.display="block",Kc=!0;var{x:t,y:r}=sp(e);es.style.left=t+"px",es.style.top=r+"px"}},rp=function(){return Tg},mm=function(e){Tg=e},ip=function(){return kg},bm=function(e){kg=e},Or=function(e){e=`${e}`.toLowerCase().trim();var t=kb[e];if(t||(t=e.substring(0,2)==="0x"?"#"+e.substring(2):e,t=t[0]==="#"?t:"#"+t,/^#[0-9a-f]{6}$/.test(t)))return t;if(/^#[0-9a-f]{3}$/.test(t))return["#",t[1],t[1],t[2],t[2],t[3],t[3]].join("");var r=e.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return r&&(e=Number(r[1]),t=Number(r[2]),r=Number(r[3]),0<=e&&256>e&&0<=t&&256>t&&0<=r&&256>r)?ie(e,t,r):null},ie=function(e,t,r){return t=e<<16|t<<8|r,16>e?"#"+(16777216|t).toString(16).substr(1):"#"+t.toString(16)},De=function(e){return e=Or(e),e?(e=parseInt(e.substr(1),16),[e>>16,e>>8&255,e&255]):[0,0,0]},be=function(e,t,r){let l=0,p=0,v=0;if(t===0)v=p=l=r;else{const O=Math.floor(e/60),G=e/60-O;e=r*(1-t);const Ie=r*(1-t*G);switch(t=r*(1-t*(1-G)),O){case 1:l=Ie,p=r,v=e;break;case 2:l=e,p=r,v=t;break;case 3:l=e,p=Ie,v=r;break;case 4:l=t,p=e,v=r;break;case 5:l=r,p=e,v=Ie;break;case 6:case 0:l=r,p=t,v=e}}return ie(Math.floor(l),Math.floor(p),Math.floor(v))},et=function(e,t,r){return e=Or(e),!e||(t=Or(t),!t)?null:(e=De(e),t=De(t),ie(Math.round(t[0]+r*(e[0]-t[0])),Math.round(t[1]+r*(e[1]-t[1])),Math.round(t[2]+r*(e[2]-t[2]))))},xt=function(e){return be(e,Tg,255*kg)},rn=function(e,t,r){const l=[];var p=e.split("");p.push("");var v=0;e=[];let O=null;for(let Qe=0;Qe<p.length;Qe++){var G=p[Qe];if(v===0)if(G==="%")(v=e.join(""))&&l.push(v),e.length=0,v=1;else if(r&&G===`
`){const Mn=e.join("");Mn&&l.push(Mn),e.length=0,l.push(G)}else e.push(G);else if(v===1)G==="%"?(e.push(G),v=0):t&&"0"<=G&&"9">=G?(v=2,O=G,(G=e.join(""))&&l.push(G),e.length=0):G==="{"?v=3:(e.push("%",G),v=0);else if(v===2)if("0"<=G&&"9">=G)O+=G;else{var Ie=void 0;l.push(parseInt((Ie=O)!=null?Ie:"",10)),Qe--,v=0}else v===3&&(G===""?(e.splice(0,0,"%{"),Qe--,v=0):G!=="}"?e.push(G):(v=e.join(""),/[A-Z]\w*/i.test(v)?(G=v.toUpperCase(),(G=G.startsWith("BKY_")?G.substring(4):null)&&G in s.Msg$$module$build$src$core$msg?(v=s.Msg$$module$build$src$core$msg[G],typeof v=="string"?Array.prototype.push.apply(l,rn(v,t,r)):t?l.push(`${v}`):l.push(v)):l.push("%{"+v+"}")):l.push("%{"+v+"}"),v=e.length=0))}for((t=e.join(""))&&l.push(t),Ie=[],e.length=0,p=0;p<l.length;p++)typeof l[p]!="string"||r&&l[p]===`
`?((t=e.join(""))&&Ie.push(t),e.length=0,Ie.push(l[p])):e.push(l[p]);return(t=e.join(""))&&Ie.push(t),e.length=0,Ie},qn=function(e){return rn(e,!0,!0)},kt=function(e){return typeof e!="string"?e:(e=rn(e,!1,!1),e.length?String(e[0]):"")},Bu=function(e){let t=!0;const r=s.Msg$$module$build$src$core$msg,l=e.match(/%{BKY_[A-Z]\w*}/gi);if(l)for(let p=0;p<l.length;p++){const v=l[p].toUpperCase();r[v.slice(6,-1)]===void 0&&(console.warn("No message string for "+l[p]+" in "+e),t=!1)}return t},ol=function(e){const t=typeof e=="string"?kt(e):e;var r=Number(t);if(!isNaN(r)&&0<=r&&360>=r)return{hue:r,hex:be(r,rp(),255*ip())};if(r=Or(t))return{hue:null,hex:r};throw r='Invalid colour: "'+t+'"',e!==t&&(r+=' (from "'+e+'")'),Error(r)},us=function(){return $r},pc=function(e){if($r=e,e===null){let t;(t=document.querySelector("."+Nd))==null||t.remove()}},op=function(){const e=Ke()||document.body;document.querySelector("."+Nd)?$r=document.querySelector("."+Nd):($r=document.createElement("div"),$r.className=Nd),e.appendChild($r)},Bi=function(e,t,r,l){if(Pi(),Nl=e,Da=r,r=$r){if(r.style.direction=t?"rtl":"ltr",r.style.display="block",!l&&e instanceof vn){let O;l=(O=e.getSourceBlock())==null?void 0:O.workspace}var p;Eg=(p=l)!=null?p:null;var v;e=(v=l)!=null?v:xe(),Aa=e.getRenderer().getClassName(),Oa=e.getTheme().getClassName(),Aa&&Fe(r,Aa),Oa&&Fe(r,Oa)}},Pi=function(){if(al()){Nl=null;var e=$r;e&&(e.style.display="none",e.style.left="",e.style.top="",Da&&Da(),Da=null,e.textContent="",Aa&&(pt(e,Aa),Aa=""),Oa&&(pt(e,Oa),Oa=""),xe().markFocused())}},al=function(){return!!Nl},nn=function(e){Nl===e&&Pi()},gc=function(e){Eg!==null&&Eg!==e||Pi()},Pu=function(e,t,r){$r.style.left=e+"px",$r.style.top=t+"px",$r.style.height=r+"px"},ll=function(e,t,r,l){const p=vm(e,t,r);e=$m(e,t,r,l),0>p?Pu(e,0,r.height+p):Pu(e,p,r.height)},$m=function(e,t,r,l){return l?Math.min(Math.max(t.right-r.width,e.left),e.right-r.width):Math.max(Math.min(t.left,e.right-r.width),e.left)},vm=function(e,t,r){return t.bottom+r.height>=e.bottom?t.top-r.height:t.bottom},ym=function(e){return!(e==null||!e.repositionForWindowResize)},cl=function(){ym(Nl)&&Nl.repositionForWindowResize()||Pi()},ji=function(){return qc},ul=function(e){qc=e},dl=function(e,t,r,l){if(Bi(Ig,r,oa,l),t.length){var p=fc(t,r,e);Yc=p,ap(p,e,r),setTimeout(function(){p.focus()},1),qc=null}else hl()},fc=function(e,t,r){const l=new ug;l.setRole(Pr.MENU);for(let p=0;p<e.length;p++){const v=e[p],O=new xd(v.text);O.setRightToLeft(t),O.setRole(Pr.MENUITEM),l.addChild(O),O.setEnabled(v.enabled),v.enabled&&O.onAction(function(){hl(),requestAnimationFrame(()=>{setTimeout(()=>{v.callback(v.scope,r)},0)})},{})}return l},ap=function(e,t,r){const l=tc();t=new Bt(t.clientY+l.top,t.clientY+l.top,t.clientX+l.left,t.clientX+l.left),lp(e);const p=e.getSize();r&&(t.left+=p.width,t.right+=p.width,l.left+=p.width,l.right+=p.width),ll(l,t,p,r),e.focus()},lp=function(e){var t=us();if(!t)throw Error("Attempting to create a context menu when widget div is null");t=e.render(t),Fe(t,"blocklyContextMenu"),Ue(t,"contextmenu",null,mc),e.focus()},mc=function(e){e.preventDefault(),e.stopPropagation()},hl=function(){nn(Ig),qc=null},oa=function(){Yc&&(Yc.dispose(),Yc=null)},s.callbackFactory$$module$build$src$core$contextmenu=function(e,t){return()=>{s.disable$$module$build$src$core$events$utils();let r;try{r=t instanceof Element?yo(t,e.workspace):Wn(t,e.workspace);const l=e.getRelativeToSurfaceXY();l.x=e.RTL?l.x-s.config$$module$build$src$core$config.snapRadius:l.x+s.config$$module$build$src$core$config.snapRadius,l.y+=2*s.config$$module$build$src$core$config.snapRadius,r.moveBy(l.x,l.y)}finally{s.enable$$module$build$src$core$events$utils()}return te()&&!r.isShadow()&&ee(new(Ce(fe.BLOCK_CREATE))(r)),s.setSelected$$module$build$src$core$common(r),r}},Fi=function(e,t){return t=me(t,e.getParentSvg(),e.getInverseScreenCTM()),t.x/=e.scale,t.y/=e.scale,t},aa=function(e,t,r){t=Fi(e,t),Ib.set(e,Le.difference(r,t))},ju=function(e,t){if(t=Fi(e,t),e=Ib.get(e),!e)throw Error("Drag not initialized");return Le.sum(e,t)},_m=function(e,t=!1){const r=s.createElement$$module$build$src$core$utils$xml("xml");var l=pl(s.allUsedVarModels$$module$build$src$core$variables(e));l.hasChildNodes()&&r.appendChild(l);for(const p of e.getTopComments())r.appendChild(bc(p,t));for(e=e.getTopBlocks(!0),l=0;l<e.length;l++)r.appendChild(vo(e[l],t));return r},bc=function(e,t=!1){const r=s.createElement$$module$build$src$core$utils$xml("comment");t||r.setAttribute("id",e.id),t=e.workspace;const l=e.getRelativeToSurfaceXY();return l.x=t.RTL?t.getWidth()-l.x:l.x,r.setAttribute("x",`${l.x}`),r.setAttribute("y",`${l.y}`),r.setAttribute("w",`${e.getSize().width}`),r.setAttribute("h",`${e.getSize().height}`),e.getText()&&(r.textContent=e.getText()),e.isCollapsed()&&r.setAttribute("collapsed","true"),e.isOwnEditable()||r.setAttribute("editable","false"),e.isOwnMovable()||r.setAttribute("movable","false"),e.isOwnDeletable()||r.setAttribute("deletable","false"),r},pl=function(e){const t=s.createElement$$module$build$src$core$utils$xml("variables");for(let r=0;r<e.length;r++){const l=e[r],p=s.createElement$$module$build$src$core$utils$xml("variable");p.appendChild(s.createTextNode$$module$build$src$core$utils$xml(l.name)),l.type&&p.setAttribute("type",l.type),p.id=l.getId(),t.appendChild(p)}return t},vo=function(e,t){if(e.isInsertionMarker()&&(e=e.getChildren(!1)[0],!e))return new DocumentFragment;let r=0;if(e.workspace.RTL&&(r=e.workspace.getWidth()),t=zi(e,t),hp(t)){const l=e.getRelativeToSurfaceXY();t.setAttribute("x",String(Math.round(e.workspace.RTL?r-l.x:l.x))),t.setAttribute("y",String(Math.round(l.y)))}return t},Fu=function(e){if(e.isSerializable()){const t=s.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name",e.name||""),e.toXml(t)}return null},wm=function(e,t){for(let r=0;r<e.inputList.length;r++){const l=e.inputList[r];for(let p=0;p<l.fieldRow.length;p++){const v=Fu(l.fieldRow[p]);v&&t.appendChild(v)}}},zi=function(e,t){if(e.isInsertionMarker())return(t=e.getChildren(!1)[0])?zi(t):new DocumentFragment;const r=s.createElement$$module$build$src$core$utils$xml(e.isShadow()?"shadow":"block");if(r.setAttribute("type",e.type),t||(r.id=e.id),e.mutationToDom){var l=e.mutationToDom();l&&(l.hasChildNodes()||l.hasAttributes())&&r.appendChild(l)}if(wm(e,r),l=e.getCommentText()){var p=e.getIcon(Qn.COMMENT),v=p.getBubbleSize();p=p.bubbleIsVisible();var O=s.createElement$$module$build$src$core$utils$xml("comment");O.appendChild(s.createTextNode$$module$build$src$core$utils$xml(l)),O.setAttribute("pinned",`${p}`),O.setAttribute("h",String(v.height)),O.setAttribute("w",String(v.width)),r.appendChild(O)}for(e.data&&(l=s.createElement$$module$build$src$core$utils$xml("data"),l.appendChild(s.createTextNode$$module$build$src$core$utils$xml(e.data)),r.appendChild(l)),l=0;l<e.inputList.length;l++){v=e.inputList[l];var G=void 0;if(p=!0,v.type!==s.inputTypes$$module$build$src$core$inputs$input_types.DUMMY&&v.type!==s.inputTypes$$module$build$src$core$inputs$input_types.END_ROW){O=v.connection.targetBlock(),v.type===s.inputTypes$$module$build$src$core$inputs$input_types.VALUE?G=s.createElement$$module$build$src$core$utils$xml("value"):v.type===s.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT&&(G=s.createElement$$module$build$src$core$utils$xml("statement"));const Qe=v.connection.getShadowDom();!Qe||O&&O.isShadow()||G.appendChild(cp(Qe,t)),O&&(O=zi(O,t),O.nodeType===Ji.ELEMENT_NODE&&(G.appendChild(O),p=!1)),G.setAttribute("name",v.name),p||r.appendChild(G)}}e.inputsInline!==void 0&&e.inputsInline!==e.inputsInlineDefault&&r.setAttribute("inline",String(e.inputsInline)),e.isCollapsed()&&r.setAttribute("collapsed","true"),e.isEnabled()||r.setAttribute("disabled-reasons",Array.from(e.getDisabledReasons()).map(encodeURIComponent).join(",")),e.isOwnDeletable()||r.setAttribute("deletable","false"),e.isOwnMovable()||r.setAttribute("movable","false"),e.isOwnEditable()||r.setAttribute("editable","false"),G=e.getNextBlock();let Ie;return G&&(l=zi(G,t),l.nodeType===Ji.ELEMENT_NODE&&(Ie=s.createElement$$module$build$src$core$utils$xml("next"),Ie.appendChild(l),r.appendChild(Ie))),e=e.nextConnection&&e.nextConnection.getShadowDom(),!e||G&&G.isShadow()||Ie.appendChild(cp(e,t)),r},cp=function(e,t){let r=e=e.cloneNode(!0),l;for(;r;)if(t&&r.nodeName==="shadow"&&r.removeAttribute("id"),r.firstChild)r=r.firstChild;else{for(;r&&!r.nextSibling;){l=r,r=r.parentNode;let p;l.nodeType===Ji.TEXT_NODE&&l.data.trim()===""&&((p=r)==null?void 0:p.firstChild)!==l&&mt(l)}r&&(l=r,r=r.nextSibling,l.nodeType===Ji.TEXT_NODE&&l.data.trim()===""&&mt(l))}return e},ci=function(e){return U(e).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},Xn=function(e){e=ci(e).split("<");let t="";for(let r=1;r<e.length;r++){const l=e[r];l[0]==="/"&&(t=t.substring(2)),e[r]=t+"<"+l,l[0]!=="/"&&l.slice(-2)!=="/>"&&(t+="  ")}return e=e.join(`
`),e=e.replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>"),e.replace(/^\n/,"")},fs=function(e,t){return t.setResizesEnabled(!1),t.clear(),e=s.domToWorkspace$$module$build$src$core$xml(e,t),t.setResizesEnabled(!0),e},s.domToWorkspace$$module$build$src$core$xml=function(e,t){let r=0;t.RTL&&(r=t.getWidth());const l=[];zn();const p=s.getGroup$$module$build$src$core$events$utils();p||s.setGroup$$module$build$src$core$events$utils(!0),t.setResizesEnabled&&t.setResizesEnabled(!1);let v=!0;try{for(let O=0,G;G=e.childNodes[O];O++){const Ie=G.nodeName.toLowerCase(),Qe=G;if(Ie==="block"||Ie==="shadow"&&!se()){const Mn=yo(Qe,t);l.push(Mn.id);let On;const Vr=parseInt((On=Qe.getAttribute("x"))!=null?On:"10",10);let uh;const tf=parseInt((uh=Qe.getAttribute("y"))!=null?uh:"10",10);isNaN(Vr)||isNaN(tf)||Mn.moveBy(t.RTL?r-Vr:Vr,tf,["create"]),v=!1}else{if(Ie==="shadow")throw TypeError("Shadow block cannot be a top-level block.");if(Ie==="comment")up(Qe,t);else if(Ie==="variables"){if(v)dp(Qe,t);else throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");v=!1}}}}finally{s.setGroup$$module$build$src$core$events$utils(p),t.setResizesEnabled&&t.setResizesEnabled(!0),t.rendered&&Ms(),Jn()}return ee(new(Ce(fe.FINISHED_LOADING))(t)),l},up=function(e,t){var r;const l=(r=e.getAttribute("id"))!=null?r:void 0;r=t.rendered?new Pd(t,l):new Xc(t,l);var p;r.setText((p=e.textContent)!=null?p:"");var v;p=parseInt((v=e.getAttribute("x"))!=null?v:"",10);let O;v=parseInt((O=e.getAttribute("y"))!=null?O:"",10),isNaN(p)||isNaN(v)||(p=t.RTL?t.getWidth()-p:p,r.moveTo(new Le(p,v)));var G;t=parseInt((G=e.getAttribute("w"))!=null?G:"",10);let Ie;return G=parseInt((Ie=e.getAttribute("h"))!=null?Ie:"",10),isNaN(t)||isNaN(G)||r.setSize(new Jt(t,G)),e.getAttribute("collapsed")==="true"&&r.setCollapsed(!0),e.getAttribute("editable")==="false"&&r.setEditable(!1),e.getAttribute("movable")==="false"&&r.setMovable(!1),e.getAttribute("deletable")==="false"&&r.setDeletable(!1),r},Cm=function(e,t){if(!t.getBlocksBoundingBox)return s.domToWorkspace$$module$build$src$core$xml(e,t);var r=t.getBlocksBoundingBox();if(e=s.domToWorkspace$$module$build$src$core$xml(e,t),r&&r.top!==r.bottom){var l=r.bottom;r=t.RTL?r.right:r.left;var p=1/0;let v=-1/0,O=1/0;for(let G=0;G<e.length;G++){const Ie=t.getBlockById(e[G]).getRelativeToSurfaceXY();Ie.y<O&&(O=Ie.y),Ie.x<p&&(p=Ie.x),Ie.x>v&&(v=Ie.x)}for(l=l-O+10,r=t.RTL?r-v:r-p,p=0;p<e.length;p++)t.getBlockById(e[p]).moveBy(r,l,["create"])}return e},s.domToBlock$$module$build$src$core$xml=function(e,t){return e=yo(e,t),t.rendered&&Ms(),e},yo=function(e,t){s.disable$$module$build$src$core$events$utils();var r=t.getAllVariables();let l;try{if(l=Wu(e,t),t.rendered){const p=l,v=l.getDescendants(!1);p.setConnectionTracking(!1);for(let O=v.length-1;0<=O;O--)v[O].initSvg();for(let O=v.length-1;0<=O;O--)v[O].queueRender();setTimeout(function(){p.disposed||p.setConnectionTracking(!0)},1),t.resizeContents()}else{const p=l.getDescendants(!1);for(let v=p.length-1;0<=v;v--)p[v].initModel()}}finally{s.enable$$module$build$src$core$events$utils()}if(te()){for(e=ac(t,r),t=0;t<e.length;t++)r=e[t],ee(new(Ce(fe.VAR_CREATE))(r));ee(new(Ce(fe.BLOCK_CREATE))(l))}return l},dp=function(e,t){for(let l=0;l<e.children.length;l++){var r=e.children[l];const p=r.getAttribute("type"),v=r.getAttribute("id");if(r=r.textContent,!r)break;t.createVariable(r,p,v)}},zu=function(e){const t={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let r=0;r<e.children.length;r++){const l=e.children[r];if(l.nodeType!==Ji.TEXT_NODE)switch(l.nodeName.toLowerCase()){case"mutation":t.mutation.push(l);break;case"comment":t.comment.push(l);break;case"data":t.data.push(l);break;case"title":case"field":t.field.push(l);break;case"value":case"statement":t.input.push(l);break;case"next":t.next.push(l);break;default:console.warn("Ignoring unknown tag: "+l.nodeName)}}return t},gl=function(e,t){let r=!1;for(let l=0;l<e.length;l++){const p=e[l];t.domToMutation&&(t.domToMutation(p),t.initSvg&&(r=!0))}return r},Uu=function(e,t){for(let l=0;l<e.length;l++){var r=e[l];const p=r.textContent,v=r.getAttribute("pinned")==="true";let O;const G=parseInt((O=r.getAttribute("w"))!=null?O:"50",10);let Ie;r=parseInt((Ie=r.getAttribute("h"))!=null?Ie:"50",10),t.setCommentText(p);const Qe=t.getIcon(Qn.COMMENT);isNaN(G)||isNaN(r)||Qe.setBubbleSize(new Jt(G,r)),Qe.setBubbleVisible(v),setTimeout(()=>Qe.setBubbleVisible(v),1)}},la=function(e,t){for(let r=0;r<e.length;r++)t.data=e[r].textContent},fl=function(e,t){for(let r=0;r<e.length;r++){const l=e[r],p=l.getAttribute("name");p?Sm(t,p,l):console.warn(`Ignoring unnamed field in block ${t.type}`)}},ca=function(e){let t=null,r=null;for(let l=0;l<e.childNodes.length;l++){const p=e.childNodes[l];hp(p)&&(p.nodeName.toLowerCase()==="block"?t=p:p.nodeName.toLowerCase()==="shadow"&&(r=p))}return{childBlockElement:t,childShadowElement:r}},$c=function(e,t,r,l){for(let v=0;v<e.length;v++){var p=e[v];const O=p.getAttribute("name"),G=O?r.getInput(O):null;if(!G){console.warn("Ignoring non-existent input "+O+" in block "+l);break}if(p=ca(p),p.childBlockElement){if(!G.connection)throw TypeError("Input connection does not exist.");Wu(p.childBlockElement,t,G.connection,!1)}if(p.childShadowElement){let Ie;(Ie=G.connection)==null||Ie.setShadowDom(p.childShadowElement)}}},ua=function(e,t,r){for(let l=0;l<e.length;l++){const p=ca(e[l]);if(p.childBlockElement){if(!r.nextConnection)throw TypeError("Next statement does not exist.");if(r.nextConnection.isConnected())throw TypeError("Next statement is already connected.");Wu(p.childBlockElement,t,r.nextConnection,!0)}p.childShadowElement&&r.nextConnection&&r.nextConnection.setShadowDom(p.childShadowElement)}},Wu=function(e,t,r,l){var p;const v=e.getAttribute("type");if(!v)throw TypeError("Block type unspecified: "+e.outerHTML);var O=(p=e.getAttribute("id"))!=null?p:void 0;p=t.newBlock(v,O),O=zu(e);const G=gl(O.mutation,p);if(Uu(O.comment,p),la(O.data,p),r)if(l)if(p.previousConnection)r.connect(p.previousConnection);else throw TypeError("Next block does not have previous statement.");else if(p.outputConnection)r.connect(p.outputConnection);else if(p.previousConnection)r.connect(p.previousConnection);else throw TypeError("Child block does not have output or previous statement.");if(fl(O.field,p),$c(O.input,t,p,v),ua(O.next,t,p),G&&p.initSvg(),(t=e.getAttribute("inline"))&&p.setInputsInline(t==="true"),(t=e.getAttribute("disabled"))&&p.setDisabledReason(t==="true"||t==="disabled",Bs),t=e.getAttribute("disabled-reasons"),t!==null)for(var Ie of t.split(","))p.setDisabledReason(!0,decodeURIComponent(Ie));if((Ie=e.getAttribute("deletable"))&&p.setDeletable(Ie==="true"),(Ie=e.getAttribute("movable"))&&p.setMovable(Ie==="true"),(Ie=e.getAttribute("editable"))&&p.setEditable(Ie==="true"),(Ie=e.getAttribute("collapsed"))&&p.setCollapsed(Ie==="true"),e.nodeName.toLowerCase()==="shadow"){for(e=p.getChildren(!1),Ie=0;Ie<e.length;Ie++)if(!e[Ie].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");p.setShadow(!0)}return p},Sm=function(e,t,r){const l=e.getField(t);l?l.fromXml(r):console.warn("Ignoring non-existent field "+t+" in block "+e.type)},Tm=function(e){for(let t=0;t<e.childNodes.length;t++){const r=e.childNodes[t];if(r.nodeName.toLowerCase()==="next"){e.removeChild(r);break}}},hp=function(e){return e.nodeType===Ji.ELEMENT_NODE},Hu=function(e){if(!(100<e.getDescendants(!1).length)){var t=e.workspace,r=e.getSvgRoot();t.getAudioManager().play("delete");var l=e.getRelativeToSurfaceXY(),p=r.cloneNode(!0);p.setAttribute("transform","translate("+l.x+","+l.y+")");var v;(v=t.getLayerManager())==null||v.appendToAnimationLayer({getSvgRoot:()=>p}),ml(p,{x:l.x,y:l.y,width:e.width,height:e.height},t.RTL,new Date)}},ml=function(e,t,r,l){const p=(new Date().getTime()-l.getTime())/150;1<p?mt(e):(e.setAttribute("transform","translate("+(t.x+(r?-1:1)*t.width/2*p)+","+(t.y+t.height/2*p)+") scale("+(1-p)+")"),setTimeout(ml,10,e,t,r,l))},_o=function(e){var t=e.workspace;const r=t.scale;if(t.getAudioManager().play("click"),!(1>r)){var l=t.getSvgXY(e.getSvgRoot());e.outputConnection?(l.x+=(e.RTL?3:-3)*r,l.y+=13*r):e.previousConnection&&(l.x+=(e.RTL?-23:23)*r,l.y+=3*r);var p=re(oe.CIRCLE,{cx:l.x,cy:l.y,r:0,fill:"none",stroke:"#888","stroke-width":10},t.getParentSvg());e=re(oe.ANIMATE,{id:"animationCircle",begin:"indefinite",attributeName:"r",dur:"150ms",from:0,to:25*r},p),t=re(oe.ANIMATE,{id:"animationOpacity",begin:"indefinite",attributeName:"opacity",dur:"150ms",from:1,to:0},p),e.beginElement(),t.beginElement(),setTimeout(()=>void mt(p),150)}},Vu=function(e){if(qr(),e.workspace.getAudioManager().play("disconnect"),!(1>e.workspace.scale)){var t=e.getHeightWidth().height;t=Math.atan(10/t)/Math.PI*180,e.RTL||(t*=-1),Zc=e,M(e,t,new Date,0)}},M=function(e,t,r,l){const p=[.66,1,.66,0,-.66,-1,-.66,0];let v="";r.getTime()+200>new Date().getTime()&&(v=`skewX(${Math.round(p[l%p.length]*t)})`,jd=setTimeout(M,15,e,t,r,l+1)),e.getSvgRoot().setAttribute("transform",`${e.getTranslation()} ${v}`)},qr=function(){Zc&&(jd&&(clearTimeout(jd),jd=null),Zc.getSvgRoot().setAttribute("transform",Zc.getTranslation()),Zc=null)},ui=function(e){return e.getRelativeToSurfaceXY!==void 0&&e.isMovable!==void 0&&e.startDrag!==void 0&&e.drag!==void 0&&e.endDrag!==void 0&&e.revertDrag!==void 0},Zn=function(e,t){for(const r in t)e[r]=t[r]!==null&&typeof t[r]=="object"?Zn(e[r]||Object.create(null),t[r]):t[r];return e},Ot=function(e,t){i(Be.FIELD,e,t)},km=function(e){c(Be.FIELD,e)},s.fromJson$$module$build$src$core$field_registry=function(e){return Ab.fromJsonInternal(e)},Em=function(e){const t=$(Be.FIELD,e.type);return t?t.fromJson(e):(console.warn("Blockly could not create a field of type "+e.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)},s.register$$module$build$src$core$extensions=function(e,t){if(typeof e!="string"||e.trim()==="")throw Error('Error: Invalid extension name "'+e+'"');if(Tn[e])throw Error('Error: Extension "'+e+'" is already registered.');if(typeof t!="function")throw Error('Error: Extension "'+e+'" must be a function');Tn[e]=t},s.registerMixin$$module$build$src$core$extensions=function(e,t){if(!t||typeof t!="object")throw Error('Error: Mixin "'+e+'" must be a object');s.register$$module$build$src$core$extensions(e,function(){this.mixin(t)})},s.registerMutator$$module$build$src$core$extensions=function(e,t,r,l){const p='Error when registering mutator "'+e+'": ';gp(p,t);const v=pp(t,p);if(r&&typeof r!="function")throw Error(p+'Extension "'+e+'" is not a function');s.register$$module$build$src$core$extensions(e,function(){v&&this.setMutator(new s.MutatorIcon$$module$build$src$core$icons$mutator_icon(l||[],this)),this.mixin(t),r&&r.apply(this)})},Im=function(e){Ui(e)?delete Tn[e]:console.warn('No extension mapping for name "'+e+'" found to unregister')},Ui=function(e){return!!Tn[e]},Gu=function(e,t,r){const l=Tn[e];if(typeof l!="function")throw Error('Error: Extension "'+e+'" not found.');let p;if(r?xm(e,t):p=Ku(t),l.apply(t),r)gp('Error after applying mutator "'+e+'": ',t);else if(!Om(p,t))throw Error('Error when applying extension "'+e+'": mutation properties changed when applying a non-mutator extension.')},xm=function(e,t){if(Ku(t).length)throw Error('Error: tried to apply mutation "'+e+'" to a block that already has mutator functions.  Block id: '+t.id)},Dm=function(e,t){return Rr(e.mutationToDom,e.domToMutation,t+" mutationToDom/domToMutation")},Am=function(e,t){return Rr(e.saveExtraState,e.loadExtraState,t+" saveExtraState/loadExtraState")},pp=function(e,t){return Rr(e.compose,e.decompose,t+" compose/decompose")},Rr=function(e,t,r){if(e&&t){if(typeof e!="function"||typeof t!="function")throw Error(r+" must be a function");return!0}if(!e&&!t)return!1;throw Error(r+"Must have both or neither functions")},gp=function(e,t){const r=Dm(t,e),l=Am(t,e);if(!r&&!l)throw Error(e+"Mutations must contain either XML hooks, or JSON hooks, or both");pp(t,e)},Ku=function(e){const t=[];return e.domToMutation!==void 0&&t.push(e.domToMutation),e.mutationToDom!==void 0&&t.push(e.mutationToDom),e.saveExtraState!==void 0&&t.push(e.saveExtraState),e.loadExtraState!==void 0&&t.push(e.loadExtraState),e.compose!==void 0&&t.push(e.compose),e.decompose!==void 0&&t.push(e.decompose),t},Om=function(e,t){if(t=Ku(t),t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(e[r]!==t[r])return!1;return!0},Rm=function(e){if(typeof document!="object")throw Error("runAfterPageLoad() requires browser document.");if(document.readyState==="complete")e();else{const t=setInterval(function(){document.readyState==="complete"&&(clearInterval(t),e())},10)}},s.buildTooltipForDropdown$$module$build$src$core$extensions=function(e,t){const r=[];return function(){r.includes(this.type)||(Mm(this,e,t),r.push(this.type)),this.setTooltip(function(){const l=String(this.getFieldValue(e));return kt(t[l])}.bind(this))}},Mm=function(e,t,r){var l=e.getField(t);if(l instanceof rr&&!l.isOptionListDynamic()){l=l.getOptions();for(const[,p]of l)r[p]===void 0&&console.warn(`No tooltip mapping for value ${p} of field ${t} of block type ${e.type}.`)}},s.buildTooltipWithFieldText$$module$build$src$core$extensions=function(e,t){return function(){this.setTooltip(function(){const r=this.getField(t);return kt(e).replace("%1",r?r.getText():"")}.bind(this))}},di=function(){const e=this.tooltip;this.setTooltip(function(){const t=this.getParent();return t&&t.getInputsInline()&&t.tooltip||e}.bind(this))},ut=function(e,t){return" "+e+","+t+" "},Zs=function(e,t){return" "+e+t.join("")},is=function(e,t){return" M "+e+","+t+" "},xn=function(e,t){return" m "+e+","+t+" "},hi=function(e,t){return" l "+e+","+t+" "},Mr=function(e){return" l"+e.join("")},tt=function(e,t){return" "+e+" "+t+" "},Hn=function(e,t,r,l){return e+" "+r+" "+r+" "+t+l},pr=function(e,t){i(Be.ICON,e.toString(),t)},Nm=function(e){c(Be.ICON,e)},wo=function(e){return e.getProcedureModel!==void 0&&e.doProcedureUpdate!==void 0&&e.isProcedureDef!==void 0},Ju=function(e){return e.startPublishing!==void 0&&e.stopPublishing!==void 0},qu=function(e){const t=e.getProcedureMap().getProcedures().filter(l=>!l.getReturnTypes()).map(l=>[l.getName(),l.getParameters().map(p=>p.getName()),!1]);e.getBlocksByType("procedures_defnoreturn",!1).forEach(l=>{!wo(l)&&ea(l)&&t.push(l.getProcedureDef())});const r=e.getProcedureMap().getProcedures().filter(l=>!!l.getReturnTypes()).map(l=>[l.getName(),l.getParameters().map(p=>p.getName()),!0]);return e.getBlocksByType("procedures_defreturn",!1).forEach(l=>{!wo(l)&&ea(l)&&r.push(l.getProcedureDef())}),t.sort(fp),r.sort(fp),[t,r]},fp=function(e,t){return e[0].localeCompare(t[0],void 0,{sensitivity:"base"})},s.findLegalName$$module$build$src$core$procedures=function(e,t){if(t.isInFlyout)return e;for(e=e||s.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed";!mp(e,t.workspace,t);){const r=e.match(/^(.*?)(\d+)$/);e=r?r[1]+(parseInt(r[2])+1):e+"2"}return e},mp=function(e,t,r){return!Yu(e,t,r)},Yu=function(e,t,r){for(const l of t.getAllBlocks(!1))if(l!==r&&ea(l)&&s.Names$$module$build$src$core$names.equals(l.getProcedureDef()[0],e))return!0;r=r&&wo(r)?r==null?void 0:r.getProcedureModel():void 0;for(const l of t.getProcedureMap().getProcedures())if(l!==r&&s.Names$$module$build$src$core$names.equals(l.getName(),e))return!0;return!1},s.rename$$module$build$src$core$procedures=function(e){var t=this.getSourceBlock();if(!t)throw new Gn;e=e.trim();const r=s.findLegalName$$module$build$src$core$procedures(e,t);wo(t)&&!t.isInsertionMarker()&&t.getProcedureModel().setName(r);const l=this.getValue();if(l!==e&&l!==r)for(e=t.workspace.getAllBlocks(!1),t=0;t<e.length;t++){const p=e[t];p.renameProcedure&&p.renameProcedure(l,r)}return r},Xu=function(e){function t(v,O){for(let Ie=0;Ie<v.length;Ie++){var G=v[Ie][0];const Qe=v[Ie][1],Mn=s.createElement$$module$build$src$core$utils$xml("block");Mn.setAttribute("type",O),Mn.setAttribute("gap","16");const On=s.createElement$$module$build$src$core$utils$xml("mutation");for(On.setAttribute("name",G),Mn.appendChild(On),G=0;G<Qe.length;G++){const Vr=s.createElement$$module$build$src$core$utils$xml("arg");Vr.setAttribute("name",Qe[G]),On.appendChild(Vr)}r.push(Mn)}}const r=[];if(tr.procedures_defnoreturn){var l=s.createElement$$module$build$src$core$utils$xml("block");l.setAttribute("type","procedures_defnoreturn"),l.setAttribute("gap","16");var p=s.createElement$$module$build$src$core$utils$xml("field");p.setAttribute("name","NAME"),p.appendChild(s.createTextNode$$module$build$src$core$utils$xml(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE)),l.appendChild(p),r.push(l)}return tr.procedures_defreturn&&(l=s.createElement$$module$build$src$core$utils$xml("block"),l.setAttribute("type","procedures_defreturn"),l.setAttribute("gap","16"),p=s.createElement$$module$build$src$core$utils$xml("field"),p.setAttribute("name","NAME"),p.appendChild(s.createTextNode$$module$build$src$core$utils$xml(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE)),l.appendChild(p),r.push(l)),tr.procedures_ifreturn&&(l=s.createElement$$module$build$src$core$utils$xml("block"),l.setAttribute("type","procedures_ifreturn"),l.setAttribute("gap","16"),r.push(l)),r.length&&r[r.length-1].setAttribute("gap","24"),e=qu(e),t(e[0],"procedures_callnoreturn"),t(e[1],"procedures_callreturn"),r},bp=function(e){var t=[],r=e.getBlocksByType("procedures_mutatorarg",!1);for(let v=0,O;O=r[v];v++)t.push(O.getFieldValue("NAME"));r=s.createElement$$module$build$src$core$utils$xml("xml");const l=s.createElement$$module$build$src$core$utils$xml("block");l.setAttribute("type","procedures_mutatorarg");const p=s.createElement$$module$build$src$core$utils$xml("field");p.setAttribute("name","NAME"),t=ic(s.DEFAULT_ARG$$module$build$src$core$procedures,t),t=s.createTextNode$$module$build$src$core$utils$xml(t),p.appendChild(t),l.appendChild(p),r.appendChild(l),e.updateToolbox(r)},vc=function(e){if(H(e)&&e.bubbleType==="mutator"&&e.isOpen&&e.blockId){e=he(e.workspaceId).getBlockById(e.blockId);var t=e.type;(t==="procedures_defnoreturn"||t==="procedures_defreturn")&&(e=e.getIcon(s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE).getWorkspace(),bp(e),e.addChangeListener(bl))}},bl=function(e){(k(e)||A(e)||P(e)||N(e))&&(e=he(e.workspaceId),bp(e))},$l=function(e,t){return t.getAllBlocks(!1).filter(r=>Lm(r,e)||Lh(r)&&s.Names$$module$build$src$core$names.equals(r.getProcedureCall(),e))},Lm=function(e,t){return wo(e)&&!e.isProcedureDef()&&e.getProcedureModel()&&s.Names$$module$build$src$core$names.equals(e.getProcedureModel().getName(),t)},s.mutateCallers$$module$build$src$core$procedures=function(e){const t=se();var r=e.getProcedureDef()[0];const l=e.mutationToDom(!0);e=$l(r,e.workspace);for(let v=0,O;O=e[v];v++){r=(r=O.mutationToDom())&&U(r),O.domToMutation&&O.domToMutation(l);var p=O.mutationToDom();p=p&&U(p),r!==p&&(s.setRecordUndo$$module$build$src$core$events$utils(!1),ee(new(Ce(fe.BLOCK_CHANGE))(O,"mutation",null,r,p)),s.setRecordUndo$$module$build$src$core$events$utils(t))}},s.getDefinition$$module$build$src$core$procedures=function(e,t){for(const r of t.getAllBlocks(!1))if(wo(r)&&r.isProcedureDef()&&s.Names$$module$build$src$core$names.equals(r.getProcedureModel().getName(),e)||ea(r)&&s.Names$$module$build$src$core$names.equals(r.getProcedureDef()[0],e))return r;return null},yc=function(e){return e.isDynamic},Bm=function(e){return e.pathDown!==void 0&&e.pathUp!==void 0},pi=function(e){return e.pathLeft!==void 0&&e.pathRight!==void 0},Zu=function(e,t){if(!e||!t)throw Error("Cannot connect null connections.");e.targetConnection=t,t.targetConnection=e},Co=function(e,t){let r=null;t=t.outputConnection;const l=t==null?void 0:t.getConnectionChecker();for(let p=0,v;v=e.inputList[p];p++){const O=v.connection;let G;if(O&&((G=l)!=null&&G.canConnect(t,O,!1))){if(r)return null;r=O}}return r},gr=function(e,t){let r;for(;r=Co(e,t);)if(e=r.targetBlock(),!e||e.isShadow())return r;return null},$p=function(e){return e.getType!==void 0&&e.initView!==void 0&&e.dispose!==void 0&&e.getWeight!==void 0&&e.getSize!==void 0&&e.applyColour!==void 0&&e.hideForInsertionMarker!==void 0&&e.updateEditable!==void 0&&e.updateCollapsed!==void 0&&e.isShownWhenCollapsed!==void 0&&e.setOffsetInBlock!==void 0&&e.onLocationChange!==void 0&&e.onClick!==void 0},vp=function(e){return $p(e)&&Ya(e)&&qs(e)&&e.setText!==void 0&&e.getText!==void 0&&e.setBubbleSize!==void 0&&e.getBubbleSize!==void 0&&e.getType()===Qn.COMMENT},vl=function(e){let t=e.outputConnection;return(!t||e.previousConnection&&e.previousConnection.isConnected())&&(t=e.previousConnection),t},Wi=function(e,t){i(Be.RENDERER,e,t)},Hi=function(e){c(Be.RENDERER,e)},Qu=function(e,t,r){return e=new(b(Be.RENDERER,e))(e),e.init(t,r),e},yp=function(e){qa(e.getTargetWorkspace(),void 0,"String")},yl=function(e){qa(e.getTargetWorkspace(),void 0,"Number")},_p=function(e){qa(e.getTargetWorkspace(),void 0,"Colour")},_c=function(e){let t=[],r=document.createElement("button");return r.setAttribute("text",s.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE),r.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),t.push(r),r=document.createElement("button"),r.setAttribute("text",s.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE),r.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),t.push(r),r=document.createElement("button"),r.setAttribute("text",s.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE),r.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),t.push(r),e.registerButtonCallback("CREATE_VARIABLE_STRING",yp),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",yl),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",_p),e=os(e),t=t.concat(e)},os=function(e){e=e.getAllVariables();const t=[];if(0<e.length){if(tr.variables_set_dynamic){var r=e[e.length-1];const l=s.createElement$$module$build$src$core$utils$xml("block");l.setAttribute("type","variables_set_dynamic"),l.setAttribute("gap","24"),l.appendChild(ta(r)),t.push(l)}if(tr.variables_get_dynamic){e.sort(Uc.compareByName);for(let l=0,p;p=e[l];l++)r=s.createElement$$module$build$src$core$utils$xml("block"),r.setAttribute("type","variables_get_dynamic"),r.setAttribute("gap","8"),r.appendChild(ta(p)),t.push(r)}}return t},ed=function(e,t){const r=e.workspace,l=s.config$$module$build$src$core$config.snapRadius,p=Le.difference(t,e.getRelativeToSurfaceXY()),v=new Le(0,0),O=r.getAllBlocks(!1).filter(G=>G.id!=e.id).map(G=>G.getRelativeToSurfaceXY());for(;wp(Le.sum(t,v),O)||Yr(e,Le.sum(p,v),l);)r.RTL?v.translate(-l,2*l):v.translate(l,2*l);e.moveTo(Le.sum(t,v))},wp=function(e,t){return t.some(r=>1>=Math.abs(r.x-e.x)&&1>=Math.abs(r.y-e.y))},Yr=function(e,t,r){return e.getConnections_(!1).some(l=>!!l.closest(r,t).connection)},So=function(e,t,r){const l=r.getBoundingRectangle(),p=l.right-l.left,v=na(t.top,l.top,t.top+t.height-(l.bottom-l.top))-l.top;let O=t.left;return t=t.left+t.width-p,e.RTL?O=Math.min(t,O):t=Math.max(O,t),(e=na(O,l.left,t)-l.left)||v?(r.moveBy(e,v,["inbounds"]),!0):!1},_l=function(e){return t=>{var r=e.getMetricsManager();if(r.hasFixedEdges()&&!e.isDragging()){var l;if(Up.includes((l=t.type)!=null?l:"")){l=r.getScrollMetrics(!0);const p=To(e,t);p&&(r=s.getGroup$$module$build$src$core$events$utils()||!1,s.setGroup$$module$build$src$core$events$utils(t.group),So(e,l,p)&&!t.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),s.setGroup$$module$build$src$core$events$utils(r))}else q(t)&&t.scale&&t.oldScale&&t.scale>t.oldScale&&wc(e)}}},To=function(e,t){let r=null;switch(t.type){case fe.BLOCK_CREATE:case fe.BLOCK_MOVE:(r=e.getBlockById(t.blockId))&&(r=r.getRootBlock());break;case fe.COMMENT_CREATE:case fe.COMMENT_MOVE:case fe.COMMENT_RESIZE:r=e.getCommentById(t.commentId)}return r},wc=function(e){var t=e.getMetricsManager();if(t.hasFixedEdges()&&!e.isDragging()){t=t.getScrollMetrics(!0);var r=e.getTopBoundedElements();for(let l=0,p;p=r[l];l++)So(e,t,p)}},Dn=function(e){return e.isDeletable!==void 0&&e.dispose!==void 0&&e.setDeleteStyle!==void 0},td=function(e){const t=e.toCopyData();Ds=t;let r;return cu=(r=e.workspace)!=null?r:null,t},ko=function(e,t,r){return e&&t?Cp(e,t,r):Ds&&cu?Cp(Ds,cu):null},Cp=function(e,t,r){let l;t=t.isMutator?t:(l=t.getRootWorkspace())!=null?l:t;let p,v;return(v=(p=$(Be.PASTER,e.paster,!1))==null?void 0:p.paste(e,t,r))!=null?v:null},Pm=function(e){const t=e.toCopyData();return t?ko(t,e.workspace):null},da=function(e){return e.toCopyData!==void 0},Sp=function(){un.registry.register({name:_i.ESCAPE,preconditionFn(e){return!e.options.readOnly},callback(e){return e.hideChaff(),!0},keyCodes:[Vt.ESC]})},ha=function(){un.registry.register({name:_i.DELETE,preconditionFn(e){const t=ne();return!e.options.readOnly&&t!=null&&Dn(t)&&t.isDeletable()&&!Qi.inProgress()},callback(e,t){return t.preventDefault(),e=ne(),e instanceof Ur?e.checkAndDelete():Dn(e)&&e.isDeletable()&&(s.setGroup$$module$build$src$core$events$utils(!0),e.dispose(),s.setGroup$$module$build$src$core$events$utils(!1)),!0},keyCodes:[Vt.DELETE,Vt.BACKSPACE]})},nd=function(){const e=un.registry.createSerializedKey(Vt.C,[Vt.CTRL]),t=un.registry.createSerializedKey(Vt.C,[Vt.ALT]),r=un.registry.createSerializedKey(Vt.C,[Vt.META]);un.registry.register({name:_i.COPY,preconditionFn(l){const p=ne();return!l.options.readOnly&&!Qi.inProgress()&&p!=null&&Dn(p)&&p.isDeletable()&&ui(p)&&p.isMovable()&&da(p)},callback(l,p){return p.preventDefault(),l.hideChaff(),p=ne(),!p||!da(p)?!1:(Bo=p.toCopyData(),wi=p.workspace instanceof Cr?p.workspace:l,Vl=ui(p)?p.getRelativeToSurfaceXY():null,!!Bo)},keyCodes:[e,t,r]})},Tp=function(){const e=un.registry.createSerializedKey(Vt.X,[Vt.CTRL]),t=un.registry.createSerializedKey(Vt.X,[Vt.ALT]),r=un.registry.createSerializedKey(Vt.X,[Vt.META]);un.registry.register({name:_i.CUT,preconditionFn(l){const p=ne();return!l.options.readOnly&&!Qi.inProgress()&&p!=null&&Dn(p)&&p.isDeletable()&&ui(p)&&p.isMovable()&&!p.workspace.isFlyout},callback(l){const p=ne();return p instanceof Ur?(Bo=p.toCopyData(),wi=l,Vl=p.getRelativeToSurfaceXY(),p.checkAndDelete(),!0):Dn(p)&&p.isDeletable()&&da(p)?(Bo=p.toCopyData(),wi=l,Vl=ui(p)?p.getRelativeToSurfaceXY():null,p.dispose(),!0):!1},keyCodes:[e,t,r]})},kp=function(){const e=un.registry.createSerializedKey(Vt.V,[Vt.CTRL]),t=un.registry.createSerializedKey(Vt.V,[Vt.ALT]),r=un.registry.createSerializedKey(Vt.V,[Vt.META]);un.registry.register({name:_i.PASTE,preconditionFn(l){return!l.options.readOnly&&!Qi.inProgress()},callback(){if(!Bo||!wi)return!1;if(!Vl)return!!ko(Bo,wi);const{left:l,top:p,width:v,height:O}=wi.getMetricsManager().getViewMetrics(!0);if(new Bt(p,p+O,l,l+v).contains(Vl.x,Vl.y))return!!ko(Bo,wi);const G=new Le(l+v/2,p+O/2);return!!ko(Bo,wi,G)},keyCodes:[e,t,r]})},pa=function(){const e=un.registry.createSerializedKey(Vt.Z,[Vt.CTRL]),t=un.registry.createSerializedKey(Vt.Z,[Vt.ALT]),r=un.registry.createSerializedKey(Vt.Z,[Vt.META]);un.registry.register({name:_i.UNDO,preconditionFn(l){return!l.options.readOnly&&!Qi.inProgress()},callback(l,p){return l.hideChaff(),l.undo(!1),p.preventDefault(),!0},keyCodes:[e,t,r]})},Ep=function(){const e=un.registry.createSerializedKey(Vt.Z,[Vt.SHIFT,Vt.CTRL]),t=un.registry.createSerializedKey(Vt.Z,[Vt.SHIFT,Vt.ALT]),r=un.registry.createSerializedKey(Vt.Z,[Vt.SHIFT,Vt.META]),l=un.registry.createSerializedKey(Vt.Y,[Vt.CTRL]);un.registry.register({name:_i.REDO,preconditionFn(p){return!Qi.inProgress()&&!p.options.readOnly},callback(p,v){return p.hideChaff(),p.undo(!0),v.preventDefault(),!0},keyCodes:[e,t,r,l]})},Ip=function(){Sp(),ha(),nd(),Tp(),kp(),pa(),Ep()},Cc=function(e){const t=e.saveState();return e.getParameters().length&&(t.parameters=e.getParameters().map(r=>r.saveState())),t},sd=function(e,t,r,l){if(e=e.loadState(r,l),!r.parameters)return e;for(const[p,v]of r.parameters.entries())e.insertParameter(t.loadState(v,l),p);return e},jm=function(e){const t=Object.create(null),r=y(Be.SERIALIZER,!0);for(const l in r){let p;const v=(p=r[l])==null?void 0:p.save(e);v&&(t[l]=v)}return t},Fm=function(e,t,{recordUndo:r=!1}={}){var l=y(Be.SERIALIZER,!0);if(l){l=Object.entries(l).sort((v,O)=>O[1].priority-v[1].priority);var p=se();s.setRecordUndo$$module$build$src$core$events$utils(r),(r=s.getGroup$$module$build$src$core$events$utils())||s.setGroup$$module$build$src$core$events$utils(!0),zn(),t instanceof Cr&&t.setResizesEnabled(!1);for(const[,v]of l.reverse()){let O;(O=v)==null||O.clear(t)}for(const[v,O]of l.reverse())if(e[v]){let G;(G=O)==null||G.load(e[v],t)}t instanceof Cr&&t.setResizesEnabled(!0),Jn(),ee(new(Ce(fe.FINISHED_LOADING))(t)),s.setGroup$$module$build$src$core$events$utils(r),s.setRecordUndo$$module$build$src$core$events$utils(p)}},zm=function(e,t){let r=null;r=typeof e=="string"?document.getElementById(e)||document.querySelector(e):e;var l;if(!document.contains(r)&&document!==((l=r)==null?void 0:l.ownerDocument))throw Error("Error: container is not in current document");e=new zr(t||{}),l=document.createElement("div"),Fe(l,"injectionDiv"),t!=null&&t.rtl&&Fe(l,"blocklyRTL"),l.tabIndex=0,tn(l,as.LABEL,s.Msg$$module$build$src$core$msg.WORKSPACE_ARIA_LABEL),r.appendChild(l),t=xp(l,e);const p=rd(l,t,e);return Um(p),He(p),Je(p),l.addEventListener("focusin",function(){He(p)}),Ue(l,"keydown",null,wl),Ue(wn(),"keydown",null,wl),(t=us())&&Ue(t,"keydown",null,wl),p},xp=function(e,t){e.setAttribute("dir","LTR"),Ve(t.hasCss,t.pathToMedia),e=re(oe.SVG,{xmlns:Nc,"xmlns:html":bi,"xmlns:xlink":nr,version:"1.1",class:"blocklySvg",tabindex:"0"},e);const r=re(oe.DEFS,{},e),l=String(Math.random()).substring(2);return t.gridPattern=eo.createDom(l,t.gridOptions,r),e},rd=function(e,t,r){r.parentWorkspace=null,r=new Cr(r);const l=r.options;r.scale=l.zoomOptions.startScale,t.appendChild(r.createDom("blocklyMainBackground",e));var p=r.getRenderer().getClassName();return p&&Fe(e,p),(p=r.getTheme().getClassName())&&Fe(e,p),!l.hasCategories&&l.languageTree&&(e=r.addFlyout(oe.SVG),Cn(e,t)),l.hasTrashcan&&r.addTrashcan(),l.zoomOptions&&l.zoomOptions.controls&&r.addZoomControls(),r.getThemeManager().subscribe(t,"workspaceBackgroundColour","background-color"),r.translate(0,0),r.addChangeListener(_l(r)),Je(r),op(),ai(),$o(),r},Um=function(e){const t=e.options;var r=e.getParentSvg();if(Ue(r.parentNode,"contextmenu",null,function(l){qt(l)||l.preventDefault()}),r=Ue(window,"resize",null,function(){Li(),e.hideComponents(!0),hc(),cl(),Je(e),wc(e)}),e.setResizeHandlerWrapper(r),Dp(),t.languageTree){r=e.getToolbox();const l=e.getFlyout(!0);r?r.init():l&&(l.init(e),l.show(t.languageTree),typeof l.scrollToStart=="function"&&l.scrollToStart())}t.hasTrashcan&&e.trashcan.init(),t.zoomOptions&&t.zoomOptions.controls&&e.zoomControls_.init(),t.moveOptions&&t.moveOptions.scrollbars?(e.scrollbar=new Jg(e,t.moveOptions.scrollbars===!0||!!t.moveOptions.scrollbars.horizontal,t.moveOptions.scrollbars===!0||!!t.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),e.scrollbar.resize()):e.setMetrics({x:.5,y:.5}),t.hasSounds&&Ap(t.pathToMedia,e)},wl=function(e){const t=xe();t&&!(qt(e)||t.rendered&&!t.isVisible())&&un.registry.onKeyDown(t,e)},Dp=function(){l$||(Ue(document,"scroll",null,function(){const e=Ae();for(let t=0,r;r=e[t];t++)r instanceof Cr&&r.updateInverseScreenCTM()}),Nt(document,"touchend",null,lt),Nt(document,"touchcancel",null,lt)),l$=!0},Ap=function(e,t){function r(){for(;p.length;){const v=p.pop();v&&wt(v)}l.preload()}const l=t.getAudioManager();l.load([e+"click.mp3",e+"click.wav",e+"click.ogg"],"click"),l.load([e+"disconnect.wav",e+"disconnect.mp3",e+"disconnect.ogg"],"disconnect"),l.load([e+"delete.mp3",e+"delete.ogg",e+"delete.wav"],"delete");const p=[];p.push(Ue(document,"pointermove",null,r,!0)),p.push(Ue(document,"touchstart",null,r,!0))},id=function(){zt.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.UNDO},preconditionFn(e){return 0<e.workspace.getUndoStack().length?"enabled":"disabled"},callback(e){e.workspace.undo(!1)},scopeType:zt.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},Cl=function(){zt.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.REDO},preconditionFn(e){return 0<e.workspace.getRedoStack().length?"enabled":"disabled"},callback(e){e.workspace.undo(!0)},scopeType:zt.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},Op=function(){zt.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.CLEAN_UP},preconditionFn(e){return e.workspace.isMovable()?1<e.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden"},callback(e){e.workspace.cleanUp()},scopeType:zt.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},od=function(e,t){function r(v){p--,v.setCollapsed(e),p===0&&s.setGroup$$module$build$src$core$events$utils(!1)}let l=0,p=0;s.setGroup$$module$build$src$core$events$utils(!0);for(let v=0;v<t.length;v++){let O=t[v];for(;O;)p++,setTimeout(r.bind(null,O),l),O=O.getNextBlock(),l+=10}},ad=function(){zt.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.COLLAPSE_ALL},preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let t=0;t<e.length;t++){let r=e[t];for(;r;){if(!r.isCollapsed())return"enabled";r=r.getNextBlock()}}return"disabled"}return"hidden"},callback(e){od(!0,e.workspace.getTopBlocks(!0))},scopeType:zt.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},Rp=function(){zt.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.EXPAND_ALL},preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let t=0;t<e.length;t++){let r=e[t];for(;r;){if(r.isCollapsed())return"enabled";r=r.getNextBlock()}}return"disabled"}return"hidden"},callback(e){od(!1,e.workspace.getTopBlocks(!0))},scopeType:zt.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},ld=function(e,t){if(e.isDeletable())Array.prototype.push.apply(t,e.getDescendants(!1));else{e=e.getChildren(!1);for(let r=0;r<e.length;r++)ld(e[r],t)}},cd=function(e){const t=[];e=e.getTopBlocks(!0);for(let r=0;r<e.length;r++)ld(e[r],t);return t},ga=function(e,t){t?s.setGroup$$module$build$src$core$events$utils(t):(s.setGroup$$module$build$src$core$events$utils(!0),t=s.getGroup$$module$build$src$core$events$utils());const r=e.shift();r&&(r.isDeadOrDying()?ga(e,t):(r.dispose(!1,!0),setTimeout(ga,10,e,t))),s.setGroup$$module$build$src$core$events$utils(!1)},ud=function(){zt.registry.register({displayText(e){return e.workspace?(e=cd(e.workspace).length,e===1?s.Msg$$module$build$src$core$msg.DELETE_BLOCK:s.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${e}`)):""},preconditionFn(e){return e.workspace&&0<cd(e.workspace).length?"enabled":"disabled"},callback(e){if(e.workspace){e.workspace.cancelCurrentGesture();var t=cd(e.workspace);2>t.length?ga(t):Ja(s.Msg$$module$build$src$core$msg.DELETE_ALL_BLOCKS.replace("%1",String(t.length)),function(r){r&&ga(t)})}},scopeType:zt.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},dd=function(){id(),Cl(),Op(),ad(),Rp(),ud()},Mp=function(){zt.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.DUPLICATE_BLOCK},preconditionFn(e){return e=e.block,!e.isInFlyout&&e.isDeletable()&&e.isMovable()?e.isDuplicatable()?"enabled":"disabled":"hidden"},callback(e){if(e.block){var t=e.block.toCopyData();t&&ko(t,e.block.workspace)}},scopeType:zt.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},Sc=function(){zt.registry.register({displayText(e){return e.block.hasIcon(no.TYPE)?s.Msg$$module$build$src$core$msg.REMOVE_COMMENT:s.Msg$$module$build$src$core$msg.ADD_COMMENT},preconditionFn(e){return e=e.block,!e.isInFlyout&&e.workspace.options.comments&&!e.isCollapsed()&&e.isEditable()?"enabled":"hidden"},callback(e){e=e.block,e.hasIcon(no.TYPE)?e.setCommentText(null):e.setCommentText("")},scopeType:zt.ScopeType.BLOCK,id:"blockComment",weight:2})},Ht=function(){zt.registry.register({displayText(e){return e.block.getInputsInline()?s.Msg$$module$build$src$core$msg.EXTERNAL_INPUTS:s.Msg$$module$build$src$core$msg.INLINE_INPUTS},preconditionFn(e){if(e=e.block,!e.isInFlyout&&e.isMovable()&&!e.isCollapsed()){for(let t=1;t<e.inputList.length;t++)if(!(e.inputList[t-1]instanceof ah||e.inputList[t]instanceof ah))return"enabled"}return"hidden"},callback(e){e.block.setInputsInline(!e.block.getInputsInline())},scopeType:zt.ScopeType.BLOCK,id:"blockInline",weight:3})},Np=function(){zt.registry.register({displayText(e){return e.block.isCollapsed()?s.Msg$$module$build$src$core$msg.EXPAND_BLOCK:s.Msg$$module$build$src$core$msg.COLLAPSE_BLOCK},preconditionFn(e){return e=e.block,!e.isInFlyout&&e.isMovable()&&e.workspace.options.collapse?"enabled":"hidden"},callback(e){e.block.setCollapsed(!e.block.isCollapsed())},scopeType:zt.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},Lp=function(){zt.registry.register({displayText(e){return e.block.hasDisabledReason(Bs)?s.Msg$$module$build$src$core$msg.ENABLE_BLOCK:s.Msg$$module$build$src$core$msg.DISABLE_BLOCK},preconditionFn(e){if(e=e.block,!e.isInFlyout&&e.workspace.options.disable&&e.isEditable()){var t=e.getDisabledReasons();return t=t.size>(t.has(Bs)?1:0),e.getInheritedDisabled()||t?"disabled":"enabled"}return"hidden"},callback(e){e=e.block;const t=s.getGroup$$module$build$src$core$events$utils();t||s.setGroup$$module$build$src$core$events$utils(!0),e.setDisabledReason(!e.hasDisabledReason(Bs),Bs),s.setGroup$$module$build$src$core$events$utils(t)},scopeType:zt.ScopeType.BLOCK,id:"blockDisable",weight:5})},fa=function(){zt.registry.register({displayText(e){var t=e.block;return e=t.getDescendants(!1).length,(t=t.getNextBlock())&&(e-=t.getDescendants(!1).length),e===1?s.Msg$$module$build$src$core$msg.DELETE_BLOCK:s.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${e}`)},preconditionFn(e){return!e.block.isInFlyout&&e.block.isDeletable()?"enabled":"hidden"},callback(e){e.block&&e.block.checkAndDelete()},scopeType:zt.ScopeType.BLOCK,id:"blockDelete",weight:6})},hd=function(){zt.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.HELP},preconditionFn(e){return e=e.block,(typeof e.helpUrl=="function"?e.helpUrl():e.helpUrl)?"enabled":"hidden"},callback(e){e.block.showHelp()},scopeType:zt.ScopeType.BLOCK,id:"blockHelp",weight:7})},Bp=function(){zt.registry.register({displayText:()=>s.Msg$$module$build$src$core$msg.REMOVE_COMMENT,preconditionFn(e){let t;return(t=e.comment)!=null&&t.isDeletable()?"enabled":"hidden"},callback(e){s.setGroup$$module$build$src$core$events$utils(!0);let t;(t=e.comment)==null||t.dispose(),s.setGroup$$module$build$src$core$events$utils(!1)},scopeType:zt.ScopeType.COMMENT,id:"commentDelete",weight:6})},Pp=function(){zt.registry.register({displayText:()=>s.Msg$$module$build$src$core$msg.DUPLICATE_COMMENT,preconditionFn(e){let t;return(t=e.comment)!=null&&t.isMovable()?"enabled":"hidden"},callback(e){if(e.comment){var t=e.comment.toCopyData();t&&ko(t,e.comment.workspace)}},scopeType:zt.ScopeType.COMMENT,id:"commentDuplicate",weight:1})},Qs=function(){zt.registry.register({displayText:()=>s.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:e=>{let t;return(t=e.workspace)!=null&&t.isMutator?"hidden":"enabled"},callback:(e,t)=>{if(e=e.workspace){s.setGroup$$module$build$src$core$events$utils(!0);var r=new Pd(e);r.setText(s.Msg$$module$build$src$core$msg.WORKSPACE_COMMENT_DEFAULT_TEXT),r.moveTo(Wm(new Le(t.clientX,t.clientY),e)),s.setSelected$$module$build$src$core$common(r),s.setGroup$$module$build$src$core$events$utils(!1)}},scopeType:zt.ScopeType.WORKSPACE,id:"commentCreate",weight:8})},Wm=function(e,t){var r=t.getInjectionDiv().getBoundingClientRect();return e=new Le(e.x-r.left,e.y-r.top),r=t.getOriginOffsetInPixels(),e=Le.difference(e,r),e.scale(1/t.scale),e},Tc=function(){Mp(),Sc(),Ht(),Np(),Lp(),fa(),hd()},pd=function(){Pp(),Bp(),Qs()},gd=function(){dd(),Tc()},jp=function(e){return e.paste!==void 0},er=function(e){return e.getSvgRoot!==void 0},Vi=function(e){return typeof e.id=="string"&&e.workspace!==void 0&&e.select!==void 0&&e.unselect!==void 0},fd=function(e){return e.isSelectable()},Fp=function(e){xe().hideChaff(e)},Re=Re||{},Re.scope={},Re.ASSUME_ES5=!1,Re.ASSUME_NO_NATIVE_MAP=!1,Re.ASSUME_NO_NATIVE_SET=!1,Re.SIMPLE_FROUND_POLYFILL=!1,Re.ISOLATE_POLYFILLS=!1,Re.FORCE_POLYFILL_PROMISE=!1,Re.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,Re.defineProperty=Re.ASSUME_ES5||typeof Object.defineProperties=="function"?Object.defineProperty:function(e,t,r){return e==Array.prototype||e==Object.prototype||(e[t]=r.value),e},Re.getGlobal=function(e){e=[typeof globalThis=="object"&&globalThis,e,typeof window=="object"&&window,typeof self=="object"&&self,typeof Vo=="object"&&Vo];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")},Re.global=Re.getGlobal(this),Re.IS_SYMBOL_NATIVE=typeof Symbol=="function"&&typeof Symbol("x")=="symbol",Re.TRUST_ES6_POLYFILLS=!Re.ISOLATE_POLYFILLS||Re.IS_SYMBOL_NATIVE,Re.polyfills={},Re.propertyToPolyfillSymbol={},Re.POLYFILL_PREFIX="$jscp$",Re.polyfill=function(e,t,r,l){t&&(Re.ISOLATE_POLYFILLS?Re.polyfillIsolated(e,t,r,l):Re.polyfillUnisolated(e,t,r,l))},Re.polyfillUnisolated=function(e,t,r,l){for(r=Re.global,e=e.split("."),l=0;l<e.length-1;l++){var p=e[l];if(!(p in r))return;r=r[p]}e=e[e.length-1],l=r[e],t=t(l),t!=l&&t!=null&&Re.defineProperty(r,e,{configurable:!0,writable:!0,value:t})},Re.polyfillIsolated=function(e,t,r,l){var p=e.split(".");e=p.length===1,l=p[0],l=!e&&l in Re.polyfills?Re.polyfills:Re.global;for(var v=0;v<p.length-1;v++){var O=p[v];if(!(O in l))return;l=l[O]}p=p[p.length-1],r=Re.IS_SYMBOL_NATIVE&&r==="es6"?l[p]:null,t=t(r),t!=null&&(e?Re.defineProperty(Re.polyfills,p,{configurable:!0,writable:!0,value:t}):t!==r&&(Re.propertyToPolyfillSymbol[p]===void 0&&(r=1e9*Math.random()>>>0,Re.propertyToPolyfillSymbol[p]=Re.IS_SYMBOL_NATIVE?Re.global.Symbol(p):Re.POLYFILL_PREFIX+r+"$"+p),Re.defineProperty(l,Re.propertyToPolyfillSymbol[p],{configurable:!0,writable:!0,value:t})))},Re.underscoreProtoCanBeSet=function(){var e={a:!0},t={};try{return t.__proto__=e,t.a}catch{}return!1},Re.setPrototypeOf=Re.TRUST_ES6_POLYFILLS&&typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf:Re.underscoreProtoCanBeSet()?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null,Re.arrayIteratorImpl=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}},Re.arrayIterator=function(e){return{next:Re.arrayIteratorImpl(e)}},Re.makeIterator=function(e){var t=typeof Symbol<"u"&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if(typeof e.length=="number")return Re.arrayIterator(e);throw Error(String(e)+" is not an iterable or ArrayLike")},Re.generator={},Re.generator.ensureIteratorResultIsObject_=function(e){if(!(e instanceof Object))throw new TypeError("Iterator result "+e+" is not an object")},Re.generator.Context=function(){this.isRunning_=!1,this.yieldAllIterator_=null,this.yieldResult=void 0,this.nextAddress=1,this.finallyAddress_=this.catchAddress_=0,this.finallyContexts_=this.abruptCompletion_=null},Re.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0},Re.generator.Context.prototype.stop_=function(){this.isRunning_=!1},Re.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_},Re.generator.Context.prototype.next_=function(e){this.yieldResult=e},Re.generator.Context.prototype.throw_=function(e){this.abruptCompletion_={exception:e,isException:!0},this.jumpToErrorHandler_()},Re.generator.Context.prototype.return=function(e){this.abruptCompletion_={return:e},this.nextAddress=this.finallyAddress_},Re.generator.Context.prototype.jumpThroughFinallyBlocks=function(e){this.abruptCompletion_={jumpTo:e},this.nextAddress=this.finallyAddress_},Re.generator.Context.prototype.yield=function(e,t){return this.nextAddress=t,{value:e}},Re.generator.Context.prototype.yieldAll=function(e,t){e=Re.makeIterator(e);var r=e.next();if(Re.generator.ensureIteratorResultIsObject_(r),r.done)this.yieldResult=r.value,this.nextAddress=t;else return this.yieldAllIterator_=e,this.yield(r.value,t)},Re.generator.Context.prototype.jumpTo=function(e){this.nextAddress=e},Re.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0},Re.generator.Context.prototype.setCatchFinallyBlocks=function(e,t){this.catchAddress_=e,t!=null&&(this.finallyAddress_=t)},Re.generator.Context.prototype.setFinallyBlock=function(e){this.catchAddress_=0,this.finallyAddress_=e||0},Re.generator.Context.prototype.leaveTryBlock=function(e,t){this.nextAddress=e,this.catchAddress_=t||0},Re.generator.Context.prototype.enterCatchBlock=function(e){return this.catchAddress_=e||0,e=this.abruptCompletion_.exception,this.abruptCompletion_=null,e},Re.generator.Context.prototype.enterFinallyBlock=function(e,t,r){r?this.finallyContexts_[r]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_],this.catchAddress_=e||0,this.finallyAddress_=t||0},Re.generator.Context.prototype.leaveFinallyBlock=function(e,t){if(t=this.finallyContexts_.splice(t||0)[0],t=this.abruptCompletion_=this.abruptCompletion_||t){if(t.isException)return this.jumpToErrorHandler_();t.jumpTo!=null&&this.finallyAddress_<t.jumpTo?(this.nextAddress=t.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=e},Re.generator.Context.prototype.forIn=function(e){return new Re.generator.Context.PropertyIterator(e)},Re.generator.Context.PropertyIterator=function(e){this.object_=e,this.properties_=[];for(var t in e)this.properties_.push(t);this.properties_.reverse()},Re.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var e=this.properties_.pop();if(e in this.object_)return e}return null},Re.generator.Engine_=function(e){this.context_=new Re.generator.Context,this.program_=e},Re.generator.Engine_.prototype.next_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.next,e,this.context_.next_):(this.context_.next_(e),this.nextStep_())},Re.generator.Engine_.prototype.return_=function(e){this.context_.start_();var t=this.context_.yieldAllIterator_;return t?this.yieldAllStep_("return"in t?t.return:function(r){return{value:r,done:!0}},e,this.context_.return):(this.context_.return(e),this.nextStep_())},Re.generator.Engine_.prototype.throw_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.throw,e,this.context_.next_):(this.context_.throw_(e),this.nextStep_())},Re.generator.Engine_.prototype.yieldAllStep_=function(e,t,r){try{var l=e.call(this.context_.yieldAllIterator_,t);if(Re.generator.ensureIteratorResultIsObject_(l),!l.done)return this.context_.stop_(),l;var p=l.value}catch(v){return this.context_.yieldAllIterator_=null,this.context_.throw_(v),this.nextStep_()}return this.context_.yieldAllIterator_=null,r.call(this.context_,p),this.nextStep_()},Re.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var e=this.program_(this.context_);if(e)return this.context_.stop_(),{value:e.value,done:!1}}catch(t){this.context_.yieldResult=void 0,this.context_.throw_(t)}if(this.context_.stop_(),this.context_.abruptCompletion_){if(e=this.context_.abruptCompletion_,this.context_.abruptCompletion_=null,e.isException)throw e.exception;return{value:e.return,done:!0}}return{value:void 0,done:!0}},Re.generator.Generator_=function(e){this.next=function(t){return e.next_(t)},this.throw=function(t){return e.throw_(t)},this.return=function(t){return e.return_(t)},this[Symbol.iterator]=function(){return this}},Re.generator.createGenerator=function(e,t){return t=new Re.generator.Generator_(new Re.generator.Engine_(t)),Re.setPrototypeOf&&e.prototype&&Re.setPrototypeOf(t,e.prototype),t},Re.asyncExecutePromiseGenerator=function(e){function t(l){return e.next(l)}function r(l){return e.throw(l)}return new Promise(function(l,p){function v(O){O.done?l(O.value):Promise.resolve(O.value).then(t,r).then(v,p)}v(e.next())})},Re.asyncExecutePromiseGeneratorFunction=function(e){return Re.asyncExecutePromiseGenerator(e())},Re.asyncExecutePromiseGeneratorProgram=function(e){return Re.asyncExecutePromiseGenerator(new Re.generator.Generator_(new Re.generator.Engine_(e)))},Re.polyfill("globalThis",function(e){return e||Re.global},"es_2020","es3"),Re.polyfill("Array.prototype.includes",function(e){return e||function(t,r){var l=this;l instanceof String&&(l=String(l));var p=l.length;for(r=r||0,0>r&&(r=Math.max(r+p,0));r<p;r++){var v=l[r];if(v===t||Object.is(v,t))return!0}return!1}},"es7","es3"),Re.initSymbol=function(){},Re.iteratorPrototype=function(e){return e={next:e},e[Symbol.iterator]=function(){return this},e},Re.iteratorFromArray=function(e,t){e instanceof String&&(e+="");var r=0,l=!1,p={next:function(){if(!l&&r<e.length){var v=r++;return{value:t(v,e[v]),done:!1}}return l=!0,{done:!0,value:void 0}}};return p[Symbol.iterator]=function(){return p},p},Re.polyfill("Array.prototype.values",function(e){return e||function(){return Re.iteratorFromArray(this,function(t,r){return r})}},"es8","es3"),Re.polyfill("Array.prototype.flat",function(e){return e||function(t){t=t===void 0?1:t;var r=[];return Array.prototype.forEach.call(this,function(l){Array.isArray(l)&&0<t?(l=Array.prototype.flat.call(l,t-1),r.push.apply(r,l)):r.push(l)}),r}},"es9","es5"),Re.polyfill("Array.prototype.flatMap",function(e){return e||function(t,r){var l=[];return Array.prototype.forEach.call(this,function(p,v){p=t.call(r,p,v,this),Array.isArray(p)?l.push.apply(l,p):l.push(p)}),l}},"es9","es5"),Re.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},Re.polyfill("Object.entries",function(e){return e||function(t){var r=[],l;for(l in t)Re.owns(t,l)&&r.push([l,t[l]]);return r}},"es8","es3"),Re.polyfill("Object.values",function(e){return e||function(t){var r=[],l;for(l in t)Re.owns(t,l)&&r.push(t[l]);return r}},"es8","es3");var Gi=Object.create(null),zp={typeMap:Gi},kc=Object.create(null),Nr="default",Be=class{constructor(e){this.name=e}toString(){return this.name}};Be.CONNECTION_CHECKER=new Be("connectionChecker"),Be.CONNECTION_PREVIEWER=new Be("connectionPreviewer"),Be.CURSOR=new Be("cursor"),Be.EVENT=new Be("event"),Be.FIELD=new Be("field"),Be.INPUT=new Be("input"),Be.RENDERER=new Be("renderer"),Be.TOOLBOX=new Be("toolbox"),Be.THEME=new Be("theme"),Be.TOOLBOX_ITEM=new Be("toolboxItem"),Be.FLYOUTS_VERTICAL_TOOLBOX=new Be("flyoutsVerticalToolbox"),Be.FLYOUTS_HORIZONTAL_TOOLBOX=new Be("flyoutsHorizontalToolbox"),Be.METRICS_MANAGER=new Be("metricsManager"),Be.BLOCK_DRAGGER=new Be("blockDragger"),Be.SERIALIZER=new Be("serializer"),Be.ICON=new Be("icon"),Be.PASTER=new Be("paster");var ks={DEFAULT:Nr,TEST_ONLY:zp};ks.Type=Be,ks.getAllItems=y,ks.getClass=b,ks.getClassFromOptions=w,ks.getObject=$,ks.hasItem=g,ks.register=i,ks.unregister=c;var tr=Object.create(null),fe;(function(e){e.BLOCK_CREATE="create",e.BLOCK_DELETE="delete",e.BLOCK_CHANGE="change",e.BLOCK_FIELD_INTERMEDIATE_CHANGE="block_field_intermediate_change",e.BLOCK_MOVE="move",e.VAR_CREATE="var_create",e.VAR_DELETE="var_delete",e.VAR_RENAME="var_rename",e.UI="ui",e.BLOCK_DRAG="drag",e.SELECTED="selected",e.CLICK="click",e.MARKER_MOVE="marker_move",e.BUBBLE_OPEN="bubble_open",e.TRASHCAN_OPEN="trashcan_open",e.TOOLBOX_ITEM_SELECT="toolbox_item_select",e.THEME_CHANGE="theme_change",e.VIEWPORT_CHANGE="viewport_change",e.COMMENT_CREATE="comment_create",e.COMMENT_DELETE="comment_delete",e.COMMENT_CHANGE="comment_change",e.COMMENT_MOVE="comment_move",e.COMMENT_RESIZE="comment_resize",e.COMMENT_DRAG="comment_drag",e.COMMENT_COLLAPSE="comment_collapse",e.FINISHED_LOADING="finished_loading"})(fe||(fe={}));var Up=[fe.BLOCK_CREATE,fe.BLOCK_MOVE,fe.COMMENT_CREATE,fe.COMMENT_MOVE],Wp=new Set,md={};md.warn=T;var Hm="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Vm={genUid:()=>{const e=Hm.length,t=[];for(let r=0;20>r;r++)t[r]=Hm.charAt(Math.random()*e);return t.join("")}},ty=0,bd={TEST_ONLY:Vm};bd.genUid=E,bd.getNextUniqueId=C;var Hp="",Ec=!0,$d=0,vd="ORPHANED_BLOCK",Vn=[],Xr={FIRE_QUEUE:Vn,enqueueEvent:X,fireNow:Y,fireInternal:K,setGroupInternal:ke};s.disable$$module$build$src$core$events$utils,s.enable$$module$build$src$core$events$utils,s.getGroup$$module$build$src$core$events$utils,s.setGroup$$module$build$src$core$events$utils,s.setRecordUndo$$module$build$src$core$events$utils;var Ic=Object.create(null),Gm,gi=null,ma,Sl=[],Vp={defineBlocksWithJsonArrayInternal:Wt},ms={TEST_ONLY:Vp};ms.createBlockDefinitionsFromJsonArray=s.createBlockDefinitionsFromJsonArray$$module$build$src$core$common,ms.defineBlocks=s.defineBlocks$$module$build$src$core$common,ms.defineBlocksWithJsonArray=nt,ms.draggingConnections=Sl,ms.getAllWorkspaces=Ae,ms.getBlockTypeCounts=rt,ms.getMainWorkspace=xe,ms.getParentContainer=Ke,ms.getSelected=ne,ms.getWorkspaceById=he,ms.registerWorkspace=de,ms.setMainWorkspace=He,ms.setParentContainer=Te,ms.setSelected=s.setSelected$$module$build$src$core$common,ms.svgResize=Je,ms.unregisterWorkpace=Se;var ba=class{constructor(){this.workspaceId=void 0,this.isUiEvent=!1,this.type="",this.group=s.getGroup$$module$build$src$core$events$utils(),this.recordUndo=se()}toJson(){return{type:this.type,group:this.group}}static fromJson(e,t,r){return r.isBlank=!1,r.group=e.group||"",r.workspaceId=t.id,r}isNull(){return!1}run(e){}getEventWorkspace_(){let e;if(this.workspaceId&&(e=he(this.workspaceId)),!e)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return e}},Es=class extends ba{constructor(e){super(),this.recordUndo=!1,this.isUiEvent=!0,this.isBlank=typeof e>"u",this.workspaceId=e||""}},$a=class extends Es{constructor(e,t,r){t=e?e.workspace.id:t,t===null&&(t=void 0),super(t),this.type=fe.CLICK,this.blockId=e?e.id:void 0,this.targetType=r}toJson(){const e=super.toJson();if(!this.targetType)throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson");return e.targetType=this.targetType,e.blockId=this.blockId,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new $a),t.targetType=e.targetType,t.blockId=e.blockId,t}},Gp;(function(e){e.BLOCK="block",e.WORKSPACE="workspace",e.ZOOM_CONTROLS="zoom_controls"})(Gp||(Gp={})),i(Be.EVENT,fe.CLICK,$a);var Km=750,Kp="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),va=null,Eo={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},ya=0,Ki={TOUCH_ENABLED:Kp,TOUCH_MAP:Eo};Ki.checkTouchIdentifier=mn,Ki.clearTouchIdentifier=ft,Ki.getTouchIdentifierFromEvent=At,Ki.longStart=St,Ki.longStop=lt,Ki.shouldHandleEvent=st;var Tl,Jm,Jp,xc,Dc,kl,qp,Yp,fi,Xp;(function(e){function t(l){return r.includes(l.toUpperCase())}Tl=e;const r=Tl.toUpperCase();Jm=t("JavaFX"),Jp=t("WebKit"),xc=t("Gecko")&&!Jp,Dc=t("Android"),e=globalThis.navigator&&globalThis.navigator.maxTouchPoints,kl=t("iPad")||t("Macintosh")&&0<e,qp=t("iPhone")&&!kl,Yp=t("Macintosh"),fi=kl||Dc&&!t("Mobile")||t("Silk"),Xp=!fi&&(qp||Dc)})(globalThis.navigator&&globalThis.navigator.userAgent||"");var qm=Tl,Ym=Jm,Zp=xc,Qp=Dc,yd=kl,mi=qp,Ac=Yp,_d=Xp,eg={ANDROID:Qp,GECKO:Zp,IPAD:yd,IPHONE:mi,JavaFx:Ym,MAC:Ac,MOBILE:_d,raw:qm},Oc=40,_a=125,gt={};gt.bind=Nt,gt.conditionalBind=Ue,gt.getScrollDeltaPixels=ge,gt.isRightButton=ct,gt.isTargetInput=qt,gt.mouseToSvg=me,gt.unbind=wt;var Rc={};Rc.removeElem=ue;var Zr=class{constructor(e){this.name=e}toString(){return this.name}};Zr.POSITIONABLE=new Zr("positionable"),Zr.DRAG_TARGET=new Zr("drag_target"),Zr.DELETE_AREA=new Zr("delete_area"),Zr.AUTOHIDEABLE=new Zr("autohideable");var pn=class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(e,t){const r=e.component.id;if(!t&&this.componentData.has(r)){var l;throw Error('Plugin "'+r+'" with capabilities "'+((l=this.componentData.get(r))==null?void 0:l.capabilities)+'" already added.')}for(this.componentData.set(r,e),t=[],l=0;l<e.capabilities.length;l++){const p=String(e.capabilities[l]).toLowerCase();if(t.push(p),this.capabilityToComponentIds.has(p)){let v;(v=this.capabilityToComponentIds.get(p))==null||v.push(r)}else this.capabilityToComponentIds.set(p,[r])}this.componentData.get(r).capabilities=t}removeComponent(e){const t=this.componentData.get(e);if(t){for(let r=0;r<t.capabilities.length;r++){const l=String(t.capabilities[r]).toLowerCase();ue(this.capabilityToComponentIds.get(l),e)}this.componentData.delete(e)}}addCapability(e,t){if(!this.getComponent(e))throw Error('Cannot add capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');if(this.hasCapability(e,t))console.warn('Plugin "'+e+'already has capability "'+t+'"');else{t=`${t}`.toLowerCase();var r;(r=this.componentData.get(e))==null||r.capabilities.push(t);var l;(l=this.capabilityToComponentIds.get(t))==null||l.push(e)}}removeCapability(e,t){if(!this.getComponent(e))throw Error('Cannot remove capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');this.hasCapability(e,t)?(t=`${t}`.toLowerCase(),ue(this.componentData.get(e).capabilities,t),ue(this.capabilityToComponentIds.get(t),e)):console.warn('Plugin "'+e+`doesn't have capability "`+t+'" to remove')}hasCapability(e,t){return t=`${t}`.toLowerCase(),this.componentData.has(e)&&this.componentData.get(e).capabilities.includes(t)}getComponent(e){let t;return(t=this.componentData.get(e))==null?void 0:t.component}getComponents(e,t){if(e=`${e}`.toLowerCase(),e=this.capabilityToComponentIds.get(e),!e)return[];const r=[];if(t){const l=[];e.forEach(p=>{l.push(this.componentData.get(p))}),l.sort(function(p,v){return p.weight-v.weight}),l.forEach(function(p){r.push(p.component)})}else e.forEach(l=>{r.push(this.componentData.get(l).component)});return r}};pn.Capability=Zr,function(e){e=e.ComponentWeight||(e.ComponentWeight={}),e[e.TOOLBOX_WEIGHT=0]="TOOLBOX_WEIGHT",e[e.FLYOUT_WEIGHT=1]="FLYOUT_WEIGHT",e[e.TRASHCAN_WEIGHT=2]="TRASHCAN_WEIGHT",e[e.ZOOM_CONTROLS_WEIGHT=3]="ZOOM_CONTROLS_WEIGHT"}(pn||(pn={})),pn.ComponentWeight;var tg=!1,Mc=`
.blocklySvg {
  background-color: #fff;
  outline: none;
  overflow: hidden;  /* IE overflows by default. */
  position: absolute;
  display: block;
}

.blocklyWidgetDiv {
  display: none;
  position: absolute;
  z-index: 99999;  /* big value for bootstrap3 compatibility */
}

.injectionDiv {
  height: 100%;
  position: relative;
  overflow: hidden;  /* So blocks in drag surface disappear at edges */
  touch-action: none;
  user-select: none;
  -webkit-user-select: none;
}

.blocklyNonSelectable {
  user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
}

.blocklyBlockCanvas.blocklyCanvasTransitioning,
.blocklyBubbleCanvas.blocklyCanvasTransitioning {
  transition: transform .5s;
}

.blocklyTooltipDiv {
  background-color: #ffffc7;
  border: 1px solid #ddc;
  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);
  color: #000;
  display: none;
  font: 9pt sans-serif;
  opacity: .9;
  padding: 2px;
  position: absolute;
  z-index: 100000;  /* big value for bootstrap3 compatibility */
}

.blocklyDropDownDiv {
  position: absolute;
  left: 0;
  top: 0;
  z-index: 1000;
  display: none;
  border: 1px solid;
  border-color: #dadce0;
  background-color: #fff;
  border-radius: 2px;
  padding: 4px;
  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);
}

.blocklyDropDownDiv.blocklyFocused {
  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);
}

.blocklyDropDownContent {
  max-height: 300px;  /* @todo: spec for maximum height. */
  overflow: auto;
  overflow-x: hidden;
  position: relative;
}

.blocklyDropDownArrow {
  position: absolute;
  left: 0;
  top: 0;
  width: 16px;
  height: 16px;
  z-index: -1;
  background-color: inherit;
  border-color: inherit;
}

.blocklyDropDownButton {
  display: inline-block;
  float: left;
  padding: 0;
  margin: 4px;
  border-radius: 4px;
  outline: none;
  border: 1px solid;
  transition: box-shadow .1s;
  cursor: pointer;
}

.blocklyArrowTop {
  border-top: 1px solid;
  border-left: 1px solid;
  border-top-left-radius: 4px;
  border-color: inherit;
}

.blocklyArrowBottom {
  border-bottom: 1px solid;
  border-right: 1px solid;
  border-bottom-right-radius: 4px;
  border-color: inherit;
}

.blocklyResizeSE {
  cursor: se-resize;
  fill: #aaa;
}

.blocklyResizeSW {
  cursor: sw-resize;
  fill: #aaa;
}

.blocklyResizeLine {
  stroke: #515A5A;
  stroke-width: 1;
}

.blocklyHighlightedConnectionPath {
  fill: none;
  stroke: #fc3;
  stroke-width: 4px;
}

.blocklyPathLight {
  fill: none;
  stroke-linecap: round;
  stroke-width: 1;
}

.blocklySelected>.blocklyPathLight {
  display: none;
}

.blocklyDraggable {
  cursor: grab;
  cursor: -webkit-grab;
}

.blocklyDragging {
  cursor: grabbing;
  cursor: -webkit-grabbing;
  /* Drag surface disables events to not block the toolbox, so we have to
   * reenable them here for the cursor values to work. */
  pointer-events: auto;
}

  /* Changes cursor on mouse down. Not effective in Firefox because of
     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */
.blocklyDraggable:active {
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

.blocklyDragging.blocklyDraggingDelete {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyDragging>.blocklyPath,
.blocklyDragging>.blocklyPathLight {
  fill-opacity: .8;
  stroke-opacity: .8;
}

.blocklyDragging>.blocklyPathDark {
  display: none;
}

.blocklyDisabled>.blocklyPath {
  fill-opacity: .5;
  stroke-opacity: .5;
}

.blocklyDisabled>.blocklyPathLight,
.blocklyDisabled>.blocklyPathDark {
  display: none;
}

.blocklyInsertionMarker>.blocklyPath,
.blocklyInsertionMarker>.blocklyPathLight,
.blocklyInsertionMarker>.blocklyPathDark {
  fill-opacity: .2;
  stroke: none;
}

.blocklyNonEditableText>text {
  pointer-events: none;
}

.blocklyFlyout {
  position: absolute;
  z-index: 20;
}

.blocklyText text {
  cursor: default;
}

.blocklyHidden {
  display: none;
}

.blocklyFieldDropdown:not(.blocklyHidden) {
  display: block;
}

.blocklyIconGroup {
  cursor: default;
}

.blocklyIconGroup:not(:hover),
.blocklyIconGroupReadonly {
  opacity: .6;
}

.blocklyIconShape {
  fill: #00f;
  stroke: #fff;
  stroke-width: 1px;
}

.blocklyIconSymbol {
  fill: #fff;
}

.blocklyMinimalBody {
  margin: 0;
  padding: 0;
  height: 100%;
}

.blocklyHtmlInput {
  border: none;
  border-radius: 4px;
  height: 100%;
  margin: 0;
  outline: none;
  padding: 0;
  width: 100%;
  text-align: center;
  display: block;
  box-sizing: border-box;
}

/* Remove the increase and decrease arrows on the field number editor */
input.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,
input.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

input[type=number] {
  -moz-appearance: textfield;
}

.blocklyMainBackground {
  stroke-width: 1;
  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */
}

.blocklyMutatorBackground {
  fill: #fff;
  stroke: #ddd;
  stroke-width: 1;
}

.blocklyFlyoutBackground {
  fill: #ddd;
  fill-opacity: .8;
}

.blocklyMainWorkspaceScrollbar {
  z-index: 20;
}

.blocklyFlyoutScrollbar {
  z-index: 30;
}

.blocklyScrollbarHorizontal,
.blocklyScrollbarVertical {
  position: absolute;
  outline: none;
}

.blocklyScrollbarBackground {
  opacity: 0;
  pointer-events: none;
}

.blocklyScrollbarHandle {
  fill: #ccc;
}

.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,
.blocklyScrollbarHandle:hover {
  fill: #bbb;
}

/* Darken flyout scrollbars due to being on a grey background. */
/* By contrast, workspace scrollbars are on a white background. */
.blocklyFlyout .blocklyScrollbarHandle {
  fill: #bbb;
}

.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,
.blocklyFlyout .blocklyScrollbarHandle:hover {
  fill: #aaa;
}

.blocklyInvalidInput {
  background: #faa;
}

.blocklyVerticalMarker {
  stroke-width: 3px;
  fill: rgba(255,255,255,.5);
  pointer-events: none;
}

.blocklyComputeCanvas {
  position: absolute;
  width: 0;
  height: 0;
}

.blocklyNoPointerEvents {
  pointer-events: none;
}

.blocklyContextMenu {
  border-radius: 4px;
  max-height: 100%;
}

.blocklyDropdownMenu {
  border-radius: 2px;
  padding: 0 !important;
}

.blocklyDropdownMenu .blocklyMenuItem {
  /* 28px on the left for icon or checkbox. */
  padding-left: 28px;
}

/* BiDi override for the resting state. */
.blocklyDropdownMenu .blocklyMenuItemRtl {
  /* Flip left/right padding for BiDi. */
  padding-left: 5px;
  padding-right: 28px;
}

.blocklyWidgetDiv .blocklyMenu {
  background: #fff;
  border: 1px solid transparent;
  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);
  font: normal 13px Arial, sans-serif;
  margin: 0;
  outline: none;
  padding: 4px 0;
  position: absolute;
  overflow-y: auto;
  overflow-x: hidden;
  max-height: 100%;
  z-index: 20000;  /* Arbitrary, but some apps depend on it... */
}

.blocklyWidgetDiv .blocklyMenu.blocklyFocused {
  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);
}

.blocklyDropDownDiv .blocklyMenu {
  background: inherit;  /* Compatibility with gapi, reset from goog-menu */
  border: inherit;  /* Compatibility with gapi, reset from goog-menu */
  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;
  outline: none;
  position: relative;  /* Compatibility with gapi, reset from goog-menu */
  z-index: 20000;  /* Arbitrary, but some apps depend on it... */
}

/* State: resting. */
.blocklyMenuItem {
  border: none;
  color: #000;
  cursor: pointer;
  list-style: none;
  margin: 0;
  /* 7em on the right for shortcut. */
  min-width: 7em;
  padding: 6px 15px;
  white-space: nowrap;
}

/* State: disabled. */
.blocklyMenuItemDisabled {
  color: #ccc;
  cursor: inherit;
}

/* State: hover. */
.blocklyMenuItemHighlight {
  background-color: rgba(0,0,0,.1);
}

/* State: selected/checked. */
.blocklyMenuItemCheckbox {
  height: 16px;
  position: absolute;
  width: 16px;
}

.blocklyMenuItemSelected .blocklyMenuItemCheckbox {
  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;
  float: left;
  margin-left: -24px;
  position: static;  /* Scroll with the menu. */
}

.blocklyMenuItemRtl .blocklyMenuItemCheckbox {
  float: right;
  margin-right: -24px;
}

.blocklyBlockDragSurface, .blocklyAnimationLayer {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: visible !important;
  z-index: 80;
  pointer-events: none;
}
`,wd={};wd.inject=Ve,wd.register=we;var Le=class{constructor(e,t){this.x=e,this.y=t}clone(){return new Le(this.x,this.y)}scale(e){return this.x*=e,this.y*=e,this}translate(e,t){return this.x+=e,this.y+=t,this}static equals(e,t){return e===t?!0:e&&t?e.x===t.x&&e.y===t.y:!1}static distance(e,t){const r=e.x-t.x;return e=e.y-t.y,Math.sqrt(r*r+e*e)}static magnitude(e){return Math.sqrt(e.x*e.x+e.y*e.y)}static difference(e,t){return new Le(e.x-t.x,e.y-t.y)}static sum(e,t){return new Le(e.x+t.x,e.y+t.y)}},Nc="http://www.w3.org/2000/svg",bi="http://www.w3.org/1999/xhtml",nr="http://www.w3.org/1999/xlink",Ji;(function(e){e[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE"})(Ji||(Ji={}));var Lr=null,ng=0,Cd=null,ds={HTML_NS:bi};ds.NodeType=Ji,ds.SVG_NS=Nc,ds.XLINK_NS=nr,ds.addClass=Fe,ds.createSvgElement=re,ds.getFastTextWidth=ns,ds.getFastTextWidthWithSizeString=Rn,ds.getTextWidth=Gs,ds.hasClass=En,ds.insertAfter=Cn,ds.measureFontMetrics=Kt,ds.removeClass=pt,ds.removeClasses=It,ds.removeNode=mt,ds.setCssTransform=$n,ds.startTextWidthCache=zn,ds.stopTextWidthCache=Jn;var oe=class{constructor(e){this.tagName=e}toString(){return this.tagName}};oe.ANIMATE=new oe("animate"),oe.CIRCLE=new oe("circle"),oe.CLIPPATH=new oe("clipPath"),oe.DEFS=new oe("defs"),oe.FECOMPOSITE=new oe("feComposite"),oe.FECOMPONENTTRANSFER=new oe("feComponentTransfer"),oe.FEFLOOD=new oe("feFlood"),oe.FEFUNCA=new oe("feFuncA"),oe.FEGAUSSIANBLUR=new oe("feGaussianBlur"),oe.FEPOINTLIGHT=new oe("fePointLight"),oe.FESPECULARLIGHTING=new oe("feSpecularLighting"),oe.FILTER=new oe("filter"),oe.FOREIGNOBJECT=new oe("foreignObject"),oe.G=new oe("g"),oe.IMAGE=new oe("image"),oe.LINE=new oe("line"),oe.PATH=new oe("path"),oe.PATTERN=new oe("pattern"),oe.POLYGON=new oe("polygon"),oe.RECT=new oe("rect"),oe.SVG=new oe("svg"),oe.TEXT=new oe("text"),oe.TSPAN=new oe("tspan");var Bt=class{constructor(e,t,r,l){this.top=e,this.bottom=t,this.left=r,this.right=l}clone(){return new Bt(this.top,this.bottom,this.left,this.right)}getHeight(){return this.bottom-this.top}getWidth(){return this.right-this.left}contains(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom}intersects(e){return this.left<=e.right&&this.right>=e.left&&this.bottom>=e.top&&this.top<=e.bottom}static equals(e,t){return e===t?!0:e&&t?e.top===t.top&&e.bottom===t.bottom&&e.left===t.left&&e.right===t.right:!1}static createFromPoint(e,t,r){const l=e.x;return e=e.y,new Bt(e,e+r,l,l+t)}},Jt=class{constructor(e,t){this.width=e,this.height=t}static equals(e,t){return e===t?!0:e&&t?e.width===t.width&&e.height===t.height:!1}static max(e,t){return new Jt(Math.max(e.width,t.width),Math.max(e.height,t.height))}static min(e,t){return new Jt(Math.min(e.width,t.width),Math.min(e.height,t.height))}},Xm={getSizeInternal:cs},$i={TEST_ONLY:Xm};$i.getBorderBox=ii,$i.getComputedStyle=jn,$i.getContainerOffsetToScrollInto=ec,$i.getPageOffset=Un,$i.getSize=Pn,$i.getViewportPageOffset=Rs,$i.scrollIntoContainerView=Ir;var Zm=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,Qm=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,Lc={XY_REGEX:Zm,XY_STYLE_REGEX:Qm},Io={TEST_ONLY:Lc};Io.getDocumentScroll=nc,Io.getInjectionDivXY=Ka,Io.getRelativeXY=xr,Io.getViewportBBox=tc,Io.screenToWsCoordinates=Tu,Io.wsToScreenCoordinates=Yo;var Fn=class{constructor(e,t,r,l,p){this.workspace=e,this.horizontal=t,this.oldHostMetrics=null,this.ratio=1,this.origin=new Le(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=!0,this.position=new Le(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=r||!1,this.margin=p!==void 0?p:Fn.DEFAULT_SCROLLBAR_MARGIN,e="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),l&&(e+=" "+l),this.outerSvg=re(oe.SVG,{class:e}),l=re(oe.G,{},this.outerSvg),this.svgBackground=re(oe.RECT,{class:"blocklyScrollbarBackground"},l),e=Math.floor((Fn.scrollbarThickness-5)/2),this.svgHandle=re(oe.RECT,{class:"blocklyScrollbarHandle",rx:e,ry:e},l),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),Cn(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),t?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=Ue(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=Ue(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){const e=Fn.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(e)),this.outerSvg.setAttribute("height",String(e)),this.svgHandle.setAttribute("height",String(e-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(e)),this.outerSvg.setAttribute("width",String(e)),this.svgHandle.setAttribute("width",String(e-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),wt(this.onMouseDownBarWrapper_),wt(this.onMouseDownHandleWrapper_),mt(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(e){return e=0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength)}setHandleLength(e){this.handleLength=e,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(e){return e=0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength-this.handleLength)}setHandlePosition(e){this.handlePosition=e,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(e){this.scrollbarLength=e,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(e,t){this.position.x=e,this.position.y=t,$n(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(e){!e&&(e=this.workspace.getMetrics(),!e)||this.oldHostMetrics&&Fn.metricsAreEquivalent(e,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(e):this.resizeVertical(e),this.oldHostMetrics=e,this.updateMetrics())}requiresViewResize(e){return this.oldHostMetrics?this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft||this.oldHostMetrics.absoluteTop!==e.absoluteTop:!0}resizeHorizontal(e){this.requiresViewResize(e)?this.resizeViewHorizontal(e):this.resizeContentHorizontal(e)}resizeViewHorizontal(e){var t=e.viewWidth-2*this.margin;this.pair&&(t-=Fn.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),t=e.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(t+=Fn.scrollbarThickness),this.setPosition(t,e.absoluteTop+e.viewHeight-Fn.scrollbarThickness-this.margin),this.resizeContentHorizontal(e)}resizeContentHorizontal(e){if(e.viewWidth>=e.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var t=this.scrollbarLength*e.viewWidth/e.scrollWidth;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollWidth-e.viewWidth;var r=this.scrollbarLength-this.handleLength;e=(e.viewLeft-e.scrollLeft)/t*r,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=r/t}}resizeVertical(e){this.requiresViewResize(e)?this.resizeViewVertical(e):this.resizeContentVertical(e)}resizeViewVertical(e){let t=e.viewHeight-2*this.margin;this.pair&&(t-=Fn.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),this.setPosition(this.workspace.RTL?e.absoluteLeft+this.margin:e.absoluteLeft+e.viewWidth-Fn.scrollbarThickness-this.margin,e.absoluteTop+this.margin),this.resizeContentVertical(e)}resizeContentVertical(e){if(e.viewHeight>=e.scrollHeight)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var t=this.scrollbarLength*e.viewHeight/e.scrollHeight;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollHeight-e.viewHeight;var r=this.scrollbarLength-this.handleLength;e=(e.viewTop-e.scrollTop)/t*r,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=r/t}}isVisible(){return this.isHandleVisible}setContainerVisible(e){const t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay_()}setVisible(e){if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.setVisibleInternal(e)}setVisibleInternal(e){const t=e!==this.isVisible();this.isHandleVisible=e,t&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(e){if(this.workspace.markFocused(),ft(),this.cleanUp(),ct(e))e.stopPropagation();else{var t=me(e,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());t=this.horizontal?t.x:t.y;var r=Ka(this.svgHandle);r=this.horizontal?r.x:r.y;var l=this.handlePosition,p=.95*this.handleLength;t<=r?l-=p:t>=r+this.handleLength&&(l+=p),this.setHandlePosition(this.constrainHandlePosition(l)),this.updateMetrics(),e.stopPropagation(),e.preventDefault()}}onMouseDownHandle(e){this.workspace.markFocused(),this.cleanUp(),ct(e)?e.stopPropagation():(this.startDragHandle=this.handlePosition,this.startDragMouse=this.horizontal?e.clientX:e.clientY,this.onMouseUpWrapper_=Ue(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=Ue(document,"pointermove",this,this.onMouseMoveHandle),e.stopPropagation(),e.preventDefault())}onMouseMoveHandle(e){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?e.clientX:e.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){ft(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(!0),this.onMouseUpWrapper_&&(wt(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(wt(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let e=this.handlePosition/(this.scrollbarLength-this.handleLength);return isNaN(e)&&(e=0),e}updateMetrics(){const e=this.getRatio_();this.horizontal?this.workspace.setMetrics({x:e}):this.workspace.setMetrics({y:e})}set(e,t){this.setHandlePosition(this.constrainHandlePosition(e*this.ratio)),(t||t===void 0)&&this.updateMetrics()}setOrigin(e,t){this.origin=new Le(e,t)}static metricsAreEquivalent(e,t){return e.viewWidth===t.viewWidth&&e.viewHeight===t.viewHeight&&e.viewLeft===t.viewLeft&&e.viewTop===t.viewTop&&e.absoluteTop===t.absoluteTop&&e.absoluteLeft===t.absoluteLeft&&e.scrollWidth===t.scrollWidth&&e.scrollHeight===t.scrollHeight&&e.scrollLeft===t.scrollLeft&&e.scrollTop===t.scrollTop}};Fn.scrollbarThickness=Kp?25:15,Fn.DEFAULT_SCROLLBAR_MARGIN=.5;var Sd={parseFromString:function(){throw Error("DOMParser was not found in the global scope and was not properly injected using injectDependencies")}},sg={serializeToString:function(){throw Error("XMLSerializer was not foundin the global scope and was not properly injected using injectDependencies")}},{document:Td,DOMParser:Bc,XMLSerializer:El}=globalThis;Bc&&(Sd=new Bc),El&&(sg=new El);var rg="https://developers.google.com/blockly/xml",ny=/[\x00-\x09\x0B\x0C\x0E-\x1F]/g,xo={NAME_SPACE:rg};xo.createElement=s.createElement$$module$build$src$core$utils$xml,xo.createTextNode=s.createTextNode$$module$build$src$core$utils$xml,xo.domToText=U,xo.injectDependencies=z,xo.textToDom=s.textToDom$$module$build$src$core$utils$xml;var kd="categoryToolbox",Il="flyoutToolbox",Rt;(function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"})(Rt||(Rt={}));var ig={hasCategoriesInternal:_e},qi={};qi.Position=Rt,qi.TEST_ONLY=ig,qi.convertFlyoutDefToJsonArray=pe,qi.convertToolboxDefToJson=j,qi.hasCategories=Ee,qi.isCategoryCollapsible=ae,qi.parseToolboxTree=Yt;var Br;(function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM"})(Br||(Br={}));var wa;(function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT"})(wa||(wa={}));var bs;(function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN"})(bs||(bs={}));var fr={};fr.bumpDirection=bs,fr.bumpPositionRect=an,fr.getCornerOppositeToolbox=Lt,fr.getStartPositionRect=on,fr.horizontalPosition=wa,fr.verticalPosition=Br;var Ls={width:96,height:124,url:"sprites.png"},og=class{constructor(e){this.workspace=e,this.id="zoomControls",this.boundEvents=[],this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=!1}createDom(){this.svgGroup=re(oe.G,{});const e=String(Math.random()).substring(2);return this.createZoomOutSvg(e),this.createZoomInSvg(e),this.workspace.isMovable()&&this.createZoomResetSvg(e),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:pn.ComponentWeight.ZOOM_CONTROLS_WEIGHT,capabilities:[pn.Capability.POSITIONABLE]}),this.initialized=!0}dispose(){this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&mt(this.svgGroup);for(const e of this.boundEvents)wt(e);this.boundEvents.length=0}getBoundingRectangle(){let e=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(e+=this.LARGE_SPACING+this.HEIGHT),new Bt(this.top,this.top+e,this.left,this.left+this.WIDTH)}position(e,t){if(this.initialized){var r=Lt(this.workspace,e),l=this.SMALL_SPACING+2*this.HEIGHT;if(this.zoomResetGroup&&(l+=this.LARGE_SPACING+this.HEIGHT),e=on(r,new Jt(this.WIDTH,l),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,e,this.workspace),r=r.vertical,t=an(e,this.MARGIN_VERTICAL,r===Br.TOP?bs.DOWN:bs.UP,t),r===Br.TOP){var p=this.SMALL_SPACING+this.HEIGHT,v;(v=this.zoomInGroup)==null||v.setAttribute("transform","translate(0, "+p+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(p+this.LARGE_SPACING+this.HEIGHT)+")")}else{v=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0;let G;(G=this.zoomInGroup)==null||G.setAttribute("transform","translate(0, "+v+")"),v=v+this.SMALL_SPACING+this.HEIGHT,(p=this.zoomOutGroup)==null||p.setAttribute("transform","translate(0, "+v+")")}this.top=t.top,this.left=t.left;var O;(O=this.svgGroup)==null||O.setAttribute("transform","translate("+this.left+","+this.top+")")}}createZoomOutSvg(e){this.zoomOutGroup=re(oe.G,{class:"blocklyZoom blocklyZoomOut"},this.svgGroup);const t=re(oe.CLIPPATH,{id:"blocklyZoomoutClipPath"+e},this.zoomOutGroup);re(oe.RECT,{width:32,height:32},t),re(oe.IMAGE,{width:Ls.width,height:Ls.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+e+")"},this.zoomOutGroup).setAttributeNS(nr,"xlink:href",this.workspace.options.pathToMedia+Ls.url),this.boundEvents.push(Ue(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1)))}createZoomInSvg(e){this.zoomInGroup=re(oe.G,{class:"blocklyZoom blocklyZoomIn"},this.svgGroup);const t=re(oe.CLIPPATH,{id:"blocklyZoominClipPath"+e},this.zoomInGroup);re(oe.RECT,{width:32,height:32},t),re(oe.IMAGE,{width:Ls.width,height:Ls.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+e+")"},this.zoomInGroup).setAttributeNS(nr,"xlink:href",this.workspace.options.pathToMedia+Ls.url),this.boundEvents.push(Ue(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1)))}zoom(e,t){this.workspace.markFocused(),this.workspace.zoomCenter(e),this.fireZoomEvent(),ft(),t.stopPropagation(),t.preventDefault()}createZoomResetSvg(e){this.zoomResetGroup=re(oe.G,{class:"blocklyZoom blocklyZoomReset"},this.svgGroup);const t=re(oe.CLIPPATH,{id:"blocklyZoomresetClipPath"+e},this.zoomResetGroup);re(oe.RECT,{width:32,height:32},t),re(oe.IMAGE,{width:Ls.width,height:Ls.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+e+")"},this.zoomResetGroup).setAttributeNS(nr,"xlink:href",this.workspace.options.pathToMedia+Ls.url),this.boundEvents.push(Ue(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this)))}resetZoom(e){this.workspace.markFocused();const t=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(t),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),ft(),e.stopPropagation(),e.preventDefault()}fireZoomEvent(){const e=new(Ce(fe.CLICK))(null,this.workspace.id,"zoom_controls");ee(e)}};we(`
.blocklyZoom>image, .blocklyZoom>svg>image {
  opacity: .4;
}

.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {
  opacity: .6;
}

.blocklyZoom>image:active, .blocklyZoom>svg>image:active {
  opacity: .8;
}
`);var eb=100,tb=75,nb=50,sb=25,sy={BLOCKS:nb,PROCEDURES:tb,VARIABLES:eb,WORKSPACE_COMMENTS:sb},ag={};ag.register=_n,ag.unregister=Tt;var rb=class{constructor(){this.priority=sb}save(e){const t=[];for(const r of e.getTopComments())(e=In(r,{addCoordinates:!0,saveIds:!0}))&&t.push(e);return t.length?t:null}load(e,t){for(const r of e)ss(r,t,{recordUndo:se()})}clear(e){for(const t of e.getTopComments())t.dispose()}};_n("workspaceComments",new rb);var Ed={};Ed.WorkspaceCommentSerializer=rb,Ed.append=ss,Ed.save=In;var lg={};lg.register=Js,lg.unregister=Xo;var Id=class{paste(e,t,r){e=e.commentState,r&&(e.x=r.x,e.y=r.y),s.disable$$module$build$src$core$events$utils();let l;try{l=ss(e,t),Dr(l)}finally{s.enable$$module$build$src$core$events$utils()}return l?(te()&&ee(new(Ce(fe.COMMENT_CREATE))(l)),s.setSelected$$module$build$src$core$common(l),l):null}};Id.TYPE="workspace-comment",Js(Id.TYPE,new Id);var cg;cg=28,s.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:cg,connectingSnapRadius:cg,currentConnectionPreference:8,bumpDelay:250},s.config$$module$build$src$core$config;var ib="aria-",ob="role",Pr;(function(e){e.GRID="grid",e.GRIDCELL="gridcell",e.GROUP="group",e.LISTBOX="listbox",e.MENU="menu",e.MENUITEM="menuitem",e.MENUITEMCHECKBOX="menuitemcheckbox",e.OPTION="option",e.PRESENTATION="presentation",e.ROW="row",e.TREE="tree",e.TREEITEM="treeitem"})(Pr||(Pr={}));var as;(function(e){e.ACTIVEDESCENDANT="activedescendant",e.COLCOUNT="colcount",e.DISABLED="disabled",e.EXPANDED="expanded",e.INVALID="invalid",e.LABEL="label",e.LABELLEDBY="labelledby",e.LEVEL="level",e.ORIENTATION="orientation",e.POSINSET="posinset",e.ROWCOUNT="rowcount",e.SELECTED="selected",e.SETSIZE="setsize",e.VALUEMAX="valuemax",e.VALUEMIN="valuemin"})(as||(as={}));var Pc={};Pc.Role=Pr,Pc.State=as,Pc.setRole=Ts,Pc.setState=tn;var ug=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.pointerLeaveHandler=this.pointerEnterHandler=this.clickHandler=this.pointerMoveHandler=this.highlightedItem=this.openingCoords=null}addChild(e){this.menuItems.push(e)}render(e){const t=document.createElement("div");t.className="blocklyMenu goog-menu blocklyNonSelectable",t.tabIndex=0,this.roleName&&Ts(t,this.roleName),this.element=t;for(let r=0,l;l=this.menuItems[r];r++)t.appendChild(l.createDom());return this.pointerMoveHandler=Ue(t,"pointermove",this,this.handlePointerMove,!0),this.clickHandler=Ue(t,"pointerup",this,this.handleClick,!0),this.pointerEnterHandler=Ue(t,"pointerenter",this,this.handlePointerEnter,!0),this.pointerLeaveHandler=Ue(t,"pointerleave",this,this.handlePointerLeave,!0),this.onKeyDownHandler=Ue(t,"keydown",this,this.handleKeyEvent),e.appendChild(t),t}getElement(){return this.element}focus(){const e=this.getElement();e&&(e.focus({preventScroll:!0}),Fe(e,"blocklyFocused"))}blur(){const e=this.getElement();e&&(e.blur(),pt(e,"blocklyFocused"))}setRole(e){this.roleName=e}dispose(){this.pointerMoveHandler&&(wt(this.pointerMoveHandler),this.pointerMoveHandler=null),this.clickHandler&&(wt(this.clickHandler),this.clickHandler=null),this.pointerEnterHandler&&(wt(this.pointerEnterHandler),this.pointerEnterHandler=null),this.pointerLeaveHandler&&(wt(this.pointerLeaveHandler),this.pointerLeaveHandler=null),this.onKeyDownHandler&&(wt(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let e=0,t;t=this.menuItems[e];e++)t.dispose();this.element=null}getMenuItem(e){const t=this.getElement();for(;e&&e!==t;){if(e.classList.contains("blocklyMenuItem")){for(let r=0,l;l=this.menuItems[r];r++)if(l.getElement()===e)return l}e=e.parentElement}return null}setHighlighted(e){var t=this.highlightedItem;if(t&&(t.setHighlighted(!1),this.highlightedItem=null),e){e.setHighlighted(!0),this.highlightedItem=e,t=this.getElement();const r=t==null?void 0:t.parentElement,l=e.getElement();r&&l&&(Ir(l,r),tn(t,as.ACTIVEDESCENDANT,e.getId()))}}highlightNext(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e,1)}highlightPrevious(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(0>e?this.menuItems.length:e,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(e,t){e+=t;let r;for(;r=this.menuItems[e];){if(r.isEnabled()){this.setHighlighted(r);break}e+=t}}handlePointerMove(e){Math.max(Math.abs(e.movementX),Math.abs(e.movementY))!==0&&(e=this.getMenuItem(e.target))&&(e.isEnabled()?this.highlightedItem!==e&&this.setHighlighted(e):this.setHighlighted(null))}handleClick(e){const t=this.openingCoords;if(this.openingCoords=null,t&&typeof e.clientX=="number"){const r=new Le(e.clientX,e.clientY);if(1>Le.distance(t,r))return}(e=this.getMenuItem(e.target))&&e.performAction()}handlePointerEnter(e){this.focus()}handlePointerLeave(e){this.getElement()&&this.setHighlighted(null)}handleKeyEvent(e){if(this.menuItems.length&&!(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){var t=this.highlightedItem;switch(e.key){case"Enter":case" ":t&&t.performAction();break;case"ArrowUp":this.highlightPrevious();break;case"ArrowDown":this.highlightNext();break;case"PageUp":case"Home":this.highlightFirst();break;case"PageDown":case"End":this.highlightLast();break;default:return}e.preventDefault(),e.stopPropagation()}}getSize(){const e=this.getElement(),t=Pn(e);return t.height=e.scrollHeight,t}},xd=class{constructor(e,t){this.content=e,this.opt_value=t,this.enabled=!0,this.element=null,this.rightToLeft=!1,this.roleName=null,this.highlight=this.checked=this.checkable=!1,this.actionHandler=null}createDom(){const e=document.createElement("div");e.id=C(),this.element=e,e.className="blocklyMenuItem goog-menuitem "+(this.enabled?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl goog-menuitem-rtl ":"");const t=document.createElement("div");if(t.className="blocklyMenuItemContent goog-menuitem-content",this.checkable){var r=document.createElement("div");r.className="blocklyMenuItemCheckbox goog-menuitem-checkbox",t.appendChild(r)}return r=this.content,typeof this.content=="string"&&(r=document.createTextNode(this.content)),t.appendChild(r),e.appendChild(t),this.roleName&&Ts(e,this.roleName),tn(e,as.SELECTED,this.checkable&&this.checked||!1),tn(e,as.DISABLED,!this.enabled),e}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){let e;return(e=this.opt_value)!=null?e:null}setRightToLeft(e){this.rightToLeft=e}setRole(e){this.roleName=e}setCheckable(e){this.checkable=e}setChecked(e){this.checked=e}setHighlighted(e){this.highlight=e;const t=this.getElement();t&&this.isEnabled()&&(e?(Fe(t,"blocklyMenuItemHighlight"),Fe(t,"goog-menuitem-highlight")):(pt(t,"blocklyMenuItemHighlight"),pt(t,"goog-menuitem-highlight")))}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}performAction(){this.isEnabled()&&this.actionHandler&&this.actionHandler(this)}onAction(e,t){this.actionHandler=e.bind(t)}},jc="_TEMP_COLLAPSED_INPUT",Dd="_TEMP_COLLAPSED_FIELD",Bs="MANUALLY_DISABLED",ry={COLLAPSED_FIELD_NAME:Dd,COLLAPSED_INPUT_NAME:jc,MANUALLY_DISABLED:Bs};(function(e){e[e.VALUE=1]="VALUE",e[e.STATEMENT=3]="STATEMENT",e[e.DUMMY=5]="DUMMY",e[e.CUSTOM=6]="CUSTOM",e[e.END_ROW=7]="END_ROW"})(s.inputTypes$$module$build$src$core$inputs$input_types||(s.inputTypes$$module$build$src$core$inputs$input_types={})),s.inputTypes$$module$build$src$core$inputs$input_types;var Ad=new Set,dg=new WeakSet,sr=new WeakMap,xl=null,hg=null,ab=0,Fc={};Fc.finishQueuedRenders=rs,Fc.queueRender=Oi,Fc.triggerQueuedRenders=Ms;var lb=function(e,t){window.alert(e),t&&t()},cb=function(e,t){t(window.confirm(e))},ub=function(e,t,r){r(window.prompt(e,t))},db={confirmInternal:Qo},Yi={TEST_ONLY:db};Yi.alert=Mi,Yi.confirm=Ja,Yi.prompt=sc,Yi.setAlert=ku,Yi.setConfirm=Nh,Yi.setPrompt=Xf;var pg,hb;s.Msg$$module$build$src$core$msg=Object.create(null),pg=function(e){Object.keys(e).forEach(function(t){s.Msg$$module$build$src$core$msg[t]=e[t]})},hb={Msg:s.Msg$$module$build$src$core$msg,setLocale:pg};var zc=class extends ba{constructor(e){super(),this.isBlank=typeof e>"u",e&&(this.varId=e.getId(),this.workspaceId=e.workspace.id)}toJson(){const e=super.toJson();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");return e.varId=this.varId,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new zc),t.varId=e.varId,t}},gg=class extends zc{constructor(e){super(e),this.type=fe.VAR_CREATE,e&&(this.varType=e.type,this.varName=e.name)}toJson(){const e=super.toJson();if(this.varType===void 0)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new gg),t.varType=e.varType,t.varName=e.varName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");e?t.createVariable(this.varName,this.varType,this.varId):t.deleteVariableById(this.varId)}};i(Be.EVENT,fe.VAR_CREATE,gg);var Uc=class{constructor(e,t,r,l){this.workspace=e,this.name=t,this.type=r||"",this.id=l||E()}getId(){return this.id}static compareByName(e,t){return e.name.localeCompare(t.name,void 0,{sensitivity:"base"})}},fg="VARIABLE",mg="ijkmnopqrstuvwxyzabcdefgh",pb={generateUniqueNameInternal:Zf},$s={CATEGORY_NAME:fg,TEST_ONLY:pb,VAR_LETTER_OPTIONS:mg};$s.allDeveloperVariables=s.allDeveloperVariables$$module$build$src$core$variables,$s.allUsedVarModels=s.allUsedVarModels$$module$build$src$core$variables,$s.createVariableButtonHandler=qa,$s.flyoutCategory=rc,$s.flyoutCategoryBlocks=Bh,$s.generateUniqueName=Ph,$s.generateUniqueNameFromOptions=ic,$s.generateVariableFieldDom=ta,$s.getAddedVariables=ac,$s.getOrCreateVariablePackage=s.getOrCreateVariablePackage$$module$build$src$core$variables,$s.getVariable=s.getVariable$$module$build$src$core$variables,$s.nameUsedWithAnyType=jh,$s.nameUsedWithConflictingParam=oc,$s.promptName=Iu,$s.renameVariable=s.renameVariable$$module$build$src$core$variables;var Dl=class extends Error{},gb=class extends Dl{constructor(e){super("Expected to find a 'type' property, defining the block type"),this.state=e}},Wc=class extends Dl{constructor(e,t,r){super(`The block ${t.toDevString()} is missing a(n) ${e}
connection`),this.block=t,this.state=r}},fb=class extends Dl{constructor(e,t,r,l){super(`The block ${r.toDevString()} could not connect its
${t} to its parent, because: ${e}`),this.childBlock=r,this.childState=l}},mb=class extends Dl{constructor(e){super(`Encountered a real block which is defined as a child of a shadow
block. It is an invariant of Blockly that shadow blocks only have shadow
children`),this.state=e}},bb=class extends Dl{constructor(e,t,r){super(`Cannot add an icon of type '${e}' to the block ${t.toDevString()}, because there is no icon registered with type '${e}'. Make sure that all of your icons have been registered.`),this.block=t,this.state=r}},Ca={};Ca.BadConnectionCheck=fb,Ca.DeserializationError=Dl,Ca.MissingBlockType=gb,Ca.MissingConnection=Wc,Ca.RealChildOfShadow=mb,Ca.UnregisteredIcon=bb;var $b=class{constructor(){this.priority=nb}save(e){const t=[];for(const r of e.getTopBlocks(!1))(e=Qt(r,{addCoordinates:!0,doFullSerialization:!1}))&&t.push(e);return t.length?{languageVersion:0,blocks:t}:null}load(e,t){e=e.blocks;for(const r of e)Ni(r,t,{recordUndo:se()})}clear(e){for(const t of e.getTopBlocks(!1))t.dispose(!1)}};_n("blocks",new $b);var Hc={};Hc.BlockSerializer=$b,Hc.append=Ni,Hc.appendInternal=Wn,Hc.save=Qt;var Qn=class{constructor(e){this.name=e}toString(){return this.name}equals(e){return this.name===e.toString()}};Qn.MUTATOR=new Qn("mutator"),Qn.WARNING=new Qn("warning"),Qn.COMMENT=new Qn("comment");var Sa=class extends ba{constructor(e){super(),this.isBlank=!e,e&&(this.blockId=e.id,this.workspaceId=e.workspace.id)}toJson(){const e=super.toJson();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.blockId=this.blockId,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Sa),t.blockId=e.blockId,t}},Xi=class extends Sa{constructor(e,t,r,l,p){super(e),this.type=fe.BLOCK_CHANGE,e&&(this.element=t,this.name=r||void 0,this.oldValue=l,this.newValue=p)}toJson(){const e=super.toJson();if(!this.element)throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson");return e.element=this.element,e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,this.disabledReason&&(e.disabledReason=this.disabledReason),e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Xi),t.element=e.element,t.name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,e.disabledReason!==void 0&&(t.disabledReason=e.disabledReason),t}setDisabledReason(e){if(this.element!=="disabled")throw Error('Cannot set the disabled reason for a BlockChange event if the element is not "disabled".');this.disabledReason=e}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(t=t.getBlockById(this.blockId),!t)throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");const r=t.getIcon(Qn.MUTATOR);switch(r&&Ya(r)&&r.bubbleIsVisible()&&r.setBubbleVisible(!1),e=e?this.newValue:this.oldValue,this.element){case"field":(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name);break;case"comment":t.setCommentText(e||null);break;case"collapsed":t.setCollapsed(!!e);break;case"disabled":var l;t.setDisabledReason(!!e,(l=this.disabledReason)!=null?l:Bs);break;case"inline":t.setInputsInline(!!e);break;case"mutation":l=Xi.getExtraBlockState_(t),t.loadExtraState?t.loadExtraState(JSON.parse(e||"{}")):t.domToMutation&&t.domToMutation(s.textToDom$$module$build$src$core$utils$xml(e||"<mutation/>")),ee(new Xi(t,"mutation",null,l,e));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(e){return e.saveExtraState?(e=e.saveExtraState(!0))?JSON.stringify(e):"":e.mutationToDom&&(e=e.mutationToDom())?ci(e):""}};i(Be.EVENT,fe.BLOCK_CHANGE,Xi);var Vc={};Vc.clamp=na,Vc.toDegrees=cm,Vc.toRadians=Ns;var Od=16,vb=1,yb=12,bg=16,Rd=.25,$g=null,Ta=null,Al="",ka="",ln,Zi,Ea,vg=null,Do=null,_b=null,yg={getBoundsInfo:function(){const e=Un(vg),t=Pn(vg);return{left:e.x,right:e.x+t.width,top:e.y,bottom:e.y+t.height,width:t.width,height:t.height}},getPositionMetrics:function(e,t,r,l){const p=yg.getBoundsInfo(),v=Pn(ln);return t+v.height<p.bottom?Za(e,t,p,v):l-v.height>p.top?bo(r,l,p,v):t+v.height<document.documentElement.clientHeight?Za(e,t,p,v):l-v.height>document.documentElement.clientTop?bo(r,l,p,v):dm(e,p,v)}},Is={ANIMATION_TIME:Rd,ARROW_HORIZONTAL_PADDING:yb,ARROW_SIZE:Od,BORDER_SIZE:vb,PADDING_Y:bg,TEST_ONLY:yg};Is.clearContent=Kr,Is.createDom=ai,Is.getContentDiv=wn,Is.getOwner=cc,Is.getPositionX=Qa,Is.hide=tl,Is.hideIfOwner=el,Is.hideWithoutAnimation=Jr,Is.isVisible=Ru,Is.repositionForWindowResize=hc,Is.setBoundsElement=Xa,Is.setColour=uc,Is.show=Ou,Is.showPositionedByBlock=um,Is.showPositionedByField=dc;var Gc=class{constructor(e){this.workspace=e,this.cursorSvg=this.cursor=null,this.markers=new Map,this.markerSvg=null}registerMarker(e,t){this.markers.has(e)&&this.unregisterMarker(e),t.setDrawer(this.workspace.getRenderer().makeMarkerDrawer(this.workspace,t)),this.setMarkerSvg(t.getDrawer().createDom()),this.markers.set(e,t)}unregisterMarker(e){const t=this.markers.get(e);if(t)t.dispose(),this.markers.delete(e);else throw Error("Marker with ID "+e+" does not exist. Can only unregister markers that exist.")}getCursor(){return this.cursor}getMarker(e){return this.markers.get(e)||null}setCursor(e){this.cursor&&this.cursor.getDrawer()&&this.cursor.getDrawer().dispose(),(this.cursor=e)&&(e=this.workspace.getRenderer().makeMarkerDrawer(this.workspace,this.cursor),this.cursor.setDrawer(e),this.setCursorSvg(this.cursor.getDrawer().createDom()))}setCursorSvg(e){e?(this.workspace.getBlockCanvas().appendChild(e),this.cursorSvg=e):this.cursorSvg=null}setMarkerSvg(e){e?this.workspace.getBlockCanvas()&&(this.cursorSvg?this.workspace.getBlockCanvas().insertBefore(e,this.cursorSvg):this.workspace.getBlockCanvas().appendChild(e)):this.markerSvg=null}updateMarkers(){this.workspace.keyboardAccessibilityMode&&this.cursorSvg&&this.workspace.getCursor().draw()}dispose(){const e=Object.keys(this.markers);for(let t=0,r;r=e[t];t++)this.unregisterMarker(r);this.markers.clear(),this.cursor&&(this.cursor.dispose(),this.cursor=null)}};Gc.LOCAL_MARKER="local_marker_1";var Ol={};Ol.commonWordPrefix=Yh,Ol.commonWordSuffix=Mu,Ol.isNumber=s.isNumber$$module$build$src$core$utils$string,Ol.shortestStringLength=sa,Ol.wrap=s.wrap$$module$build$src$core$utils$string;var Md=void 0,Kc=!1,Rl=!1,wb=50,Cb=0,Ia=0,_g=0,wg=0,mr=null,Ml=null,Cg=0,Sg=10,Sb=10,Tb=750,xa=5,es=null,br={HOVER_MS:Tb,LIMIT:wb,MARGINS:xa,OFFSET_X:Cg,OFFSET_Y:Sg,RADIUS_OK:Sb};br.bindMouseEvents=rl,br.block=tp,br.createDom=$o,br.dispose=il,br.getCustomTooltip=hm,br.getDiv=gm,br.getTooltipOfObject=sl,br.hide=Li,br.isVisible=pm,br.setCustomTooltip=Zh,br.unbindMouseEvents=Nu,br.unblock=np;var Tg=.45,kg=.65,kb={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},jr={};jr.blend=et,jr.getHsvSaturation=rp,jr.getHsvValue=ip,jr.hexToRgb=De,jr.hsvToHex=be,jr.hueToHex=xt,jr.names=kb,jr.parse=Or,jr.rgbToHex=ie,jr.setHsvSaturation=mm,jr.setHsvValue=bm;var Jc={};Jc.checkMessageReferences=Bu,Jc.parseBlockColour=ol,Jc.replaceMessageReferences=kt,Jc.tokenizeInterpolation=qn;var vn=class{constructor(e,t,r){this.DEFAULT_VALUE=null,this.name=void 0,this.constants_=this.mouseDownWrapper=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg=this.cursorSvg=this.tooltip=this.validator_=null,this.disposed=!1,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=!0,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=!0,this.SERIALIZABLE=!1,this.CURSOR="",this.value_="DEFAULT_VALUE"in new.target.prototype?new.target.prototype.DEFAULT_VALUE:this.DEFAULT_VALUE,this.size_=new Jt(0,0),e!==vn.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){e.tooltip&&this.setTooltip(kt(e.tooltip))}setSourceBlock(e){if(this.sourceBlock_)throw Error("Field already bound to a block");this.sourceBlock_=e}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){this.fieldGroup_||(this.fieldGroup_=re(oe.G,{}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip),this.bindEvents_(),this.initModel(),this.applyColour())}initView(){this.createBorderRect_(),this.createTextElement_()}initModel(){}isFullBlockField(){return!this.borderRect_}createBorderRect_(){this.borderRect_=re(oe.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=re(oe.TEXT,{class:"blocklyText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){const e=this.getClickTarget_();if(!e)throw Error("A click target has not been set.");rl(e),this.mouseDownWrapper=Ue(e,"pointerdown",this,this.onMouseDown_)}fromXml(e){this.setValue(e.textContent)}toXml(e){return e.textContent=this.getValue(),e}saveState(e){return e=this.saveLegacyState(vn),e!==null?e:this.getValue()}loadState(e){this.loadLegacyState(vn,e)||this.setValue(e)}saveLegacyState(e){return e.prototype.saveState===this.saveState&&e.prototype.toXml!==this.toXml?(e=s.createElement$$module$build$src$core$utils$xml("field"),e.setAttribute("name",this.name||""),U(this.toXml(e)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(e,t){return e.prototype.loadState===this.loadState&&e.prototype.fromXml!==this.fromXml?(this.fromXml(s.textToDom$$module$build$src$core$utils$xml(t)),!0):!1}dispose(){el(this),nn(this);let e;(e=this.getSourceBlock())!=null&&e.isDeadOrDying()||mt(this.fieldGroup_),this.disposed=!0}updateEditable(){const e=this.fieldGroup_,t=this.getSourceBlock();this.EDITABLE&&e&&t&&(this.enabled_&&t.isEditable()?(Fe(e,"blocklyEditableText"),pt(e,"blocklyNonEditableText"),e.style.cursor=this.CURSOR):(Fe(e,"blocklyNonEditableText"),pt(e,"blocklyEditableText"),e.style.cursor=""))}setEnabled(e){this.enabled_=e,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==vn.prototype.showEditor_}isClickableInFlyout(e){return!e}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let e=!1;return this.name&&(this.SERIALIZABLE?e=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),e=!0)),e}isVisible(){return this.visible_}setVisible(e){if(this.visible_!==e){this.visible_=e;var t=this.fieldGroup_;t&&(t.style.display=e?"block":"none")}}setValidator(e){this.validator_=e}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(!this.borderRect_)throw Error(`The border rectangle is ${this.borderRect_}.`);return this.borderRect_}getTextElement(){if(!this.textElement_)throw Error(`The text element is ${this.textElement_}.`);return this.textElement_}getTextContent(){if(!this.textContent_)throw Error(`The text content is ${this.textContent_}.`);return this.textContent_}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(e){this.isClickable()&&this.showEditor_(e)}showEditor_(e){}repositionForWindowResize(){return!1}updateSize_(e){const t=this.getConstants();e=e!==void 0?e:this.isFullBlockField()?0:this.getConstants().FIELD_BORDER_RECT_X_PADDING;let r=2*e,l=t.FIELD_TEXT_HEIGHT,p=0;this.textElement_&&(p=ns(this.textElement_,t.FIELD_TEXT_FONTSIZE,t.FIELD_TEXT_FONTWEIGHT,t.FIELD_TEXT_FONTFAMILY),r+=p),this.isFullBlockField()||(l=Math.max(l,t.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=l,this.size_.width=r,this.positionTextElement_(e,p),this.positionBorderRect_()}positionTextElement_(e,t){if(this.textElement_){var r=this.getConstants(),l=this.size_.height/2,p;this.textElement_.setAttribute("x",String((p=this.getSourceBlock())!=null&&p.RTL?this.size_.width-t-e:e)),this.textElement_.setAttribute("y",String(r.FIELD_TEXT_BASELINE_CENTER?l:l-r.FIELD_TEXT_HEIGHT/2+r.FIELD_TEXT_BASELINE))}}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",String(this.size_.width)),this.borderRect_.setAttribute("height",String(this.size_.height)),this.borderRect_.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.borderRect_.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}getSize(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=!1):this.visible_&&this.size_.width===0&&(this.render_(),this.size_.width!==0&&console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead.")),this.size_):new Jt(0,0)}getScaledBBox(){let e;var t=this.getSourceBlock();if(!t)throw new Gn;if(this.isFullBlockField()){var r=this.sourceBlock_.getHeightWidth();const l=t.workspace.scale;e=this.getAbsoluteXY_(),t=(r.width+1)*l,r=(r.height+1)*l,Zp?(e.x+=1.5*l,e.y+=1.5*l):(e.x-=.5*l,e.y-=.5*l)}else r=this.borderRect_.getBoundingClientRect(),e=Un(this.borderRect_),t=r.width,r=r.height;return new Bt(e.y,e.y+r,e.x,e.x+t)}onLocationChange(e){}getDisplayText_(){let e=this.getText();return e?(e.length>this.maxDisplayLength&&(e=e.substring(0,this.maxDisplayLength-2)+""),e=e.replace(/\s/g,vn.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(e+=""),e):vn.NBSP}getText(){const e=this.getText_();return String(e!==null?e:this.getValue())}getText_(){return null}markDirty(){this.isDirty_=!0,this.constants_=null}forceRerender(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&this.sourceBlock_.queueRender()}setValue(e,t=!0){if(e!==null){var r=s.getGroup$$module$build$src$core$events$utils();r||s.setGroup$$module$build$src$core$events$utils(!0);try{const Ie=this.doClassValidation_(e),Qe=this.processValidation(e,Ie,t);if(!(Qe instanceof Error)){var l,p=(l=this.getValidator())==null?void 0:l.call(this,Qe),v=this.processValidation(Qe,p,t);if(!(v instanceof Error)){var O=this.sourceBlock_;if(!O||!O.disposed){var G=this.getValue();G===v?this.doValueUpdate_(v):(this.doValueUpdate_(v),t&&O&&te()&&ee(new(Ce(fe.BLOCK_CHANGE))(O,"field",this.name||null,G,v)),this.isDirty_&&this.forceRerender())}}}}finally{s.setGroup$$module$build$src$core$events$utils(r)}}}processValidation(e,t,r){return t===null?(this.doValueInvalid_(e,r),this.isDirty_&&this.forceRerender(),Error()):t===void 0?e:t}getValue(){return this.value_}doClassValidation_(e){return e??null}doValueUpdate_(e){this.value_=e,this.isDirty_=!0}doValueInvalid_(e,t){}onMouseDown_(e){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(e=this.sourceBlock_.workspace.getGesture(e))&&e.setStartField(this)}setTooltip(e){e||e===""||(e=this.sourceBlock_);const t=this.getClickTarget_();t?t.tooltip=e:this.tooltip=e}getTooltip(){const e=this.getClickTarget_();return sl(e||{tooltip:this.tooltip})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return Un(this.getClickTarget_())}referencesVariables(){return!1}refreshVariableName(){}getParentInput(){let e=null;const t=this.getSourceBlock();if(!t)throw new Gn;const r=t.inputList;for(let l=0;l<t.inputList.length;l++){const p=r[l],v=p.fieldRow;for(let O=0;O<v.length;O++)if(v[O]===this){e=p;break}}return e}getFlipRtl(){return!1}isTabNavigable(){return!1}onShortcut(e){return!1}setCursorSvg(e){if(e){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(e),this.cursorSvg=e}else this.cursorSvg=null}setMarkerSvg(e){if(e){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(e),this.markerSvg=e}else this.markerSvg=null}updateMarkers_(){var e=this.getSourceBlock();if(!e)throw new Gn;e=e.workspace,e.keyboardAccessibilityMode&&this.cursorSvg&&e.getCursor().draw(),e.keyboardAccessibilityMode&&this.markerSvg&&e.getMarker(Gc.LOCAL_MARKER).draw()}static fromJson(e){throw Error("Attempted to instantiate a field from the registry that hasn't defined a 'fromJson' method.")}};vn.NBSP="",vn.SKIP_SETUP=Symbol("SKIP_SETUP");var Gn=class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}},Nl=null,Eg=null,Da=null,Nd="blocklyWidgetDiv",Aa="",Oa="",$r,Fr={};Fr.createDom=op,Fr.getDiv=us,Fr.hide=Pi,Fr.hideIfOwner=nn,Fr.hideIfOwnerIsInWorkspace=gc,Fr.isVisible=al,Fr.positionWithAnchor=ll,Fr.repositionForWindowResize=cl,Fr.show=Bi,Fr.testOnly_setDiv=pc;var qc=null,Ig={},Yc=null,Ra={};Ra.callbackFactory=s.callbackFactory$$module$build$src$core$contextmenu,Ra.dispose=oa,Ra.getCurrentBlock=ji,Ra.hide=hl,Ra.setCurrentBlock=ul,Ra.show=dl;var zt=class{constructor(){this.registeredItems=new Map,this.reset()}reset(){this.registeredItems.clear()}register(e){if(this.registeredItems.has(e.id))throw Error('Menu item with ID "'+e.id+'" is already registered.');this.registeredItems.set(e.id,e)}unregister(e){if(!this.registeredItems.has(e))throw Error('Menu item with ID "'+e+'" not found.');this.registeredItems.delete(e)}getItem(e){let t;return(t=this.registeredItems.get(e))!=null?t:null}getContextMenuOptions(e,t){const r=[];for(const p of this.registeredItems.values())if(e===p.scopeType){var l=p.preconditionFn(t);l!=="hidden"&&(l={text:typeof p.displayText=="function"?p.displayText(t):p.displayText,enabled:l==="enabled",callback:p.callback,scope:t,weight:p.weight},r.push(l))}return r.sort(function(p,v){return p.weight-v.weight}),r}};(function(e){var t=e.ScopeType||(e.ScopeType={});t.BLOCK="block",t.WORKSPACE="workspace",t.COMMENT="comment",e.registry=new e})(zt||(zt={})),zt.ScopeType;var Ao=50,Ma=100,Ld={BLOCK:Ao,BUBBLE:Ma},Eb=class{constructor(e){this.comment=e,this.startLoc=null,this.inGroup=!1,this.workspace=e.workspace}isMovable(){return this.comment.isOwnMovable()&&!this.comment.isDeadOrDying()&&!this.workspace.options.readOnly}startDrag(){(this.inGroup=!!s.getGroup$$module$build$src$core$events$utils())||s.setGroup$$module$build$src$core$events$utils(!0),this.fireDragStartEvent(),this.startLoc=this.comment.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1);let e;(e=this.workspace.getLayerManager())==null||e.moveToDragLayer(this.comment),this.comment.setDragging(!0)}drag(e){this.comment.moveDuringDrag(e)}endDrag(){this.fireDragEndEvent(),this.fireMoveEvent();let e;(e=this.workspace.getLayerManager())==null||e.moveOffDragLayer(this.comment,Ao),this.comment.setDragging(!1),this.comment.snapToGrid(),this.workspace.setResizesEnabled(!0),this.inGroup||s.setGroup$$module$build$src$core$events$utils(!1)}fireDragStartEvent(){const e=new(Ce(fe.COMMENT_DRAG))(this.comment,!0);ee(e)}fireDragEndEvent(){const e=new(Ce(fe.COMMENT_DRAG))(this.comment,!1);ee(e)}fireMoveEvent(){if(!this.comment.isDeadOrDying()){var e=new(Ce(fe.COMMENT_MOVE))(this.comment);e.setReason(["drag"]),e.oldCoordinate_=this.startLoc,e.recordNew(),ee(e)}}revertDrag(){this.startLoc&&this.comment.moveDuringDrag(this.startLoc)}},Ib=new WeakMap,Bd=class{constructor(e){this.workspace=e,this.size=new Jt(120,100),this.collapsed=!1,this.editable=!0,this.location=new Le(0,0),this.text="",this.textChangeListeners=[],this.sizeChangeListeners=[],this.disposeListeners=[],this.collapseChangeListeners=[],this.resizePointerMoveListener=this.resizePointerUpListener=null,this.disposed=this.disposing=!1,this.svgRoot=re(oe.G,{class:"blocklyComment blocklyEditable blocklyDraggable"}),this.highlightRect=this.createHighlightRect(this.svgRoot),{topBarGroup:this.topBarGroup,topBarBackground:this.topBarBackground,deleteIcon:this.deleteIcon,foldoutIcon:this.foldoutIcon,textPreview:this.textPreview,textPreviewNode:this.textPreviewNode}=this.createTopBar(this.svgRoot,e),{foreignObject:this.foreignObject,textArea:this.textArea}=this.createTextArea(this.svgRoot),this.resizeHandle=this.createResizeHandle(this.svgRoot,e);let t;(t=e.getLayerManager())==null||t.append(this,Ao),this.setSizeWithoutFiringEvents(this.size),this.moveTo(new Le(0,0))}createHighlightRect(e){return re(oe.RECT,{class:"blocklyCommentHighlight"},e)}createTopBar(e,t){e=re(oe.G,{class:"blocklyCommentTopbar"},e);const r=re(oe.RECT,{class:"blocklyCommentTopbarBackground"},e),l=re(oe.IMAGE,{class:"blocklyDeleteIcon",href:`${t.options.pathToMedia}delete-icon.svg`},e);t=re(oe.IMAGE,{class:"blocklyFoldoutIcon",href:`${t.options.pathToMedia}foldout-icon.svg`},e);const p=re(oe.TEXT,{class:"blocklyCommentPreview blocklyCommentText blocklyText"},e),v=document.createTextNode("");return p.appendChild(v),Ue(t,"pointerdown",this,this.onFoldoutDown),Ue(l,"pointerdown",this,this.onDeleteDown),{topBarGroup:e,topBarBackground:r,deleteIcon:l,foldoutIcon:t,textPreview:p,textPreviewNode:v}}createTextArea(e){e=re(oe.FOREIGNOBJECT,{class:"blocklyCommentForeignObject"},e);const t=document.createElementNS(bi,"body");t.setAttribute("xmlns",bi),t.className="blocklyMinimalBody";const r=document.createElementNS(bi,"textarea");return Fe(r,"blocklyCommentText"),Fe(r,"blocklyTextarea"),Fe(r,"blocklyText"),t.appendChild(r),e.appendChild(t),Ue(r,"change",this,this.onTextChange),{foreignObject:e,textArea:r}}createResizeHandle(e,t){return e=re(oe.IMAGE,{class:"blocklyResizeHandle",href:`${t.options.pathToMedia}resize-handle.svg`},e),Ue(e,"pointerdown",this,this.onResizePointerDown),e}getSvgRoot(){return this.svgRoot}getSize(){return this.collapsed?this.topBarBackground.getBBox():this.size}setSizeWithoutFiringEvents(e){const t=this.topBarBackground.getBBox(),r=this.deleteIcon.getBBox(),l=this.foldoutIcon.getBBox(),p=this.textPreview.getBBox(),v=this.resizeHandle.getBBox();this.size=e=Jt.max(e,this.calcMinSize(t,l,r)),this.svgRoot.setAttribute("height",`${e.height}`),this.svgRoot.setAttribute("width",`${e.width}`),this.updateHighlightRect(e),this.updateTopBarSize(e),this.updateTextAreaSize(e,t),this.updateDeleteIconPosition(e,t,r),this.updateFoldoutIconPosition(t,l),this.updateTextPreviewSize(e,t,p,r,v),this.updateResizeHandlePosition(e,v)}setSize(e){const t=this.preResizeSize||this.size;this.setSizeWithoutFiringEvents(e),this.onSizeChange(t,this.size)}calcMinSize(e,t,r){var l;this.updateTextPreview((l=this.textArea.value)!=null?l:""),l=Gs(this.textPreview);const p=this.calcFoldoutMargin(e,t),v=this.calcDeleteMargin(e,r);let O=l;return this.foldoutIcon.checkVisibility()?O+=t.width+2*p:l&&(O+=4),this.deleteIcon.checkVisibility()?O+=r.width+2*v:l&&(O+=4),new Jt(O,e.height+20)}calcDeleteMargin(e,t){return(e.height-t.height)/2}calcFoldoutMargin(e,t){return(e.height-t.height)/2}updateHighlightRect(e){this.highlightRect.setAttribute("height",`${e.height}`),this.highlightRect.setAttribute("width",`${e.width}`),this.workspace.RTL&&this.highlightRect.setAttribute("x",`${-e.width}`)}updateTopBarSize(e){this.topBarBackground.setAttribute("width",`${e.width}`)}updateTextAreaSize(e,t){this.foreignObject.setAttribute("height",`${e.height-t.height}`),this.foreignObject.setAttribute("width",`${e.width}`),this.foreignObject.setAttribute("y",`${t.height}`),this.workspace.RTL&&this.foreignObject.setAttribute("x",`${-e.width}`)}updateDeleteIconPosition(e,t,r){t=this.calcDeleteMargin(t,r),this.deleteIcon.setAttribute("y",`${t}`),this.deleteIcon.setAttribute("x",`${e.width-r.width-t}`)}updateFoldoutIconPosition(e,t){e=this.calcFoldoutMargin(e,t),this.foldoutIcon.setAttribute("y",`${e}`),this.foldoutIcon.setAttribute("x",`${e}`)}updateTextPreviewSize(e,t,r,l,p){const v=(t.height-r.height)/2,O=this.calcDeleteMargin(t,l);t=this.calcFoldoutMargin(t,p),e=e.width-p.width-2*t-l.width-2*O,this.textPreview.setAttribute("x",`${p.width+2*t*(this.workspace.RTL?-1:1)}`),this.textPreview.setAttribute("y",`${v+r.height/2}`),this.textPreview.setAttribute("width",`${e}`)}updateResizeHandlePosition(e,t){this.resizeHandle.setAttribute("y",`${e.height-t.height}`),this.resizeHandle.setAttribute("x",`${e.width-t.width}`)}onSizeChange(e,t){for(let r=this.sizeChangeListeners.length-1;0<=r;r--)this.sizeChangeListeners[r](e,t)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}removeSizeChangeListener(e){this.sizeChangeListeners.splice(this.sizeChangeListeners.indexOf(e),1)}onResizePointerDown(e){this.isEditable()&&(this.bringToFront(),ct(e)||(this.preResizeSize=this.getSize(),aa(this.workspace,e,new Le(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=Ue(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=Ue(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation())}onResizePointerUp(e){ft(),this.resizePointerUpListener&&(wt(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(wt(this.resizePointerMoveListener),this.resizePointerMoveListener=null),this.setSize(this.size),this.preResizeSize=void 0}onResizePointerMove(e){e=ju(this.workspace,e),this.setSizeWithoutFiringEvents(new Jt(this.workspace.RTL?-e.x:e.x,e.y))}isCollapsed(){return this.collapsed}setCollapsed(e){(this.collapsed=e)?Fe(this.svgRoot,"blocklyCollapsed"):pt(this.svgRoot,"blocklyCollapsed"),this.setSizeWithoutFiringEvents(this.size),this.onCollapse()}onCollapse(){for(let e=this.collapseChangeListeners.length-1;0<=e;e--)this.collapseChangeListeners[e](this.collapsed)}addOnCollapseListener(e){this.collapseChangeListeners.push(e)}removeOnCollapseListener(e){this.collapseChangeListeners.splice(this.collapseChangeListeners.indexOf(e),1)}onFoldoutDown(e){ft(),this.bringToFront(),ct(e)||(this.setCollapsed(!this.collapsed),this.workspace.hideChaff()),e.stopPropagation()}isEditable(){return this.editable}setEditable(e){(this.editable=e)?(Fe(this.svgRoot,"blocklyEditable"),pt(this.svgRoot,"blocklyReadonly"),this.textArea.removeAttribute("readonly")):(pt(this.svgRoot,"blocklyEditable"),Fe(this.svgRoot,"blocklyReadonly"),this.textArea.setAttribute("readonly","true"))}getRelativeToSurfaceXY(){return this.location}moveTo(e){this.location=e,this.svgRoot.setAttribute("transform",`translate(${e.x}, ${e.y})`)}getText(){return this.text}setText(e){this.textArea.value=e,this.onTextChange()}addTextChangeListener(e){this.textChangeListeners.push(e)}removeTextChangeListener(e){this.textChangeListeners.splice(this.textChangeListeners.indexOf(e),1)}onTextChange(){const e=this.text;this.text=this.textArea.value,this.updateTextPreview(this.text),this.setSize(this.size);for(let t=this.textChangeListeners.length-1;0<=t;t--)this.textChangeListeners[t](e,this.text)}updateTextPreview(e){this.textPreviewNode.textContent=this.truncateText(e)}truncateText(e){return 12<=e.length?`${e.substring(0,9)}...`:e}bringToFront(){const e=this.svgRoot.parentNode,t=e.childNodes;t[t.length-1]!==this.svgRoot&&e.appendChild(this.svgRoot)}onDeleteDown(e){ft(),ct(e)||this.dispose(),e.stopPropagation()}dispose(){this.disposing=!0,mt(this.svgRoot);for(let e=this.disposeListeners.length-1;0<=e;e--)this.disposeListeners[e]();this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}addDisposeListener(e){this.disposeListeners.push(e)}removeDisposeListener(e){this.disposeListeners.splice(this.disposeListeners.indexOf(e),1)}};we(`
.injectionDiv {
  --commentFillColour: #FFFCC7;
  --commentBorderColour: #F2E49B;
}

.blocklyComment .blocklyTextarea {
  background-color: var(--commentFillColour);
  border: 1px solid var(--commentBorderColour);
  box-sizing: border-box;
  display: block;
  outline: 0;
  padding: 5px;
  resize: none;
  width: 100%;
  height: 100%;
}

.blocklyReadonly.blocklyComment .blocklyTextarea {
  cursor: inherit;
}

.blocklyDeleteIcon {
  width: 20px;
  height: 20px;
  display: none;
  cursor: pointer;
}

.blocklyFoldoutIcon {
  width: 20px;
  height: 20px;
  transform-origin: 12px 12px;
  cursor: pointer;
}
.blocklyResizeHandle {
  width: 12px;
  height: 12px;
  cursor: se-resize;
}
.blocklyReadonly.blocklyComment .blocklyResizeHandle {
  cursor: inherit;
}

.blocklyCommentTopbarBackground {
  fill: var(--commentBorderColour);
  height: 24px;
}

.blocklyComment .blocklyCommentPreview.blocklyText {
  fill: #000;
  dominant-baseline: middle;
  visibility: hidden;
}

.blocklyCollapsed.blocklyComment .blocklyCommentPreview {
  visibility: visible;
}

.blocklyCollapsed.blocklyComment .blocklyCommentForeignObject,
.blocklyCollapsed.blocklyComment .blocklyResizeHandle {
  display: none;
}

.blocklyCollapsed.blocklyComment .blocklyFoldoutIcon {
  transform: rotate(-90deg);
}

.blocklyRTL .blocklyCommentTopbar {
  transform: scale(-1, 1);
}

.blocklyRTL .blocklyCommentForeignObject {
  direction: rtl;
}

.blocklyRTL .blocklyCommentPreview {
  /* Revert the scale and control RTL using direction instead. */
  transform: scale(-1, 1);
  direction: rtl;
}

.blocklyRTL .blocklyResizeHandle {
  transform: scale(-1, 1);
  cursor: sw-resize;
}

.blocklyCommentHighlight {
  fill: none;
}

.blocklySelected .blocklyCommentHighlight {
  stroke: #fc3;
  stroke-width: 3px;
}

.blocklyCollapsed.blocklySelected .blocklyCommentHighlight {
  stroke: none;
}

.blocklyCollapsed.blocklySelected .blocklyCommentTopbarBackground {
  stroke: #fc3;
  stroke-width: 3px;
}
`);var Xc=class{constructor(e,t){this.workspace=e,this.text="",this.size=new Jt(120,100),this.collapsed=!1,this.deletable=this.movable=this.editable=!0,this.location=new Le(0,0),this.disposing=this.disposed=!1,this.id=t&&!e.getCommentById(t)?t:E(),e.addTopComment(this),this.fireCreateEvent()}fireCreateEvent(){te()&&ee(new(Ce(fe.COMMENT_CREATE))(this))}fireDeleteEvent(){te()&&ee(new(Ce(fe.COMMENT_DELETE))(this))}fireChangeEvent(e,t){te()&&ee(new(Ce(fe.COMMENT_CHANGE))(this,e,t))}fireCollapseEvent(e){te()&&ee(new(Ce(fe.COMMENT_COLLAPSE))(this,e))}setText(e){const t=this.text;this.text=e,this.fireChangeEvent(t,e)}getText(){return this.text}setSize(e){const t=new(Ce(fe.COMMENT_RESIZE))(this);this.size=e,t.recordCurrentSizeAsNewSize(),ee(t)}getSize(){return this.size}setCollapsed(e){this.collapsed=e,this.fireCollapseEvent(e)}isCollapsed(){return this.collapsed}setEditable(e){this.editable=e}isEditable(){return this.isOwnEditable()&&!this.workspace.options.readOnly}isOwnEditable(){return this.editable}setMovable(e){this.movable=e}isMovable(){return this.isOwnMovable()&&!this.workspace.options.readOnly}isOwnMovable(){return this.movable}setDeletable(e){this.deletable=e}isDeletable(){return this.isOwnDeletable()&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnDeletable(){return this.deletable}moveTo(e,t){const r=new(Ce(fe.COMMENT_MOVE))(this);t&&r.setReason(t),this.location=e,r.recordNew(),ee(r)}getRelativeToSurfaceXY(){return this.location}dispose(){this.disposing=!0,this.fireDeleteEvent(),this.workspace.removeTopComment(this),this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}},Pd=class extends Xc{constructor(e,t){super(e,t),this.dragStrategy=new Eb(this),this.workspace=e,this.view=new Bd(e),this.view.setSize(this.getSize()),this.view.setEditable(this.isEditable()),this.view.getSvgRoot().setAttribute("data-id",this.id),this.addModelUpdateBindings(),Ue(this.view.getSvgRoot(),"pointerdown",this,this.startGesture),Ue(this.view.getSvgRoot(),"wheel",this,r=>{r.stopPropagation()})}addModelUpdateBindings(){this.view.addTextChangeListener((e,t)=>void super.setText(t)),this.view.addSizeChangeListener((e,t)=>void super.setSize(t)),this.view.addOnCollapseListener(()=>void super.setCollapsed(this.view.isCollapsed())),this.view.addDisposeListener(()=>{this.isDeadOrDying()||this.dispose()})}setText(e){this.view.setText(e)}setSize(e){this.view.setSize(e)}setCollapsed(e){this.view.setCollapsed(e)}setEditable(e){super.setEditable(e),this.view.setEditable(this.isEditable())}getSvgRoot(){return this.view.getSvgRoot()}getSize(){return super.getSize()}getBoundingRectangle(){const e=this.getRelativeToSurfaceXY();var t,r;const l=(r=(t=this.view)==null?void 0:t.getSize())!=null?r:this.getSize();return this.workspace.RTL?(t=e.x-l.width,r=e.x):(t=e.x,r=e.x+l.width),new Bt(e.y,e.y+l.height,t,r)}moveBy(e,t,r){const l=this.getRelativeToSurfaceXY();e=new Le(l.x+e,l.y+t),this.moveTo(e,r)}moveTo(e,t){super.moveTo(e,t),this.view.moveTo(e)}moveDuringDrag(e){this.location=e,this.view.moveTo(e)}setDragging(e){e?Fe(this.getSvgRoot(),"blocklyDragging"):pt(this.getSvgRoot(),"blocklyDragging")}dispose(){this.disposing=!0,this.view.isDeadOrDying()||this.view.dispose(),super.dispose()}startGesture(e){const t=this.workspace.getGesture(e);if(t){if(qt(e))e.stopPropagation();else{t.handleCommentStart(e,this);let r;(r=this.workspace.getLayerManager())==null||r.append(this,Ao)}s.setSelected$$module$build$src$core$common(this)}}setDeleteStyle(e){e?Fe(this.getSvgRoot(),"blocklyDraggingDelete"):pt(this.getSvgRoot(),"blocklyDraggingDelete")}isMovable(){return this.dragStrategy.isMovable()}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){Fe(this.getSvgRoot(),"blocklySelected")}unselect(){pt(this.getSvgRoot(),"blocklySelected")}toCopyData(){return{paster:Id.TYPE,commentState:In(this,{addCoordinates:!0})}}showContextMenu(e){const t=zt.registry.getContextMenuOptions(zt.ScopeType.COMMENT,{comment:this});dl(e,t,this.workspace.RTL,this.workspace)}snapToGrid(){if(!this.isDeadOrDying()){var e=this.workspace.getGrid();if(e!=null&&e.shouldSnap()){var t=this.getRelativeToSurfaceXY();e=e.alignXY(t),e!==t&&this.moveTo(e,["snap"])}}}},xs={};xs.appendDomToWorkspace=Cm,xs.blockToDom=zi,xs.blockToDomWithXY=vo,xs.clearWorkspaceAndLoadFromXml=fs,xs.deleteNext=Tm,xs.domToBlock=s.domToBlock$$module$build$src$core$xml,xs.domToBlockInternal=yo,xs.domToPrettyText=Xn,xs.domToText=ci,xs.domToVariables=dp,xs.domToWorkspace=s.domToWorkspace$$module$build$src$core$xml,xs.loadWorkspaceComment=up,xs.saveWorkspaceComment=bc,xs.variablesToDom=pl,xs.workspaceToDom=_m;var xg=class extends Sa{constructor(e){super(e),this.type=fe.BLOCK_CREATE,e&&(e.isShadow()&&(this.recordUndo=!1),this.xml=vo(e),this.ids=Z(e),this.json=Qt(e,{addCoordinates:!0}))}toJson(){const e=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=ci(this.xml),e.ids=this.ids,e.json=this.json,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new xg),t.xml=s.textToDom$$module$build$src$core$utils$xml(e.xml),t.ids=e.ids,t.json=e.json,e.recordUndo!==void 0&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!iy(t,this.ids))if(e)Ni(this.json,t);else for(e=0;e<this.ids.length;e++){const r=this.ids[e],l=t.getBlockById(r);l?l.dispose(!1):r===this.blockId&&console.warn("Can't uncreate non-existent block: "+r)}}},iy=function(e,t){return t.map(r=>e.getBlockById(r)).filter(r=>r&&r.isShadow()).length===t.length};i(Be.EVENT,fe.BLOCK_CREATE,xg);var Dg=class extends Es{constructor(e,t){super(t),this.type=fe.THEME_CHANGE,this.themeName=e}toJson(){const e=super.toJson();if(!this.themeName)throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson");return e.themeName=this.themeName,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Dg),t.themeName=e.themeName,t}};i(Be.EVENT,fe.THEME_CHANGE,Dg);var Ag=class extends Es{constructor(e,t,r,l,p){super(l),this.type=fe.VIEWPORT_CHANGE,this.viewTop=e,this.viewLeft=t,this.scale=r,this.oldScale=p}toJson(){const e=super.toJson();if(this.viewTop===void 0)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(this.viewLeft===void 0)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(this.scale===void 0)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(this.oldScale===void 0)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return e.viewTop=this.viewTop,e.viewLeft=this.viewLeft,e.scale=this.scale,e.oldScale=this.oldScale,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Ag),t.viewTop=e.viewTop,t.viewLeft=e.viewLeft,t.scale=e.scale,t.oldScale=e.oldScale,t}};i(Be.EVENT,fe.VIEWPORT_CHANGE,Ag);var Ze;(function(e){e[e.INPUT_VALUE=1]="INPUT_VALUE",e[e.OUTPUT_VALUE=2]="OUTPUT_VALUE",e[e.NEXT_STATEMENT=3]="NEXT_STATEMENT",e[e.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT"})(Ze||(Ze={}));var Ll=class{constructor(e){this.connectionChecker=e,this.connections=[]}addConnection(e,t){t=this.calculateIndexForYPos(t),this.connections.splice(t,0,e)}findIndexOfConnection(e,t){if(!this.connections.length)return-1;const r=this.calculateIndexForYPos(t);if(r>=this.connections.length)return-1;t=e.y;let l=r;for(;0<=l&&this.connections[l].y===t;){if(this.connections[l]===e)return l;l--}for(l=r;l<this.connections.length&&this.connections[l].y===t;){if(this.connections[l]===e)return l;l++}return-1}calculateIndexForYPos(e){if(!this.connections.length)return 0;let t=0,r=this.connections.length;for(;t<r;){const l=Math.floor((t+r)/2);if(this.connections[l].y<e)t=l+1;else if(this.connections[l].y>e)r=l;else{t=l;break}}return t}removeConnection(e,t){if(e=this.findIndexOfConnection(e,t),e===-1)throw Error("Unable to find connection in connectionDB.");this.connections.splice(e,1)}getNeighbours(e,t){function r(Qe){const Mn=p-l[Qe].x,On=v-l[Qe].y;return Math.sqrt(Mn*Mn+On*On)<=t&&Ie.push(l[Qe]),On<t}const l=this.connections,p=e.x,v=e.y;e=0;let O=l.length-2,G=O;for(;e<G;)l[G].y<v?e=G:O=G,G=Math.floor((e+O)/2);const Ie=[];if(O=e=G,l.length){for(;0<=e&&r(e);)e--;do O++;while(O<l.length&&r(O))}return Ie}isInYRange(e,t,r){return Math.abs(this.connections[e].y-t)<=r}searchForClosest(e,t,r){if(!this.connections.length)return{connection:null,radius:t};const l=e.y,p=e.x;e.x=p+r.x,e.y=l+r.y;var v=this.calculateIndexForYPos(e.y);r=null;let O=t,G,Ie=v-1;for(;0<=Ie&&this.isInYRange(Ie,e.y,t);)G=this.connections[Ie],this.connectionChecker.canConnect(e,G,!0,O)&&(r=G,O=G.distanceFrom(e)),Ie--;for(;v<this.connections.length&&this.isInYRange(v,e.y,t);)G=this.connections[v],this.connectionChecker.canConnect(e,G,!0,O)&&(r=G,O=G.distanceFrom(e)),v++;return e.x=p,e.y=l,{connection:r,radius:O}}static init(e){const t=[];return t[Ze.INPUT_VALUE]=new Ll(e),t[Ze.OUTPUT_VALUE]=new Ll(e),t[Ze.NEXT_STATEMENT]=new Ll(e),t[Ze.PREVIOUS_STATEMENT]=new Ll(e),t}},jd=null,Zc=null,Qc={};Qc.connectionUiEffect=_o,Qc.disconnectUiEffect=Vu,Qc.disconnectUiStop=qr,Qc.disposeUiEffect=Hu;var xb=class{constructor(e){this.workspace=e,this.horizontalScrollEnabled=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled=this.workspace.isMovableVertically(),this.startScrollXY_=new Le(e.scrollX,e.scrollY)}dispose(){this.workspace=null}startDrag(){ne()&&ne().unselect()}endDrag(e){this.drag(e)}drag(e){if(e=Le.sum(this.startScrollXY_,e),this.horizontalScrollEnabled&&this.verticalScrollEnabled)this.workspace.scroll(e.x,e.y);else if(this.horizontalScrollEnabled)this.workspace.scroll(e.x,this.workspace.scrollY);else if(this.verticalScrollEnabled)this.workspace.scroll(this.workspace.scrollX,e.y);else throw new TypeError("Invalid state.")}},Qr=5,oy=6,Qi=class{constructor(e,t){this.creatorWorkspace=t,this.mouseDownXY=new Le(0,0),this.startWorkspace_=this.targetBlock=this.startComment=this.startBlock=this.startIcon=this.startField=this.startBubble=null,this.hasExceededDragRadius=!1,this.boundEvents=[],this.workspaceDragger=this.dragger=null,this.dragging=!1,this.flyout=null,this.multiTouch=this.isEnding_=this.gestureHasStarted=this.calledUpdateIsDragging=!1,this.cachedPoints=new Map,this.startDistance=this.previousScale=0,this.currentDropdownOwner=this.isPinchZoomEnabled=null,this.mostRecentEvent=e,this.currentDragDeltaXY=new Le(0,0)}dispose(){ft(),np(),this.creatorWorkspace.clearGesture();for(const e of this.boundEvents)wt(e);this.boundEvents.length=0,this.workspaceDragger&&this.workspaceDragger.dispose()}updateFromEvent(e){const t=new Le(e.clientX,e.clientY);this.updateDragDelta(t)&&(this.updateIsDragging(e),lt()),this.mostRecentEvent=e}updateDragDelta(e){return this.currentDragDeltaXY=Le.difference(e,this.mouseDownXY),this.hasExceededDragRadius?!1:this.hasExceededDragRadius=Le.magnitude(this.currentDragDeltaXY)>(this.flyout?s.config$$module$build$src$core$config.flyoutDragRadius:s.config$$module$build$src$core$config.dragRadius)}updateIsDraggingFromFlyout(){let e;if(!this.targetBlock||(e=this.flyout)==null||!e.isBlockCreatable(this.targetBlock))return!1;if(!this.flyout.targetWorkspace)throw Error(`Cannot update dragging from the flyout because the ' +
          'flyout's target workspace is undefined`);return!this.flyout.isScrollable()||this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY)?(this.startWorkspace_=this.flyout.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),s.getGroup$$module$build$src$core$events$utils()||s.setGroup$$module$build$src$core$events$utils(!0),this.startBlock=null,this.targetBlock=this.flyout.createBlock(this.targetBlock),s.setSelected$$module$build$src$core$common(this.targetBlock),!0):!1}updateIsDraggingWorkspace(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout?this.flyout.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.dragging=!0,this.workspaceDragger=new xb(this.startWorkspace_),this.workspaceDragger.startDrag())}updateIsDragging(e){if(!this.startWorkspace_)throw Error("Cannot update dragging because the start workspace is undefined");if(this.calledUpdateIsDragging)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging=!0,this.flyout&&this.updateIsDraggingFromFlyout();const t=ne();t&&ui(t)&&t.isMovable()?(this.dragging=!0,this.dragger=this.createDragger(t,this.startWorkspace_),this.dragger.onDragStart(e),this.dragger.onDrag(e,this.currentDragDeltaXY)):this.updateIsDraggingWorkspace()}createDragger(e,t){return new(w(Be.BLOCK_DRAGGER,this.creatorWorkspace.options,!0))(e,t)}doStart(e){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,qt(e)?this.cancel():(this.gestureHasStarted=!0,qr(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=cc(),this.startWorkspace_.hideChaff(!!this.flyout),this.startWorkspace_.markFocused(),this.mostRecentEvent=e,tp(),ct(e)?this.handleRightClick(e):(e.type.toLowerCase()==="pointerdown"&&e.pointerType!=="mouse"&&St(e,this),this.mouseDownXY=new Le(e.clientX,e.clientY),this.bindMouseEvents(e),this.isEnding_||this.handleTouchStart(e)))}bindMouseEvents(e){this.boundEvents.push(Ue(document,"pointerdown",null,this.handleStart.bind(this),!0)),this.boundEvents.push(Ue(document,"pointermove",null,this.handleMove.bind(this),!0)),this.boundEvents.push(Ue(document,"pointerup",null,this.handleUp.bind(this),!0)),e.preventDefault(),e.stopPropagation()}handleStart(e){this.isDragging()||(this.handleTouchStart(e),this.isMultiTouch()&&lt())}handleMove(e){this.isDragging()&&st(e)||!this.isMultiTouch()?(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(e),lt())}handleUp(e){if(this.isDragging()||this.handleTouchEnd(e),!this.isMultiTouch()||this.isDragging()){if(!st(e))return;if(this.updateFromEvent(e),lt(),this.isEnding_){console.log("Trying to end a gesture recursively.");return}this.isEnding_=!0,this.dragger?this.dragger.onDragEnd(e,this.currentDragDeltaXY):this.workspaceDragger?this.workspaceDragger.endDrag(this.currentDragDeltaXY):this.isBubbleClick()||this.isCommentClick()||(this.isFieldClick()?this.doFieldClick():this.isIconClick()?this.doIconClick():this.isBlockClick()?this.doBlockClick():this.isWorkspaceClick()&&this.doWorkspaceClick(e))}e.preventDefault(),e.stopPropagation(),this.dispose()}handleTouchStart(e){var t=At(e);this.cachedPoints.set(t,this.getTouchPoint(e));var r=Array.from(this.cachedPoints.keys());r.length===2&&(t=this.cachedPoints.get(r[0]),r=this.cachedPoints.get(r[1]),this.startDistance=Le.distance(t,r),this.multiTouch=!0,e.preventDefault())}handleTouchMove(e){const t=At(e);this.cachedPoints.set(t,this.getTouchPoint(e)),this.isPinchZoomEnabled&&this.cachedPoints.size===2?this.handlePinch(e):(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation())}handlePinch(e){var t=Array.from(this.cachedPoints.keys()),r=this.cachedPoints.get(t[0]);if(t=this.cachedPoints.get(t[1]),r=Le.distance(r,t)/this.startDistance,0<this.previousScale&&1/0>this.previousScale){if(t=r-this.previousScale,t=0<t?t*Qr:t*oy,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");const l=this.startWorkspace_,p=me(e,l.getParentSvg(),l.getInverseScreenCTM());l.zoom(p.x,p.y,t)}this.previousScale=r,e.preventDefault()}handleTouchEnd(e){e=At(e),this.cachedPoints.has(e)&&this.cachedPoints.delete(e),2>this.cachedPoints.size&&(this.cachedPoints.clear(),this.previousScale=0)}getTouchPoint(e){return this.startWorkspace_?new Le(e.pageX,e.pageY):null}isMultiTouch(){return this.multiTouch}cancel(){this.isEnding_||(lt(),this.dragger?this.dragger.onDragEnd(this.mostRecentEvent,this.currentDragDeltaXY):this.workspaceDragger&&this.workspaceDragger.endDrag(this.currentDragDeltaXY),this.dispose())}handleRightClick(e){this.targetBlock?(this.bringBlockToFront(),this.targetBlock.workspace.hideChaff(!!this.flyout),this.targetBlock.showContextMenu(e)):this.startBubble?this.startBubble.showContextMenu(e):this.startComment?(this.startComment.workspace.hideChaff(),this.startComment.showContextMenu(e)):this.startWorkspace_&&!this.flyout&&(this.startWorkspace_.hideChaff(),this.startWorkspace_.showContextMenu(e)),e.preventDefault(),e.stopPropagation(),this.dispose()}handleWsStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace(t),this.mostRecentEvent=e,this.startBlock||this.startBubble||this.startComment||s.setSelected$$module$build$src$core$common(null),this.doStart(e)}fireWorkspaceClick(e){ee(new(Ce(fe.CLICK))(null,e.id,"workspace"))}handleFlyoutStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout(t),this.handleWsStart(e,t.getWorkspace())}handleBlockStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(t),this.mostRecentEvent=e}handleBubbleStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(t),this.mostRecentEvent=e}handleCommentStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleCommentStart, but the gesture had already been started.");this.setStartComment(t),this.mostRecentEvent=e}doFieldClick(){if(!this.startField)throw Error("Cannot do a field click because the start field is undefined");this.currentDropdownOwner!==this.startField&&this.startField.showEditor(this.mostRecentEvent),this.bringBlockToFront()}doIconClick(){if(!this.startIcon)throw Error("Cannot do an icon click because the start icon is undefined");this.bringBlockToFront(),this.startIcon.onClick()}doBlockClick(){if(this.flyout&&this.flyout.autoClose){if(!this.targetBlock)throw Error("Cannot do a block click because the target block is undefined");if(this.targetBlock.isEnabled()){s.getGroup$$module$build$src$core$events$utils()||s.setGroup$$module$build$src$core$events$utils(!0);var e=this.flyout.createBlock(this.targetBlock);e.snapToGrid(),e.bumpNeighbours()}}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");e=new(Ce(fe.CLICK))(this.startBlock,this.startWorkspace_.id,"block"),ee(e)}this.bringBlockToFront(),s.setGroup$$module$build$src$core$events$utils(!1)}doWorkspaceClick(e){e=this.creatorWorkspace,ne()&&ne().unselect(),this.fireWorkspaceClick(this.startWorkspace_||e)}bringBlockToFront(){this.targetBlock&&!this.flyout&&this.targetBlock.bringToFront()}setStartField(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField||(this.startField=e)}setStartIcon(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartIcon, but the gesture had already been started.");this.startIcon||(this.startIcon=e)}setStartBubble(e){this.startBubble||(this.startBubble=e)}setStartComment(e){this.startComment||(this.startComment=e)}setStartBlock(e){this.startBlock||this.startBubble||(this.startBlock=e,s.setSelected$$module$build$src$core$common(this.startBlock),e.isInFlyout&&e!==e.getRootBlock()?this.setTargetBlock(e.getRootBlock()):this.setTargetBlock(e))}setTargetBlock(e){e.isShadow()?this.setTargetBlock(e.getParent()):this.targetBlock=e}setStartWorkspace(e){this.startWorkspace_||(this.startWorkspace_=e)}setStartFlyout(e){this.flyout||(this.flyout=e)}isBubbleClick(){return!!this.startBubble&&!this.hasExceededDragRadius}isCommentClick(){return!!this.startComment&&!this.hasExceededDragRadius}isBlockClick(){return!!this.startBlock&&!this.hasExceededDragRadius&&!this.isFieldClick()&&!this.isIconClick()}isFieldClick(){return this.startField?this.startField.isClickable()&&!this.hasExceededDragRadius&&(!this.flyout||this.startField.isClickableInFlyout(this.flyout.autoClose)):!1}isIconClick(){if(!this.startIcon)return!1;const e=!this.flyout||!this.startIcon.isClickableInFlyout||this.startIcon.isClickableInFlyout(this.flyout.autoClose);return!this.hasExceededDragRadius&&e}isWorkspaceClick(){return!this.startBlock&&!this.startBubble&&!this.startField&&!this.hasExceededDragRadius}getCurrentDragger(){let e,t;return(t=(e=this.workspaceDragger)!=null?e:this.dragger)!=null?t:null}isDragging(){return this.dragging}hasStarted(){return this.gestureHasStarted}static inProgress(){const e=Ae();for(let t=0,r;r=e[t];t++)if(r.currentGesture_)return!0;return!1}},eo=class{constructor(e,t){this.pattern=e,this.scale=1;let r;this.spacing=(r=t.spacing)!=null?r:0;let l;this.length=(l=t.length)!=null?l:1,this.line2=(this.line1=e.firstChild)&&this.line1.nextSibling;let p;this.snapToGrid=(p=t.snap)!=null?p:!1}setSpacing(e){this.spacing=e,this.update(this.scale)}getSpacing(){return this.spacing}setLength(e){this.length=e,this.update(this.scale)}getLength(){return this.length}setSnapToGrid(e){this.snapToGrid=e}shouldSnap(){return this.snapToGrid}getPatternId(){return this.pattern.id}update(e){this.scale=e;var t=this.spacing*e;this.pattern.setAttribute("width",`${t}`),this.pattern.setAttribute("height",`${t}`),t=Math.floor(this.spacing/2)+.5;let r=t-this.length/2,l=t+this.length/2;t*=e,r*=e,l*=e,this.setLineAttributes(this.line1,e,r,l,t,t),this.setLineAttributes(this.line2,e,t,t,r,l)}setLineAttributes(e,t,r,l,p,v){e&&(e.setAttribute("stroke-width",`${t}`),e.setAttribute("x1",`${r}`),e.setAttribute("y1",`${p}`),e.setAttribute("x2",`${l}`),e.setAttribute("y2",`${v}`))}moveTo(e,t){this.pattern.setAttribute("x",`${e}`),this.pattern.setAttribute("y",`${t}`)}alignXY(e){var t=this.getSpacing();const r=t/2,l=Math.round(Math.round((e.x-r)/t)*t+r);return t=Math.round(Math.round((e.y-r)/t)*t+r),l===e.x&&t===e.y?e:new Le(l,t)}static createDom(e,t,r){e=re(oe.PATTERN,{id:"blocklyGridPattern"+e,patternUnits:"userSpaceOnUse"},r);let l,p;if(0<((l=t.length)!=null?l:1)&&0<((p=t.spacing)!=null?p:0)){re(oe.LINE,{stroke:t.colour},e);let v;(v=t.length)!=null&&v&&re(oe.LINE,{stroke:t.colour},e)}else re(oe.LINE,{},e);return e}},jt=class{constructor(e){this.workspace=e,this.layers=new Map,(e=e.getInjectionDiv())&&(this.dragLayer=this.createDragLayer(e),this.animationLayer=this.createAnimationLayer(e)),e=this.createLayer(Ao),Fe(e,"blocklyBlockCanvas"),e=this.createLayer(Ma),Fe(e,"blocklyBubbleCanvas")}createDragLayer(e){const t=re(oe.SVG,{class:"blocklyBlockDragSurface",xmlns:Nc,"xmlns:html":bi,"xmlns:xlink":nr,version:"1.1"});return e.append(t),re(oe.G,{},t)}createAnimationLayer(e){const t=re(oe.SVG,{class:"blocklyAnimationLayer",xmlns:Nc,"xmlns:html":bi,"xmlns:xlink":nr,version:"1.1"});return e.append(t),re(oe.G,{},t)}appendToAnimationLayer(e){let t;const r=(t=this.dragLayer)==null?void 0:t.getAttribute("transform");if(r){let p;(p=this.animationLayer)==null||p.setAttribute("transform",r)}let l;(l=this.animationLayer)==null||l.appendChild(e.getSvgRoot())}translateLayers(e,t){e=`translate(${e.x}, ${e.y}) scale(${t})`;let r;(r=this.dragLayer)==null||r.setAttribute("transform",e);for(const[,l]of this.layers)l.setAttribute("transform",e)}moveToDragLayer(e){let t;(t=this.dragLayer)==null||t.appendChild(e.getSvgRoot())}moveOffDragLayer(e,t){this.append(e,t)}append(e,t){this.layers.has(t)||this.createLayer(t);let r;(r=this.layers.get(t))==null||r.appendChild(e.getSvgRoot())}createLayer(e){const t=this.workspace.getSvgGroup(),r=re(oe.G,{});let l=!1;const p=[...this.layers].sort((v,O)=>v[0]-O[0]);for(const[v,O]of p)if(e<v){t.insertBefore(r,O),l=!0;break}return l||t.appendChild(r),this.layers.set(e,r),r}hasLayer(e){return e===this.dragLayer||new Set(this.layers.values()).has(e)}getBlockLayer(){return this.layers.get(Ao)}getBubbleLayer(){return this.layers.get(Ma)}},Db={};Db.deepMerge=Zn;var ts=class{constructor(e,t,r,l){this.name=e,this.startHats=!1,this.blockStyles=t||Object.create(null),this.categoryStyles=r||Object.create(null),this.componentStyles=l||Object.create(null),this.fontStyle=Object.create(null),i(Be.THEME,e,this,!0)}getClassName(){return this.name+"-theme"}setBlockStyle(e,t){this.blockStyles[e]=t}setCategoryStyle(e,t){this.categoryStyles[e]=t}getComponentStyle(e){if(e=this.componentStyles[e],!e)return null;if(typeof e=="string"){const t=this.getComponentStyle(e);if(t)return t}return`${e}`}setComponentStyle(e,t){this.componentStyles[e]=t}setFontStyle(e){this.fontStyle=e}setStartHats(e){this.startHats=e}static defineTheme(e,t){e=e.toLowerCase();const r=new ts(e);let l=t.base;if(l){if(typeof l=="string"){let p;l=(p=$(Be.THEME,l))!=null?p:void 0}l instanceof ts&&(Zn(r,l),r.name=e)}return Zn(r.blockStyles,t.blockStyles),Zn(r.categoryStyles,t.categoryStyles),Zn(r.componentStyles,t.componentStyles),Zn(r.fontStyle,t.fontStyle),t.startHats!==null&&(r.startHats=t.startHats),r}},Yn={colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},ay={colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}},ei=new ts("classic",Yn,ay),zr=class{constructor(e){this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let t=null,r=!1;var l=!1,p=!1,v=!1,O=!1,G=!1;const Ie=!!e.readOnly;if(!Ie){var Qe;t=j((Qe=e.toolbox)!=null?Qe:null),r=Ee(t),l=e.trashcan,l=l===void 0?r:l,p=e.collapse,p=p===void 0?r:p,v=e.comments,v=v===void 0?r:v,O=e.disable,O=O===void 0?r:O,G=e.sounds,G=G===void 0?!0:G}Qe=e.maxTrashcanContents,l?Qe===void 0&&(Qe=32):Qe=0;const Mn=!!e.rtl;let On=e.horizontalLayout;On===void 0&&(On=!1);var Vr=e.toolboxPosition!=="end";Vr=On?Vr?Rt.TOP:Rt.BOTTOM:Vr===Mn?Rt.RIGHT:Rt.LEFT;let uh=e.css;uh===void 0&&(uh=!0);let tf="https://blockly-demo.appspot.com/static/media/";e.media&&(tf=e.media.endsWith("/")?e.media:e.media+"/");const BC=e.oneBasedIndex,SI=e.renderer||"geras",TI=e.plugins||{};let Cy=e.modalInputs;Cy===void 0&&(Cy=!0),this.RTL=Mn,this.oneBasedIndex=BC===void 0?!0:BC,this.collapse=p,this.comments=v,this.disable=O,this.readOnly=Ie,this.maxBlocks=e.maxBlocks||1/0;let PC;this.maxInstances=(PC=e.maxInstances)!=null?PC:null,this.modalInputs=Cy,this.pathToMedia=tf,this.hasCategories=r,this.moveOptions=zr.parseMoveOptions(e,r),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=l,this.maxTrashcanContents=Qe,this.hasSounds=G,this.hasCss=uh,this.horizontalLayout=On,this.languageTree=t,this.gridOptions=zr.parseGridOptions(e),this.zoomOptions=zr.parseZoomOptions(e),this.toolboxPosition=Vr,this.theme=zr.parseThemeOptions(e),this.renderer=SI;let jC;this.rendererOverrides=(jC=e.rendererOverrides)!=null?jC:null;let FC;this.parentWorkspace=(FC=e.parentWorkspace)!=null?FC:null,this.plugins=TI}static parseMoveOptions(e,t){const r=e.move||{},l={};return r.scrollbars===void 0&&e.scrollbars===void 0?l.scrollbars=t:typeof r.scrollbars=="object"?(l.scrollbars={horizontal:!!r.scrollbars.horizontal,vertical:!!r.scrollbars.vertical},l.scrollbars.horizontal&&l.scrollbars.vertical?l.scrollbars=!0:l.scrollbars.horizontal||l.scrollbars.vertical||(l.scrollbars=!1)):l.scrollbars=!!r.scrollbars||!!e.scrollbars,l.wheel=l.scrollbars&&r.wheel!==void 0?!!r.wheel:typeof l.scrollbars=="object",l.drag=l.scrollbars?r.drag===void 0?!0:!!r.drag:!1,l}static parseZoomOptions(e){e=e.zoom||{};const t={};return t.controls=e.controls===void 0?!1:!!e.controls,t.wheel=e.wheel===void 0?!1:!!e.wheel,t.startScale=e.startScale===void 0?1:Number(e.startScale),t.maxScale=e.maxScale===void 0?3:Number(e.maxScale),t.minScale=e.minScale===void 0?.3:Number(e.minScale),t.scaleSpeed=e.scaleSpeed===void 0?1.2:Number(e.scaleSpeed),t.pinch=e.pinch===void 0?t.wheel||t.controls:!!e.pinch,t}static parseGridOptions(e){e=e.grid||{};const t={};return t.spacing=Number(e.spacing)||0,t.colour=e.colour||"#888",t.length=e.length===void 0?1:Number(e.length),t.snap=0<t.spacing&&!!e.snap,t}static parseThemeOptions(e){return e=e.theme||ei,typeof e=="string"?$(Be.THEME,e):e instanceof ts?e:ts.defineTheme(e.name||"builtin"+C(),e)}},Ab={fromJsonInternal:Em},Fd={TEST_ONLY:Ab};Fd.fromJson=s.fromJson$$module$build$src$core$field_registry,Fd.register=Ot,Fd.unregister=km;var rr=class extends vn{constructor(e,t,r){super(vn.SKIP_SETUP),this.svgArrow=this.arrow=this.imageElement=this.menu_=this.selectedMenuItem=null,this.SERIALIZABLE=!0,this.CURSOR="default",this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions=null,e!==vn.SKIP_SETUP&&(Array.isArray(e)?(this.validateOptions(e),e=this.trimOptions(e),this.menuGenerator_=e.options,this.prefixField=e.prefix||null,this.suffixField=e.suffix||null):this.menuGenerator_=e,this.selectedOption=this.getOptions(!1)[0],r&&this.configure_(r),this.setValue(this.selectedOption[1]),t&&this.setValidator(t))}fromXml(e){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e.textContent)}loadState(e){this.loadLegacyState(rr,e)||(this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement=re(oe.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&Fe(this.borderRect_,"blocklyDropdownRect")}shouldAddBorderRect_(){let e;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!((e=this.getSourceBlock())!=null&&e.isShadow())}createTextArrow_(){this.arrow=re(oe.TSPAN,{},this.textElement_);let e;this.arrow.appendChild(document.createTextNode((e=this.getSourceBlock())!=null&&e.RTL?rr.ARROW_CHAR+" ":" "+rr.ARROW_CHAR)),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.arrow.setAttribute("dominant-baseline","central");let t;(t=this.getSourceBlock())!=null&&t.RTL?this.getTextElement().insertBefore(this.arrow,this.textContent_):this.getTextElement().appendChild(this.arrow)}createSVGArrow_(){this.svgArrow=re(oe.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS(nr,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(e){var t=this.getSourceBlock();if(!t)throw new Gn;this.dropdownCreate(),this.menu_.openingCoords=e&&typeof e.clientX=="number"?new Le(e.clientX,e.clientY):null,Kr(),e=this.menu_.render(wn()),Fe(e,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(t=t.getColour(),e=this.sourceBlock_.getColourTertiary(),uc(t,e)),dc(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem&&(this.menu_.setHighlighted(this.selectedMenuItem),Ir(this.selectedMenuItem.getElement(),wn(),!0)),this.applyColour()}dropdownCreate(){const e=this.getSourceBlock();if(!e)throw new Gn;const t=new ug;t.setRole(Pr.LISTBOX),this.menu_=t;const r=this.getOptions(!1);this.selectedMenuItem=null;for(let p=0;p<r.length;p++){const[v,O]=r[p];if(typeof v=="object"){var l=new Image(v.width,v.height);l.src=v.src,l.alt=v.alt||""}else l=v;l=new xd(l,O),l.setRole(Pr.OPTION),l.setRightToLeft(e.RTL),l.setCheckable(!0),t.addChild(l),l.setChecked(O===this.value_),O===this.value_&&(this.selectedMenuItem=l),l.onAction(this.handleMenuActionEvent,this)}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem=this.menu_=null,this.applyColour()}handleMenuActionEvent(e){el(this,!0),this.onItemSelected_(this.menu_,e)}onItemSelected_(e,t){this.setValue(t.getValue())}isOptionListDynamic(){return typeof this.menuGenerator_=="function"}getOptions(e){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:e&&this.generatedOptions?this.generatedOptions:(this.generatedOptions=this.menuGenerator_(),this.validateOptions(this.generatedOptions),this.generatedOptions)}doClassValidation_(e){return this.getOptions(!0).some(t=>t[1]===e)?e:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+e),null)}doValueUpdate_(e){super.doValueUpdate_(e),e=this.getOptions(!0);for(let t=0,r;r=e[t];t++)r[1]===this.value_&&(this.selectedOption=r)}applyColour(){const e=this.sourceBlock_;this.borderRect_&&(this.borderRect_.setAttribute("stroke",e.getColourTertiary()),this.menu_?this.borderRect_.setAttribute("fill",e.getColourTertiary()):this.borderRect_.setAttribute("fill","transparent")),e&&this.arrow&&(e.isShadow()?this.arrow.style.fill=e.getColourSecondary():this.arrow.style.fill=e.getColour())}render_(){this.getTextContent().nodeValue="",this.imageElement.style.display="none";const e=this.selectedOption&&this.selectedOption[0];e&&typeof e=="object"?this.renderSelectedImage(e):this.renderSelectedText(),this.positionBorderRect_()}renderSelectedImage(e){const t=this.getSourceBlock();if(!t)throw new Gn;this.imageElement.style.display="",this.imageElement.setAttributeNS(nr,"xlink:href",e.src),this.imageElement.setAttribute("height",String(e.height)),this.imageElement.setAttribute("width",String(e.width));const r=Number(e.height);e=Number(e.width);var l=!!this.borderRect_;const p=Math.max(l?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,r+rr.IMAGE_Y_PADDING);l=l?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let v;v=this.svgArrow?this.positionSVGArrow(e+l,p/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):ns(this.arrow,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY),this.size_.width=e+v+2*l,this.size_.height=p;let O=0;t.RTL?this.imageElement.setAttribute("x",`${l+v}`):(O=e+v,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement.setAttribute("x",`${l}`)),this.imageElement.setAttribute("y",String(p/2-r/2)),this.positionTextElement_(O+l,e+v)}renderSelectedText(){this.getTextContent().nodeValue=this.getDisplayText_();var e=this.getTextElement();Fe(e,"blocklyDropdownText"),e.setAttribute("text-anchor","start");var t=!!this.borderRect_;e=Math.max(t?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);const r=ns(this.getTextElement(),this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);t=t?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let l=0;this.svgArrow&&(l=this.positionSVGArrow(r+t,e/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=r+l+2*t,this.size_.height=e,this.positionTextElement_(t,r)}positionSVGArrow(e,t){if(!this.svgArrow)return 0;const r=this.getSourceBlock();if(!r)throw new Gn;const l=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,p=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,v=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow.setAttribute("transform","translate("+(r.RTL?l:e+p)+","+t+")"),v+p}getText_(){if(!this.selectedOption)return null;const e=this.selectedOption[0];return typeof e=="object"?e.alt:e}static fromJson(e){if(!e.options)throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(e.options,void 0,e)}trimOptions(e){let t=!1;const r=e.map(([O,G])=>typeof O=="string"?[kt(O),G]:(t=!0,[O.alt!==null?Object.assign({},O,{alt:kt(O.alt)}):Object.assign({},O),G]));if(t||2>e.length)return{options:r};var l=r.map(([O])=>O),p=sa(l);e=Yh(l,p);const v=Mu(l,p);return!e&&!v||p<=e+v?{options:r}:(p=e?l[0].substring(0,e-1):void 0,l=v?l[0].substr(1-v):void 0,{options:this.applyTrim(r,e,v),prefix:p,suffix:l})}applyTrim(e,t,r){return e.map(([l,p])=>[l.substring(t,l.length-r),p])}validateOptions(e){if(!Array.isArray(e))throw TypeError("FieldDropdown options must be an array.");if(!e.length)throw TypeError("FieldDropdown options must not be an empty array.");let t=!1;for(let r=0;r<e.length;r++){const l=e[r];Array.isArray(l)?typeof l[1]!="string"?(t=!0,console.error(`Invalid option[${r}]: Each FieldDropdown option id must be a string. 
          Found ${l[1]} in: ${l}`)):l[0]&&typeof l[0]!="string"&&typeof l[0].src!="string"&&(t=!0,console.error(`Invalid option[${r}]: Each FieldDropdown option must have a string 
          label or image description. Found ${l[0]} in: ${l}`)):(t=!0,console.error(`Invalid option[${r}]: Each FieldDropdown option must be an array.
          Found: ${l}`))}if(t)throw TypeError("Found invalid FieldDropdown options.")}};rr.CHECKMARK_OVERHANG=25,rr.MAX_MENU_HEIGHT_VH=.45,rr.ARROW_CHAR="",rr.IMAGE_Y_OFFSET=5,rr.IMAGE_Y_PADDING=2*rr.IMAGE_Y_OFFSET,Ot("field_dropdown",rr);var Ob=class{constructor(e,t){this.bubble=e,this.workspace=t,this.startLoc=null,this.inGroup=!1}isMovable(){return!0}startDrag(){(this.inGroup=!!s.getGroup$$module$build$src$core$events$utils())||s.setGroup$$module$build$src$core$events$utils(!0),this.startLoc=this.bubble.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1);let e;(e=this.workspace.getLayerManager())==null||e.moveToDragLayer(this.bubble),this.bubble.setDragging&&this.bubble.setDragging(!0)}drag(e){this.bubble.moveDuringDrag(e)}endDrag(){this.workspace.setResizesEnabled(!0),this.inGroup||s.setGroup$$module$build$src$core$events$utils(!1);let e;(e=this.workspace.getLayerManager())==null||e.moveOffDragLayer(this.bubble,Ma),this.bubble.setDragging(!1)}revertDrag(){this.startLoc&&this.bubble.moveDuringDrag(this.startLoc)}},Ps,fn=class{constructor(e,t,r){this.workspace=e,this.anchor=t,this.ownerRect=r,this.size=new Jt(0,0),this.colour="#ffffff",this.disposed=!1,this.relativeLeft=this.relativeTop=0,this.dragStrategy=new Ob(this,this.workspace),this.id=C(),this.svgRoot=re(oe.G,{class:"blocklyBubble"},e.getBubbleCanvas()),e=re(oe.G,{filter:`url(#${this.workspace.getRenderer().getConstants().embossFilterId})`},this.svgRoot),this.tail=re(oe.PATH,{class:"blocklyBubbleTail"},e),this.background=re(oe.RECT,{class:"blocklyDraggable",x:0,y:0,rx:Ps.BORDER_WIDTH,ry:Ps.BORDER_WIDTH},e),this.contentContainer=re(oe.G,{},this.svgRoot),Ue(this.background,"pointerdown",this,this.onMouseDown)}dispose(){mt(this.svgRoot),this.disposed=!0}setAnchorLocation(e,t=!1){this.anchor=e,t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}setPositionRelativeToAnchor(e,t){this.relativeLeft=e,this.relativeTop=t,this.positionRelativeToAnchor(),this.renderTail()}getSize(){return this.size}setSize(e,t=!1){e.width=Math.max(e.width,Ps.MIN_SIZE),e.height=Math.max(e.height,Ps.MIN_SIZE),this.size=e,this.background.setAttribute("width",`${e.width}`),this.background.setAttribute("height",`${e.height}`),t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}getColour(){return this.colour}setColour(e){this.colour=e,this.tail.setAttribute("fill",e),this.background.setAttribute("fill",e)}onMouseDown(e){let t;(t=this.workspace.getGesture(e))==null||t.handleBubbleStart(e,this),this.bringToFront(),s.setSelected$$module$build$src$core$common(this)}positionRelativeToAnchor(){let e=this.anchor.x;e=this.workspace.RTL?e-(this.relativeLeft+this.size.width):e+this.relativeLeft,this.moveTo(e,this.relativeTop+this.anchor.y)}moveTo(e,t){this.svgRoot.setAttribute("transform",`translate(${e}, ${t})`)}positionByRect(e=new Bt(0,0,0,0)){var t=this.workspace.getMetricsManager().getViewMetrics(!0),r=this.getOptimalRelativeLeft(t),l=this.getOptimalRelativeTop(t);const p={x:r,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},v={x:-this.size.width-30,y:l};l={x:e.getWidth(),y:l};var O={x:r,y:e.getHeight()};r=e.getWidth()<e.getHeight()?l:O,e=e.getWidth()<e.getHeight()?O:l,l=this.getOverlap(p,t),O=this.getOverlap(v,t);const G=this.getOverlap(r,t);t=this.getOverlap(e,t),t=Math.max(l,O,G,t),l===t?(this.relativeLeft=p.x,this.relativeTop=p.y):O===t?(this.relativeLeft=v.x,this.relativeTop=v.y):G===t?(this.relativeLeft=r.x,this.relativeTop=r.y):(this.relativeLeft=e.x,this.relativeTop=e.y),this.positionRelativeToAnchor()}getOverlap(e,t){var r=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x+this.anchor.x;return e=e.y+this.anchor.y,Math.max(0,Math.min(1,(Math.min(r+this.size.width,t.left+t.width)-Math.max(r,t.left))*(Math.min(e+this.size.height,t.top+t.height)-Math.max(e,t.top))/(this.size.width*this.size.height)))}getOptimalRelativeLeft(e){let t=-this.size.width/4;if(this.size.width>e.width)return t;if(e=this.getWorkspaceViewRect(e),this.workspace.RTL){var r=this.anchor.x-t;r-this.size.width<e.left?t=-(e.left-this.anchor.x+this.size.width):r>e.right&&(t=-(e.right-this.anchor.x))}else{r=t+this.anchor.x;const l=r+this.size.width;r<e.left?t=e.left-this.anchor.x:l>e.right&&(t=e.right-this.anchor.x-this.size.width)}return t}getOptimalRelativeTop(e){let t=-this.size.height/4;if(this.size.height>e.height)return t;const r=this.anchor.y+t,l=r+this.size.height;return e=this.getWorkspaceViewRect(e),r<e.top?t=e.top-this.anchor.y:l>e.bottom&&(t=e.bottom-this.anchor.y-this.size.height),t}getWorkspaceViewRect(e){const t=e.top;let r=e.top+e.height,l=e.left;return e=e.left+e.width,r-=this.getScrollbarThickness(),this.workspace.RTL?l-=this.getScrollbarThickness():e-=this.getScrollbarThickness(),new Bt(t,r,l,e)}getScrollbarThickness(){return Fn.scrollbarThickness/this.workspace.scale}renderTail(){const e=[];var t=this.size.width/2,r=this.size.height/2,l=-this.relativeLeft,p=-this.relativeTop;if(t===l&&r===p)e.push("M "+t+","+r);else{p-=r,l-=t,this.workspace.RTL&&(l*=-1);var v=Math.sqrt(p*p+l*l),O=Math.acos(l/v);0>p&&(O=2*Math.PI-O);var G=O+Math.PI/2;G>2*Math.PI&&(G-=2*Math.PI);var Ie=Math.sin(G);const Mn=Math.cos(G);let On=(this.size.width+this.size.height)/Ps.TAIL_THICKNESS;On=Math.min(On,this.size.width,this.size.height)/4,G=1-Ps.ANCHOR_RADIUS/v,l=t+G*l,p=r+G*p,G=t+On*Mn;const Vr=r+On*Ie;t-=On*Mn,r-=On*Ie,Ie=Ns(this.workspace.RTL?-Ps.TAIL_ANGLE:Ps.TAIL_ANGLE),Ie=O+Ie,Ie>2*Math.PI&&(Ie-=2*Math.PI),O=Math.sin(Ie)*v/Ps.TAIL_BEND,v=Math.cos(Ie)*v/Ps.TAIL_BEND,e.push("M"+G+","+Vr),e.push("C"+(G+v)+","+(Vr+O)+" "+l+","+p+" "+l+","+p),e.push("C"+l+","+p+" "+(t+v)+","+(r+O)+" "+t+","+r)}e.push("z");let Qe;(Qe=this.tail)==null||Qe.setAttribute("d",e.join(" "))}bringToFront(){let e;const t=(e=this.svgRoot)==null?void 0:e.parentNode;return this.svgRoot&&(t==null?void 0:t.lastChild)!==this.svgRoot?(t==null||t.appendChild(this.svgRoot),!0):!1}getRelativeToSurfaceXY(){return new Le(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(e){this.moveTo(e.x,e.y),this.relativeLeft=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x-this.anchor.x,this.relativeTop=e.y-this.anchor.y,this.renderTail()}setDragging(e){}setDeleteStyle(e){}isDeletable(){return!1}showContextMenu(e){}isMovable(){return!0}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){}unselect(){}};Ps=fn,fn.BORDER_WIDTH=6,fn.DOUBLE_BORDER=2*Ps.BORDER_WIDTH,fn.MIN_SIZE=Ps.DOUBLE_BORDER,fn.TAIL_THICKNESS=1,fn.TAIL_ANGLE=20,fn.TAIL_BEND=4,fn.ANCHOR_RADIUS=8;var vs=class extends fn{constructor(e,t,r,l){super(t,r,l),this.workspace=t,this.anchor=r,this.ownerRect=l,this.autoLayout=!0,t=new zr(e),this.validateWorkspaceOptions(t),this.svgDialog=re(oe.SVG,{x:fn.BORDER_WIDTH,y:fn.BORDER_WIDTH},this.contentContainer),e.parentWorkspace=this.workspace,this.miniWorkspace=this.newWorkspaceSvg(new zr(e)),this.miniWorkspace.internalIsMutator=!0,e=this.miniWorkspace.createDom("blocklyMutatorBackground"),this.svgDialog.appendChild(e),t.languageTree&&(e.insertBefore(this.miniWorkspace.addFlyout(oe.G),this.miniWorkspace.getCanvas()),e=this.miniWorkspace.getFlyout(),e==null||e.init(this.miniWorkspace),e==null||e.show(t.languageTree)),this.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this));let p,v;(p=this.miniWorkspace.getFlyout())==null||(v=p.getWorkspace())==null||v.addChangeListener(this.onWorkspaceChange.bind(this)),this.updateBubbleSize()}dispose(){this.miniWorkspace.dispose(),super.dispose()}getWorkspace(){return this.miniWorkspace}addWorkspaceChangeListener(e){this.miniWorkspace.addChangeListener(e)}validateWorkspaceOptions(e){if(e.hasCategories)throw Error("The miniworkspace bubble does not support toolboxes with categories");if(e.hasTrashcan)throw Error("The miniworkspace bubble does not support trashcans");if(e.zoomOptions.controls||e.zoomOptions.wheel||e.zoomOptions.pinch)throw Error("The miniworkspace bubble does not support zooming");if(e.moveOptions.scrollbars||e.moveOptions.wheel||e.moveOptions.drag)throw Error("The miniworkspace bubble does not scrolling/moving the workspace");if(e.horizontalLayout)throw Error("The miniworkspace bubble does not support horizontal layouts")}onWorkspaceChange(){this.bumpBlocksIntoBounds(),this.updateBubbleSize()}bumpBlocksIntoBounds(){if(!this.miniWorkspace.isDragging())for(const e of this.miniWorkspace.getTopBlocks(!1)){const t=e.getRelativeToSurfaceXY();if(20>t.y&&e.moveBy(0,20-t.y),e.RTL){let r=-20;const l=this.miniWorkspace.getFlyout();l&&(r-=l.getWidth()),t.x>r&&e.moveBy(r-t.x,0)}else 20>t.x&&e.moveBy(20-t.x,0)}}updateBubbleSize(){if(!this.miniWorkspace.isDragging()){var e=this.getSize(),t=this.calculateWorkspaceSize();Math.abs(e.width-t.width)<vs.MINIMUM_VIEW_CHANGE&&Math.abs(e.height-t.height)<vs.MINIMUM_VIEW_CHANGE||(this.svgDialog.setAttribute("width",`${t.width}px`),this.svgDialog.setAttribute("height",`${t.height}px`),this.miniWorkspace.setCachedParentSvgSize(t.width,t.height),this.miniWorkspace.RTL&&this.miniWorkspace.getCanvas().setAttribute("transform",`translate(${t.width}, 0)`),this.setSize(new Jt(t.width+fn.DOUBLE_BORDER,t.height+fn.DOUBLE_BORDER),this.autoLayout),this.miniWorkspace.resize(),this.miniWorkspace.recordDragTargets())}}calculateWorkspaceSize(){var e=this.miniWorkspace.getCanvas().getBBox();let t=e.width+vs.MARGIN;e=e.height+vs.MARGIN;const r=this.miniWorkspace.getFlyout();if(r){const l=r.getWorkspace().getMetricsManager().getScrollMetrics();e=Math.max(e,l.height+20),t+=r.getWidth()}return new Jt(t,e)}updateBlockStyles(){for(var e of this.miniWorkspace.getAllBlocks(!1))e.setStyle(e.getStyleName());let t;if(e=(t=this.miniWorkspace.getFlyout())==null?void 0:t.getWorkspace())for(const r of e.getAllBlocks(!1))r.setStyle(r.getStyleName())}moveDuringDrag(e){super.moveDuringDrag(e),this.autoLayout=!1}moveTo(e,t){super.moveTo(e,t),this.miniWorkspace.recordDragTargets()}newWorkspaceSvg(e){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}};vs.MINIMUM_VIEW_CHANGE=10,vs.MARGIN=3*fn.DOUBLE_BORDER;var eu=class{constructor(e){this.sourceBlock=e,this.offsetInBlock=new Le(0,0),this.workspaceLocation=new Le(0,0),this.svgRoot=null,this.tooltip=e}getType(){throw Error("Icons must implement getType")}initView(e){if(!this.svgRoot){var t=this.sourceBlock;this.svgRoot=re(oe.G,{class:"blocklyIconGroup"}),t.getSvgRoot().appendChild(this.svgRoot),this.updateSvgRootOffset(),Ue(this.svgRoot,"pointerdown",this,e),this.svgRoot.tooltip=this,rl(this.svgRoot)}}dispose(){Nu(this.svgRoot),mt(this.svgRoot)}getWeight(){return-1}getSize(){return new Jt(0,0)}setTooltip(e){this.tooltip=e??this.sourceBlock}getTooltip(){return this.tooltip}applyColour(){}updateEditable(){}updateCollapsed(){this.svgRoot&&(this.sourceBlock.isCollapsed()?this.svgRoot.style.display="none":this.svgRoot.style.display="block",Ya(this)&&this.setBubbleVisible(!1))}hideForInsertionMarker(){this.svgRoot&&(this.svgRoot.style.display="none")}isShownWhenCollapsed(){return!1}setOffsetInBlock(e){this.offsetInBlock=e,this.updateSvgRootOffset()}updateSvgRootOffset(){let e;(e=this.svgRoot)==null||e.setAttribute("transform",`translate(${this.offsetInBlock.x}, ${this.offsetInBlock.y})`)}onLocationChange(e){this.workspaceLocation=Le.sum(e,this.offsetInBlock)}onClick(){}isClickableInFlyout(e){return!0}},Na,An;Na=17,An=16,s.MutatorIcon$$module$build$src$core$icons$mutator_icon=class extends eu{constructor(e,t){super(t),this.flyoutBlockTypes=e,this.sourceBlock=t,this.saveConnectionsListener=this.updateWorkspacePid=this.rootBlock=this.miniWorkspaceBubble=null}getType(){return s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE}initView(e){this.svgRoot||(super.initView(e),re(oe.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},this.svgRoot),re(oe.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},this.svgRoot),re(oe.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},this.svgRoot),Fe(this.svgRoot,"blockly-icon-mutator"))}dispose(){super.dispose();let e;(e=this.miniWorkspaceBubble)==null||e.dispose()}getWeight(){return s.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT}getSize(){return new Jt(Na,Na)}applyColour(){super.applyColour();let e;(e=this.miniWorkspaceBubble)==null||e.setColour(this.sourceBlock.getColour());let t;(t=this.miniWorkspaceBubble)==null||t.updateBlockStyles()}updateCollapsed(){super.updateCollapsed(),this.sourceBlock.isCollapsed()&&this.setBubbleVisible(!1)}onLocationChange(e){super.onLocationChange(e);let t;(t=this.miniWorkspaceBubble)==null||t.setAnchorLocation(this.getAnchorLocation())}onClick(){super.onClick(),this.sourceBlock.isEditable()&&this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.miniWorkspaceBubble}setBubbleVisible(e){const t=this;return Re.asyncExecutePromiseGeneratorFunction(function*(){if(t.bubbleIsVisible()!==e){if(yield rs(),e){t.miniWorkspaceBubble=new vs(t.getMiniWorkspaceConfig(),t.sourceBlock.workspace,t.getAnchorLocation(),t.getBubbleOwnerRect()),t.applyColour(),t.createRootBlock(),t.addSaveConnectionsListener();let r;(r=t.miniWorkspaceBubble)==null||r.addWorkspaceChangeListener(t.createMiniWorkspaceChangeListener())}else{let r;(r=t.miniWorkspaceBubble)==null||r.dispose(),t.miniWorkspaceBubble=null,t.saveConnectionsListener&&t.sourceBlock.workspace.removeChangeListener(t.saveConnectionsListener),t.saveConnectionsListener=null}ee(new(Ce(fe.BUBBLE_OPEN))(t.sourceBlock,e,"mutator"))}})}getMiniWorkspaceConfig(){let e;const t={disable:!1,media:this.sourceBlock.workspace.options.pathToMedia,rtl:this.sourceBlock.RTL,renderer:this.sourceBlock.workspace.options.renderer,rendererOverrides:(e=this.sourceBlock.workspace.options.rendererOverrides)!=null?e:void 0};return this.flyoutBlockTypes.length&&(t.toolbox={kind:"flyoutToolbox",contents:this.flyoutBlockTypes.map(r=>({kind:"block",type:r}))}),t}getAnchorLocation(){const e=Na/2;return Le.sum(this.workspaceLocation,new Le(e,e))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new Bt(e.y,e.y+e.height,e.x,e.x+e.width)}createRootBlock(){if(!this.sourceBlock.decompose)throw Error("Blocks with mutator icons must include a decompose method");this.rootBlock=this.sourceBlock.decompose(this.miniWorkspaceBubble.getWorkspace());for(var e of this.rootBlock.getDescendants(!1))e.queueRender();this.rootBlock.setMovable(!1),this.rootBlock.setDeletable(!1);let t,r,l,p;e=(p=(t=this.miniWorkspaceBubble)==null||(r=t.getWorkspace())==null||(l=r.getFlyout())==null?void 0:l.getWidth())!=null?p:0,this.rootBlock.moveBy(this.rootBlock.RTL?-(e+An):An,An)}addSaveConnectionsListener(){this.sourceBlock.saveConnections&&this.rootBlock&&(this.saveConnectionsListener=()=>{this.sourceBlock.saveConnections&&this.rootBlock&&this.sourceBlock.saveConnections(this.rootBlock)},this.saveConnectionsListener(),this.sourceBlock.workspace.addChangeListener(this.saveConnectionsListener))}createMiniWorkspaceChangeListener(){return e=>{s.MutatorIcon$$module$build$src$core$icons$mutator_icon.isIgnorableMutatorEvent(e)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout(()=>{this.updateWorkspacePid=null,this.recomposeSourceBlock()},0))}}static isIgnorableMutatorEvent(e){return e.isUiEvent||k(e)||P(e)&&e.element==="disabled"}recomposeSourceBlock(){if(this.rootBlock){if(!this.sourceBlock.compose)throw Error("Blocks with mutator icons must include a compose method");var e=s.getGroup$$module$build$src$core$events$utils();e||s.setGroup$$module$build$src$core$events$utils(!0);var t=Xi.getExtraBlockState_(this.sourceBlock);this.sourceBlock.compose(this.rootBlock);var r=Xi.getExtraBlockState_(this.sourceBlock);t!==r&&ee(new(Ce(fe.BLOCK_CHANGE))(this.sourceBlock,"mutation",null,t,r)),s.setGroup$$module$build$src$core$events$utils(e)}}getWorkspace(){let e;return(e=this.miniWorkspaceBubble)==null?void 0:e.getWorkspace()}},s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE=Qn.MUTATOR,s.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT=1,s.MutatorIcon$$module$build$src$core$icons$mutator_icon;var Tn=Object.create(null),Rb={allExtensions:Tn};s.register$$module$build$src$core$extensions("parent_tooltip_when_inline",di);var ti={TEST_ONLY:Rb};ti.apply=Gu,ti.buildTooltipForDropdown=s.buildTooltipForDropdown$$module$build$src$core$extensions,ti.buildTooltipWithFieldText=s.buildTooltipWithFieldText$$module$build$src$core$extensions,ti.isRegistered=Ui,ti.register=s.register$$module$build$src$core$extensions,ti.registerMixin=s.registerMixin$$module$build$src$core$extensions,ti.registerMutator=s.registerMutator$$module$build$src$core$extensions,ti.runAfterPageLoad=Rm,ti.unregister=Im;var Vt;(function(e){e[e.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",e[e.MAC_ENTER=3]="MAC_ENTER",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.NUM_CENTER=12]="NUM_CENTER",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESC=27]="ESC",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.PLUS_SIGN=43]="PLUS_SIGN",e[e.PRINT_SCREEN=44]="PRINT_SCREEN",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.ZERO=48]="ZERO",e[e.ONE=49]="ONE",e[e.TWO=50]="TWO",e[e.THREE=51]="THREE",e[e.FOUR=52]="FOUR",e[e.FIVE=53]="FIVE",e[e.SIX=54]="SIX",e[e.SEVEN=55]="SEVEN",e[e.EIGHT=56]="EIGHT",e[e.NINE=57]="NINE",e[e.FF_SEMICOLON=59]="FF_SEMICOLON",e[e.FF_EQUALS=61]="FF_EQUALS",e[e.FF_DASH=173]="FF_DASH",e[e.FF_HASH=163]="FF_HASH",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.AT_SIGN=64]="AT_SIGN",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.META=91]="META",e[e.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",e[e.CONTEXT_MENU=93]="CONTEXT_MENU",e[e.NUM_ZERO=96]="NUM_ZERO",e[e.NUM_ONE=97]="NUM_ONE",e[e.NUM_TWO=98]="NUM_TWO",e[e.NUM_THREE=99]="NUM_THREE",e[e.NUM_FOUR=100]="NUM_FOUR",e[e.NUM_FIVE=101]="NUM_FIVE",e[e.NUM_SIX=102]="NUM_SIX",e[e.NUM_SEVEN=103]="NUM_SEVEN",e[e.NUM_EIGHT=104]="NUM_EIGHT",e[e.NUM_NINE=105]="NUM_NINE",e[e.NUM_MULTIPLY=106]="NUM_MULTIPLY",e[e.NUM_PLUS=107]="NUM_PLUS",e[e.NUM_MINUS=109]="NUM_MINUS",e[e.NUM_PERIOD=110]="NUM_PERIOD",e[e.NUM_DIVISION=111]="NUM_DIVISION",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUMLOCK=144]="NUMLOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",e[e.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",e[e.SEMICOLON=186]="SEMICOLON",e[e.DASH=189]="DASH",e[e.EQUALS=187]="EQUALS",e[e.COMMA=188]="COMMA",e[e.PERIOD=190]="PERIOD",e[e.SLASH=191]="SLASH",e[e.APOSTROPHE=192]="APOSTROPHE",e[e.TILDE=192]="TILDE",e[e.SINGLE_QUOTE=222]="SINGLE_QUOTE",e[e.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",e[e.BACKSLASH=220]="BACKSLASH",e[e.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",e[e.WIN_KEY=224]="WIN_KEY",e[e.MAC_FF_META=224]="MAC_FF_META",e[e.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",e[e.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",e[e.WIN_IME=229]="WIN_IME",e[e.VK_NONAME=252]="VK_NONAME",e[e.PHANTOM=255]="PHANTOM"})(Vt||(Vt={}));var to={};to.arc=Hn,to.curve=Zs,to.line=Mr,to.lineOnAxis=tt,to.lineTo=hi,to.moveBy=xn,to.moveTo=is,to.point=ut;var Ln={};Ln.Coordinate=Le,Ln.KeyCodes=Vt,Ln.Rect=Bt,Ln.Size=Jt,Ln.Svg=oe,Ln.aria=Pc,Ln.array=Rc,Ln.browserEvents=gt,Ln.colour=jr,Ln.deprecation=md,Ln.dom=ds,Ln.extensions=ti,Ln.idGenerator=bd,Ln.math=Vc,Ln.object=Db,Ln.parsing=Jc,Ln.string=Ol,Ln.style=$i,Ln.svgMath=Io,Ln.svgPaths=to,Ln.toolbox=qi,Ln.userAgent=eg,Ln.xml=xo;var Mb=class extends fn{constructor(e,t,r){super(e,t,r),this.workspace=e,this.anchor=t,this.ownerRect=r,this.resizePointerMoveListener=this.resizePointerUpListener=null,this.textChangeListeners=[],this.sizeChangeListeners=[],this.text="",this.DEFAULT_SIZE=new Jt(160+fn.DOUBLE_BORDER,80+fn.DOUBLE_BORDER),this.MIN_SIZE=new Jt(45+fn.DOUBLE_BORDER,20+fn.DOUBLE_BORDER),this.editable=!0,Fe(this.svgRoot,"blocklyTextInputBubble"),{inputRoot:this.inputRoot,textArea:this.textArea}=this.createEditor(this.contentContainer),this.resizeGroup=this.createResizeHandle(this.svgRoot,e),this.setSize(this.DEFAULT_SIZE,!0)}getText(){return this.text}setText(e){this.text=e,this.textArea.value=e,this.onTextChange()}setEditable(e){(this.editable=e)?this.textArea.removeAttribute("readonly"):this.textArea.setAttribute("readonly","")}isEditable(){return this.editable}addTextChangeListener(e){this.textChangeListeners.push(e)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}createEditor(e){e=re(oe.FOREIGNOBJECT,{x:fn.BORDER_WIDTH,y:fn.BORDER_WIDTH},e);const t=document.createElementNS(bi,"body");t.setAttribute("xmlns",bi),t.className="blocklyMinimalBody";const r=document.createElementNS(bi,"textarea");return r.className="blocklyTextarea blocklyText",r.setAttribute("dir",this.workspace.RTL?"RTL":"LTR"),t.appendChild(r),e.appendChild(t),this.bindTextAreaEvents(r),setTimeout(()=>{r.focus()},0),{inputRoot:e,textArea:r}}bindTextAreaEvents(e){Ue(e,"wheel",this,t=>{t.stopPropagation()}),Ue(e,"focus",this,this.onStartEdit,!0),Ue(e,"change",this,this.onTextChange)}createResizeHandle(e,t){return e=re(oe.IMAGE,{class:"blocklyResizeHandle",href:`${t.options.pathToMedia}resize-handle.svg`},e),Ue(e,"pointerdown",this,this.onResizePointerDown),e}setSize(e,t=!1){e.width=Math.max(e.width,this.MIN_SIZE.width),e.height=Math.max(e.height,this.MIN_SIZE.height);const r=e.width-fn.DOUBLE_BORDER,l=e.height-fn.DOUBLE_BORDER;this.inputRoot.setAttribute("width",`${r}`),this.inputRoot.setAttribute("height",`${l}`),this.resizeGroup.setAttribute("y",`${l}`),this.workspace.RTL?this.resizeGroup.setAttribute("x",`${-fn.DOUBLE_BORDER}`):this.resizeGroup.setAttribute("x",`${r}`),super.setSize(e,t),this.onSizeChange()}getSize(){return super.getSize()}onResizePointerDown(e){this.bringToFront(),ct(e)||(aa(this.workspace,e,new Le(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=Ue(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=Ue(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation()}onResizePointerUp(e){ft(),this.resizePointerUpListener&&(wt(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(wt(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(e){e=ju(this.workspace,e),this.setSize(new Jt(this.workspace.RTL?-e.x:e.x,e.y),!1),this.onSizeChange()}onStartEdit(){this.bringToFront()&&this.textArea.focus()}onTextChange(){this.text=this.textArea.value;for(const e of this.textChangeListeners)e()}onSizeChange(){for(const e of this.sizeChangeListeners)e()}};we(`
.blocklyTextInputBubble .blocklyTextarea {
  background-color: var(--commentFillColour);
  border: 0;
  box-sizing: border-box;
  display: block;
  outline: 0;
  padding: 5px;
  resize: none;
  width: 100%;
  height: 100%;
}
`);var Og={};Og.register=pr,Og.unregister=Nm;var zd=17,Bl=160,Ud=80,no=class extends eu{constructor(e){super(e),this.sourceBlock=e,this.textInputBubble=null,this.text="",this.bubbleSize=new Jt(Bl,Ud),this.bubbleVisiblity=!1}getType(){return no.TYPE}initView(e){this.svgRoot||(super.initView(e),re(oe.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},this.svgRoot),re(oe.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},this.svgRoot),re(oe.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},this.svgRoot),Fe(this.svgRoot,"blockly-icon-comment"))}dispose(){super.dispose();let e;(e=this.textInputBubble)==null||e.dispose()}getWeight(){return no.WEIGHT}getSize(){return new Jt(zd,zd)}applyColour(){super.applyColour();const e=this.sourceBlock.getColour();let t;(t=this.textInputBubble)==null||t.setColour(e)}updateEditable(){const e=this,t=()=>super.updateEditable;return Re.asyncExecutePromiseGeneratorFunction(function*(){t().call(e),e.bubbleIsVisible()&&(yield e.setBubbleVisible(!1),yield e.setBubbleVisible(!0))})}onLocationChange(e){super.onLocationChange(e),e=this.getAnchorLocation();let t;(t=this.textInputBubble)==null||t.setAnchorLocation(e)}setText(e){const t=this.text;ee(new(Ce(fe.BLOCK_CHANGE))(this.sourceBlock,"comment",null,t,e)),this.text=e;let r;(r=this.textInputBubble)==null||r.setText(this.text)}getText(){return this.text}setBubbleSize(e){this.bubbleSize=e;let t;(t=this.textInputBubble)==null||t.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}saveState(){return this.text?{text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width}:null}loadState(e){let t;this.text=(t=e.text)!=null?t:"";let r,l;this.bubbleSize=new Jt((r=e.width)!=null?r:Bl,(l=e.height)!=null?l:Ud);let p;this.bubbleVisiblity=(p=e.pinned)!=null?p:!1,this.setBubbleVisible(this.bubbleVisiblity)}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}onTextChange(){if(this.textInputBubble){var e=this.textInputBubble.getText();this.text!==e&&(ee(new(Ce(fe.BLOCK_CHANGE))(this.sourceBlock,"comment",null,this.text,e)),this.text=e)}}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}bubbleIsVisible(){return this.bubbleVisiblity}setBubbleVisible(e){const t=this;return Re.asyncExecutePromiseGeneratorFunction(function*(){t.bubbleVisiblity!==e&&(t.bubbleVisiblity=e,yield rs(),!t.sourceBlock.rendered||t.sourceBlock.isInFlyout||t.sourceBlock.isInsertionMarker()||(e?(t.sourceBlock.isEditable()?t.showEditableBubble():t.showNonEditableBubble(),t.applyColour()):t.hideBubble(),ee(new(Ce(fe.BUBBLE_OPEN))(t.sourceBlock,e,"comment"))))})}showEditableBubble(){this.createBubble();let e;(e=this.textInputBubble)==null||e.addTextChangeListener(()=>this.onTextChange());let t;(t=this.textInputBubble)==null||t.addSizeChangeListener(()=>this.onSizeChange())}showNonEditableBubble(){this.createBubble();let e;(e=this.textInputBubble)==null||e.setEditable(!1)}createBubble(){this.textInputBubble=new Mb(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0)}hideBubble(){let e;(e=this.textInputBubble)==null||e.dispose(),this.textInputBubble=null}getAnchorLocation(){const e=zd/2;return Le.sum(this.workspaceLocation,new Le(e,e))}getBubbleOwnerRect(){return this.sourceBlock.getBoundingRectangleWithoutChildren()}};no.TYPE=Qn.COMMENT,no.WEIGHT=3,pr(no.TYPE,no);var Rg=class extends Error{constructor(e){super(`Tried to append an icon of type ${e.getType()} when an icon of that type already exists on the block. Use getIcon to access the existing icon.`),this.icon=e}},tu={};tu.DuplicateIconType=Rg;var ir=class extends fn{constructor(e,t,r,l){super(t,r,l),this.text=e,this.workspace=t,this.anchor=r,this.ownerRect=l,this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize()}getText(){return this.text}setText(e){this.text=e,mt(this.paragraph),this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize()}stringToSvg(e,t){return t=this.createParagraph(t),e=this.createTextFragments(t,e),this.workspace.RTL&&this.rightAlignTextFragments(t.getBBox().width,e),t}createParagraph(e){return re(oe.G,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",transform:`translate(0,${fn.BORDER_WIDTH})`,style:`direction: ${this.workspace.RTL?"rtl":"ltr"}`},e)}createTextFragments(e,t){let r=1;return t.split(`
`).map(l=>{const p=re(oe.TEXT,{y:`${r}em`,x:fn.BORDER_WIDTH},e);return l=document.createTextNode(l),p.appendChild(l),r+=1,p})}rightAlignTextFragments(e,t){for(const r of t)r.setAttribute("text-anchor","start"),r.setAttribute("x",`${e+fn.BORDER_WIDTH}`)}updateBubbleSize(){const e=this.paragraph.getBBox();this.setSize(new Jt(e.width+2*fn.BORDER_WIDTH,e.height+2*fn.BORDER_WIDTH),!0)}},Oo=17,so=class extends eu{constructor(e){super(e),this.sourceBlock=e,this.textMap=new Map,this.textBubble=null}getType(){return so.TYPE}initView(e){this.svgRoot||(super.initView(e),re(oe.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},this.svgRoot),re(oe.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},this.svgRoot),re(oe.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},this.svgRoot),Fe(this.svgRoot,"blockly-icon-warning"))}dispose(){super.dispose();let e;(e=this.textBubble)==null||e.dispose()}getWeight(){return so.WEIGHT}getSize(){return new Jt(Oo,Oo)}applyColour(){super.applyColour();let e;(e=this.textBubble)==null||e.setColour(this.sourceBlock.getColour())}updateCollapsed(){}isShownWhenCollapsed(){return!0}onLocationChange(e){super.onLocationChange(e);let t;(t=this.textBubble)==null||t.setAnchorLocation(this.getAnchorLocation())}addMessage(e,t){if(this.textMap.get(t)===e)return this;e?this.textMap.set(t,e):this.textMap.delete(t);let r;return(r=this.textBubble)==null||r.setText(this.getText()),this}getText(){return[...this.textMap.values()].join(`
`)}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.textBubble}setBubbleVisible(e){const t=this;return Re.asyncExecutePromiseGeneratorFunction(function*(){if(t.bubbleIsVisible()!==e){if(yield rs(),e)t.textBubble=new ir(t.getText(),t.sourceBlock.workspace,t.getAnchorLocation(),t.getBubbleOwnerRect()),t.applyColour();else{let r;(r=t.textBubble)==null||r.dispose(),t.textBubble=null}ee(new(Ce(fe.BUBBLE_OPEN))(t.sourceBlock,e,"warning"))}})}getAnchorLocation(){const e=Oo/2;return Le.sum(this.workspaceLocation,new Le(e,e))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new Bt(e.y,e.y+e.height,e.x,e.x+e.width)}};so.TYPE=Qn.WARNING,so.WEIGHT=2;var Ro={};Ro.CommentIcon=no,Ro.Icon=eu,Ro.IconType=Qn,Ro.MutatorIcon=s.MutatorIcon$$module$build$src$core$icons$mutator_icon,Ro.WarningIcon=so,Ro.exceptions=tu,Ro.registry=Og,s.Names$$module$build$src$core$names=class{constructor(e,t){this.db=new Map,this.dbReverse=new Set,this.variableMap=null,this.variablePrefix=t||"",this.reservedWords=new Set(e?e.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap=null}setVariableMap(e){this.variableMap=e}getNameForUserVariable(e){return this.variableMap?(e=this.variableMap.getVariableById(e))?e.name:null:(console.warn(`Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:
Blockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());`),null)}populateVariables(e){e=s.allUsedVarModels$$module$build$src$core$variables(e);for(let t=0;t<e.length;t++)this.getName(e[t].getId(),s.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(e){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(e,t){let r=e;t===s.NameType$$module$build$src$core$names.VARIABLE&&(e=this.getNameForUserVariable(e))&&(r=e),e=r.toLowerCase();const l=t===s.NameType$$module$build$src$core$names.VARIABLE||t===s.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"";this.db.has(t)||this.db.set(t,new Map);const p=this.db.get(t);return p.has(e)?l+p.get(e):(t=this.getDistinctName(r,t),p.set(e,t.substr(l.length)),t)}getUserNames(e){let t;return(e=(t=this.db.get(e))==null?void 0:t.keys())?Array.from(e):[]}getDistinctName(e,t){e=this.safeName(e);let r=null,l,p;for(;this.dbReverse.has(e+((l=r)!=null?l:""))||this.reservedWords.has(e+((p=r)!=null?p:""));)r=r?r+1:2;let v;return e+=(v=r)!=null?v:"",this.dbReverse.add(e),(t===s.NameType$$module$build$src$core$names.VARIABLE||t===s.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"")+e}safeName(e){return e?(e=encodeURI(e.replace(/ /g,"_")).replace(/[^\w]/g,"_"),"0123456789".includes(e[0])&&(e="my_"+e)):e=s.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed",e}static equals(e,t){return e.toLowerCase()===t.toLowerCase()}},function(e){e=e.NameType||(e.NameType={}),e.DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",e.VARIABLE="VARIABLE",e.PROCEDURE="PROCEDURE"}(s.Names$$module$build$src$core$names||(s.Names$$module$build$src$core$names={})),s.NameType$$module$build$src$core$names=s.Names$$module$build$src$core$names.NameType,s.Names$$module$build$src$core$names.DEVELOPER_VARIABLE_TYPE=s.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE,s.NameType$$module$build$src$core$names,s.Names$$module$build$src$core$names;var Nb=class extends Map{constructor(){super()}set(e,t){return this.get(e)===t?this:(super.set(e,t),Ju(t)&&t.startPublishing(),this)}delete(e){const t=this.get(e);return e=super.delete(e),e&&(Ju(t)&&t.stopPublishing(),e)}clear(){if(this.size)for(const e of this.keys())this.delete(e)}add(e){return this.set(e.getId(),e)}getProcedures(){return[...this.values()]}},Wd,js;Wd="PROCEDURE",s.DEFAULT_ARG$$module$build$src$core$procedures="x",js={CATEGORY_NAME:Wd,DEFAULT_ARG:s.DEFAULT_ARG$$module$build$src$core$procedures},js.ObservableProcedureMap=Nb,js.allProcedures=qu,js.findLegalName=s.findLegalName$$module$build$src$core$procedures,js.flyoutCategory=Xu,js.getCallers=$l,js.getDefinition=s.getDefinition$$module$build$src$core$procedures,js.isNameUsed=Yu,js.isProcedureBlock=wo,js.mutateCallers=s.mutateCallers$$module$build$src$core$procedures,js.mutatorOpenListener=vc,js.rename=s.rename$$module$build$src$core$procedures;var Lb=class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=16777216}getType(e){return Object.prototype.hasOwnProperty.call(this,e)||(this[e]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[e]}isField(e){return e.type&this.FIELD}isHat(e){return e.type&this.HAT}isIcon(e){return e.type&this.ICON}isSpacer(e){return e.type&this.SPACER}isInRowSpacer(e){return e.type&this.IN_ROW_SPACER}isInput(e){return e.type&this.INPUT}isExternalInput(e){return e.type&this.EXTERNAL_VALUE_INPUT}isInlineInput(e){return e.type&this.INLINE_INPUT}isStatementInput(e){return e.type&this.STATEMENT_INPUT}isPreviousConnection(e){return e.type&this.PREVIOUS_CONNECTION}isNextConnection(e){return e.type&this.NEXT_CONNECTION}isPreviousOrNextConnection(e){return e.type&(this.PREVIOUS_CONNECTION|this.NEXT_CONNECTION)}isLeftRoundedCorner(e){return e.type&this.LEFT_ROUND_CORNER}isRightRoundedCorner(e){return e.type&this.RIGHT_ROUND_CORNER}isLeftSquareCorner(e){return e.type&this.LEFT_SQUARE_CORNER}isRightSquareCorner(e){return e.type&this.RIGHT_SQUARE_CORNER}isCorner(e){return e.type&this.CORNER}isJaggedEdge(e){return e.type&this.JAGGED_EDGE}isRow(e){return e.type&this.ROW}isBetweenRowSpacer(e){return e.type&this.BETWEEN_ROW_SPACER}isTopRow(e){return e.type&this.TOP_ROW}isBottomRow(e){return e.type&this.BOTTOM_ROW}isTopOrBottomRow(e){return e.type&(this.TOP_ROW|this.BOTTOM_ROW)}isInputRow(e){return e.type&this.INPUT_ROW}},J=new Lb,Ct=class{constructor(e){this.centerline=this.xPos=this.height=this.width=0,this.constants_=e,this.type=J.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},Pl=class{constructor(e){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=!1,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=!1,this.align=null,this.constants_=e,this.type=J.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let e=this.elements.length-1;0<=e;e--){const t=this.elements[e];if(J.isInput(t))return t}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return!0}endsWithElemSpacer(){return!0}getFirstSpacer(){for(let e=0;e<this.elements.length;e++){const t=this.elements[e];if(J.isSpacer(t))return t}return null}getLastSpacer(){for(let e=this.elements.length-1;0<=e;e--){const t=this.elements[e];if(J.isSpacer(t))return t}return null}},or=class extends Pl{constructor(e){super(e),this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=J.BOTTOM_ROW}hasLeftSquareCorner(e){return!!e.outputConnection||!!e.getNextBlock()}hasRightSquareCorner(e){return!0}measure(){let e=0,t=0,r=0;for(let l=0;l<this.elements.length;l++){const p=this.elements[l];t+=p.width,J.isSpacer(p)||(J.isNextConnection(p)?r=Math.max(r,p.height):e=Math.max(e,p.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+r,this.descenderHeight=r,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},vi=class extends Ct{constructor(e,t){super(e),this.connectionModel=t,this.type|=J.CONNECTION,this.shape=this.constants_.shapeFor(t),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.highlighted=t.isHighlighted()}},Mo=class extends vi{constructor(e,t){super(e,t.connection),this.input=t,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=J.INPUT,this.align=t.align,(this.connectedBlock=t.connection&&t.connection.targetBlock()?t.connection.targetBlock():null)?(e=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=e.width,this.connectedBlockHeight=e.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},cn=class extends Mo{constructor(e,t){super(e,t),this.height=0,this.type|=J.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},jl=class extends Ct{constructor(e,t,r){super(e),this.field=t,this.parentInput=r,this.isEditable=t.EDITABLE,this.flipRtl=t.getFlipRtl(),this.type|=J.FIELD,e=this.field.getSize(),this.height=e.height,this.width=e.width}},Hd=class extends Ct{constructor(e){super(e),this.type|=J.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},nu=class extends Ct{constructor(e,t){super(e),this.icon=t,this.flipRtl=!1,this.type|=J.ICON,e=t.getSize(),this.height=e.height,this.width=e.width}},vr=class extends Ct{constructor(e,t){super(e),this.type=this.type|J.SPACER|J.IN_ROW_SPACER,this.width=t,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},Mg=class extends Mo{constructor(e,t){super(e,t),this.type|=J.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},su=class extends Mo{constructor(e,t){super(e,t),this.type|=J.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},Ng=class extends Pl{constructor(e){super(e),this.connectedBlockWidths=0,this.type|=J.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let e=0;for(let t=0;t<this.elements.length;t++){const r=this.elements[t];this.width+=r.width,J.isInput(r)&&r instanceof Mo&&(J.isStatementInput(r)&&r instanceof su?e+=r.connectedBlockWidth:J.isExternalInput(r)&&r instanceof cn&&r.connectedBlockWidth!==0&&(e+=r.connectedBlockWidth-r.connectionWidth)),J.isSpacer(r)||(this.height=Math.max(this.height,r.height))}this.connectedBlockWidths=e,this.widthWithConnectedBlocks=this.width+e}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},Bb=class extends Ct{constructor(e){super(e),this.type|=J.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},Pb=class extends vi{constructor(e,t){super(e,t),this.type|=J.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},jb=class extends vi{constructor(e,t){super(e,t),this.connectionOffsetX=0,this.type|=J.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},Fb=class extends vi{constructor(e,t){super(e,t),this.type|=J.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},ru=class extends Ct{constructor(e,t){super(e),this.type=(t&&t!=="left"?J.RIGHT_ROUND_CORNER:J.LEFT_ROUND_CORNER)|J.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},Lg=class extends Pl{constructor(e,t,r){super(e),this.height=t,this.width=r,this.precedesStatement=this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.type=this.type|J.SPACER|J.BETWEEN_ROW_SPACER,this.elements=[new vr(this.constants_,r)]}measure(){}},iu=class extends Ct{constructor(e,t){super(e),this.type=(t&&t!=="left"?J.RIGHT_SQUARE_CORNER:J.LEFT_SQUARE_CORNER)|J.CORNER,this.width=this.height=this.constants_.NO_PADDING}},Bg=class extends Pl{constructor(e){super(e),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null,this.type|=J.TOP_ROW}hasLeftSquareCorner(e){const t=(e.hat?e.hat==="cap":this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection,r=e.getPreviousBlock();return!!e.outputConnection||t||(r?r.getNextBlock()===e:!1)}hasRightSquareCorner(e){return!0}measure(){let e=0,t=0,r=0;for(let l=0;l<this.elements.length;l++){const p=this.elements[l];t+=p.width,J.isSpacer(p)||(J.isHat(p)&&p instanceof Hd?r=Math.max(r,p.ascenderHeight):e=Math.max(e,p.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+r,this.capline=this.ascenderHeight=r,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},Vd=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs=null,this.embossFilterId="",this.embossFilter=null,this.disabledPatternId="",this.disabledPattern=null,this.debugFilterId="",this.cssNode=this.debugFilter=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=xn(0,0),this.FIELD_TEXT_BASELINE_CENTER=!0,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(e){this.blockStyles=Object.create(null);const t=e.blockStyles;for(const r in t)this.blockStyles[r]=this.validatedBlockStyle_(t[r]);this.setDynamicProperties_(e)}setDynamicProperties_(e){this.setFontConstants_(e),this.setComponentConstants_(e),this.ADD_START_HATS=e.startHats!==void 0?e.startHats:this.ADD_START_HATS}setFontConstants_(e){e.fontStyle&&e.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=e.fontStyle.family),e.fontStyle&&e.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=e.fontStyle.weight),e.fontStyle&&e.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=e.fontStyle.size),e=Kt("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=e.height,this.FIELD_TEXT_BASELINE=e.baseline}setComponentConstants_(e){this.CURSOR_COLOUR=e.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=e.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=e.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(e.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(e){const t="auto_"+e;return this.blockStyles[t]||(this.blockStyles[t]=this.createBlockStyle_(e)),{style:this.blockStyles[t],name:t}}getBlockStyle(e){return this.blockStyles[e||""]||(e&&e.startsWith("auto_")?this.getBlockStyleForColour(e.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(e){return this.validatedBlockStyle_({colourPrimary:e})}validatedBlockStyle_(e){const t={};return e&&Object.assign(t,e),e=ol(t.colourPrimary||"#000"),t.colourPrimary=e.hex,t.colourSecondary=t.colourSecondary?ol(t.colourSecondary).hex:this.generateSecondaryColour_(t.colourPrimary),t.colourTertiary=t.colourTertiary?ol(t.colourTertiary).hex:this.generateTertiaryColour_(t.colourPrimary),t.hat=t.hat||"",t}generateSecondaryColour_(e){return et("#fff",e,.6)||e}generateTertiaryColour_(e){return et("#fff",e,.3)||e}dispose(){this.embossFilter&&mt(this.embossFilter),this.disabledPattern&&mt(this.disabledPattern),this.debugFilter&&mt(this.debugFilter),this.cssNode=null}makeJaggedTeeth(){const e=this.JAGGED_TEETH_HEIGHT,t=this.JAGGED_TEETH_WIDTH,r=Mr([ut(t,e/4),ut(2*-t,e/2),ut(t,e/4)]);return{height:e,width:t,path:r}}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH,r=Zs("c",[ut(30,-e),ut(70,-e),ut(t,0)]);return{height:e,width:t,path:r}}makePuzzleTab(){function e(v){v=v?-1:1;const O=-v;var G=r/2;const Ie=G+2.5,Qe=G+.5,Mn=ut(-t,v*G);return G=ut(t,v*G),Zs("c",[ut(0,v*Ie),ut(-t,O*Qe),Mn])+Zs("s",[ut(t,2.5*O),G])}const t=this.TAB_WIDTH,r=this.TAB_HEIGHT,l=e(!0),p=e(!1);return{type:this.SHAPES.PUZZLE,width:t,height:r,pathDown:p,pathUp:l}}makeNotch(){function e(O){return Mr([ut(O*l,r),ut(3*O,0),ut(O*l,-r)])}const t=this.NOTCH_WIDTH,r=this.NOTCH_HEIGHT,l=(t-3)/2,p=e(1),v=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:r,pathLeft:p,pathRight:v}}makeInsideCorners(){const e=this.CORNER_RADIUS,t=Hn("a","0 0,0",e,ut(-e,e)),r=Hn("a","0 0,0",e,ut(e,e));return{width:e,height:e,pathTop:t,pathBottom:r}}makeOutsideCorners(){const e=this.CORNER_RADIUS,t=xn(0,e)+Hn("a","0 0,1",e,ut(e,-e)),r=Hn("a","0 0,1",e,ut(e,e)),l=Hn("a","0 0,1",e,ut(-e,-e)),p=Hn("a","0 0,1",e,ut(-e,e));return{topLeft:t,topRight:r,bottomRight:p,bottomLeft:l,rightHeight:e}}shapeFor(e){switch(e.type){case Ze.INPUT_VALUE:case Ze.OUTPUT_VALUE:return this.PUZZLE_TAB;case Ze.PREVIOUS_STATEMENT:case Ze.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(e,t,r){this.injectCSS_(t,r),this.defs=re(oe.DEFS,{},e),e=re(oe.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs),re(oe.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},e),t=re(oe.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},e),re(oe.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},t),re(oe.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},e),re(oe.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},e),this.embossFilterId=e.id,this.embossFilter=e,e=re(oe.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs),re(oe.RECT,{width:10,height:10,fill:"#aaa"},e),re(oe.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},e),this.disabledPatternId=e.id,this.disabledPattern=e,this.createDebugFilter()}createDebugFilter(){if(!this.debugFilter){const e=re(oe.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs),t=re(oe.FECOMPONENTTRANSFER,{result:"outBlur"},e);re(oe.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),re(oe.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},e),re(oe.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.debugFilterId=e.id,this.debugFilter=e}}injectCSS_(e,t){t=this.getCSS_(t),e="blockly-renderer-style-"+e,this.cssNode=document.getElementById(e);const r=t.join(`
`);this.cssNode?this.cssNode.firstChild.textContent=r:(t=document.createElement("style"),t.id=e,e=document.createTextNode(r),t.appendChild(e),document.head.insertBefore(t,document.head.firstChild),this.cssNode=t)}getCSS_(e){return[`${e} .blocklyText, `,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableText>rect,`,`${e} .blocklyEditableText>rect {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"fill-opacity: .6;","stroke: none;","}",`${e} .blocklyNonEditableText>text,`,`${e} .blocklyEditableText>text {`,"fill: #000;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #000;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #000;","}",`${e} .blocklyEditableText:not(.editing):hover>rect {`,"stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"}",`${e} .blocklySelected>.blocklyPath {`,"stroke: #fc3;","stroke-width: 3px;","}",`${e} .blocklyHighlightedConnectionPath {`,"stroke: #fc3;","}",`${e} .blocklyReplaceable .blocklyPath {`,"fill-opacity: .5;","}",`${e} .blocklyReplaceable .blocklyPathLight,`,`${e} .blocklyReplaceable .blocklyPathDark {`,"display: none;","}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},Fl=class{constructor(e,t){this.inlinePath_=this.outlinePath_="",this.block_=e,this.info_=t,this.topLeft_=e.getRelativeToSurfaceXY(),this.constants_=t.getRenderer().getConstants()}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),this.block_.pathObject.setPath(this.outlinePath_+`
`+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),this.recordSizeOnBlock_()}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren,this.block_.childlessWidth=this.info_.width}drawOutline_(){this.drawTop_();for(let e=1;e<this.info_.rows.length-1;e++){const t=this.info_.rows[e];t.hasJaggedEdge?this.drawJaggedEdge_(t):t.hasStatement?this.drawStatementInput_(t):t.hasExternalInput?this.drawValueInput_(t):this.drawRightSideRow_(t)}this.drawBottom_(),this.drawLeft_()}drawTop_(){const e=this.info_.topRow,t=e.elements;this.positionPreviousConnection_(),this.outlinePath_+=xn(e.xPos,this.info_.startY);for(let r=0,l;l=t[r];r++)J.isLeftRoundedCorner(l)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:J.isRightRoundedCorner(l)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:J.isPreviousConnection(l)&&l instanceof vi?this.outlinePath_+=l.shape.pathLeft:J.isHat(l)?this.outlinePath_+=this.constants_.START_HAT.path:J.isSpacer(l)&&(this.outlinePath_+=tt("h",l.width));this.outlinePath_+=tt("v",e.height)}drawJaggedEdge_(e){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+tt("v",e.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(e){const t=e.getLastInput();this.positionExternalValueConnection_(e);const r=yc(t.shape)?t.shape.pathDown(t.height):t.shape.pathDown;this.outlinePath_+=tt("H",t.xPos+t.width)+r+tt("v",e.height-t.connectionHeight)}drawStatementInput_(e){var t=e.getLastInput();if(t){var r=t.xPos+t.notchOffset+t.shape.width;t=t.shape.pathRight+tt("h",-(t.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var l=e.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=tt("H",r)+t+tt("v",l)+this.constants_.INSIDE_CORNERS.pathBottom+tt("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}}drawRightSideRow_(e){this.outlinePath_+=tt("V",e.yPos+e.height)}drawBottom_(){const e=this.info_.bottomRow,t=e.elements;this.positionNextConnection_();let r=0,l="";for(let p=t.length-1,v;v=t[p];p--)J.isNextConnection(v)&&v instanceof vi?l+=v.shape.pathRight:J.isLeftSquareCorner(v)?l+=tt("H",e.xPos):J.isLeftRoundedCorner(v)?l+=this.constants_.OUTSIDE_CORNERS.bottomLeft:J.isRightRoundedCorner(v)?(l+=this.constants_.OUTSIDE_CORNERS.bottomRight,r=this.constants_.OUTSIDE_CORNERS.rightHeight):J.isSpacer(v)&&(l+=tt("h",-1*v.width));this.outlinePath_+=tt("V",e.baseline-r),this.outlinePath_+=l}drawLeft_(){var e=this.info_.outputConnection;if(this.positionOutputConnection_(),e){const t=e.connectionOffsetY+e.height;e=yc(e.shape)?e.shape.pathUp(e.height):e.shape.pathUp,this.outlinePath_+=tt("V",t)+e}this.outlinePath_+="z"}drawInternals_(){for(let e=0,t;t=this.info_.rows[e];e++)for(let r=0,l;l=t.elements[r];r++)J.isInlineInput(l)?this.drawInlineInput_(l):(J.isIcon(l)||J.isField(l))&&this.layoutField_(l)}layoutField_(e){const t=e.centerline-e.height/2;let r=e.xPos;var l="";this.info_.RTL&&(r=-(r+e.width),e.flipRtl&&(r+=e.width,l="scale(-1 1)")),J.isIcon(e)?(l=e.icon,l.setOffsetInBlock(new Le(r,t)),this.info_.isInsertionMarker&&l.hideForInsertionMarker()):(e=e.field.getSvgRoot(),e.setAttribute("transform","translate("+r+","+t+")"+l),this.info_.isInsertionMarker&&e.setAttribute("display","none"))}drawInlineInput_(e){const t=e.width,r=e.height,l=e.connectionOffsetY,p=e.connectionHeight+l;this.inlinePath_+=is(e.xPos+e.connectionWidth,e.centerline-r/2)+tt("v",l)+e.shape.pathDown+tt("v",r-p)+tt("h",t-e.connectionWidth)+tt("v",-r)+"z",this.positionInlineInputConnection_(e)}positionInlineInputConnection_(e){const t=e.centerline-e.height/2;if(e.connectionModel){let r=e.xPos+e.connectionWidth+e.connectionOffsetX;this.info_.RTL&&(r*=-1),e.connectionModel.setOffsetInBlock(r,t+e.connectionOffsetY)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(t!=null&&t.connectionModel){let r=e.xPos+e.statementEdge+t.notchOffset;this.info_.RTL&&(r*=-1),t.connectionModel.setOffsetInBlock(r,e.yPos)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let r=e.xPos+e.width;this.info_.RTL&&(r*=-1),t.connectionModel.setOffsetInBlock(r,e.yPos)}}positionPreviousConnection_(){const e=this.info_.topRow;if(e.connection){const t=e.xPos+e.notchOffset;e.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-t:t,0)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,r=t.xPos;t.connectionModel.setOffsetInBlock(this.info_.RTL?-r:r,e.baseline)}}positionOutputConnection_(){if(this.info_.outputConnection){const e=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-e:e,this.info_.outputConnection.connectionOffsetY)}}updateConnectionHighlights(){for(const e of this.info_.rows)for(const t of e.elements)if(t instanceof vi)if(t.highlighted)this.drawConnectionHighlightPath(t);else{let r,l;(l=(r=this.block_.pathObject).removeConnectionHighlight)==null||l.call(r,t.connectionModel)}}drawConnectionHighlightPath(e){const t=e.connectionModel;e=t.type===Ze.INPUT_VALUE||t.type===Ze.OUTPUT_VALUE?this.getExpressionConnectionHighlightPath(e):this.getStatementConnectionHighlightPath(e);const r=t.getSourceBlock();let l,p;(p=(l=r.pathObject).addConnectionHighlight)==null||p.call(l,t,e,t.getOffsetInBlock(),r.RTL)}getExpressionConnectionHighlightPath(e){let t="";return yc(e.shape)?t=e.shape.pathDown(e.height):Bm(e.shape)&&(t=e.shape.pathDown),e=this.constants_.TAB_OFFSET_FROM_TOP,xn(0,-e)+tt("v",e)+t+tt("v",e)}getStatementConnectionHighlightPath(e){if(!pi(e.shape))throw Error("Statement connections should have notch shapes");const t=this.constants_.NOTCH_OFFSET_LEFT-this.constants_.CORNER_RADIUS;return xn(-t,0)+tt("h",t)+e.shape.pathLeft+tt("h",t)}};(function(e){e[e.LEFT=-1]="LEFT",e[e.CENTRE=0]="CENTRE",e[e.RIGHT=1]="RIGHT"})(s.Align$$module$build$src$core$inputs$align||(s.Align$$module$build$src$core$inputs$align={})),s.Align$$module$build$src$core$inputs$align;var La=class extends vn{constructor(e,t,r){super(vn.SKIP_SETUP),this.class=null,this.EDITABLE=!1,this.maxDisplayLength=1/0,e!==vn.SKIP_SETUP&&(r?this.configure_(r):this.class=t||null,this.setValue(e))}configure_(e){super.configure_(e),e.class&&(this.class=e.class)}initView(){this.createTextElement_(),this.class&&Fe(this.getTextElement(),this.class)}doClassValidation_(e){return e==null?null:`${e}`}setClass(e){this.textElement_&&(this.class&&pt(this.textElement_,this.class),e&&Fe(this.textElement_,e)),this.class=e}static fromJson(e){return new this(kt(e.text),void 0,e)}};Ot("field_label",La),La.prototype.DEFAULT_VALUE="";var No=class{constructor(e,t){this.name=e,this.sourceBlock=t,this.fieldRow=[],this.align=s.Align$$module$build$src$core$inputs$align.LEFT,this.visible=!0,this.type=s.inputTypes$$module$build$src$core$inputs$input_types.CUSTOM,this.connection=null}getSourceBlock(){return this.sourceBlock}appendField(e,t){return this.insertFieldAt(this.fieldRow.length,e,t),this}insertFieldAt(e,t,r){if(0>e||e>this.fieldRow.length)throw Error("index "+e+" out of bounds.");return(t||t===""&&r)&&(typeof t=="string"&&(t=s.fromJson$$module$build$src$core$field_registry({type:"field_label",text:t})),t.setSourceBlock(this.sourceBlock),this.sourceBlock.initialized&&this.initField(t),t.name=r,t.setVisible(this.isVisible()),t.prefixField&&(e=this.insertFieldAt(e,t.prefixField)),this.fieldRow.splice(e,0,t),e++,t.suffixField&&(e=this.insertFieldAt(e,t.suffixField)),this.sourceBlock.rendered&&this.sourceBlock.queueRender()),e}removeField(e,t){for(let r=0,l;l=this.fieldRow[r];r++)if(l.name===e)return l.dispose(),this.fieldRow.splice(r,1),this.sourceBlock.rendered&&this.sourceBlock.queueRender(),!0;if(t)return!1;throw Error('Field "'+e+'" not found.')}isVisible(){return this.visible}setVisible(e){let t=[];if(this.visible===e)return t;this.visible=e;for(let l=0,p;p=this.fieldRow[l];l++)p.setVisible(e);if(this.connection){var r=this.connection;e?t=r.startTrackingAll():r.stopTrackingAll(),(r=r.targetBlock())&&(r.getSvgRoot().style.display=e?"block":"none")}return t}markDirty(){for(let e=0,t;t=this.fieldRow[e];e++)t.markDirty()}setCheck(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(e),this}setAlign(e){return this.align=e,this.sourceBlock.rendered&&this.sourceBlock.queueRender(),this}setShadowDom(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(e),this}getShadowDom(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()}init(){for(const e of this.fieldRow)e.init()}initModel(){for(const e of this.fieldRow)e.initModel()}initField(e){this.sourceBlock.rendered?e.init():e.initModel()}dispose(){for(let e=0,t;t=this.fieldRow[e];e++)t.dispose();this.connection&&this.connection.dispose()}makeConnection(e){return this.sourceBlock.makeConnection_(e)}},yi=class extends No{constructor(e,t){super(e,t),this.name=e,this.type=s.inputTypes$$module$build$src$core$inputs$input_types.DUMMY}},ro=class extends No{constructor(e,t){super(e,t),this.name=e,this.type=s.inputTypes$$module$build$src$core$inputs$input_types.END_ROW}},yr=class extends No{constructor(e,t){if(!e)throw Error("Statement inputs must have a non-empty name");super(e,t),this.name=e,this.type=s.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT,this.connection=this.makeConnection(Ze.NEXT_STATEMENT)}},ls;s.ValueInput$$module$build$src$core$inputs$value_input=class extends No{constructor(e,t){if(!e)throw Error("Value inputs must have a non-empty name");super(e,t),this.name=e,this.type=s.inputTypes$$module$build$src$core$inputs$input_types.VALUE,this.connection=this.makeConnection(Ze.INPUT_VALUE)}},ls={},ls.ValueInput=s.ValueInput$$module$build$src$core$inputs$value_input;var hs=class{constructor(e,t){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.startY=this.startX=0,this.renderer_=e,this.block_=t,this.constants_=this.renderer_.getConstants(),this.outputConnection=t.outputConnection?new jb(this.constants_,t.outputConnection):null,this.isInline=t.getInputsInline()&&!t.isCollapsed(),this.isCollapsed=t.isCollapsed(),this.isInsertionMarker=t.isInsertionMarker(),this.RTL=t.RTL,this.topRow=new Bg(this.constants_),this.bottomRow=new or(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let e=new Ng(this.constants_);this.inputRows.push(e);var t=this.block_.getIcons();for(let r=0,l;l=t[r];r++){const p=new nu(this.constants_,l);this.isCollapsed&&!l.isShownWhenCollapsed()||e.elements.push(p)}t=void 0;for(let r=0,l;l=this.block_.inputList[r];r++)if(l.isVisible()){this.shouldStartNewRow_(l,t)&&(this.rows.push(e),e=new Ng(this.constants_),this.inputRows.push(e));for(let p=0,v;v=l.fieldRow[p];p++)e.elements.push(new jl(this.constants_,v,l));this.addInput_(l,e),t=l}this.isCollapsed&&(e.hasJaggedEdge=!0,e.elements.push(new Bb(this.constants_))),(e.elements.length||e.hasDummyInput)&&this.rows.push(e),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var e=!!this.block_.previousConnection;const t=(this.block_.hat?this.block_.hat==="cap":this.constants_.ADD_START_HATS)&&!this.outputConnection&&!e;let r=this.topRow.hasLeftSquareCorner(this.block_)?iu:ru;this.topRow.elements.push(new r(this.constants_)),t?(e=new Hd(this.constants_),this.topRow.elements.push(e),this.topRow.capline=e.ascenderHeight):e&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new Fb(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0]instanceof yr&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,r=this.topRow.hasRightSquareCorner(this.block_)?iu:ru,this.topRow.elements.push(new r(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof yr?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new iu(this.constants_)):this.bottomRow.elements.push(new ru(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new Pb(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new iu(this.constants_,"right")):this.bottomRow.elements.push(new ru(this.constants_,"right"))}addInput_(e,t){this.isInline&&e instanceof s.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new Mg(this.constants_,e)),t.hasInlineInput=!0):e instanceof yr?(t.elements.push(new su(this.constants_,e)),t.hasStatement=!0):e instanceof s.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new cn(this.constants_,e)),t.hasExternalInput=!0):(e instanceof yi||e instanceof ro)&&(t.minHeight=Math.max(t.minHeight,e.getSourceBlock()&&e.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),t.align===null&&(t.align=e.align)}shouldStartNewRow_(e,t){return t?t instanceof ro||e instanceof yr||t instanceof yr?!0:e instanceof s.ValueInput$$module$build$src$core$inputs$value_input||e instanceof yi||t instanceof s.ValueInput$$module$build$src$core$inputs$value_input?!this.isInline:!1:!1}addElemSpacing_(){for(let e=0,t;t=this.rows[e];e++){const r=t.elements;if(t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new vr(this.constants_,this.getInRowSpacing_(null,r[0]))),r.length){for(let l=0;l<r.length-1;l++){t.elements.push(r[l]);const p=this.getInRowSpacing_(r[l],r[l+1]);t.elements.push(new vr(this.constants_,p))}t.elements.push(r[r.length-1]),t.endsWithElemSpacer()&&t.elements.push(new vr(this.constants_,this.getInRowSpacing_(r[r.length-1],null)))}}}getInRowSpacing_(e,t){if(!e&&t&&J.isStatementInput(t))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(e&&J.isInput(e)&&!t){if(J.isExternalInput(e))return this.constants_.NO_PADDING;if(J.isInlineInput(e))return this.constants_.LARGE_PADDING;if(J.isStatementInput(e))return this.constants_.NO_PADDING}return e&&J.isLeftSquareCorner(e)&&t&&(J.isPreviousConnection(t)||J.isNextConnection(t))?t.notchOffset:e&&J.isLeftRoundedCorner(e)&&t&&(J.isPreviousConnection(t)||J.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}computeBounds_(){let e=0,t=0,r=0;for(let p=0,v;v=this.rows[p];p++){if(v.measure(),t=Math.max(t,v.width),v.hasStatement){var l=v.getLastInput();let O,G;l=v.width-((G=(O=l)==null?void 0:O.width)!=null?G:0),e=Math.max(e,l)}r=Math.max(r,v.widthWithConnectedBlocks)}this.statementEdge=e,this.width=t;for(let p=0,v;v=this.rows[p];p++)v.hasStatement&&(v.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(t,r),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let t=0,r;r=this.rows[t];t++)if(r.hasStatement)this.alignStatementRow_(r);else{var e=r.width;e=this.getDesiredRowWidth_(r)-e,0<e&&this.addAlignmentPadding_(r,e),J.isTopOrBottomRow(r)&&(r.widthWithConnectedBlocks=r.width)}}getDesiredRowWidth_(e){return this.width-this.startX}addAlignmentPadding_(e,t){const r=e.getFirstSpacer(),l=e.getLastSpacer();if((e.hasExternalInput||e.hasStatement)&&(e.widthWithConnectedBlocks+=t),e.align===s.Align$$module$build$src$core$inputs$align.LEFT&&l)l.width+=t;else if(e.align===s.Align$$module$build$src$core$inputs$align.CENTRE&&r&&l)r.width+=t/2,l.width+=t/2;else if(e.align===s.Align$$module$build$src$core$inputs$align.RIGHT&&r)r.width+=t;else if(l)l.width+=t;else return;e.width+=t}alignStatementRow_(e){const t=e.getLastInput();if(t){var r=e.width-t.width,l=this.statementEdge;r=l-r,0<r&&this.addAlignmentPadding_(e,r),r=e.width,l=this.getDesiredRowWidth_(e),t.width+=l-r,t.height=Math.max(t.height,e.height),e.width+=l-r,e.widthWithConnectedBlocks=Math.max(e.width,this.statementEdge+e.connectedBlockWidths)}}addRowSpacing_(){const e=this.rows;this.rows=[];for(let t=0;t<e.length;t++)this.rows.push(e[t]),t!==e.length-1&&this.rows.push(this.makeSpacerRow_(e[t],e[t+1]))}makeSpacerRow_(e,t){var r=this.getSpacerRowHeight_(e,t);const l=this.getSpacerRowWidth_(e,t);return r=new Lg(this.constants_,r,l),e.hasStatement&&(r.followsStatement=!0),t.hasStatement&&(r.precedesStatement=!0),r}getSpacerRowWidth_(e,t){return this.width-this.startX}getSpacerRowHeight_(e,t){return this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){return J.isSpacer(t)?e.yPos+t.height/2:J.isBottomRow(e)?(e=e.yPos+e.height-e.descenderHeight,J.isNextConnection(t)?e+t.height/2:e-t.height/2):J.isTopRow(e)?J.isHat(t)?e.capline-t.height/2:e.capline+t.height/2:e.yPos+e.height/2}recordElemPositions_(e){let t=e.xPos;for(let r=0,l;l=e.elements[r];r++)J.isSpacer(l)&&(l.height=e.height),l.xPos=t,l.centerline=this.getElemCenterline_(e,l),t+=l.width}finalize_(){let e=0,t=0;for(let r=0,l;l=this.rows[r];r++)l.yPos=t,l.xPos=this.startX,t+=l.height,e=Math.max(e,l.widthWithConnectedBlocks),this.recordElemPositions_(l);if(this.outputConnection&&this.block_.nextConnection){const r=this.block_.nextConnection.targetBlock();r&&(e=Math.max(e,r.getHeightWidth().width))}this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline,this.bottomRow.baseline=t-this.bottomRow.descenderHeight}getMeasureableForConnection(e){let t;if(((t=this.outputConnection)==null?void 0:t.connectionModel)===e)return this.outputConnection;for(const r of this.rows)for(const l of r.elements)if(l instanceof vi&&l.connectionModel===e)return l;return null}},Pg=class extends Sa{constructor(e){if(super(e),this.type=fe.BLOCK_DELETE,e){if(e.getParent())throw Error("Connected blocks cannot be deleted.");e.isShadow()&&(this.recordUndo=!1),this.oldXml=vo(e),this.ids=Z(e),this.wasShadow=e.isShadow(),this.oldJson=Qt(e,{addCoordinates:!0})}}toJson(){const e=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(this.wasShadow===void 0)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.oldXml=ci(this.oldXml),e.ids=this.ids,e.wasShadow=this.wasShadow,e.oldJson=this.oldJson,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Pg),t.oldXml=s.textToDom$$module$build$src$core$utils$xml(e.oldXml),t.ids=e.ids,t.wasShadow=e.wasShadow||t.oldXml.tagName.toLowerCase()==="shadow",t.oldJson=e.oldJson,e.recordUndo!==void 0&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(e)for(e=0;e<this.ids.length;e++){const r=this.ids[e],l=t.getBlockById(r);l?l.dispose(!1):r===this.blockId&&console.warn("Can't delete non-existent block: "+r)}else Ni(this.oldJson,t)}};i(Be.EVENT,fe.BLOCK_DELETE,Pg);var sn=class{constructor(e,t){this.type=t,this.targetConnection=null,this.disposed=!1,this.shadowDom=this.check=null,this.y=this.x=0,this.shadowState=null,this.sourceBlock_=e}connect_(e){const t=Ze.INPUT_VALUE,r=this.getSourceBlock();var l=e.getSourceBlock();e.isConnected()&&e.disconnectInternal(!1);let p;if(this.isConnected()){const O=this.stashShadowState(),G=this.targetBlock();G.isShadow()?G.dispose(!1):(this.disconnectInternal(),p=G),this.applyShadowState(O)}let v;te()&&(v=new(Ce(fe.BLOCK_MOVE))(l),v.setReason(["connect"])),Zu(this,e),l.setParent(r),v&&(v.recordNew(),ee(v)),p&&(e=this.type===t?p.outputConnection:p.previousConnection)&&((l=sn.getConnectionForOrphanedConnection(l,e))?e.connect(l):e.onFailedConnect(this))}dispose(){if(this.isConnected()){this.isSuperior()&&this.setShadowStateInternal();const e=this.targetBlock();e&&!e.isDeadOrDying()&&e.unplug()}this.disposed=!0}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===Ze.INPUT_VALUE||this.type===Ze.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(e){}connect(e){if(this.targetConnection===e)return!0;if(this.getConnectionChecker().canConnect(this,e,!1)){const t=s.getGroup$$module$build$src$core$events$utils();t||s.setGroup$$module$build$src$core$events$utils(!0),this.isSuperior()?this.connect_(e):e.connect_(this),s.setGroup$$module$build$src$core$events$utils(t)}return this.isConnected()}disconnect(){this.disconnectInternal()}disconnectInternal(e=!0){const{parentConnection:t,childConnection:r}=this.getParentAndChildConnections();if(!t||!r)throw Error("Source connection not connected.");const l=s.getGroup$$module$build$src$core$events$utils();l||s.setGroup$$module$build$src$core$events$utils(!0);let p;te()&&(p=new(Ce(fe.BLOCK_MOVE))(r.getSourceBlock()),p.setReason(["disconnect"]));const v=this.targetConnection;v&&(v.targetConnection=null),this.targetConnection=null,e&&r.getSourceBlock().setParent(null),p&&(p.recordNew(),ee(p)),r.getSourceBlock().isShadow()||t.respawnShadow_(),s.setGroup$$module$build$src$core$events$utils(l)}getParentAndChildConnections(){return this.targetConnection?this.isSuperior()?{parentConnection:this,childConnection:this.targetConnection}:{parentConnection:this.targetConnection,childConnection:this}:{}}respawnShadow_(){this.createShadowBlock(!0)}reconnect(e,t){if(this.getSourceBlock().isDeadOrDying())return!1;var r;return t=(r=e.getInput(t))==null?void 0:r.connection,r=this.targetBlock(),r&&r!==e||!t||t.targetConnection===this?!1:(t.isConnected()&&t.disconnect(),t.connect(this),!0)}targetBlock(){if(this.isConnected()){let e,t;return(t=(e=this.targetConnection)==null?void 0:e.getSourceBlock())!=null?t:null}return null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return e?(Array.isArray(e)||(e=[e]),this.check=e,this.onCheckChanged_()):this.check=null,this}getCheck(){return this.check}setShadowDom(e){this.setShadowStateInternal({shadowDom:e})}getShadowDom(e){return e&&this.targetBlock().isShadow()?zi(this.targetBlock()):this.shadowDom}setShadowState(e){this.setShadowStateInternal({shadowState:e})}getShadowState(e){return e&&this.targetBlock()&&this.targetBlock().isShadow()?Qt(this.targetBlock()):this.shadowState}neighbours(e){return[]}getParentInput(){let e=null;const t=this.sourceBlock_.inputList;for(let r=0;r<t.length;r++)if(t[r].connection===this){e=t[r];break}return e}toString(){const e=this.sourceBlock_;if(!e)return"Orphan Connection";if(e.outputConnection===this)var t="Output Connection of ";else if(e.previousConnection===this)t="Previous Connection of ";else if(e.nextConnection===this)t="Next Connection of ";else{t=null;for(let r=0,l;l=e.inputList[r];r++)if(l.connection===this){t=l;break}if(t)t='Input "'+t.name+'" connection on ';else return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection"}return t+e.toDevString()}stashShadowState(){const e=this.getShadowDom(!0),t=this.getShadowState(!0);return this.shadowState=this.shadowDom=null,{shadowDom:e,shadowState:t}}applyShadowState({shadowDom:e,shadowState:t}){this.shadowDom=e,this.shadowState=t}setShadowStateInternal({shadowDom:e=null,shadowState:t=null}={}){this.shadowDom=e,this.shadowState=t,this.getSourceBlock().isDeadOrDying()||((e=this.targetBlock())?e.isShadow()?(e.dispose(!1),this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())):(e=this.createShadowBlock(!1),this.serializeShadow(e),e&&e.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())))}createShadowBlock(e){var t=this.getSourceBlock();const r=this.getShadowState(),l=this.getShadowDom();if(t.isDeadOrDying()||!r&&!l)return null;if(r)return t=Wn(r,t.workspace,{parentConnection:e?this:void 0,isShadow:!0,recordUndo:!1});if(l){if(t=yo(l,t.workspace),e)if(this.type===Ze.INPUT_VALUE){if(!t.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(t.outputConnection))throw Error("Could not connect shadow block to connection")}else if(this.type===Ze.NEXT_STATEMENT){if(!t.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(t.previousConnection))throw Error("Could not connect shadow block to connection")}else throw Error("Cannot connect a shadow block to a previous/output connection");return t}return null}serializeShadow(e){e&&(this.shadowDom=zi(e),this.shadowState=Qt(e))}static getConnectionForOrphanedConnection(e,t){if(t.type===Ze.OUTPUT_VALUE)return gr(e,t.getSourceBlock());e=e.lastConnectionInStack(!0);const r=t.getConnectionChecker();return e&&r.canConnect(t,e,!1)?e:null}};sn.CAN_CONNECT=0,sn.REASON_SELF_CONNECTION=1,sn.REASON_WRONG_TYPE=2,sn.REASON_TARGET_NULL=3,sn.REASON_CHECKS_FAILED=4,sn.REASON_DIFFERENT_WORKSPACES=5,sn.REASON_SHADOW_PARENT=6,sn.REASON_DRAG_CHECKS_FAILED=7,sn.REASON_PREVIOUS_AND_OUTPUT=8;var Lo=class{constructor(e,t,r){if(this.data=null,this.disposed=!1,this.hue=null,this.colour_="#000000",this.styleName_="",this.suppressPrefixSuffix=!1,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.icons=[],this.disabledReasons=new Set,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable=this.movable=this.deletable=!0,this.collapsed_=this.shadow=!1,this.outputShape_=null,this.rendered=this.isInsertionMarker_=this.initialized=this.disposing=!1,this.onchangeWrapper=this.helpUrl=null,this.statementInputCount=0,this.workspace=e,this.id=r&&!e.getBlockById(r)?r:E(),e.setBlockById(this.id,this),this.xy=new Le(0,0),this.isInFlyout=e.isFlyout,this.isInMutator=e.isMutator,this.RTL=e.RTL,t){if(this.type=t,r=tr[t],!r||typeof r!="object")throw TypeError("Invalid block definition for type: "+t);Object.assign(this,r)}e.addTopBlock(this),e.addTypedBlock(this),new.target===Lo&&this.doInit_()}doInit_(){const e=s.getGroup$$module$build$src$core$events$utils();e||s.setGroup$$module$build$src$core$events$utils(!0);const t=se();try{typeof this.init=="function"&&(s.setRecordUndo$$module$build$src$core$events$utils(!1),this.init(),s.setRecordUndo$$module$build$src$core$events$utils(t)),te()&&ee(new(Ce(fe.BLOCK_CREATE))(this))}finally{s.setGroup$$module$build$src$core$events$utils(e),s.setRecordUndo$$module$build$src$core$events$utils(t)}this.inputsInlineDefault=this.inputsInline,typeof this.onchange=="function"&&this.setOnChange(this.onchange)}dispose(e=!1){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.unplug(e),te()&&ee(new(Ce(fe.BLOCK_DELETE))(this)),this.workspace.removeTopBlock(this),this.disposeInternal()}disposeInternal(){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),typeof this.destroy=="function"&&this.destroy(),this.childBlocks_.forEach(e=>e.disposeInternal()),this.inputList.forEach(e=>e.dispose()),this.inputList.length=0,this.getConnections_(!0).forEach(e=>e.dispose()),this.disposed=!0}isDeadOrDying(){return this.disposing||this.disposed}initModel(){if(!this.initialized){for(const e of this.inputList)e.initModel();this.initialized=!0}}unplug(e){this.outputConnection&&this.unplugFromRow(e),this.previousConnection&&this.unplugFromStack(e)}unplugFromRow(e){let t=null,r;(r=this.outputConnection)!=null&&r.isConnected()&&(t=this.outputConnection.targetConnection,this.outputConnection.disconnect()),t&&e&&(e=this.getOnlyValueConnection())&&e.isConnected()&&!e.targetBlock().isShadow()&&(e=e.targetConnection,e==null||e.disconnect(),this.workspace.connectionChecker.canConnect(e,t,!1)?t.connect(e):e==null||e.onFailedConnect(t))}getOnlyValueConnection(){let e=null;for(let t=0;t<this.inputList.length;t++){const r=this.inputList[t].connection;if(r&&r.type===Ze.INPUT_VALUE&&r.targetConnection){if(e)return null;e=r}}return e}unplugFromStack(e){let t=null;var r;if((r=this.previousConnection)!=null&&r.isConnected()&&(t=this.previousConnection.targetConnection,this.previousConnection.disconnect()),r=this.getNextBlock(),e&&r&&!r.isShadow()){let l,p;e=(p=(l=this.nextConnection)==null?void 0:l.targetConnection)!=null?p:null,e==null||e.disconnect(),t&&this.workspace.connectionChecker.canConnect(t,e,!1)&&t.connect(e)}}getConnections_(e){e=[],this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection);for(let t=0,r;r=this.inputList[t];t++)r.connection&&e.push(r.connection);return e}lastConnectionInStack(e){let t=this.nextConnection;for(;t;){const r=t.targetBlock();if(!r||e&&r.isShadow())return t;t=r.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(e){for(let t=0,r;r=this.inputList[t];t++)if(r.connection&&r.connection.targetBlock()===e)return r;return null}getSurroundParent(){let e=this,t;do if(t=e,e=e.getParent(),!e)return null;while(e.getNextBlock()===t);return e}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getRootBlock(){let e,t=this;do e=t,t=e.parentBlock_;while(t);return e}getTopStackBlock(){let e=this,t;do t=e.getPreviousBlock();while(t&&t.getNextBlock()===e&&(e=t));return e}getChildren(e){if(!e)return this.childBlocks_;e=[];for(let r=0,l;l=this.inputList[r];r++)if(l.connection){var t=l.connection.targetBlock();t&&e.push(t)}return(t=this.getNextBlock())&&e.push(t),e}setParent(e){if(e!==this.parentBlock_){var t=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),r=!!t;if(r&&e&&t!==e)throw Error("Block connected to superior one that is not new parent.");if(!r&&e)throw Error("Block not connected to new parent.");if(r&&!e)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?ue(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=e)?e.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(e){const t=[this],r=this.getChildren(e);for(let l,p=0;l=r[p];p++)t.push(...l.getDescendants(e));return t}isDeletable(){return this.deletable&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnDeletable(){return this.deletable}setDeletable(e){this.deletable=e}isMovable(){return this.movable&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnMovable(){return this.movable}setMovable(e){this.movable=e}isDuplicatable(){return this.workspace.hasBlockLimits()?this.workspace.isCapacityAvailable(rt(this,!0)):!0}isShadow(){return this.shadow}setShadow(e){this.shadow=e}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(e){this.isInsertionMarker_=e}isEditable(){return this.editable&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnEditable(){return this.editable}setEditable(e){this.editable=e;for(let t=0,r;r=this.inputList[t];t++)for(let l=0,p;p=r.fieldRow[l];l++)p.updateEditable()}isDisposed(){return this.disposed}isSimpleReporter(){if(!this.outputConnection)return!1;for(const e of this.inputList)if(e.connection||1<e.fieldRow.length)return!1;return!0}getMatchingConnection(e,t){const r=this.getConnections_(!0);if(e=e.getConnections_(!0),r.length!==e.length)throw Error("Connection lists did not match in length.");for(let l=0;l<e.length;l++)if(e[l]===t)return r[l];return null}setHelpUrl(e){this.helpUrl=e}setTooltip(e){this.tooltip=e}getTooltip(){return sl(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue}setColour(e){e=ol(e),this.hue=e.hue,this.colour_=e.hex}setStyle(e){this.styleName_=e}setOnChange(e){if(e&&typeof e!="function")throw Error("onchange must be a function.");this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.onchange=e,this.onchangeWrapper=e.bind(this),this.workspace.addChangeListener(this.onchangeWrapper)}getField(e){if(typeof e!="string")throw TypeError("Block.prototype.getField expects a string with the field name but received "+(e===void 0?"nothing":e+" of type "+typeof e)+" instead");for(let t=0,r;r=this.inputList[t];t++)for(let l=0,p;p=r.fieldRow[l];l++)if(p.name===e)return p;return null}getVars(){const e=[];for(let t=0,r;r=this.inputList[t];t++)for(let l=0,p;p=r.fieldRow[l];l++)p.referencesVariables()&&e.push(p.getValue());return e}getVarModels(){const e=[];for(let t=0,r;r=this.inputList[t];t++)for(let l=0,p;p=r.fieldRow[l];l++)if(p.referencesVariables()){const v=this.workspace.getVariableById(p.getValue());v&&e.push(v)}return e}updateVarName(e){for(let t=0,r;r=this.inputList[t];t++)for(let l=0,p;p=r.fieldRow[l];l++)p.referencesVariables()&&e.getId()===p.getValue()&&p.refreshVariableName()}renameVarById(e,t){for(let r=0,l;l=this.inputList[r];r++)for(let p=0,v;v=l.fieldRow[p];p++)v.referencesVariables()&&e===v.getValue()&&v.setValue(t)}getFieldValue(e){return(e=this.getField(e))?e.getValue():null}setFieldValue(e,t){const r=this.getField(t);if(!r)throw Error('Field "'+t+'" not found.');r.setValue(e)}setPreviousStatement(e,t){if(e)t===void 0&&(t=null),this.previousConnection||(this.previousConnection=this.makeConnection_(Ze.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(t);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(e,t){if(e)t===void 0&&(t=null),this.nextConnection||(this.nextConnection=this.makeConnection_(Ze.NEXT_STATEMENT)),this.nextConnection.setCheck(t);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(e,t){if(e)t===void 0&&(t=null),this.outputConnection||(this.outputConnection=this.makeConnection_(Ze.OUTPUT_VALUE)),this.outputConnection.setCheck(t);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(e){this.inputsInline!==e&&(ee(new(Ce(fe.BLOCK_CHANGE))(this,"inline",null,this.inputsInline,e)),this.inputsInline=e)}getInputsInline(){if(this.inputsInline!==void 0)return this.inputsInline;for(var e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof yi&&this.inputList[e]instanceof yi)return!1;for(e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof s.ValueInput$$module$build$src$core$inputs$value_input&&this.inputList[e]instanceof yi)return!0;for(e=0;e<this.inputList.length;e++)if(this.inputList[e]instanceof ro)return!0;return!1}setOutputShape(e){this.outputShape_=e}getOutputShape(){return this.outputShape_}isEnabled(){return this.disabledReasons.size===0}get disabled(){return T("disabled","v11","v12","the isEnabled or hasDisabledReason methods of Block"),this.hasDisabledReason(Bs)}set disabled(e){T("disabled","v11","v12","the setDisabledReason method of Block"),this.setDisabledReason(e,Bs)}setEnabled(e){T("setEnabled","v11","v12","the setDisabledReason method of Block"),this.setDisabledReason(!e,Bs)}setDisabledReason(e,t){e||this.workspace.options.disable||!this.hasDisabledReason(Bs)||t==Bs||this.setDisabledReason(!1,Bs),this.disabledReasons.has(t)!==e&&(e?this.disabledReasons.add(t):this.disabledReasons.delete(t),e=new(Ce(fe.BLOCK_CHANGE))(this,"disabled",null,!e,e),e.setDisabledReason(t),ee(e))}getInheritedDisabled(){let e=this.getSurroundParent();for(;e;){if(!e.isEnabled())return!0;e=e.getSurroundParent()}return!1}hasDisabledReason(e){return this.disabledReasons.has(e)}getDisabledReasons(){return this.disabledReasons}isCollapsed(){return this.collapsed_}setCollapsed(e){this.collapsed_!==e&&(ee(new(Ce(fe.BLOCK_CHANGE))(this,"collapsed",null,this.collapsed_,e)),this.collapsed_=e)}toString(e,t){t=this.toTokens(t);for(let l=2;l<t.length;l++)t[l-2]==="("&&t[l]===")"&&(t[l-2]=t[l-1],t.splice(l-1,2));let r="";return t=t.reduce((l,p)=>(l=l+(r==="("||p===")"?"":" ")+p,r=p[p.length-1],l),""),t=t.trim()||"???",e&&t.length>e&&(t=t.substring(0,e-3)+"..."),t}toTokens(e="?"){const t=[];for(const l of this.inputList)if(l.name!=jc){for(const p of l.fieldRow)t.push(p.getText());if(l.connection){const p=l.connection.targetBlock();if(p){var r=l.connection;let v=r.getCheck();!v&&r.targetConnection&&(v=r.targetConnection.getCheck()),(r=!!v&&(v.includes("Boolean")||v.includes("Number")))&&t.push("("),t.push(...p.toTokens(e)),r&&t.push(")")}else t.push(e)}}return t}appendValueInput(e){return this.appendInput(new s.ValueInput$$module$build$src$core$inputs$value_input(e,this))}appendStatementInput(e){return this.statementInputCount++,this.appendInput(new yr(e,this))}appendDummyInput(e=""){return this.appendInput(new yi(e,this))}appendEndRowInput(e=""){return this.appendInput(new ro(e,this))}appendInput(e){return this.inputList.push(e),e}appendInputFromRegistry(e,t){return(e=b(Be.INPUT,e,!1))?this.appendInput(new e(t,this)):null}jsonInit(e){var t=e.type?'Block "'+e.type+'": ':"";if(e.output&&e.previousStatement)throw Error(t+"Must not have both an output and a previousStatement.");for(var r=0;e["args"+r];){if(e["message"+r]===void 0)throw Error(t+`args${r} must have a corresponding message (message${r}).`);r++}if(e.style&&e.style.hat&&(this.hat=e.style.hat,e.style=null),e.style&&e.colour)throw Error(t+"Must not have both a colour and a style.");for(e.style?this.jsonInitStyle(e,t):this.jsonInitColour(e,t),r=0;e["message"+r]!==void 0;)this.interpolate(e["message"+r],e["args"+r]||[],e["implicitAlign"+r]||e["lastDummyAlign"+r],t),r++;if(e.inputsInline!==void 0&&(s.disable$$module$build$src$core$events$utils(),this.setInputsInline(e.inputsInline),s.enable$$module$build$src$core$events$utils()),e.output!==void 0&&this.setOutput(!0,e.output),e.outputShape!==void 0&&this.setOutputShape(e.outputShape),e.previousStatement!==void 0&&this.setPreviousStatement(!0,e.previousStatement),e.nextStatement!==void 0&&this.setNextStatement(!0,e.nextStatement),e.tooltip!==void 0&&(r=kt(e.tooltip),this.setTooltip(r)),e.enableContextMenu!==void 0&&(this.contextMenu=!!e.enableContextMenu),e.suppressPrefixSuffix!==void 0&&(this.suppressPrefixSuffix=!!e.suppressPrefixSuffix),e.helpUrl!==void 0&&(r=kt(e.helpUrl),this.setHelpUrl(r)),typeof e.extensions=="string"&&(console.warn(t+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+e.type+"' block."),e.extensions=[e.extensions]),e.mutator!==void 0&&Gu(e.mutator,this,!0),e=e.extensions,Array.isArray(e))for(t=0;t<e.length;t++)Gu(e[t],this,!1)}jsonInitColour(e,t){if("colour"in e)if(e.colour===void 0)console.warn(t+"Undefined colour value.");else{e=e.colour;try{this.setColour(e)}catch{console.warn(t+"Illegal colour value: ",e)}}}jsonInitStyle(e,t){e=e.style;try{this.setStyle(e)}catch{console.warn(t+"Style does not exist: ",e)}}mixin(e,t){if(t!==void 0&&typeof t!="boolean")throw Error("opt_disableCheck must be a boolean if provided");if(!t){t=[];for(const r in e)this[r]!==void 0&&t.push(r);if(t.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(t))}Object.assign(this,e)}interpolate(e,t,r,l){e=qn(e),this.validateTokens(e,t.length),t=this.interpolateArguments(e,t,r),r=[];for(let p=0,v;v=t[p];p++)if(this.isInputKeyword(v.type)){if(e=this.inputFromJson(v,l)){for(let O=0,G;G=r[O];O++)e.appendField(G[0],G[1]);r.length=0}}else(e=this.fieldFromJson(v))&&r.push([e,v.name])}validateTokens(e,t){const r=[];let l=0;for(let p=0;p<e.length;p++){const v=e[p];if(typeof v=="number"){if(1>v||v>t)throw Error('Block "'+this.type+'": Message index %'+v+" out of range.");if(r[v])throw Error('Block "'+this.type+'": Message index %'+v+" duplicated.");r[v]=!0,l++}}if(l!==t)throw Error('Block "'+this.type+'": Message does not reference all '+t+" arg(s).")}interpolateArguments(e,t,r){const l=[];for(let v=0;v<e.length;v++){var p=e[v];if(typeof p=="number"&&(p=t[p-1]),typeof p=="string"){if(p===`
`)p={type:"input_end_row"},r&&(p.align=r);else if(p=this.stringToFieldJson(p),!p)continue}l.push(p)}return(e=l.length)&&!this.isInputKeyword(l[e-1].type)&&(e={type:"input_dummy"},r&&(e.align=r),l.push(e)),l}fieldFromJson(e){const t=s.fromJson$$module$build$src$core$field_registry(e);return!t&&e.alt?typeof e.alt=="string"?(e=this.stringToFieldJson(e.alt))?this.fieldFromJson(e):null:this.fieldFromJson(e.alt):t}inputFromJson(e,t){var r={LEFT:s.Align$$module$build$src$core$inputs$align.LEFT,RIGHT:s.Align$$module$build$src$core$inputs$align.RIGHT,CENTRE:s.Align$$module$build$src$core$inputs$align.CENTRE,CENTER:s.Align$$module$build$src$core$inputs$align.CENTRE};let l;switch(e.type){case"input_value":l=this.appendValueInput(e.name);break;case"input_statement":l=this.appendStatementInput(e.name);break;case"input_dummy":l=this.appendDummyInput(e.name);break;case"input_end_row":l=this.appendEndRowInput(e.name);break;default:l=this.appendInputFromRegistry(e.type,e.name)}return l?(e.check&&l.setCheck(e.check),e.align&&(r=r[e.align.toUpperCase()],r===void 0?console.warn(t+"Illegal align value: ",e.align):l.setAlign(r)),l):null}isInputKeyword(e){return e==="input_value"||e==="input_statement"||e==="input_dummy"||e==="input_end_row"||g(Be.INPUT,e)}stringToFieldJson(e){return(e=e.trim())?{type:"field_label",text:e}:null}moveInputBefore(e,t){if(e!==t){var r=-1,l=t?-1:this.inputList.length;for(let p=0,v;v=this.inputList[p];p++)if(v.name===e){if(r=p,l!==-1)break}else if(t&&v.name===t&&(l=p,r!==-1))break;if(r===-1)throw Error('Named input "'+e+'" not found.');if(l===-1)throw Error('Reference input "'+t+'" not found.');this.moveNumberedInputBefore(r,l)}}moveNumberedInputBefore(e,t){if(e===t)throw Error("Can't move input to itself.");if(e>=this.inputList.length)throw RangeError("Input index "+e+" out of bounds.");if(t>this.inputList.length)throw RangeError("Reference input "+t+" out of bounds.");const r=this.inputList[e];this.inputList.splice(e,1),e<t&&t--,this.inputList.splice(t,0,r)}removeInput(e,t){for(let r=0,l;l=this.inputList[r];r++)if(l.name===e)return l instanceof yr&&this.statementInputCount--,l.dispose(),this.inputList.splice(r,1),!0;if(t)return!1;throw Error("Input not found: "+e)}getInput(e){for(let t=0,r;r=this.inputList[t];t++)if(r.name===e)return r;return null}getInputTargetBlock(e){return(e=this.getInput(e))&&e.connection&&e.connection.targetBlock()}getCommentText(){let e,t;return(t=(e=this.getIcon(Qn.COMMENT))==null?void 0:e.getText())!=null?t:null}setCommentText(e){var t;let r;const l=(r=(t=this.getIcon(Qn.COMMENT))==null?void 0:t.getText())!=null?r:null;if(l!==e){if(e!==null){if(t=this.getIcon(Qn.COMMENT),!t){if(t=b(Be.ICON,Qn.COMMENT.toString(),!1),!t)throw Error("No comment icon class is registered, so a comment cannot be set");if(t=new t(this),!vp(t))throw Error("The class registered as a comment icon does not conform to the ICommentIcon interface");t=this.addIcon(t)}s.disable$$module$build$src$core$events$utils(),t.setText(e),s.enable$$module$build$src$core$events$utils()}else this.removeIcon(Qn.COMMENT);ee(new(Ce(fe.BLOCK_CHANGE))(this,"comment",null,l,e))}}setWarningText(e,t){}setMutator(e){}addIcon(e){if(this.hasIcon(e.getType()))throw new Rg(e);return this.icons.push(e),this.icons.sort((t,r)=>t.getWeight()-r.getWeight()),e}removeIcon(e){if(!this.hasIcon(e))return!1;let t;return(t=this.getIcon(e))==null||t.dispose(),this.icons=this.icons.filter(r=>!r.getType().equals(e)),!0}hasIcon(e){return this.icons.some(t=>t.getType().equals(e))}getIcon(e){return e instanceof Qn?this.icons.find(t=>t.getType().equals(e)):this.icons.find(t=>t.getType().toString()===e)}getIcons(){return[...this.icons]}getRelativeToSurfaceXY(){return this.xy}moveBy(e,t,r){if(this.parentBlock_)throw Error("Block has parent");const l=new(Ce(fe.BLOCK_MOVE))(this);r&&l.setReason(r),this.xy.translate(e,t),l.recordNew(),ee(l)}makeConnection_(e){return new sn(this,e)}allInputsFilled(e){if(e===void 0&&(e=!0),!e&&this.isShadow())return!1;for(let r=0,l;l=this.inputList[r];r++)if(l.connection){var t=l.connection.targetBlock();if(!t||!t.allInputsFilled(e))return!1}return(t=this.getNextBlock())?t.allInputsFilled(e):!0}toDevString(){let e=this.type?'"'+this.type+'" block':"Block";return this.id&&(e+=' (id="'+this.id+'")'),e}};Lo.COLLAPSED_INPUT_NAME=jc,Lo.COLLAPSED_FIELD_NAME=Dd;var _r=class{constructor(e,t,r,l){this.workspace=e,this.targetWorkspace=t,this.isFlyoutLabel=l,this.onMouseUpWrapper=null,this.height=this.width=0,this.cursorSvg=this.svgText=this.svgGroup=null,this.text=r.text,this.position=new Le(0,0),this.callbackKey=r.callbackKey||r.callbackkey,this.cssClass=r["web-class"]||null,this.info=r}createDom(){var e=this.isFlyoutLabel?"blocklyFlyoutLabel":"blocklyFlyoutButton";this.cssClass&&(e+=" "+this.cssClass),this.svgGroup=re(oe.G,{class:e},this.workspace.getCanvas());let t;this.isFlyoutLabel||(t=re(oe.RECT,{class:"blocklyFlyoutButtonShadow",rx:_r.BORDER_RADIUS,ry:_r.BORDER_RADIUS,x:1,y:1},this.svgGroup)),e=re(oe.RECT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:_r.BORDER_RADIUS,ry:_r.BORDER_RADIUS},this.svgGroup);const r=re(oe.TEXT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup);var l=kt(this.text);this.workspace.RTL&&(l+=""),r.textContent=l,this.isFlyoutLabel&&(this.svgText=r,this.workspace.getThemeManager().subscribe(this.svgText,"flyoutForegroundColour","fill"));const p=jn(r,"fontSize"),v=jn(r,"fontWeight"),O=jn(r,"fontFamily");if(this.width=Rn(r,p,v,O),l=Kt(l,p,v,O),this.height=l.height,!this.isFlyoutLabel){this.width+=2*_r.TEXT_MARGIN_X,this.height+=2*_r.TEXT_MARGIN_Y;let G;(G=t)==null||G.setAttribute("width",String(this.width));let Ie;(Ie=t)==null||Ie.setAttribute("height",String(this.height))}return e.setAttribute("width",String(this.width)),e.setAttribute("height",String(this.height)),r.setAttribute("x",String(this.width/2)),r.setAttribute("y",String(this.height/2-l.height/2+l.baseline)),this.updateTransform(),this.onMouseUpWrapper=Ue(this.svgGroup,"pointerup",this,this.onMouseUp),this.svgGroup}show(){this.updateTransform(),this.svgGroup.setAttribute("display","block")}updateTransform(){this.svgGroup.setAttribute("transform","translate("+this.position.x+","+this.position.y+")")}moveTo(e,t){this.position.x=e,this.position.y=t,this.updateTransform()}isLabel(){return this.isFlyoutLabel}getPosition(){return this.position}getButtonText(){return this.text}getTargetWorkspace(){return this.targetWorkspace}getWorkspace(){return this.workspace}dispose(){this.onMouseUpWrapper&&wt(this.onMouseUpWrapper),this.svgGroup&&mt(this.svgGroup),this.svgText&&this.workspace.getThemeManager().unsubscribe(this.svgText)}setCursorSvg(e){e?this.svgGroup&&(this.svgGroup.appendChild(e),this.cursorSvg=e):this.cursorSvg=null}setMarkerSvg(){throw Error("Attempted to set a marker on a button.")}onMouseUp(e){(e=this.targetWorkspace.getGesture(e))&&e.cancel(),this.isFlyoutLabel&&this.callbackKey?console.warn("Labels should not have callbacks. Label text: "+this.text):this.isFlyoutLabel||this.callbackKey&&this.targetWorkspace.getButtonCallback(this.callbackKey)?this.isFlyoutLabel||(e=this.targetWorkspace.getButtonCallback(this.callbackKey))&&e(this):console.warn("Buttons should have callbacks. Button text: "+this.text)}};_r.TEXT_MARGIN_X=5,_r.TEXT_MARGIN_Y=2,_r.BORDER_RADIUS=4,we(`
.blocklyFlyoutButton {
  fill: #888;
  cursor: default;
}

.blocklyFlyoutButtonShadow {
  fill: #666;
}

.blocklyFlyoutButton:hover {
  fill: #aaa;
}

.blocklyFlyoutLabel {
  cursor: default;
}

.blocklyFlyoutLabelBackground {
  opacity: 0;
}
`);var Oe=class{constructor(e,t,r){if(this.wsCoordinate=null,!t)throw Error("Cannot create a node without a location.");this.type=e,this.isConnectionLocation=Oe.isConnectionType(e),this.location=t,this.processParams(r||null)}processParams(e){e&&e.wsCoordinate&&(this.wsCoordinate=e.wsCoordinate)}getLocation(){return this.location}getType(){return this.type}getWsCoordinate(){return this.wsCoordinate}isConnection(){return this.isConnectionLocation}findNextForInput(){var e=this.location.getParentInput();const t=e.getSourceBlock();for(e=t.inputList.indexOf(e),e+=1;e<t.inputList.length;e++){const r=t.inputList[e],l=r.fieldRow;for(let p=0;p<l.length;p++){const v=l[p];if(v.isClickable()||Oe.NAVIGATE_ALL_FIELDS)return Oe.createFieldNode(v)}if(r.connection)return Oe.createInputNode(r)}return null}findNextForField(){var e=this.location,t=e.getParentInput();const r=e.getSourceBlock();if(!r)throw Error("The current AST location is not associated with a block");var l=r.inputList.indexOf(t);for(e=t.fieldRow.indexOf(e)+1;l<r.inputList.length;l++){t=r.inputList[l];const p=t.fieldRow;for(;e<p.length;){if(p[e].isClickable()||Oe.NAVIGATE_ALL_FIELDS)return Oe.createFieldNode(p[e]);e++}if(e=0,t.connection)return Oe.createInputNode(t)}return null}findPrevForInput(){const e=this.location.getParentInput(),t=e.getSourceBlock();for(var r=t.inputList.indexOf(e);0<=r;r--){var l=t.inputList[r];if(l.connection&&l!==e)return Oe.createInputNode(l);l=l.fieldRow;for(let p=l.length-1;0<=p;p--){const v=l[p];if(v.isClickable()||Oe.NAVIGATE_ALL_FIELDS)return Oe.createFieldNode(v)}}return null}findPrevForField(){var e=this.location;const t=e.getParentInput(),r=e.getSourceBlock();if(!r)throw Error("The current AST location is not associated with a block");var l=r.inputList.indexOf(t);for(e=t.fieldRow.indexOf(e)-1;0<=l;l--){var p=r.inputList[l];if(p.connection&&p!==t)return Oe.createInputNode(p);for(p=p.fieldRow;-1<e;){if(p[e].isClickable()||Oe.NAVIGATE_ALL_FIELDS)return Oe.createFieldNode(p[e]);e--}0<=l-1&&(e=r.inputList[l-1].fieldRow.length-1)}return null}navigateBetweenStacks(e){var t=this.getLocation();if(t.getSourceBlock){var r=t.getSourceBlock();r&&(t=r)}if(!t||t.isDeadOrDying())return null;if(t.workspace.isFlyout)return this.navigateFlyoutContents(e);r=t.getRootBlock(),t=r.workspace.getTopBlocks(!0);for(let l=0;l<t.length;l++)if(r.id===t[l].id)return e=l+(e?1:-1),e===-1||e===t.length?null:Oe.createStackNode(t[e]);throw Error("Couldn't find "+(e?"next":"previous")+" stack?!")}navigateFlyoutContents(e){let t;switch(this.getType()){case Oe.types.STACK:t=this.getLocation();var r=t.workspace.targetWorkspace;break;case Oe.types.BUTTON:t=this.getLocation(),r=t.getTargetWorkspace();break;default:return null}return r=r.getFlyout(),r&&(e=this.findNextLocationInFlyout(r.getContents(),t,e))?e.type==="button"&&e.button?Oe.createButtonNode(e.button):e.type==="block"&&e.block?Oe.createStackNode(e.block):null:null}findNextLocationInFlyout(e,t,r){const l=e.findIndex(p=>t instanceof Lo&&p.block===t||t instanceof _r&&p.button===t);return 0>l?null:(r=r?l+1:l-1,r===-1||r===e.length?null:e[r])}findTopASTNodeForBlock(e){const t=vl(e);return t?Oe.createConnectionNode(t):Oe.createBlockNode(e)}getOutAstNodeForBlock(e){if(!e)return null;e=e.getTopStackBlock();const t=vl(e);return t&&t.targetConnection&&t.targetConnection.getParentInput()?Oe.createInputNode(t.targetConnection.getParentInput()):Oe.createStackNode(e)}findFirstFieldOrInput(e){e=e.inputList;for(let t=0;t<e.length;t++){const r=e[t],l=r.fieldRow;for(let p=0;p<l.length;p++){const v=l[p];if(v.isClickable()||Oe.NAVIGATE_ALL_FIELDS)return Oe.createFieldNode(v)}if(r.connection)return Oe.createInputNode(r)}return null}getSourceBlock(){return this.getType()===Oe.types.BLOCK?this.getLocation():this.getType()===Oe.types.STACK?this.getLocation():this.getType()===Oe.types.WORKSPACE||this.getType()===Oe.types.BUTTON?null:this.getLocation().getSourceBlock()}next(){switch(this.type){case Oe.types.STACK:return this.navigateBetweenStacks(!0);case Oe.types.OUTPUT:return Oe.createBlockNode(this.location.getSourceBlock());case Oe.types.FIELD:return this.findNextForField();case Oe.types.INPUT:return this.findNextForInput();case Oe.types.BLOCK:const e=this.location.nextConnection;if(!e)break;return Oe.createConnectionNode(e);case Oe.types.PREVIOUS:return Oe.createBlockNode(this.location.getSourceBlock());case Oe.types.NEXT:return Oe.createConnectionNode(this.location.targetConnection);case Oe.types.BUTTON:return this.navigateFlyoutContents(!0)}return null}in(){switch(this.type){case Oe.types.WORKSPACE:const e=this.location.getTopBlocks(!0);if(0<e.length)return Oe.createStackNode(e[0]);break;case Oe.types.STACK:return this.findTopASTNodeForBlock(this.location);case Oe.types.BLOCK:return this.findFirstFieldOrInput(this.location);case Oe.types.INPUT:return Oe.createConnectionNode(this.location.targetConnection)}return null}prev(){switch(this.type){case Oe.types.STACK:return this.navigateBetweenStacks(!1);case Oe.types.FIELD:return this.findPrevForField();case Oe.types.INPUT:return this.findPrevForInput();case Oe.types.BLOCK:var e=vl(this.location);if(!e)break;return Oe.createConnectionNode(e);case Oe.types.PREVIOUS:if((e=this.location.targetConnection)&&!e.getParentInput())return Oe.createConnectionNode(e);break;case Oe.types.NEXT:return Oe.createBlockNode(this.location.getSourceBlock());case Oe.types.BUTTON:return this.navigateFlyoutContents(!1)}return null}out(){switch(this.type){case Oe.types.STACK:var e=this.location,t=e.getRelativeToSurfaceXY();return t=new Le(t.x,t.y+Oe.DEFAULT_OFFSET_Y),Oe.createWorkspaceNode(e.workspace,t);case Oe.types.OUTPUT:return e=this.location,(t=e.targetConnection)?Oe.createConnectionNode(t):Oe.createStackNode(e.getSourceBlock());case Oe.types.FIELD:if(e=this.location.getSourceBlock(),!e)throw Error("The current AST location is not associated with a block");return Oe.createBlockNode(e);case Oe.types.INPUT:return Oe.createBlockNode(this.location.getSourceBlock());case Oe.types.BLOCK:return this.getOutAstNodeForBlock(this.location);case Oe.types.PREVIOUS:return this.getOutAstNodeForBlock(this.location.getSourceBlock());case Oe.types.NEXT:return this.getOutAstNodeForBlock(this.location.getSourceBlock())}return null}static isConnectionType(e){switch(e){case Oe.types.PREVIOUS:case Oe.types.NEXT:case Oe.types.INPUT:case Oe.types.OUTPUT:return!0}return!1}static createFieldNode(e){return e?new Oe(Oe.types.FIELD,e):null}static createConnectionNode(e){if(!e)return null;const t=e.type;return t===Ze.INPUT_VALUE||t===Ze.NEXT_STATEMENT&&e.getParentInput()?Oe.createInputNode(e.getParentInput()):t===Ze.NEXT_STATEMENT?new Oe(Oe.types.NEXT,e):t===Ze.OUTPUT_VALUE?new Oe(Oe.types.OUTPUT,e):t===Ze.PREVIOUS_STATEMENT?new Oe(Oe.types.PREVIOUS,e):null}static createInputNode(e){return e&&e.connection?new Oe(Oe.types.INPUT,e.connection):null}static createBlockNode(e){return e?new Oe(Oe.types.BLOCK,e):null}static createStackNode(e){return e?new Oe(Oe.types.STACK,e):null}static createButtonNode(e){return e?new Oe(Oe.types.BUTTON,e):null}static createWorkspaceNode(e,t){return t&&e?new Oe(Oe.types.WORKSPACE,e,{wsCoordinate:t}):null}static createTopNode(e){const t=vl(e);return t?Oe.createConnectionNode(t):Oe.createBlockNode(e)}};Oe.NAVIGATE_ALL_FIELDS=!1,Oe.DEFAULT_OFFSET_Y=-20,function(e){e=e.types||(e.types={}),e.FIELD="field",e.BLOCK="block",e.INPUT="input",e.OUTPUT="output",e.NEXT="next",e.PREVIOUS="previous",e.STACK="stack",e.WORKSPACE="workspace",e.BUTTON="button"}(Oe||(Oe={}));var jg=class extends Es{constructor(e,t,r,l){let p=e?e.workspace.id:void 0;l&&l.getType()===Oe.types.WORKSPACE&&(p=l.getLocation().id),super(p),this.type=fe.MARKER_MOVE,this.blockId=e==null?void 0:e.id,this.oldNode=r||void 0,this.newNode=l,this.isCursor=t}toJson(){const e=super.toJson();if(this.isCursor===void 0)throw Error("Whether this is a cursor event or not is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newNode)throw Error("The new node is undefined. Either pass a node to the constructor, or call fromJson");return e.isCursor=this.isCursor,e.blockId=this.blockId,e.oldNode=this.oldNode,e.newNode=this.newNode,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new jg),t.isCursor=e.isCursor,t.blockId=e.blockId,t.oldNode=e.oldNode,t.newNode=e.newNode,t}};i(Be.EVENT,fe.MARKER_MOVE,jg);var ly="blocklyCursor",zb="blocklyMarker",cy=.75,Fg=class{constructor(e,t,r){this.workspace=e,this.marker=r,this.markerSvgRect_=this.markerSvgLine_=this.markerInput_=this.markerBlock_=this.svgGroup_=this.markerSvg_=this.currentMarkerSvg=this.parent=null,this.constants_=t,e=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR,this.colour_=r.colour||e}getSvgRoot(){return this.svgGroup_}getMarker(){return this.marker}isCursor(){return this.marker.type==="cursor"}createDom(){const e=this.isCursor()?ly:zb;return this.svgGroup_=re(oe.G,{class:e}),this.createDomInternal_(),this.svgGroup_}setParent_(e){this.isCursor()?(this.parent&&this.parent.setCursorSvg(null),e.setCursorSvg(this.getSvgRoot())):(this.parent&&this.parent.setMarkerSvg(null),e.setMarkerSvg(this.getSvgRoot())),this.parent=e}draw(e,t){if(t){this.constants_=this.workspace.getRenderer().getConstants();var r=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker.colour||r,this.applyColour_(t),this.showAtLocation_(t),this.fireMarkerEvent(e,t),e=this.currentMarkerSvg.childNodes[0],e!==void 0&&e.beginElement&&e.beginElement()}else this.hide()}showAtLocation_(e){const t=e.getLocation().type;e.getType()===Oe.types.BLOCK?this.showWithBlock_(e):e.getType()===Oe.types.OUTPUT?this.showWithOutput_(e):t===Ze.INPUT_VALUE?this.showWithInput_(e):t===Ze.NEXT_STATEMENT?this.showWithNext_(e):e.getType()===Oe.types.PREVIOUS?this.showWithPrevious_(e):e.getType()===Oe.types.FIELD?this.showWithField_(e):e.getType()===Oe.types.WORKSPACE?this.showWithCoordinates_(e):e.getType()===Oe.types.STACK?this.showWithStack_(e):e.getType()===Oe.types.BUTTON&&this.showWithButton_(e)}showWithBlockPrevOutput(e){e=e.getSourceBlock();const t=e.width;var r=e.height,l=r*cy;const p=this.constants_.CURSOR_BLOCK_PADDING;e.previousConnection?(r=this.constants_.shapeFor(e.previousConnection),this.positionPrevious_(t,p,l,r)):e.outputConnection?(l=this.constants_.shapeFor(e.outputConnection),this.positionOutput_(t,r,l)):this.positionBlock_(t,p,l),this.setParent_(e),this.showCurrent_()}showWithBlock_(e){this.showWithBlockPrevOutput(e)}showWithPrevious_(e){this.showWithBlockPrevOutput(e)}showWithOutput_(e){this.showWithBlockPrevOutput(e)}showWithCoordinates_(e){var t=e.getWsCoordinate();e=t.x,t=t.y,this.workspace.RTL&&(e-=this.constants_.CURSOR_WS_WIDTH),this.positionLine_(e,t,this.constants_.CURSOR_WS_WIDTH),this.setParent_(this.workspace),this.showCurrent_()}showWithField_(e){e=e.getLocation();const t=e.getSize().width,r=e.getSize().height;this.positionRect_(0,0,t,r),this.setParent_(e),this.showCurrent_()}showWithInput_(e){e=e.getLocation();const t=e.getSourceBlock();this.positionInput_(e),this.setParent_(t),this.showCurrent_()}showWithNext_(e){var t=e.getLocation();e=t.getSourceBlock();let r=0;t=t.getOffsetInBlock().y;const l=e.getHeightWidth().width;this.workspace.RTL&&(r=-l),this.positionLine_(r,t,l),this.setParent_(e),this.showCurrent_()}showWithStack_(e){e=e.getLocation();var t=e.getHeightWidth();const r=t.width+this.constants_.CURSOR_STACK_PADDING;t=t.height+this.constants_.CURSOR_STACK_PADDING;const l=-this.constants_.CURSOR_STACK_PADDING/2,p=-this.constants_.CURSOR_STACK_PADDING/2;let v=l;this.workspace.RTL&&(v=-(r+l)),this.positionRect_(v,p,r,t),this.setParent_(e),this.showCurrent_()}showWithButton_(e){e=e.getLocation();const t=e.width+this.constants_.CURSOR_STACK_PADDING,r=e.height+this.constants_.CURSOR_STACK_PADDING,l=-this.constants_.CURSOR_STACK_PADDING/2,p=-this.constants_.CURSOR_STACK_PADDING/2;let v=l;this.workspace.RTL&&(v=-(t+l)),this.positionRect_(v,p,t,r),this.setParent_(e),this.showCurrent_()}showCurrent_(){this.hide(),this.currentMarkerSvg&&(this.currentMarkerSvg.style.display="")}positionBlock_(e,t,r){if(e=xn(-t,r)+tt("V",-t)+tt("H",e+2*t)+tt("V",r),!this.markerBlock_)throw Error("createDom should be called before positioning the marker");this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionInput_(e){const t=e.getOffsetInBlock().x,r=e.getOffsetInBlock().y;e=is(0,0)+this.constants_.shapeFor(e).pathDown,this.markerInput_.setAttribute("d",e),this.markerInput_.setAttribute("transform","translate("+t+","+r+")"+(this.workspace.RTL?" scale(-1 1)":"")),this.currentMarkerSvg=this.markerInput_}positionLine_(e,t,r){if(!this.markerSvgLine_)throw Error("createDom should be called before positioning the line");this.markerSvgLine_.setAttribute("x",`${e}`),this.markerSvgLine_.setAttribute("y",`${t}`),this.markerSvgLine_.setAttribute("width",`${r}`),this.currentMarkerSvg=this.markerSvgLine_}positionOutput_(e,t,r){if(!this.markerBlock_)throw Error("createDom should be called before positioning the output");e=xn(e,0)+tt("h",-(e-r.width))+tt("v",this.constants_.TAB_OFFSET_FROM_TOP)+r.pathDown+tt("V",t)+tt("H",e),this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionPrevious_(e,t,r,l){if(!this.markerBlock_)throw Error("createDom should be called before positioning the previous connection marker");e=xn(-t,r)+tt("V",-t)+tt("H",this.constants_.NOTCH_OFFSET_LEFT)+l.pathLeft+tt("H",e+2*t)+tt("V",r),this.markerBlock_.setAttribute("d",e),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionRect_(e,t,r,l){if(!this.markerSvgRect_)throw Error("createDom should be called before positioning the rect");this.markerSvgRect_.setAttribute("x",`${e}`),this.markerSvgRect_.setAttribute("y",`${t}`),this.markerSvgRect_.setAttribute("width",`${r}`),this.markerSvgRect_.setAttribute("height",`${l}`),this.currentMarkerSvg=this.markerSvgRect_}flipRtl(e){e.setAttribute("transform","scale(-1 1)")}hide(){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before hiding the marker");this.markerSvgLine_.style.display="none",this.markerSvgRect_.style.display="none",this.markerInput_.style.display="none",this.markerBlock_.style.display="none"}fireMarkerEvent(e,t){const r=t.getSourceBlock();e=new(Ce(fe.MARKER_MOVE))(r,this.isCursor(),e,t),ee(e)}getBlinkProperties_(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"}}createDomInternal_(){if(this.markerSvg_=re(oe.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_),this.markerSvgLine_=re(oe.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.markerSvg_),this.markerSvgRect_=re(oe.RECT,{class:"blocklyVerticalMarker",rx:10,ry:10},this.markerSvg_),this.markerInput_=re(oe.PATH,{transform:""},this.markerSvg_),this.markerBlock_=re(oe.PATH,{transform:"",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.hide(),this.isCursor()){const e=this.getBlinkProperties_();re(oe.ANIMATE,e,this.markerSvgLine_),re(oe.ANIMATE,e,this.markerInput_),re(oe.ANIMATE,Object.assign({},e,{attributeName:"stroke"}),this.markerBlock_)}return this.markerSvg_}applyColour_(e){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before applying color to the markerj");this.markerSvgLine_.setAttribute("fill",this.colour_),this.markerSvgRect_.setAttribute("stroke",this.colour_),this.markerInput_.setAttribute("fill",this.colour_),this.markerBlock_.setAttribute("stroke",this.colour_),this.isCursor()&&(e=this.colour_+";transparent;transparent;",this.markerSvgLine_.firstElementChild.setAttribute("values",e),this.markerInput_.firstElementChild.setAttribute("values",e),this.markerBlock_.firstElementChild.setAttribute("values",e))}dispose(){this.svgGroup_&&mt(this.svgGroup_)}},Gd=class{constructor(e,t,r){this.markerSvg=this.cursorSvg=null,this.connectionHighlights=new WeakMap,this.highlightOffsets=new WeakMap,this.constants=r,this.style=t,this.svgRoot=e,this.svgPath=re(oe.PATH,{class:"blocklyPath"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}setCursorSvg(e){e?(this.svgRoot.appendChild(e),this.cursorSvg=e):this.cursorSvg=null}setMarkerSvg(e){e?(this.cursorSvg?this.svgRoot.insertBefore(e,this.cursorSvg):this.svgRoot.appendChild(e),this.markerSvg=e):this.markerSvg=null}applyColour(e){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(e.isShadow()),this.updateDisabled_(!e.isEnabled()||e.getInheritedDisabled())}setStyle(e){this.style=e}setClass_(e,t){e&&(t?Fe(this.svgRoot,e):pt(this.svgRoot,e))}updateHighlighted(e){e?this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"):this.svgPath.setAttribute("filter","none")}updateShadow_(e){e&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))}updateDisabled_(e){this.setClass_("blocklyDisabled",e),e&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")")}updateSelected(e){this.setClass_("blocklySelected",e)}updateDraggingDelete(e){this.setClass_("blocklyDraggingDelete",e)}updateInsertionMarker(e){this.setClass_("blocklyInsertionMarker",e)}updateMovable(e){this.setClass_("blocklyDraggable",e)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){}addConnectionHighlight(e,t,r,l){if(this.connectionHighlights.has(e)){if(this.currentHighlightMatchesNew(e,t,r))return;this.removeConnectionHighlight(e)}t=re(oe.PATH,{class:"blocklyHighlightedConnectionPath",d:t,transform:`translate(${r.x}, ${r.y})`+(l?" scale(-1 1)":"")},this.svgRoot),this.connectionHighlights.set(e,t)}currentHighlightMatchesNew(e,t,r){let l;const p=(l=this.connectionHighlights.get(e))==null?void 0:l.getAttribute("d");return e=this.highlightOffsets.get(e),p===t&&Le.equals(e,r)}removeConnectionHighlight(e){const t=this.connectionHighlights.get(e);t&&(mt(t),this.connectionHighlights.delete(e))}},wr=class{constructor(e){this.activeCandidate=this.lastMarker=this.lastOnStack=null,this.wouldDeleteBlock=!1,this.fadedBlock=this.highlightedBlock=this.markerConnection=null,s.setSelected$$module$build$src$core$common(e),this.topBlock=e,this.workspace=e.workspace,this.firstMarker=this.createMarkerBlock(this.topBlock),this.availableConnections=this.initAvailableConnections(),this.lastOnStack&&(this.lastMarker=this.createMarkerBlock(this.lastOnStack.getSourceBlock()))}dispose(){this.availableConnections.length=0,this.disposeInsertionMarker(this.firstMarker),this.disposeInsertionMarker(this.lastMarker)}updateAvailableConnections(){this.availableConnections=this.initAvailableConnections()}wouldConnectBlock(){return!!this.activeCandidate}applyConnections(){if(this.activeCandidate){s.disable$$module$build$src$core$events$utils(),this.hidePreview(),s.enable$$module$build$src$core$events$utils();var{local:e,closest:t}=this.activeCandidate;e.connect(t);var r=e.isSuperior()?t:e,l=this.topBlock.getRootBlock();rs().then(()=>{_o(r.getSourceBlock()),setTimeout(()=>{l.bringToFront()},0)})}}update(e,t){const r=this.getCandidate(e);((this.wouldDeleteBlock=this.shouldDelete(!!r,t))||this.shouldUpdatePreviews(r,e))&&(s.disable$$module$build$src$core$events$utils(),this.maybeHidePreview(r),this.maybeShowPreview(r),s.enable$$module$build$src$core$events$utils())}createMarkerBlock(e){s.disable$$module$build$src$core$events$utils();let t;try{const r=Qt(e,{addCoordinates:!1,addInputBlocks:!1,addNextBlocks:!1,doFullSerialization:!1});if(!r)throw Error(`Failed to serialize source block. ${e.toDevString()}`);t=Ni(r,this.workspace);for(const l of t.getDescendants(!1))l.setInsertionMarker(!0);t.initSvg(),t.getSvgRoot().setAttribute("visibility","hidden")}finally{s.enable$$module$build$src$core$events$utils()}return t}initAvailableConnections(){const e=this.topBlock.getConnections_(!1),t=this.topBlock.lastConnectionInStack(!0);return t&&t!==this.topBlock.nextConnection&&(e.push(t),this.lastOnStack=t),e}shouldUpdatePreviews(e,t){if(!e)return!!this.activeCandidate;if(!this.activeCandidate)return!0;const{local:r,closest:l}=this.activeCandidate;if(l===e.closest&&r===e.local)return!1;const p=r.x+t.x-l.x;return t=r.y+t.y-l.y,e.radius<Math.sqrt(p*p+t*t)-s.config$$module$build$src$core$config.currentConnectionPreference}getCandidate(e){this.markerConnection&&this.markerConnection.isConnected()||this.updateAvailableConnections();let t=this.getStartRadius(),r=null;for(let l=0;l<this.availableConnections.length;l++){const p=this.availableConnections[l],v=p.closest(t,e);v.connection&&(r={closest:v.connection,local:p,radius:v.radius},t=v.radius)}return r}getStartRadius(){return this.activeCandidate?s.config$$module$build$src$core$config.connectingSnapRadius:s.config$$module$build$src$core$config.snapRadius}shouldDelete(e,t){return t&&this.workspace.getComponentManager().hasCapability(t.id,pn.Capability.DELETE_AREA)?t.wouldDelete(this.topBlock):!1}maybeShowPreview(e){if(!this.wouldDeleteBlock&&e){var t=e.closest,r;t===((r=this.activeCandidate)==null?void 0:r.closest)||t.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.activeCandidate=e,this.showPreview(this.activeCandidate))}}showPreview(e){const t=this.workspace.getRenderer();switch(t.getConnectionPreviewMethod(e.closest,e.local,this.topBlock)){case wr.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline(e);break;case wr.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker(e);break;case wr.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade(e)}t.shouldHighlightConnection(e.closest)&&e.closest.highlight()}maybeHidePreview(e){if(!e)this.hidePreview();else if(this.activeCandidate){const t=this.activeCandidate.local!==e.local;(this.activeCandidate.closest!==e.closest||t||this.wouldDeleteBlock)&&this.hidePreview()}this.activeCandidate=this.markerConnection=null}hidePreview(){let e;const t=(e=this.activeCandidate)==null?void 0:e.closest;t&&t.targetBlock()&&this.workspace.getRenderer().shouldHighlightConnection(t)&&t.unhighlight(),this.hideReplacementFade(),this.hideInsertionInputOutline(),this.hideInsertionMarker()}showInsertionMarker(e){const{local:t,closest:r}=e;let l=(e=this.lastOnStack&&t===this.lastOnStack)?this.lastMarker:this.firstMarker;if(!l)throw Error("Cannot show the insertion marker because there is no insertion marker block");let p;try{p=l.getMatchingConnection(t.getSourceBlock(),t)}catch{if(e&&this.lastOnStack?(this.disposeInsertionMarker(this.lastMarker),l=this.lastMarker=this.createMarkerBlock(this.lastOnStack.getSourceBlock())):(this.disposeInsertionMarker(this.firstMarker),l=this.firstMarker=this.createMarkerBlock(this.topBlock)),!l)throw Error("Cannot show the insertion marker because there is no insertion marker block");p=l.getMatchingConnection(t.getSourceBlock(),t)}if(!p)throw Error("Cannot show the insertion marker because there is no associated connection");if(p===this.markerConnection)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");l.queueRender(),Ms(),p.connect(r);const v={x:r.x-p.x,y:r.y-p.y},O=p.getOffsetInBlock().clone(),G=p;rs().then(()=>{let Ie;(Ie=l)==null||Ie.positionNearConnection(G,v,O);let Qe;(Qe=l)==null||Qe.getSvgRoot().setAttribute("visibility","visible")}),this.markerConnection=p}hideInsertionMarker(){if(this.markerConnection){var e=this.markerConnection,t=e.getSourceBlock(),r=t.outputConnection,l;if((l=t.previousConnection)!=null&&l.targetConnection||r!=null&&r.targetConnection)t.unplug(!0);else{let p;(p=e.targetBlock())==null||p.unplug(!1)}if(e.targetConnection)throw Error("markerConnection still connected at the end of disconnectInsertionMarker");this.markerConnection=null,(e=t.getSvgRoot())&&e.setAttribute("visibility","hidden")}}showInsertionInputOutline(e){e=e.closest,this.highlightedBlock=e.getSourceBlock(),this.highlightedBlock.highlightShapeForInput(e,!0)}hideInsertionInputOutline(){if(this.highlightedBlock){if(!this.activeCandidate)throw Error("Cannot hide the insertion marker outline because there is no active candidate");this.highlightedBlock.highlightShapeForInput(this.activeCandidate.closest,!1),this.highlightedBlock=null}}showReplacementFade(e){if(this.fadedBlock=e.closest.targetBlock(),!this.fadedBlock)throw Error("Cannot show the replacement fade because the closest connection does not have a target block");this.fadedBlock.fadeForReplacement(!0)}hideReplacementFade(){this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null)}getInsertionMarkers(){const e=[];return this.firstMarker&&e.push(this.firstMarker),this.lastMarker&&e.push(this.lastMarker),e}disposeInsertionMarker(e){if(e){s.disable$$module$build$src$core$events$utils();try{e.dispose()}finally{s.enable$$module$build$src$core$events$utils()}}}};(function(e){e=e.PREVIEW_TYPE||(e.PREVIEW_TYPE={}),e[e.INSERTION_MARKER=0]="INSERTION_MARKER",e[e.INPUT_OUTLINE=1]="INPUT_OUTLINE",e[e.REPLACEMENT_FADE=2]="REPLACEMENT_FADE"})(wr||(wr={})),wr.PREVIEW_TYPE;var ou=class{constructor(e){this.overrides=null,this.name=e}getClassName(){return this.name+"-renderer"}init(e,t){this.constants_=this.makeConstants_(),t&&(this.overrides=t,Object.assign(this.constants_,t)),this.constants_.setTheme(e),this.constants_.init()}createDom(e,t){this.constants_.createDom(e,this.name+"-"+t.name,"."+this.getClassName()+"."+t.getClassName())}refreshDom(e,t){const r=this.getConstants();r.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=r.randomIdentifier,this.constants_.setTheme(t),this.constants_.init(),this.createDom(e,t)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new Vd}makeRenderInfo_(e){return new hs(this,e)}makeDrawer_(e,t){return new Fl(e,t)}makeMarkerDrawer(e,t){return new Fg(e,this.getConstants(),t)}makePathObject(e,t){return new Gd(e,t,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(e){return!0}orphanCanConnectAtEnd(e,t,r){return!!sn.getConnectionForOrphanedConnection(e,r===Ze.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}getConnectionPreviewMethod(e,t,r){return T("getConnectionPreviewMethod","v10","v12","an IConnectionPreviewer, if it fulfills your use case."),t.type===Ze.OUTPUT_VALUE||t.type===Ze.PREVIOUS_STATEMENT?!e.isConnected()||this.orphanCanConnectAtEnd(r,e.targetBlock(),t.type)?wr.PREVIEW_TYPE.INSERTION_MARKER:wr.PREVIEW_TYPE.REPLACEMENT_FADE:wr.PREVIEW_TYPE.INSERTION_MARKER}render(e){const t=this.makeRenderInfo_(e);t.measure(),this.makeDrawer_(e,t).draw()}},gn={};gn.BottomRow=or,gn.Connection=vi,gn.ConstantProvider=Vd,gn.Drawer=Fl,gn.ExternalValueInput=cn,gn.Field=jl,gn.Hat=Hd,gn.Icon=nu,gn.InRowSpacer=vr,gn.InlineInput=Mg,gn.InputConnection=Mo,gn.InputRow=Ng,gn.JaggedEdge=Bb,gn.MarkerSvg=Fg,gn.Measurable=Ct,gn.NextConnection=Pb,gn.OutputConnection=jb,gn.PathObject=Gd,gn.PreviousConnection=Fb,gn.RenderInfo=hs,gn.Renderer=ou,gn.RoundCorner=ru,gn.Row=Pl,gn.SpacerRow=Lg,gn.SquareCorner=iu,gn.StatementInput=su,gn.TopRow=Bg,gn.Types=J,gn.init=Qu,gn.register=Wi,gn.unregister=Hi;var Ub=class{constructor(e,t){this.workspace=e,this.theme=t,this.subscribedWorkspaces=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(e){var t=this.theme;this.theme=e,(e=this.workspace.getInjectionDiv())&&(t&&(t=t.getClassName())&&pt(e,t),(t=this.theme.getClassName())&&Fe(e,t));for(let r=0,l;l=this.subscribedWorkspaces[r];r++)l.refreshTheme();for(const[r,l]of this.componentDB)for(const p of l){e=p.element,t=p.propertyName;const v=this.theme&&this.theme.getComponentStyle(r);e.style.setProperty(t,v||"")}for(const r of this.subscribedWorkspaces)r.hideChaff()}subscribeWorkspace(e){this.subscribedWorkspaces.push(e)}unsubscribeWorkspace(e){if(!ue(this.subscribedWorkspaces,e))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(e,t,r){this.componentDB.has(t)||this.componentDB.set(t,[]),this.componentDB.get(t).push({element:e,propertyName:r}),t=this.theme&&this.theme.getComponentStyle(t),e.style.setProperty(r,t||"")}unsubscribe(e){if(e)for(const[t,r]of this.componentDB){for(let l=r.length-1;0<=l;l--)r[l].element===e&&r.splice(l,1);r.length||this.componentDB.delete(t)}}dispose(){this.subscribedWorkspaces.length=0,this.componentDB.clear()}},zg="VARIABLE_DYNAMIC",Ba={CATEGORY_NAME:zg};Ba.flyoutCategory=_c,Ba.flyoutCategoryBlocks=os,Ba.onCreateVariableButtonClick_Colour=_p,Ba.onCreateVariableButtonClick_Number=yl,Ba.onCreateVariableButtonClick_String=yp;var Pa=30,ja=[];ja[Ze.INPUT_VALUE]=Ze.OUTPUT_VALUE,ja[Ze.OUTPUT_VALUE]=Ze.INPUT_VALUE,ja[Ze.NEXT_STATEMENT]=Ze.PREVIOUS_STATEMENT,ja[Ze.PREVIOUS_STATEMENT]=Ze.NEXT_STATEMENT;var Ug="RENAME_VARIABLE_ID",Wg="DELETE_VARIABLE_ID",Wb=class{canConnect(e,t,r,l){return this.canConnectWithReason(e,t,r,l)===sn.CAN_CONNECT}canConnectWithReason(e,t,r,l){const p=this.doSafetyChecks(e,t);return p!==sn.CAN_CONNECT?p:this.doTypeChecks(e,t)?r&&!this.doDragChecks(e,t,l||0)?sn.REASON_DRAG_CHECKS_FAILED:sn.CAN_CONNECT:sn.REASON_CHECKS_FAILED}getErrorMessage(e,t,r){switch(e){case sn.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case sn.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case sn.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case sn.REASON_TARGET_NULL:return"Target connection is null.";case sn.REASON_CHECKS_FAILED:return"Connection checks failed. "+(t+" expected "+t.getCheck()+", found "+r.getCheck());case sn.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case sn.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case sn.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(e,t){if(!e||!t)return sn.REASON_TARGET_NULL;let r,l,p;return e.isSuperior()?(r=e.getSourceBlock(),l=t.getSourceBlock(),p=t):(l=e.getSourceBlock(),r=t.getSourceBlock(),p=e,e=t),r===l?sn.REASON_SELF_CONNECTION:p.type!==ja[e.type]?sn.REASON_WRONG_TYPE:r.workspace!==l.workspace?sn.REASON_DIFFERENT_WORKSPACES:r.isShadow()&&!l.isShadow()?sn.REASON_SHADOW_PARENT:p.type===Ze.OUTPUT_VALUE&&l.previousConnection&&l.previousConnection.isConnected()||p.type===Ze.PREVIOUS_STATEMENT&&l.outputConnection&&l.outputConnection.isConnected()?sn.REASON_PREVIOUS_AND_OUTPUT:sn.CAN_CONNECT}doTypeChecks(e,t){if(e=e.getCheck(),t=t.getCheck(),!e||!t)return!0;for(let r=0;r<e.length;r++)if(t.includes(e[r]))return!0;return!1}doDragChecks(e,t,r){if(e.distanceFrom(t)>r||t.getSourceBlock().isInsertionMarker())return!1;switch(t.type){case Ze.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(e,t);case Ze.OUTPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isInsertionMarker()||e.isConnected())return!1;break;case Ze.INPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;case Ze.NEXT_STATEMENT:if(t.isConnected()&&!e.getSourceBlock().nextConnection&&!t.targetBlock().isShadow()&&t.targetBlock().nextConnection||t.targetBlock()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;default:return!1}return!Sl.includes(t)}canConnectToPrevious_(e,t){return e.targetConnection||Sl.includes(t)?!1:t.targetConnection?(e=t.targetBlock(),e.isInsertionMarker()?!e.getPreviousBlock():!1):!0}};i(Be.CONNECTION_CHECKER,Nr,Wb);var Hg=class extends zc{constructor(e){super(e),this.type=fe.VAR_DELETE,e&&(this.varType=e.type,this.varName=e.name)}toJson(){const e=super.toJson();if(this.varType===void 0)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Hg),t.varType=e.varType,t.varName=e.varName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");e?t.deleteVariableById(this.varId):t.createVariable(this.varName,this.varType,this.varId)}};i(Be.EVENT,fe.VAR_DELETE,Hg);var Kd=class extends zc{constructor(e,t){super(e),this.type=fe.VAR_RENAME,e&&(this.oldName=e.name,this.newName=typeof t>"u"?"":t)}toJson(){const e=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");return e.oldName=this.oldName,e.newName=this.newName,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Kd),t.oldName=e.oldName,t.newName=e.newName,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");e?t.renameVariableById(this.varId,this.newName):t.renameVariableById(this.varId,this.oldName)}};i(Be.EVENT,fe.VAR_RENAME,Kd);var Jd=class{constructor(e){this.workspace=e,this.variableMap=new Map}clear(){for(const e of this.variableMap.values())for(;0<e.length;)this.deleteVariable(e[0]);if(this.variableMap.size!==0)throw Error("Non-empty variable map")}renameVariable(e,t){if(e.name!==t){var r=this.getVariable(t,e.type),l=this.workspace.getAllBlocks(!1),p=s.getGroup$$module$build$src$core$events$utils();p||s.setGroup$$module$build$src$core$events$utils(!0);try{r&&r.getId()!==e.getId()?this.renameVariableWithConflict(e,t,r,l):this.renameVariableAndUses(e,t,l)}finally{s.setGroup$$module$build$src$core$events$utils(p)}}}renameVariableById(e,t){const r=this.getVariableById(e);if(!r)throw Error("Tried to rename a variable that didn't exist. ID: "+e);this.renameVariable(r,t)}renameVariableAndUses(e,t,r){for(ee(new(Ce(fe.VAR_RENAME))(e,t)),e.name=t,t=0;t<r.length;t++)r[t].updateVarName(e)}renameVariableWithConflict(e,t,r,l){const p=e.type;for(t!==r.name&&this.renameVariableAndUses(r,t,l),t=0;t<l.length;t++)l[t].renameVarById(e.getId(),r.getId());ee(new(Ce(fe.VAR_DELETE))(e)),ue(this.variableMap.get(p),e)}createVariable(e,t,r){var l=this.getVariable(e,t);if(l){if(r&&l.getId()!==r)throw Error('Variable "'+e+'" is already in use and its id is "'+l.getId()+'" which conflicts with the passed in id, "'+r+'".');return l}if(r&&this.getVariableById(r))throw Error('Variable id, "'+r+'", is already in use.');return l=r||E(),t=t||"",l=new Uc(this.workspace,e,t,l),e=this.variableMap.get(t)||[],e.push(l),this.variableMap.delete(t),this.variableMap.set(t,e),ee(new(Ce(fe.VAR_CREATE))(l)),l}deleteVariable(e){const t=e.getId(),r=this.variableMap.get(e.type);if(r){for(let l=0;l<r.length;l++)if(r[l].getId()===t){r.splice(l,1),ee(new(Ce(fe.VAR_DELETE))(e)),r.length===0&&this.variableMap.delete(e.type);break}}}deleteVariableById(e){const t=this.getVariableById(e);if(t){var r=t.name;const l=this.getVariableUsesById(e);for(let p=0,v;v=l[p];p++)if(v.type==="procedures_defnoreturn"||v.type==="procedures_defreturn"){e=String(v.getFieldValue("NAME")),r=s.Msg$$module$build$src$core$msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",r).replace("%2",e),Mi(r);return}1<l.length?(r=s.Msg$$module$build$src$core$msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(l.length)).replace("%2",r),Ja(r,p=>{p&&t&&this.deleteVariableInternal(t,l)})):this.deleteVariableInternal(t,l)}else console.warn("Can't delete non-existent variable: "+e)}deleteVariableInternal(e,t){const r=s.getGroup$$module$build$src$core$events$utils();r||s.setGroup$$module$build$src$core$events$utils(!0);try{for(let l=0;l<t.length;l++)t[l].dispose(!0);this.deleteVariable(e)}finally{s.setGroup$$module$build$src$core$events$utils(r)}}getVariable(e,t){if(t=this.variableMap.get(t||"")){for(let r=0,l;l=t[r];r++)if(s.Names$$module$build$src$core$names.equals(l.name,e))return l}return null}getVariableById(e){for(const t of this.variableMap.values())for(const r of t)if(r.getId()===e)return r;return null}getVariablesOfType(e){return(e=this.variableMap.get(e||""))?e.slice():[]}getVariableTypes(e){const t=new Set(this.variableMap.keys());if(e&&e.getPotentialVariableMap())for(const r of e.getPotentialVariableMap().variableMap.keys())t.add(r);return t.has("")||t.add(""),Array.from(t.values())}getAllVariables(){let e=[];for(const t of this.variableMap.values())e=e.concat(t);return e}getAllVariableNames(){return Array.from(this.variableMap.values()).flat().map(e=>e.name)}getVariableUsesById(e){const t=[],r=this.workspace.getAllBlocks(!1);for(let l=0;l<r.length;l++){const p=r[l].getVarModels();if(p)for(let v=0;v<p.length;v++)p[v].getId()===e&&t.push(r[l])}return t}},zl=class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(e){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=!1,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new Nb,this.potentialVariableMap=null,this.id=E(),de(this),this.options=e||new zr({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(w(Be.CONNECTION_CHECKER,this.options,!0))(this),this.variableMap=new Jd(this)}dispose(){this.listeners.length=0,this.clear(),Se(this)}sortObjects(e,t){const r=Math.sin(Ns(zl.SCAN_ANGLE))*(this.RTL?-1:1);return e=e.getRelativeToSurfaceXY(),t=t.getRelativeToSurfaceXY(),e.y+r*e.x-(t.y+r*t.x)}addTopBlock(e){this.topBlocks.push(e)}removeTopBlock(e){if(!ue(this.topBlocks,e))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(e=!1){const t=[].concat(this.topBlocks);return e&&1<t.length&&t.sort(this.sortObjects.bind(this)),t}addTypedBlock(e){this.typedBlocksDB.has(e.type)||this.typedBlocksDB.set(e.type,[]),this.typedBlocksDB.get(e.type).push(e)}removeTypedBlock(e){ue(this.typedBlocksDB.get(e.type),e),this.typedBlocksDB.get(e.type).length||this.typedBlocksDB.delete(e.type)}getBlocksByType(e,t=!1){return this.typedBlocksDB.has(e)?(e=this.typedBlocksDB.get(e).slice(0),t&&e&&1<e.length&&e.sort(this.sortObjects.bind(this)),e.filter(r=>!r.isInsertionMarker())):[]}addTopComment(e){this.topComments.push(e),this.commentDB.has(e.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+e.id+'"'),this.commentDB.set(e.id,e)}removeTopComment(e){if(!ue(this.topComments,e))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(e.id)}getTopComments(e=!1){const t=[].concat(this.topComments);return e&&1<t.length&&t.sort(this.sortObjects.bind(this)),t}getAllBlocks(e=!1){if(e){var t=this.getTopBlocks(!0);e=[];for(let r=0;r<t.length;r++)e.push(...t[r].getDescendants(!0))}else for(e=this.getTopBlocks(!1),t=0;t<e.length;t++)e.push(...e[t].getChildren(!1));return e.filter(r=>!r.isInsertionMarker())}clear(){this.isClearing=!0;try{const e=s.getGroup$$module$build$src$core$events$utils();for(e||s.setGroup$$module$build$src$core$events$utils(!0);this.topBlocks.length;)this.topBlocks[0].dispose(!1);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();s.setGroup$$module$build$src$core$events$utils(e),this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=!1}}renameVariableById(e,t){this.variableMap.renameVariableById(e,t)}createVariable(e,t,r){return this.variableMap.createVariable(e,t,r)}getVariableUsesById(e){return this.variableMap.getVariableUsesById(e)}deleteVariableById(e){this.variableMap.deleteVariableById(e)}getVariable(e,t){return this.variableMap.getVariable(e,t)}getVariableById(e){return this.variableMap.getVariableById(e)}getVariablesOfType(e){return this.variableMap.getVariablesOfType(e)}getVariableTypes(){return this.variableMap.getVariableTypes(this)}getAllVariables(){return this.variableMap.getAllVariables()}getAllVariableNames(){return this.variableMap.getAllVariableNames()}getWidth(){return 0}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(e){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length}remainingCapacityOfType(e){return this.options.maxInstances?(this.options.maxInstances[e]!==void 0?this.options.maxInstances[e]:1/0)-this.getBlocksByType(e,!1).length:1/0}isCapacityAvailable(e){if(!this.hasBlockLimits())return!0;let t=0;for(const r in e){if(e[r]>this.remainingCapacityOfType(r))return!1;t+=e[r]}return!(t>this.remainingCapacity())}hasBlockLimits(){return this.options.maxBlocks!==1/0||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(e){var t=e?this.redoStack_:this.undoStack_,r=e?this.undoStack_:this.redoStack_;const l=t.pop();if(l){for(var p=[l];t.length&&l.group&&l.group===t[t.length-1].group;){const v=t.pop();v&&p.push(v)}for(t=0;t<p.length;t++)r.push(p[t]);s.setRecordUndo$$module$build$src$core$events$utils(!1);try{for(r=0;r<p.length;r++)p[r].run(e)}finally{s.setRecordUndo$$module$build$src$core$events$utils(!0)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,W()}addChangeListener(e){return this.listeners.push(e),e}removeChangeListener(e){ue(this.listeners,e)}fireChangeListener(e){if(e.recordUndo)for(this.undoStack_.push(e),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(let t=0;t<this.listeners.length;t++)(0,this.listeners[t])(e)}getBlockById(e){return this.blockDB.get(e)||null}setBlockById(e,t){this.blockDB.set(e,t)}removeBlockById(e){this.blockDB.delete(e)}getCommentById(e){let t;return(t=this.commentDB.get(e))!=null?t:null}allInputsFilled(e){const t=this.getTopBlocks(!1);for(let r=0;r<t.length;r++)if(!t[r].allInputsFilled(e))return!1;return!0}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new Jd(this)}getVariableMap(){return this.variableMap}setVariableMap(e){this.variableMap=e}getProcedureMap(){return this.procedureMap}getRootWorkspace(){let e=null;const t=this.options.parentWorkspace;return this.isFlyout?t&&t.options&&(e=t.options.parentWorkspace):t&&(e=t),e}static getById(e){return he(e)}static getAll(){return Ae()}};zl.SCAN_ANGLE=3;var uy=100,Hb=class{constructor(e){this.parentWorkspace=e,this.sounds=new Map,this.lastSound=null,this.muted=!1}dispose(){this.sounds.clear()}load(e,t){if(e.length){try{var r=new globalThis.Audio}catch{return}for(let p=0;p<e.length;p++){const v=e[p],O=v.match(/\.(\w+)$/);if(O&&r.canPlayType("audio/"+O[1])){var l=new globalThis.Audio(v);break}}l&&this.sounds.set(t,l)}}preload(){for(const e of this.sounds.values()){e.volume=.01;const t=e.play();if(t!==void 0?t.then(e.pause).catch(function(){}):e.pause(),yd||mi)break}}play(e,t){if(!this.muted){var r=this.sounds.get(e);r?(e=new Date,this.lastSound!==null&&e.getTime()-this.lastSound.getTime()<uy||(this.lastSound=e,r=yd||Qp?r:r.cloneNode(),r.volume=t===void 0?1:t,r.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(e,t)}}setMuted(e){this.muted=e}getMuted(){return this.muted}},dy=20,Cr=class extends zl{constructor(e){super(e),this.resizeHandlerWrapper=null,this.resizesEnabled=this.visible=this.rendered=!0,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.inverseScreenCTM=this.targetWorkspace=this.dummyWheelListener=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=this.currentGesture_=this.toolbox=this.flyout=this.scrollbar=this.trashcan=null,this.inverseScreenCTMDirty=!0,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardAccessibilityMode=!1,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=this.layerManager=null,this.metricsManager=new(w(Be.METRICS_MANAGER,e,!0))(this),this.getMetrics=e.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=e.setMetrics||Cr.setTopLevelWorkspaceMetrics,this.componentManager=new pn,this.connectionDBList=Ll.init(this.connectionChecker),this.audioManager=new Hb(e.parentWorkspace),this.grid=this.options.gridPattern?new eo(this.options.gridPattern,e.gridOptions):null,this.markerManager=new Gc(this),$s&&rc&&this.registerToolboxCategoryCallback(fg,rc),Ba&&_c&&this.registerToolboxCategoryCallback(zg,_c),js&&Xu&&(this.registerToolboxCategoryCallback(Wd,Xu),this.addChangeListener(vc)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new Ub(this,this.options.theme||ei),this.themeManager_.subscribeWorkspace(this);let t;this.renderer=Qu(this.options.renderer||"geras",this.getTheme(),(t=this.options.rendererOverrides)!=null?t:void 0),this.cachedParentSvgSize=new Jt(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(e){this.metricsManager=e,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}setCursorSvg(e){this.markerManager.setCursorSvg(e)}setMarkerSvg(e){this.markerManager.setMarkerSvg(e)}getMarker(e){return this.markerManager?this.markerManager.getMarker(e):null}getCursor(){return this.markerManager?this.markerManager.getCursor():null}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(e){e||(e=ei),this.themeManager_.setTheme(e)}refreshTheme(){this.svgGroup_&&this.renderer.refreshDom(this.svgGroup_,this.getTheme()),this.updateBlockStyles(this.getAllBlocks(!1).filter(t=>!!t.getStyleName())),this.refreshToolboxSelection(),this.toolbox&&this.toolbox.refreshTheme(),this.isVisible()&&this.setVisible(!0);const e=new(Ce(fe.THEME_CHANGE))(this.getTheme().name,this.id);ee(e)}updateBlockStyles(e){for(let t=0,r;r=e[t];t++){const l=r.getStyleName();l&&r.setStyle(l)}}getInverseScreenCTM(){if(this.inverseScreenCTMDirty){const e=this.getParentSvg().getScreenCTM();e&&(this.inverseScreenCTM=e.inverse(),this.inverseScreenCTMDirty=!1)}return this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=!0}isVisible(){return this.visible}getSvgXY(e){let t=0,r=0,l=1;(this.getCanvas().contains(e)||this.getBubbleCanvas().contains(e))&&(l=this.scale);do{const p=xr(e);(e===this.getCanvas()||e===this.getBubbleCanvas())&&(l=1),t+=p.x*l,r+=p.y*l,e=e.parentNode}while(e&&e!==this.getParentSvg()&&e!==this.getInjectionDiv());return new Le(t,r)}getCachedParentSvgSize(){const e=this.cachedParentSvgSize;return new Jt(e.width,e.height)}getOriginOffsetInPixels(){return Ka(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let e=this.svgGroup_;for(;e;){if((" "+(e.getAttribute("class")||"")+" ").includes(" injectionDiv ")){this.injectionDiv=e;break}e=e.parentNode}}return this.injectionDiv}getSvgGroup(){return this.svgGroup_}getBlockCanvas(){return this.getCanvas()}setResizeHandlerWrapper(e){this.resizeHandlerWrapper=e}createDom(e,t){return this.injectionDiv||(this.injectionDiv=t??null),this.svgGroup_=re(oe.G,{class:"blocklyWorkspace"}),e&&(this.svgBackground_=re(oe.RECT,{height:"100%",width:"100%",class:e},this.svgGroup_),e==="blocklyMainBackground"&&this.grid?this.svgBackground_.style.fill="url(#"+this.grid.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.layerManager=new jt(this),this.svgBlockCanvas_=this.layerManager.getBlockLayer(),this.svgBubbleCanvas_=this.layerManager.getBubbleLayer(),this.isFlyout||(Ue(this.svgGroup_,"pointerdown",this,this.onMouseDown,!1),this.dummyWheelListener=()=>{},document.body.addEventListener("wheel",this.dummyWheelListener),Ue(this.svgGroup_,"wheel",this,this.onMouseWheel)),this.options.hasCategories&&(this.toolbox=new(w(Be.TOOLBOX,this.options,!0))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(e=w(Be.CURSOR,this.options))&&this.markerManager.setCursor(new e),this.renderer.createDom(this.svgGroup_,this.getTheme()),this.svgGroup_}dispose(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&mt(this.svgGroup_),this.toolbox&&(this.toolbox.dispose(),this.toolbox=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager&&this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),!this.options.parentWorkspace){const e=this.getParentSvg();e&&e.parentNode&&mt(e.parentNode)}this.resizeHandlerWrapper&&(wt(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null),this.dummyWheelListener&&(document.body.removeEventListener("wheel",this.dummyWheelListener),this.dummyWheelListener=null)}addTrashcan(){this.trashcan=Cr.newTrashcan(this);const e=this.trashcan.createDom();this.svgGroup_.insertBefore(e,this.getCanvas())}static newTrashcan(e){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new og(this);const e=this.zoomControls_.createDom();this.svgGroup_.appendChild(e)}addFlyout(e){const t=new zr({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,move:{scrollbars:!0}});return t.toolboxPosition=this.options.toolboxPosition,this.flyout=this.horizontalLayout?new(w(Be.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(t):new(w(Be.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(t),this.flyout.autoClose=!1,this.flyout.getWorkspace().setVisible(!0),this.flyout.createDom(e)}getFlyout(e){return this.flyout||e?this.flyout:this.toolbox?this.toolbox.getFlyout():null}getToolbox(){return this.toolbox}updateScreenCalculations(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox&&this.toolbox.position(),this.flyout&&this.flyout.position();const e=this.componentManager.getComponents(pn.Capability.POSITIONABLE,!0),t=this.getMetricsManager().getUiMetrics(),r=[];for(let l=0,p;p=e[l];l++){p.position(t,r);const v=p.getBoundingRectangle();v&&r.push(v)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations()}updateScreenCalculationsIfScrolled(){const e=nc();Le.equals(this.lastRecordedPageScroll,e)||(this.lastRecordedPageScroll=e,this.updateScreenCalculations())}getLayerManager(){return this.layerManager}getCanvas(){return this.layerManager.getBlockLayer()}setCachedParentSvgSize(e,t){const r=this.getParentSvg();e!=null&&(this.cachedParentSvgSize.width=e,r.setAttribute("data-cached-width",`${e}`)),t!=null&&(this.cachedParentSvgSize.height=t,r.setAttribute("data-cached-height",`${t}`))}getBubbleCanvas(){return this.layerManager.getBubbleLayer()}getParentSvg(){if(!this.cachedParentSvg){let e=this.svgGroup_;for(;e;){if(e.tagName==="svg"){this.cachedParentSvg=e;break}e=e.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){if(te()){var e=this.scale,t=-this.scrollY,r=-this.scrollX;if(!(e===this.oldScale&&1>Math.abs(t-this.oldTop)&&1>Math.abs(r-this.oldLeft))){var l=new(Ce(fe.VIEWPORT_CHANGE))(t,r,e,this.id,this.oldScale);this.oldScale=e,this.oldTop=t,this.oldLeft=r,ee(l)}}}translate(e,t){let r;(r=this.layerManager)==null||r.translateLayers(new Le(e,t),this.scale);let l;(l=this.grid)==null||l.moveTo(e,t),this.maybeFireViewportChangeEvent()}getWidth(){const e=this.getMetrics();return e?e.viewWidth/this.scale:0}setVisible(e){this.visible=e,this.svgGroup_&&(this.scrollbar&&this.scrollbar.setContainerVisible(e),this.getFlyout()&&this.getFlyout().setContainerVisible(e),this.getParentSvg().style.display=e?"block":"none",this.toolbox&&this.toolbox.setVisible(e),e||this.hideChaff(!0))}render(){const e=this.getAllBlocks(!1);for(let t=e.length-1;0<=t;t--)e[t].queueRender();this.getTopBlocks().flatMap(t=>t.getDescendants(!1)).filter(t=>t.isInsertionMarker()).forEach(t=>t.queueRender()),rs().then(()=>void this.markerManager.updateMarkers())}highlightBlock(e,t){if(t===void 0){for(let r=0,l;l=this.highlightedBlocks[r];r++)l.setHighlighted(!1);this.highlightedBlocks.length=0}(e=e?this.getBlockById(e):null)&&((t=t===void 0||t)?this.highlightedBlocks.includes(e)||this.highlightedBlocks.push(e):ue(this.highlightedBlocks,e),e.setHighlighted(t))}refreshToolboxSelection(){const e=this.isFlyout?this.targetWorkspace:this;e&&!e.currentGesture_&&e.toolbox&&e.toolbox.getFlyout()&&e.toolbox.refreshSelection()}renameVariableById(e,t){super.renameVariableById(e,t),this.refreshToolboxSelection()}deleteVariableById(e){super.deleteVariableById(e),this.refreshToolboxSelection()}createVariable(e,t,r){return e=super.createVariable(e,t,r),this.refreshToolboxSelection(),e}recordDragTargets(){const e=this.componentManager.getComponents(pn.Capability.DRAG_TARGET,!0);this.dragTargetAreas=[];for(let t=0,r;r=e[t];t++){const l=r.getClientRect();l&&this.dragTargetAreas.push({component:r,clientRect:l})}}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(e){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}getDragTarget(e){for(let t=0,r;r=this.dragTargetAreas[t];t++)if(r.clientRect.contains(e.clientX,e.clientY))return r.component;return null}onMouseDown(e){const t=this.getGesture(e);t&&t.handleWsStart(e,this)}startDrag(e,t){aa(this,e,t)}moveDrag(e){return ju(this,e)}isDragging(){return this.currentGesture_!==null&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollHorizontally())}isMovableVertically(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollVertically())}onMouseWheel(e){if(Qi.inProgress())e.preventDefault(),e.stopPropagation();else{var t=this.options.zoomOptions&&this.options.zoomOptions.wheel,r=this.options.moveOptions&&this.options.moveOptions.wheel;if(t||r){var l=ge(e);if(Ac)var p=e.metaKey;t&&(e.ctrlKey||p||!r)?(l=-l.y/50,t=me(e,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(t.x,t.y,l)):(t=this.scrollX-l.x,r=this.scrollY-l.y,e.shiftKey&&!l.x&&(t=this.scrollX-l.y,r=this.scrollY),this.scroll(t,r)),e.preventDefault()}}}getBlocksBoundingBox(){const e=this.getTopBoundedElements();if(!e.length)return new Bt(0,0,0,0);const t=e[0].getBoundingRectangle();for(let l=1;l<e.length;l++){var r=e[l];r.isInsertionMarker&&r.isInsertionMarker()||(r=r.getBoundingRectangle(),r.top<t.top&&(t.top=r.top),r.bottom>t.bottom&&(t.bottom=r.bottom),r.left<t.left&&(t.left=r.left),r.right>t.right&&(t.right=r.right))}return t}cleanUp(){this.setResizesEnabled(!1),s.setGroup$$module$build$src$core$events$utils(!0);var e=this.getTopBlocks(!0),t=e.filter(v=>v.isMovable());const r=e.filter(v=>!v.isMovable()).map(v=>v.getBoundingRectangle());e=function(v){for(const O of r)if(v.intersects(O))return O;return null};var l=0;const p=this.renderer.getConstants().MIN_BLOCK_HEIGHT;for(const v of t){for(t=v.getBoundingRectangle(),v.moveBy(-t.left,l-t.top,["cleanup"]),v.snapToGrid(),t=v.getBoundingRectangle(),l=e(t);l!=null;)l=l.top+l.getHeight()+p,v.moveBy(0,l-t.top,["cleanup"]),v.snapToGrid(),t=v.getBoundingRectangle(),l=e(t);l=v.getRelativeToSurfaceXY().y+v.getHeightWidth().height+p}s.setGroup$$module$build$src$core$events$utils(!1),this.setResizesEnabled(!0)}showContextMenu(e){if(!this.options.readOnly&&!this.isFlyout){var t=zt.registry.getContextMenuOptions(zt.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(t,e),dl(e,t,this.RTL,this)}}updateToolbox(e){if(e=j(e)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(Ee(e)){if(!this.toolbox)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=e,this.toolbox.render(e)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=e,this.flyout.show(e)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(He(this),this.getParentSvg().focus({preventScroll:!0}))}zoom(e,t,r){r=Math.pow(this.options.zoomOptions.scaleSpeed,r);const l=this.scale*r;if(this.scale!==l){l>this.options.zoomOptions.maxScale?r=this.options.zoomOptions.maxScale/this.scale:l<this.options.zoomOptions.minScale&&(r=this.options.zoomOptions.minScale/this.scale);var p=this.getCanvas().getCTM(),v=this.getParentSvg().createSVGPoint();v.x=e,v.y=t,v=v.matrixTransform(p.inverse()),e=v.x,t=v.y,p=p.translate(e*(1-r),t*(1-r)).scale(r),this.scrollX=p.e,this.scrollY=p.f,this.setScale(l)}}zoomCenter(e){var t=this.getMetrics();let r;this.flyout?(r=t.svgWidth?t.svgWidth/2:0,t=t.svgHeight?t.svgHeight/2:0):(r=t.viewWidth/2+t.absoluteLeft,t=t.viewHeight/2+t.absoluteTop),this.zoom(r,t,e)}zoomToFit(){if(this.isMovable()){var e=this.getMetrics(),t=e.viewWidth;e=e.viewHeight;var r=this.getBlocksBoundingBox(),l=2*dy,p=r.right-r.left+l;if(r=r.bottom-r.top+l,p){this.flyout&&(this.horizontalLayout?(e+=this.flyout.getHeight(),r+=this.flyout.getHeight()/this.scale):(t+=this.flyout.getWidth(),p+=this.flyout.getWidth()/this.scale)),t/=p,e/=r,s.disable$$module$build$src$core$events$utils();try{this.setScale(Math.min(t,e)),this.scrollCenter()}finally{s.enable$$module$build$src$core$events$utils()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){Fe(this.getCanvas(),"blocklyCanvasTransitioning"),Fe(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}endCanvasTransition(){pt(this.getCanvas(),"blocklyCanvasTransitioning"),pt(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}scrollCenter(){if(this.isMovable()){var e=this.getMetrics(),t=(e.scrollWidth-e.viewWidth)/2,r=(e.scrollHeight-e.viewHeight)/2;t=-t-e.scrollLeft,r=-r-e.scrollTop,this.scroll(t,r)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(e,t){if(this.isMovable()){var r=e?this.getBlockById(e):null;if(r){e=r.getRelativeToSurfaceXY(),r=t?{height:r.height,width:r.width}:r.getHeightWidth();var l=this.scale;t=(e.x+(this.RTL?-1:1)*r.width/2)*l,e=(e.y+r.height/2)*l,r=this.getMetrics(),this.scroll(-(t-r.viewWidth/2),-(e-r.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(e){this.options.zoomOptions.maxScale&&e>this.options.zoomOptions.maxScale?e=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&e<this.options.zoomOptions.minScale&&(e=this.options.zoomOptions.minScale),this.scale=e,this.hideChaff(!1),(e=this.getFlyout(!1))&&e.isVisible()&&(e.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),e=this.getMetrics(),this.scrollX-=e.absoluteLeft,this.scrollY-=e.absoluteTop,e.viewLeft+=e.absoluteLeft,e.viewTop+=e.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(e):this.scrollbar.resizeContent(e))}getScale(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale}scroll(e,t){this.hideChaff(!0);const r=this.getMetrics();e=Math.min(e,-r.scrollLeft),t=Math.min(t,-r.scrollTop);const l=r.scrollTop+Math.max(0,r.scrollHeight-r.viewHeight);e=Math.max(e,-(r.scrollLeft+Math.max(0,r.scrollWidth-r.viewWidth))),t=Math.max(t,-l),this.scrollX=e,this.scrollY=t,this.scrollbar&&this.scrollbar.set(-(e+r.scrollLeft),-(t+r.scrollTop),!1),e+=r.absoluteLeft,t+=r.absoluteTop,this.translate(e,t)}getBlockById(e){return super.getBlockById(e)}getAllBlocks(e=!1){return super.getAllBlocks(e)}getTopBlocks(e=!1){return super.getTopBlocks(e)}addTopBlock(e){this.addTopBoundedElement(e),super.addTopBlock(e)}removeTopBlock(e){this.removeTopBoundedElement(e),super.removeTopBlock(e)}addTopComment(e){this.addTopBoundedElement(e),super.addTopComment(e)}removeTopComment(e){this.removeTopBoundedElement(e),super.removeTopComment(e)}getRootWorkspace(){return super.getRootWorkspace()}addTopBoundedElement(e){this.topBoundedElements.push(e)}removeTopBoundedElement(e){ue(this.topBoundedElements,e)}getTopBoundedElements(){return[].concat(this.topBoundedElements)}setResizesEnabled(e){const t=!this.resizesEnabled&&e;this.resizesEnabled=e,t&&this.resizeContents()}clear(){this.setResizesEnabled(!1),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(!0)}registerButtonCallback(e,t){if(typeof t!="function")throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(e,t)}getButtonCallback(e){let t;return(t=this.flyoutButtonCallbacks.get(e))!=null?t:null}removeButtonCallback(e){this.flyoutButtonCallbacks.delete(e)}registerToolboxCategoryCallback(e,t){if(typeof t!="function")throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(e,t)}getToolboxCategoryCallback(e){return this.toolboxCategoryCallbacks.get(e)||null}removeToolboxCategoryCallback(e){this.toolboxCategoryCallbacks.delete(e)}getGesture(e){const t=e.type==="pointerdown",r=this.currentGesture_;return r?t&&r.hasStarted()?(console.warn("Tried to start the same gesture twice."),r.cancel(),null):r:t?this.currentGesture_=new Qi(e,this):null}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(e=!1){Li(),gc(this),Jr(),this.hideComponents(e)}hideComponents(e=!1){this.getComponentManager().getComponents(pn.Capability.AUTOHIDEABLE,!0).forEach(t=>t.autoHide(e))}static setTopLevelWorkspaceMetrics(e){const t=this.getMetrics();typeof e.x=="number"&&(this.scrollX=-(t.scrollLeft+(t.scrollWidth-t.viewWidth)*e.x)),typeof e.y=="number"&&(this.scrollY=-(t.scrollTop+(t.scrollHeight-t.viewHeight)*e.y)),this.translate(this.scrollX+t.absoluteLeft,this.scrollY+t.absoluteTop)}},Vg=class extends Es{constructor(e,t,r){super(r),this.type=fe.SELECTED,this.oldElementId=e??void 0,this.newElementId=t??void 0}toJson(){const e=super.toJson();return e.oldElementId=this.oldElementId,e.newElementId=this.newElementId,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Vg),t.oldElementId=e.oldElementId,t.newElementId=e.newElementId,t}};i(Be.EVENT,fe.SELECTED,Vg);var au=class{paste(e,t,r){if(!t.isCapacityAvailable(e.typeCounts))return null;r&&(e.blockState.x=r.x,e.blockState.y=r.y),r=r||new Le(e.blockState.x||0,e.blockState.y||0),s.disable$$module$build$src$core$events$utils();let l;try{l=Ni(e.blockState,t),ed(l,r)}finally{s.enable$$module$build$src$core$events$utils()}return l&&(te()&&!l.isShadow()&&ee(new(Ce(fe.BLOCK_CREATE))(l)),s.setSelected$$module$build$src$core$common(l),l)}};au.TYPE="block",Js(au.TYPE,new au);var qd={};qd.bumpIntoBounds=So,qd.bumpIntoBoundsHandler=_l,qd.bumpTopObjectsIntoBounds=wc;var Vb=class{constructor(e){this.block=e,this.connectionPreviewer=this.connectionCandidate=this.startLoc=this.startChildConn=this.startParentConn=null,this.dragging=!1,this.dragOffset=new Le(0,0),this.inGroup=!1,this.workspace=e.workspace}isMovable(){if(this.block.isShadow()){let e,t;return(t=(e=this.block.getParent())==null?void 0:e.isMovable())!=null?t:!1}return this.block.isOwnMovable()&&!this.block.isDeadOrDying()&&!this.workspace.options.readOnly&&!this.block.isInFlyout}startDrag(e){if(this.block.isShadow())this.startDraggingShadow(e);else{this.dragging=!0,(this.inGroup=!!s.getGroup$$module$build$src$core$events$utils())||s.setGroup$$module$build$src$core$events$utils(!0),this.fireDragStartEvent(),this.startLoc=this.block.getRelativeToSurfaceXY(),this.connectionCandidate=null,this.connectionPreviewer=new(w(Be.CONNECTION_PREVIEWER,this.workspace.options))(this.block),zn(),this.workspace.setResizesEnabled(!1),qr(),e=!!e&&(e.altKey||e.ctrlKey||e.metaKey),this.shouldDisconnect(e)&&this.disconnectBlock(e),this.block.setDragging(!0);var t;(t=this.workspace.getLayerManager())==null||t.moveToDragLayer(this.block)}}startDraggingShadow(e){const t=this.block.getParent();if(!t)throw Error("Tried to drag a shadow block with no parent. Shadow blocks should always have parents.");this.dragOffset=Le.difference(t.getRelativeToSurfaceXY(),this.block.getRelativeToSurfaceXY()),t.startDrag(e)}shouldDisconnect(e){return!!(this.block.getParent()||e&&this.block.nextConnection&&this.block.nextConnection.targetBlock())}disconnectBlock(e){let t,r,l;if(this.startParentConn=(l=(t=this.block.outputConnection)==null?void 0:t.targetConnection)!=null?l:(r=this.block.previousConnection)==null?void 0:r.targetConnection,e){let p;this.startChildConn=(p=this.block.nextConnection)==null?void 0:p.targetConnection}this.block.unplug(e),Vu(this.block)}fireDragStartEvent(){const e=new(Ce(fe.BLOCK_DRAG))(this.block,!0,this.block.getDescendants(!1));ee(e)}fireDragEndEvent(){const e=new(Ce(fe.BLOCK_DRAG))(this.block,!1,this.block.getDescendants(!1));ee(e)}fireMoveEvent(){if(!this.block.isDeadOrDying()){var e=new(Ce(fe.BLOCK_MOVE))(this.block);e.setReason(["drag"]),e.oldCoordinate=this.startLoc,e.recordNew(),ee(e)}}drag(e){if(this.block.isShadow()){let t;(t=this.block.getParent())==null||t.drag(Le.sum(e,this.dragOffset))}else this.block.moveDuringDrag(e),this.updateConnectionPreview(this.block,Le.difference(e,this.startLoc))}updateConnectionPreview(e,t){var r=this.connectionCandidate;const l=this.getConnectionCandidate(e,t);if(l){this.connectionCandidate=t=r&&this.currCandidateIsBetter(r,t,l)?r:l;var{local:p,neighbour:v}=t;t=p.type===Ze.OUTPUT_VALUE||p.type===Ze.PREVIOUS_STATEMENT,r=v.isConnected()&&!v.targetBlock().isInsertionMarker(),t&&r&&!this.orphanCanConnectAtEnd(e,v.targetBlock(),p.type)?this.connectionPreviewer.previewReplacement(p,v,v.targetBlock()):this.connectionPreviewer.previewConnection(p,v)}else this.connectionPreviewer.hidePreview(),this.connectionCandidate=null}orphanCanConnectAtEnd(e,t,r){return!!sn.getConnectionForOrphanedConnection(e,r===Ze.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}currCandidateIsBetter(e,t,r){const{local:l,neighbour:p}=e;e=new Le(l.x,l.y);const v=new Le(p.x,p.y);return t=Le.distance(Le.sum(e,t),v),r.distance>t-s.config$$module$build$src$core$config.currentConnectionPreference}getConnectionCandidate(e,t){e=this.getLocalConnections(e);let r=this.connectionCandidate?s.config$$module$build$src$core$config.connectingSnapRadius:s.config$$module$build$src$core$config.snapRadius,l=null;for(const p of e){const{connection:v,radius:O}=p.closest(r,t);v&&(l={local:p,neighbour:v,distance:O},r=O)}return l}getLocalConnections(e){const t=e.getConnections_(!1),r=e.lastConnectionInStack(!0);return r&&r!==e.nextConnection&&t.push(r),t}endDrag(e){if(this.block.isShadow()){let t;(t=this.block.getParent())==null||t.endDrag(e)}else{if(this.fireDragEndEvent(),this.fireMoveEvent(),Jn(),qr(),this.connectionPreviewer.hidePreview(),!this.block.isDeadOrDying()&&this.dragging){let t;(t=this.workspace.getLayerManager())==null||t.moveOffDragLayer(this.block,Ao),this.block.setDragging(!1)}this.connectionCandidate?(this.applyConnections(this.connectionCandidate),this.disposeStep()):this.block.queueRender().then(()=>this.disposeStep()),this.inGroup||s.setGroup$$module$build$src$core$events$utils(!1)}}disposeStep(){this.block.snapToGrid(),this.connectionPreviewer.dispose(),this.workspace.setResizesEnabled(!0)}applyConnections(e){const{local:t,neighbour:r}=e;t.connect(r);const l=t.isSuperior()?r:t,p=this.block.getRootBlock();rs().then(()=>{_o(l.getSourceBlock()),setTimeout(()=>{p.bringToFront()},0)})}revertDrag(){if(this.block.isShadow()){let t;(t=this.block.getParent())==null||t.revertDrag()}else{var e;if((e=this.startChildConn)==null||e.connect(this.block.nextConnection),this.startParentConn)switch(this.startParentConn.type){case Ze.INPUT_VALUE:this.startParentConn.connect(this.block.outputConnection);break;case Ze.NEXT_STATEMENT:this.startParentConn.connect(this.block.previousConnection)}else{this.block.moveTo(this.startLoc,["drag"]);let t;(t=this.workspace.getLayerManager())==null||t.moveOffDragLayer(this.block,Ao),So(this.workspace,this.workspace.getMetricsManager().getScrollMetrics(!0),this.block)}this.startParentConn=this.startChildConn=null,this.connectionPreviewer.hidePreview(),this.connectionCandidate=null,this.block.setDragging(!1),this.dragging=!1}}},Gb=class{constructor(){this.drawer=this.curNode=this.colour=null,this.type="marker"}setDrawer(e){this.drawer=e}getDrawer(){return this.drawer}getCurNode(){return this.curNode}setCurNode(e){const t=this.curNode;this.curNode=e,this.drawer&&this.drawer.draw(t,this.curNode)}draw(){this.drawer&&this.drawer.draw(this.curNode,this.curNode)}hide(){this.drawer&&this.drawer.hide()}dispose(){this.getDrawer()&&this.getDrawer().dispose()}},Gg=class extends Gb{constructor(){super(),this.type="cursor"}next(){var e=this.getCurNode();if(!e)return null;for(e=e.next();e&&e.next()&&(e.getType()===Oe.types.NEXT||e.getType()===Oe.types.BLOCK);)e=e.next();return e&&this.setCurNode(e),e}in(){var e=this.getCurNode();if(!e)return null;(e.getType()===Oe.types.PREVIOUS||e.getType()===Oe.types.OUTPUT)&&(e=e.next());let t,r;return(e=(r=(t=e)==null?void 0:t.in())!=null?r:null)&&this.setCurNode(e),e}prev(){var e=this.getCurNode();if(!e)return null;for(e=e.prev();e&&e.prev()&&(e.getType()===Oe.types.NEXT||e.getType()===Oe.types.BLOCK);)e=e.prev();return e&&this.setCurNode(e),e}out(){var e=this.getCurNode();return e?((e=e.out())&&e.getType()===Oe.types.BLOCK&&(e=e.prev()||e),e&&this.setCurNode(e),e):null}};i(Be.CURSOR,Nr,Gg);var lu=class extends Gg{constructor(){super()}next(){var e=this.getCurNode();return e?((e=this.getNextNode_(e,this.validNode_))&&this.setCurNode(e),e):null}in(){return this.next()}prev(){var e=this.getCurNode();return e?((e=this.getPreviousNode_(e,this.validNode_))&&this.setCurNode(e),e):null}out(){return this.prev()}getNextNode_(e,t){if(!e)return null;const r=e.in()||e.next();return t(r)?r:r?this.getNextNode_(r,t):(e=this.findSiblingOrParent(e.out()),t(e)?e:e?this.getNextNode_(e,t):null)}getPreviousNode_(e,t){if(!e)return null;let r=e.prev();return r=r?this.getRightMostChild(r):e.out(),t(r)?r:r?this.getPreviousNode_(r,t):null}validNode_(e){let t=!1;return e=e&&e.getType(),(e===Oe.types.OUTPUT||e===Oe.types.INPUT||e===Oe.types.FIELD||e===Oe.types.NEXT||e===Oe.types.PREVIOUS||e===Oe.types.WORKSPACE)&&(t=!0),t}findSiblingOrParent(e){if(!e)return null;const t=e.next();return t||this.findSiblingOrParent(e.out())}getRightMostChild(e){if(!e.in())return e;for(e=e.in();e&&e.next();)e=e.next();return this.getRightMostChild(e)}};lu.registrationName="basicCursor",i(Be.CURSOR,lu.registrationName,lu);var Kb=class extends lu{validNode_(e){let t=!1;const r=e&&e.getType();return e&&(e=e.getLocation(),r===Oe.types.FIELD&&e&&e.isTabNavigable()&&e.isClickable()&&(t=!0)),t}},Jb=10,Fs=class extends sn{constructor(e,t){super(e,t),this.highlighted=!1,this.targetConnection=null,this.db=e.workspace.connectionDBList[t],this.dbOpposite=e.workspace.connectionDBList[ja[t]],this.offsetInBlock=new Le(0,0),this.trackedState=Fs.TrackedState.WILL_TRACK}dispose(){super.dispose(),this.trackedState===Fs.TrackedState.TRACKED&&this.db.removeConnection(this,this.y);let e,t;(t=(e=this.sourceBlock_.pathObject).removeConnectionHighlight)==null||t.call(e,this)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(e){const t=this.x-e.x;return e=this.y-e.y,Math.sqrt(t*t+e*e)}bumpAwayFrom(e,t=!1){if(!this.sourceBlock_.workspace.isDragging()){var r=s.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*Jb),l=s.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*Jb),p=e.sourceBlock_.getRootBlock(),v=this.sourceBlock_.getRootBlock();if(!p.isInFlyout&&!v.isInFlyout){var O=!0;if(v.isMovable())p.isMovable()&&t&&(l=-l);else if(p.isMovable())O=!1,r=-r,l=-l;else return;t=O?e:this,e=O?this:e,p=O?v:p,(v=ne()===p)||p.addSelect(),p.RTL&&(r=-r),p.moveBy(t.x+r-e.x,t.y+l-e.y,["bump"]),v||p.removeSelect()}}}moveTo(e,t){let r=!1;return this.trackedState===Fs.TrackedState.WILL_TRACK?(this.db.addConnection(this,t),this.trackedState=Fs.TrackedState.TRACKED,r=!0):this.trackedState===Fs.TrackedState.TRACKED&&(this.db.removeConnection(this,this.y),this.db.addConnection(this,t),r=!0),this.x=e,this.y=t,r}moveBy(e,t){return this.moveTo(this.x+e,this.y+t)}moveToOffset(e){return this.moveTo(e.x+this.offsetInBlock.x,e.y+this.offsetInBlock.y)}setOffsetInBlock(e,t){this.offsetInBlock.x=e,this.offsetInBlock.y=t}getOffsetInBlock(){return this.offsetInBlock}tightenEfficiently(){var e=this.targetConnection;const t=this.targetBlock();e&&t&&(e=Le.difference(this.offsetInBlock,e.offsetInBlock),t.translate(e.x,e.y))}closest(e,t){return this.dbOpposite.searchForClosest(this,e,t)}highlight(){this.highlighted=!0,this.getSourceBlock().queueRender()}unhighlight(){this.highlighted=!1,this.getSourceBlock().queueRender()}isHighlighted(){return this.highlighted}setTracking(e){e&&this.trackedState===Fs.TrackedState.TRACKED||!e&&this.trackedState===Fs.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(e?(this.db.addConnection(this,this.y),this.trackedState=Fs.TrackedState.TRACKED):(this.trackedState===Fs.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.trackedState=Fs.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(!1),this.targetConnection){const e=this.targetBlock().getDescendants(!1);for(let t=0;t<e.length;t++){const r=e[t],l=r.getConnections_(!0);for(let p=0;p<l.length;p++)l[p].setTracking(!1);for(const p of r.getIcons())Ya(p)&&p.setBubbleVisible(!1)}}}startTrackingAll(){this.setTracking(!0);let e=[];if(this.type!==Ze.INPUT_VALUE&&this.type!==Ze.NEXT_STATEMENT)return e;const t=this.targetBlock();if(t){let r;t.isCollapsed()?(r=[],t.outputConnection&&r.push(t.outputConnection),t.nextConnection&&r.push(t.nextConnection),t.previousConnection&&r.push(t.previousConnection)):r=t.getConnections_(!0);for(let l=0;l<r.length;l++)e.push(...r[l].startTrackingAll());e.length||(e=[t])}return e}onFailedConnect(e){const t=this.getSourceBlock();if(se()){const r=s.getGroup$$module$build$src$core$events$utils();setTimeout(function(){t.isDisposed()||t.getParent()||(s.setGroup$$module$build$src$core$events$utils(r),this.bumpAwayFrom(e),s.setGroup$$module$build$src$core$events$utils(!1))}.bind(this),s.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal(e=!0){const{parentConnection:t,childConnection:r}=this.getParentAndChildConnections();if(t&&r){var l=s.getGroup$$module$build$src$core$events$utils();l||s.setGroup$$module$build$src$core$events$utils(!0);var p=t.getSourceBlock(),v=r.getSourceBlock();super.disconnectInternal(e),p.queueRender(),v.updateDisabled(),v.queueRender(),v.getSvgRoot().style.display="block",s.setGroup$$module$build$src$core$events$utils(l)}}respawnShadow_(){super.respawnShadow_();const e=this.targetBlock();e&&(e.initSvg(),e.queueRender())}neighbours(e){return this.dbOpposite.getNeighbours(this,e)}connect_(e){super.connect_(e);var t=this.getSourceBlock();e=e.getSourceBlock(),t.updateDisabled(),e.updateDisabled(),e.queueRender();var r=ne();(r=r===t&&t||r===e&&e)&&(r.removeSelect(),r.addSelect()),(t=t.getInputWithBlock(e))&&(t=t.isVisible(),e.getSvgRoot().style.display=t?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return super.setCheck(e),this.sourceBlock_.queueRender(),this}};(function(e){e=e.TrackedState||(e.TrackedState={}),e[e.WILL_TRACK=-1]="WILL_TRACK",e[e.UNTRACKED=0]="UNTRACKED",e[e.TRACKED=1]="TRACKED"})(Fs||(Fs={})),Fs.TrackedState;var Ur=class extends Lo{constructor(e,t,r){if(super(e,t,r),this.childlessWidth=this.width=this.height=0,this.warningTextDb=new Map,this.mutator=null,this.rendered=!0,this.visuallyDisabled=!1,this.translation="",this.dragging=!1,this.relativeCoords=new Le(0,0),this.dragStrategy=new Vb(this),!e.rendered)throw TypeError("Cannot create a rendered block in a headless workspace");this.workspace=e,this.svgGroup=re(oe.G,{}),this.style=e.getRenderer().getConstants().getBlockStyle(null),this.pathObject=e.getRenderer().makePathObject(this.svgGroup,this.style),e=this.pathObject.svgPath,e.tooltip=this,rl(e),this.svgGroup.setAttribute("data-id",this.id),this.doInit_()}initSvg(){if(!this.initialized){for(var e of this.inputList)e.init();for(const t of this.getIcons())t.initView(this.createIconPointerDownListener(t)),t.updateEditable();this.applyColour(),this.pathObject.updateMovable(this.isMovable()||this.isInFlyout),e=this.getSvgRoot(),!this.workspace.options.readOnly&&e&&Ue(e,"pointerdown",this,this.onMouseDown),e.parentNode||this.workspace.getCanvas().appendChild(e),this.initialized=!0}}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){if(this.isShadow()){let e;(e=this.getParent())==null||e.select()}else this.addSelect()}unselect(){if(this.isShadow()){let e;(e=this.getParent())==null||e.unselect()}else this.removeSelect()}setParent(e){const t=this.parentBlock_;if(e!==t){zn(),super.setParent(e),Jn();var r=this.getSvgRoot();if(!this.workspace.isClearing&&r){var l=this.getRelativeToSurfaceXY();e?e.getSvgRoot().appendChild(r):t&&((e=this.workspace.getCanvas().querySelector(".blocklyDragging"))?this.workspace.getCanvas().insertBefore(r,e):this.workspace.getCanvas().appendChild(r),this.translate(l.x,l.y)),this.applyColour()}}}getRelativeToSurfaceXY(){const e=this.workspace.getLayerManager();if(!e)throw Error("Cannot calculate position because the workspace has not been appended");let t=0,r=0,l=this.getSvgRoot();if(l)do{const p=xr(l);t+=p.x,r+=p.y,l=l.parentNode}while(l&&!e.hasLayer(l));return new Le(t,r)}moveBy(e,t,r){if(this.parentBlock_)throw Error("Block has parent");const l=te();let p=null;l&&(p=new(Ce(fe.BLOCK_MOVE))(this),r&&p.setReason(r)),e=new Le(e,t),t=this.getRelativeToSurfaceXY(),e=Le.sum(t,e),this.translate(e.x,e.y),this.updateComponentLocations(e),l&&p&&(p.recordNew(),ee(p)),this.workspace.resizeContents()}translate(e,t){this.translation=`translate(${e}, ${t})`,this.relativeCoords=new Le(e,t),this.getSvgRoot().setAttribute("transform",this.getTranslation())}getTranslation(){return this.translation}moveTo(e,t){const r=this.getRelativeToSurfaceXY();this.moveBy(e.x-r.x,e.y-r.y,t)}moveDuringDrag(e){this.translate(e.x,e.y),this.getSvgRoot().setAttribute("transform",this.getTranslation()),this.updateComponentLocations(e)}snapToGrid(){if(!this.isDeadOrDying()&&!this.getParent()&&!this.isInFlyout){var e=this.workspace.getGrid();if(e!=null&&e.shouldSnap()){var t=this.getRelativeToSurfaceXY();e=e.alignXY(t),e!==t&&this.moveTo(e,["snap"])}}}getBoundingRectangle(){return this.getBoundingRectangleWithDimensions(this.getHeightWidth())}getBoundingRectangleWithoutChildren(){return this.getBoundingRectangleWithDimensions({height:this.height,width:this.childlessWidth})}getBoundingRectangleWithDimensions(e){const t=this.getRelativeToSurfaceXY();let r,l;return this.RTL?(r=t.x-e.width,l=t.x):(r=t.x,l=t.x+e.width),new Bt(t.y,t.y+e.height,r,l)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let e=0,t;t=this.inputList[e];e++)t.markDirty()}setCollapsed(e){this.collapsed_!==e&&(super.setCollapsed(e),this.updateCollapsed())}updateCollapsed(){var e=this.isCollapsed();const t=jc,r=Dd;for(let p=0,v;v=this.inputList[p];p++)v.name!==t&&v.setVisible(!e);for(var l of this.getIcons())l.updateCollapsed();e?(e=this.toString(Pa),(l=this.getField(r))?l.setValue(e):(this.getInput(t)||this.appendDummyInput(t)).appendField(new La(e),r)):(this.updateDisabled(),this.removeInput(t))}tab(e,t){const r=new Kb;r.setCurNode(Oe.createFieldNode(e)),e=r.getCurNode(),t?r.next():r.prev(),(t=r.getCurNode())&&t!==e&&(t.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(t))}onMouseDown(e){const t=this.workspace.getGesture(e);t&&t.handleBlockStart(e,this)}showHelp(){const e=typeof this.helpUrl=="function"?this.helpUrl():this.helpUrl;e&&window.open(e)}generateContextMenu(){if(this.workspace.options.readOnly||!this.contextMenu)return null;const e=zt.registry.getContextMenuOptions(zt.ScopeType.BLOCK,{block:this});return this.customContextMenu&&this.customContextMenu(e),e}showContextMenu(e){const t=this.generateContextMenu();t&&t.length&&(dl(e,t,this.RTL,this.workspace),ul(this))}updateComponentLocations(e){this.dragging||this.updateConnectionLocations(e),this.updateIconLocations(e),this.updateFieldLocations(e);for(const t of this.getChildren(!1))t.updateComponentLocations(Le.sum(e,t.relativeCoords))}updateConnectionLocations(e){for(const t of this.getConnections_(!1))t.moveToOffset(e)}updateIconLocations(e){for(const t of this.getIcons())t.onLocationChange(e)}updateFieldLocations(e){for(const t of this.inputList)for(const r of t.fieldRow)r.onLocationChange(e)}setDragging(e){(this.dragging=e)?(this.translation="",Sl.push(...this.getConnections_(!0)),Fe(this.svgGroup,"blocklyDragging")):(Sl.length=0,pt(this.svgGroup,"blocklyDragging"));for(let t=0;t<this.childBlocks_.length;t++)this.childBlocks_[t].setDragging(e)}setMovable(e){super.setMovable(e),this.pathObject.updateMovable(e)}setEditable(e){super.setEditable(e),e=this.getIcons();for(let t=0;t<e.length;t++)e[t].updateEditable()}setShadow(e){super.setShadow(e),this.applyColour()}setInsertionMarker(e){this.isInsertionMarker_!==e&&(this.isInsertionMarker_=e)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))}getSvgRoot(){return this.svgGroup}dispose(e,t){if(this.disposing=!0,il(),hl(),t&&(this.unplug(e),Hu(this)),t=ne(),t instanceof Lo){let r=t;for(;r!==null;)r===this&&t.unselect(),r=r.getParent()}super.dispose(!!e),mt(this.svgGroup)}disposeInternal(){this.disposing=!0,super.disposeInternal(),ne()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),[...this.warningTextDb.values()].forEach(e=>clearTimeout(e)),this.warningTextDb.clear(),this.getIcons().forEach(e=>e.dispose())}checkAndDelete(){this.workspace.isFlyout||(s.setGroup$$module$build$src$core$events$utils(!0),this.workspace.hideChaff(),this.outputConnection?this.dispose(!1,!0):this.dispose(!0,!0),s.setGroup$$module$build$src$core$events$utils(!1))}toCopyData(){return this.isInsertionMarker_?null:{paster:au.TYPE,blockState:Qt(this,{addCoordinates:!0,addNextBlocks:!1}),typeCounts:rt(this,!0)}}applyColour(){this.pathObject.applyColour(this);const e=this.getIcons();for(let t=0;t<e.length;t++)e[t].applyColour();for(let t=0,r;r=this.inputList[t];t++)for(let l=0,p;p=r.fieldRow[l];l++)p.applyColour()}updateDisabled(){const e=!this.isEnabled()||this.getInheritedDisabled();if(this.visuallyDisabled===e){let t;(t=this.getNextBlock())==null||t.updateDisabled()}else{this.applyColour(),this.visuallyDisabled=e;for(const t of this.getChildren(!1))t.updateDisabled()}}setWarningText(e,t=""){if(t)this.warningTextDb.has(t)&&(clearTimeout(this.warningTextDb.get(t)),this.warningTextDb.delete(t));else{for(var r of this.warningTextDb.values())clearTimeout(r);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(t,setTimeout(()=>{this.isDeadOrDying()||(this.warningTextDb.delete(t),this.setWarningText(e,t))},100));else if(this.isInFlyout&&(e=null),r=this.getIcon(so.TYPE),e){let l=this.getSurroundParent(),p=null;for(;l;)l.isCollapsed()&&(p=l),l=l.getSurroundParent();p&&p.setWarningText(s.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,Ur.COLLAPSED_WARNING_ID),r?r.addMessage(e,t):this.addIcon(new so(this).addMessage(e,t))}else r&&(t?(r.addMessage("",t),r.getText()||this.removeIcon(so.TYPE)):this.removeIcon(so.TYPE))}setMutator(e){this.removeIcon(s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE),e&&this.addIcon(e)}addIcon(e){return super.addIcon(e),e instanceof s.MutatorIcon$$module$build$src$core$icons$mutator_icon&&(this.mutator=e),e.initView(this.createIconPointerDownListener(e)),e.applyColour(),e.updateEditable(),this.queueRender(),e}createIconPointerDownListener(e){return t=>{this.isDeadOrDying()||(t=this.workspace.getGesture(t))&&t.setStartIcon(e)}}removeIcon(e){const t=super.removeIcon(e);return e.equals(s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE)&&(this.mutator=null),this.queueRender(),t}setEnabled(e){T("setEnabled","v11","v12","the setDisabledReason method of BlockSvg");const t=this.isEnabled();super.setEnabled(e),this.isEnabled()===t||this.getInheritedDisabled()||this.updateDisabled()}setDisabledReason(e,t){const r=this.isEnabled();super.setDisabledReason(e,t),this.isEnabled()===r||this.getInheritedDisabled()||this.updateDisabled()}setHighlighted(e){this.pathObject.updateHighlighted(e)}addSelect(){this.pathObject.updateSelected(!0)}removeSelect(){this.pathObject.updateSelected(!1)}setDeleteStyle(e){this.pathObject.updateDraggingDelete(e)}getColour(){return this.style.colourPrimary}setColour(e){super.setColour(e),e=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),this.pathObject.setStyle(e.style),this.style=e.style,this.styleName_=e.name,this.applyColour()}setStyle(e){const t=this.workspace.getRenderer().getConstants().getBlockStyle(e);if(this.styleName_=e,t)this.hat=t.hat,this.pathObject.setStyle(t),this.colour_=t.colourPrimary,this.style=t,this.applyColour();else throw Error("Invalid style name: "+e)}getStyle(){return this.style}bringToFront(e=!1){let t=this;if(!t.isDeadOrDying())do{const r=t.getSvgRoot(),l=r.parentNode,p=l.childNodes;if(p[p.length-1]!==r&&l.appendChild(r),e)break;t=t.getParent()}while(t)}setPreviousStatement(e,t){super.setPreviousStatement(e,t),this.queueRender()}setNextStatement(e,t){super.setNextStatement(e,t),this.queueRender()}setOutput(e,t){super.setOutput(e,t),this.queueRender()}setInputsInline(e){super.setInputsInline(e),this.queueRender()}removeInput(e,t){return e=super.removeInput(e,t),this.queueRender(),e}moveNumberedInputBefore(e,t){super.moveNumberedInputBefore(e,t),this.queueRender()}appendInput(e){return super.appendInput(e),this.queueRender(),e}setConnectionTracking(e){if(this.previousConnection&&this.previousConnection.setTracking(e),this.outputConnection&&this.outputConnection.setTracking(e),this.nextConnection){this.nextConnection.setTracking(e);var t=this.nextConnection.targetBlock();t&&t.setConnectionTracking(e)}if(!this.collapsed_)for(t=0;t<this.inputList.length;t++){var r=this.inputList[t].connection;r&&(r.setTracking(e),(r=r.targetBlock())&&r.setConnectionTracking(e))}}getConnections_(e){const t=[];if(this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection),e||!this.collapsed_)for(let r=0,l;l=this.inputList[r];r++)l.connection&&t.push(l.connection);return t}lastConnectionInStack(e){return super.lastConnectionInStack(e)}getMatchingConnection(e,t){return super.getMatchingConnection(e,t)}makeConnection_(e){return new Fs(this,e)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){const e=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||e.isInFlyout))for(const t of this.getConnections_(!1)){if(t.isSuperior()){let r;(r=t.targetBlock())==null||r.bumpNeighbours()}for(const r of t.neighbours(s.config$$module$build$src$core$config.snapRadius))r.getSourceBlock().getRootBlock()!==e&&(t.isConnected()&&r.isConnected()||(t.isSuperior()?r.bumpAwayFrom(t,!1):t.bumpAwayFrom(r,!0)))}}scheduleSnapAndBump(){this.snapToGrid(),this.bumpNeighbours()}positionNearConnection(e,t,r){if(e.type===Ze.NEXT_STATEMENT||e.type===Ze.INPUT_VALUE){let l=t.x;t=t.y,l+=r.x-e.getOffsetInBlock().x,t+=r.y-e.getOffsetInBlock().y,this.moveBy(l,t)}}getChildren(e){return super.getChildren(e)}queueRender(){return Oi(this)}render(){this.queueRender(),Ms()}renderEfficiently(){zn(),this.isCollapsed()&&this.updateCollapsed(),this.isEnabled()||this.updateDisabled(),this.workspace.getRenderer().render(this),this.tightenChildrenEfficiently(),Jn(),this.updateMarkers_()}tightenChildrenEfficiently(){for(const e of this.inputList){const t=e.connection;t&&t.tightenEfficiently()}this.nextConnection&&this.nextConnection.tightenEfficiently()}updateMarkers_(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw(),this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(Gc.LOCAL_MARKER).draw();for(const e of this.inputList)for(const t of e.fieldRow)t.updateMarkers_()}setCursorSvg(e){this.pathObject.setCursorSvg(e)}setMarkerSvg(e){this.pathObject.setMarkerSvg(e)}getHeightWidth(){let e=this.height,t=this.width;var r=this.getNextBlock();if(r){r=r.getHeightWidth();const l=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;e+=r.height-l,t=Math.max(t,r.width)}return{height:e,width:t}}fadeForReplacement(e){this.pathObject.updateReplacementFade(e)}highlightShapeForInput(e,t){this.pathObject.updateShapeForInputHighlight(e,t)}setDragStrategy(e){this.dragStrategy=e}isMovable(){return this.dragStrategy.isMovable()}startDrag(e){this.dragStrategy.startDrag(e)}drag(e,t){this.dragStrategy.drag(e,t)}endDrag(e){this.dragStrategy.endDrag(e)}revertDrag(){this.dragStrategy.revertDrag()}toFlyoutInfo(){const e=Object.assign({},{kind:"BLOCK"},Qt(this)),t=new Set(["id","height","width","pinned","enabled"]),r=function(l){for(const p in l)t.has(p)?delete l[p]:typeof l[p]=="object"&&r(l[p])};return r(e),[e]}};Ur.INLINE=-1,Ur.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_";var qb=class{constructor(){}onDragEnter(e){}onDragOver(e){}onDragExit(e){}onDrop(e){}getClientRect(){return null}shouldPreventMove(e){return!1}},Yd=class extends qb{constructor(){super(),this.wouldDelete_=!1}wouldDelete(e){return e instanceof Ur?(e=!e.getParent()&&e.isDeletable(),this.updateWouldDelete_(e)):this.updateWouldDelete_(Dn(e)&&e.isDeletable()),this.wouldDelete_}updateWouldDelete_(e){this.wouldDelete_=e}},Kg=class extends Es{constructor(e,t){super(t),this.type=fe.TRASHCAN_OPEN,this.isOpen=e}toJson(){const e=super.toJson();if(this.isOpen===void 0)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Kg),t.isOpen=e.isOpen,t}};i(Be.EVENT,fe.TRASHCAN_OPEN,Kg);var Yb=class extends Yd{constructor(e){super(),this.workspace=e,this.id="trashcan",this.contents=[],this.flyout=null,this.isLidOpen=!1,this.minOpenness=0,this.lidTask=this.svgLid=this.svgGroup=null,this.top=this.left=this.lidOpen=0,this.initialized=!1,0>=this.workspace.options.maxTrashcanContents||(e=new zr({scrollbars:!0,parentWorkspace:this.workspace,rtl:this.workspace.RTL,oneBasedIndex:this.workspace.options.oneBasedIndex,renderer:this.workspace.options.renderer,rendererOverrides:this.workspace.options.rendererOverrides,move:{scrollbars:!0}}),this.workspace.horizontalLayout?(e.toolboxPosition=this.workspace.toolboxPosition===Rt.TOP?Rt.BOTTOM:Rt.TOP,this.flyout=new(w(Be.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,!0))(e)):(e.toolboxPosition=this.workspace.toolboxPosition===Rt.RIGHT?Rt.LEFT:Rt.RIGHT,this.flyout=new(w(Be.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,!0))(e)),this.workspace.addChangeListener(this.onDelete.bind(this)))}createDom(){this.svgGroup=re(oe.G,{class:"blocklyTrash"});let e;const t=String(Math.random()).substring(2);e=re(oe.CLIPPATH,{id:"blocklyTrashBodyClipPath"+t},this.svgGroup),re(oe.RECT,{width:Ul,height:Xd,y:Wl},e);const r=re(oe.IMAGE,{width:Ls.width,x:-Zd,height:Ls.height,y:-Qd,"clip-path":"url(#blocklyTrashBodyClipPath"+t+")"},this.svgGroup);return r.setAttributeNS(nr,"xlink:href",this.workspace.options.pathToMedia+Ls.url),e=re(oe.CLIPPATH,{id:"blocklyTrashLidClipPath"+t},this.svgGroup),re(oe.RECT,{width:Ul,height:Wl},e),this.svgLid=re(oe.IMAGE,{width:Ls.width,x:-Zd,height:Ls.height,y:-Qd,"clip-path":"url(#blocklyTrashLidClipPath"+t+")"},this.svgGroup),this.svgLid.setAttributeNS(nr,"xlink:href",this.workspace.options.pathToMedia+Ls.url),Nt(this.svgGroup,"pointerdown",this,this.blockMouseDownWhenOpenable),Nt(this.svgGroup,"pointerup",this,this.click),Nt(r,"pointerover",this,this.mouseOver),Nt(r,"pointerout",this,this.mouseOut),this.animateLid(),this.svgGroup}init(){0<this.workspace.options.maxTrashcanContents&&(Cn(this.flyout.createDom(oe.SVG),this.workspace.getParentSvg()),this.flyout.init(this.workspace)),this.workspace.getComponentManager().addComponent({component:this,weight:pn.ComponentWeight.TRASHCAN_WEIGHT,capabilities:[pn.Capability.AUTOHIDEABLE,pn.Capability.DELETE_AREA,pn.Capability.DRAG_TARGET,pn.Capability.POSITIONABLE]}),this.initialized=!0,this.setLidOpen(!1)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup&&mt(this.svgGroup),this.lidTask&&clearTimeout(this.lidTask)}hasContents(){return!!this.contents.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){if(!this.contentsIsOpen()){var e=this.contents.map(function(r){return JSON.parse(r)}),t=this.workspace.getParentSvg().style;t.cursor="wait",setTimeout(()=>{let r;(r=this.flyout)==null||r.show(e),t.cursor="";let l;(l=this.workspace.scrollbar)==null||l.setVisible(!1)},10),this.fireUiEvent(!0)}}closeFlyout(){if(this.contentsIsOpen()){var e;(e=this.flyout)==null||e.hide();var t;(t=this.workspace.scrollbar)==null||t.setVisible(!0),this.fireUiEvent(!1),this.workspace.recordDragTargets()}}autoHide(e){!e&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents()&&(this.contents.length=0,this.setMinOpenness(0),this.closeFlyout())}position(e,t){if(this.initialized){var r=Lt(this.workspace,e);e=on(r,new Jt(Ul,Xd+Wl),hy,Xb,e,this.workspace),t=an(e,Xb,r.vertical===Br.TOP?bs.DOWN:bs.UP,t),this.top=t.top,this.left=t.left;var l;(l=this.svgGroup)==null||l.setAttribute("transform","translate("+this.left+","+this.top+")");var p;(p=this.flyout)==null||p.position()}}getBoundingRectangle(){return new Bt(this.top,this.top+Xd+Wl,this.left,this.left+Ul)}getClientRect(){if(!this.svgGroup)return null;var e=this.svgGroup.getBoundingClientRect();const t=e.top+Qd-Hl;return e=e.left+Zd-Hl,new Bt(t,t+Wl+Xd+2*Hl,e,e+Ul+2*Hl)}onDragOver(e){this.setLidOpen(this.wouldDelete_)}onDragExit(e){this.setLidOpen(!1)}onDrop(e){setTimeout(this.setLidOpen.bind(this,!1),100)}setLidOpen(e){this.isLidOpen!==e&&(this.lidTask&&clearTimeout(this.lidTask),this.isLidOpen=e,this.animateLid())}animateLid(){const e=fy;var t=1/(e+1);this.lidOpen+=this.isLidOpen?t:-t,this.lidOpen=Math.min(Math.max(this.lidOpen,this.minOpenness),1),this.setLidAngle(this.lidOpen*Zb),t=eh+this.lidOpen*(my-eh),this.svgGroup&&(this.svgGroup.style.opacity=`${t}`),this.lidOpen>this.minOpenness&&1>this.lidOpen&&(this.lidTask=setTimeout(this.animateLid.bind(this),gy/e))}setLidAngle(e){const t=this.workspace.toolboxPosition===Rt.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;let r;(r=this.svgLid)==null||r.setAttribute("transform","rotate("+(t?-e:e)+","+(t?4:Ul-4)+","+(Wl-2)+")")}setMinOpenness(e){this.minOpenness=e,this.isLidOpen||this.setLidAngle(e*Zb)}closeLid(){this.setLidOpen(!1)}click(){this.hasContents()&&!this.workspace.isDragging()&&this.openFlyout()}fireUiEvent(e){e=new(Ce(fe.TRASHCAN_OPEN))(e,this.workspace.id),ee(e)}blockMouseDownWhenOpenable(e){!this.contentsIsOpen()&&this.hasContents()&&e.stopPropagation()}mouseOver(){this.hasContents()&&this.setLidOpen(!0)}mouseOut(){this.setLidOpen(!1)}onDelete(e){if(!(0>=this.workspace.options.maxTrashcanContents||!A(e)||e.wasShadow)){if(!e.oldJson)throw Error("Encountered a delete event without proper oldJson");if(e=JSON.stringify(this.cleanBlockJson(e.oldJson)),!this.contents.includes(e)){for(this.contents.unshift(e);this.contents.length>this.workspace.options.maxTrashcanContents;)this.contents.pop();this.setMinOpenness(py)}}}cleanBlockJson(e){function t(r){if(r){if(delete r.id,delete r.x,delete r.y,delete r.enabled,delete r.disabledReasons,r.icons&&r.icons.comment){var l=r.icons.comment;delete l.height,delete l.width,delete l.pinned}l=r.inputs;for(var p in l){var v=l[p];const O=v.block;v=v.shadow,O&&t(O),v&&t(v)}r.next&&(p=r.next,r=p.block,p=p.shadow,r&&t(r),p&&t(p))}}return e=JSON.parse(JSON.stringify(e)),t(e),Object.assign({},{kind:"BLOCK"},e)}},Ul=47,Xd=44,Wl=16,Xb=20,hy=20,Hl=10,Zd=0,Qd=32,py=.1,gy=80,fy=4,eh=.4,my=.8,Zb=45,un=class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(e,t){if(this.shortcuts.get(e.name)&&!t)throw Error(`Shortcut named "${e.name}" already exists.`);if(this.shortcuts.set(e.name,e),t=e.keyCodes,t!=null&&t.length)for(const r of t)this.addKeyMapping(r,e.name,!!e.allowCollision)}unregister(e){return this.shortcuts.get(e)?(this.removeAllKeyMappings(e),this.shortcuts.delete(e),!0):(console.warn(`Keyboard shortcut named "${e}" not found.`),!1)}addKeyMapping(e,t,r){e=`${e}`;const l=this.keyMap.get(e);if(l&&!r)throw Error(`Shortcut named "${t}" collides with shortcuts "${l}"`);l&&r?l.unshift(t):this.keyMap.set(e,[t])}removeKeyMapping(e,t,r){const l=this.keyMap.get(e);if(!l)return r||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),!1;const p=l.indexOf(t);return-1<p?(l.splice(p,1),l.length===0&&this.keyMap.delete(e),!0):(r||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),!1)}removeAllKeyMappings(e){for(const t of this.keyMap.keys())this.removeKeyMapping(t,e,!0)}setKeyMap(e){this.keyMap.clear();for(const t in e)this.keyMap.set(t,e[t])}getKeyMap(){const e=Object.create(null);for(const[t,r]of this.keyMap)e[t]=r;return e}getRegistry(){const e=Object.create(null);for(const[t,r]of this.shortcuts)e[t]=r;return Zn(Object.create(null),e)}onKeyDown(e,t){var r=this.serializeKeyEvent(t);if(r=this.getShortcutNamesByKeyCode(r),!r)return!1;for(const l of r){if(r=this.shortcuts.get(l),!r||r.preconditionFn&&!r.preconditionFn(e))continue;let p,v;if((v=(p=r).callback)!=null&&v.call(p,e,t,r))return!0}return!1}getShortcutNamesByKeyCode(e){return this.keyMap.get(e)||[]}getKeyCodesByShortcutName(e){const t=[];for(const[r,l]of this.keyMap)-1<l.indexOf(e)&&t.push(r);return t}serializeKeyEvent(e){let t="";for(const r in un.modifierKeys)e.getModifierState(r)&&(t!==""&&(t+="+"),t+=r);return t!==""&&e.keyCode?t+="+"+e.keyCode:e.keyCode&&(t=String(e.keyCode)),t}checkModifiers(e){for(const t of e)if(!(t in un.modifierKeys))throw Error(t+" is not a valid modifier key.")}createSerializedKey(e,t){let r="";if(t){this.checkModifiers(t);for(const l in un.modifierKeys)t.includes(un.modifierKeys[l])&&(r!==""&&(r+="+"),r+=l)}return r!==""&&e?r+="+"+e:e&&(r=`${e}`),r}};un.registry=new un,function(e){e=e.modifierKeys||(e.modifierKeys={}),e[e.Shift=16]="Shift",e[e.Control=17]="Control",e[e.Alt=18]="Alt",e[e.Meta=91]="Meta"}(un||(un={}));var Ds=null,cu=null,by={duplicateInternal:Pm,copyInternal:td},uu={};uu.BlockPaster=au,uu.TEST_ONLY=by,uu.paste=ko,uu.registry=lg;var _i;(function(e){e.ESCAPE="escape",e.DELETE="delete",e.COPY="copy",e.CUT="cut",e.PASTE="paste",e.UNDO="undo",e.REDO="redo"})(_i||(_i={}));var Bo=null,wi=null,Vl=null;Ip();var Wr={};Wr.names=_i,Wr.registerCopy=nd,Wr.registerCut=Tp,Wr.registerDefaultShortcuts=Ip,Wr.registerDelete=ha,Wr.registerEscape=Sp,Wr.registerPaste=kp,Wr.registerRedo=Ep,Wr.registerUndo=pa;var $y=class{constructor(e,t){this.procedureModelClass=e,this.parameterModelClass=t,this.priority=tb}save(e){return e=e.getProcedureMap().getProcedures().map(t=>Cc(t)),e.length?e:null}load(e,t){const r=t.getProcedureMap();for(const l of e)r.add(sd(this.procedureModelClass,this.parameterModelClass,l,t))}clear(e){e.getProcedureMap().clear()}},th={};th.ProcedureSerializer=$y,th.loadProcedure=sd,th.saveProcedure=Cc;var Qb=class{constructor(){this.priority=eb}save(e){const t=[];for(const r of e.getAllVariables())e={name:r.name,id:r.getId()},r.type&&(e.type=r.type),t.push(e);return t.length?t:null}load(e,t){for(const r of e)t.createVariable(r.name,r.type,r.id)}clear(e){e.getVariableMap().clear()}};_n("variables",new Qb);var e$={};e$.VariableSerializer=Qb;var nh={};nh.load=Fm,nh.save=jm;var vy={blocks:Hc,exceptions:Ca,priorities:sy,procedures:th,registry:ag,variables:e$,workspaceComments:Ed,workspaces:nh},Jg=class{constructor(e,t,r,l,p){this.workspace=e,this.oldHostMetrics=this.corner_=this.vScroll=this.hScroll=null,t=t===void 0?!0:t,r=r===void 0?!0:r;const v=t&&r;t&&(this.hScroll=new Fn(e,!0,v,l,p)),r&&(this.vScroll=new Fn(e,!1,v,l,p)),v&&(this.corner_=re(oe.RECT,{height:Fn.scrollbarThickness,width:Fn.scrollbarThickness,class:"blocklyScrollbarBackground"}),Cn(this.corner_,e.getBubbleCanvas()))}dispose(){mt(this.corner_),this.oldHostMetrics=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){const e=this.workspace.getMetrics();if(e){var t=!1,r=!1;if(this.oldHostMetrics&&this.oldHostMetrics.viewWidth===e.viewWidth&&this.oldHostMetrics.viewHeight===e.viewHeight&&this.oldHostMetrics.absoluteTop===e.absoluteTop&&this.oldHostMetrics.absoluteLeft===e.absoluteLeft?(this.oldHostMetrics&&this.oldHostMetrics.scrollWidth===e.scrollWidth&&this.oldHostMetrics.viewLeft===e.viewLeft&&this.oldHostMetrics.scrollLeft===e.scrollLeft||(t=!0),this.oldHostMetrics&&this.oldHostMetrics.scrollHeight===e.scrollHeight&&this.oldHostMetrics.viewTop===e.viewTop&&this.oldHostMetrics.scrollTop===e.scrollTop||(r=!0)):r=t=!0,t||r){try{s.disable$$module$build$src$core$events$utils(),this.hScroll&&t&&this.hScroll.resize(e),this.vScroll&&r&&this.vScroll.resize(e)}finally{s.enable$$module$build$src$core$events$utils()}this.workspace.maybeFireViewportChangeEvent()}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics||this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft){let l;(l=this.corner_)==null||l.setAttribute("x",String(this.vScroll.position.x))}if(!this.oldHostMetrics||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteTop!==e.absoluteTop){let l;(l=this.corner_)==null||l.setAttribute("y",String(this.hScroll.position.y))}}this.oldHostMetrics=e}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(e,t){this.hScroll&&this.hScroll.setOrigin(e,t),this.vScroll&&this.vScroll.setOrigin(e,t)}set(e,t,r){this.hScroll&&this.hScroll.set(e,!1),this.vScroll&&this.vScroll.set(t,!1),(r||r===void 0)&&(e={},this.hScroll&&(e.x=this.hScroll.getRatio_()),this.vScroll&&(e.y=this.vScroll.getRatio_()),this.workspace.setMetrics(e))}setX(e){this.hScroll&&this.hScroll.set(e,!0)}setY(e){this.vScroll&&this.vScroll.set(e,!0)}setContainerVisible(e){this.hScroll&&this.hScroll.setContainerVisible(e),this.vScroll&&this.vScroll.setContainerVisible(e)}isVisible(){let e=!1;return this.hScroll&&(e=this.hScroll.isVisible()),this.vScroll&&(e=e||this.vScroll.isVisible()),e}setVisible(e){this.hScroll&&this.hScroll.setVisibleInternal(e),this.vScroll&&this.vScroll.setVisibleInternal(e)}resizeContent(e){this.hScroll&&this.hScroll.resizeContentHorizontal(e),this.vScroll&&this.vScroll.resizeContentVertical(e)}resizeView(e){this.hScroll&&this.hScroll.resizeViewHorizontal(e),this.vScroll&&this.vScroll.resizeViewVertical(e)}},qg=class{constructor(e){this.workspace_=e}getDimensionsPx_(e){let t=0,r=0;return e&&(t=e.getWidth(),r=e.getHeight()),new Jt(t,r)}getFlyoutMetrics(e){return e=this.getDimensionsPx_(this.workspace_.getFlyout(e)),{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){const e=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){let e=0,t=0;const r=this.getToolboxMetrics(),l=this.getFlyoutMetrics(),p=!!this.workspace_.getToolbox();var v;const O=!((v=this.workspace_.getFlyout())!=null&&v.autoClose);v=p?r.position:l.position;const G=v===Rt.TOP;return v===Rt.LEFT&&(p&&(e+=r.width),O&&(e+=l.width)),G&&(p&&(t+=r.height),O&&(t+=l.height)),{top:t,left:e}}getViewMetrics(e){e=e?this.workspace_.scale:1;const t=this.getSvgMetrics(),r=this.getToolboxMetrics(),l=this.getFlyoutMetrics(),p=!!this.workspace_.getToolbox();var v;const O=!((v=this.workspace_.getFlyout())!=null&&v.autoClose);v=p?r.position:l.position;const G=v===Rt.LEFT||v===Rt.RIGHT;return(v===Rt.TOP||v===Rt.BOTTOM)&&(p&&(t.height-=r.height),O&&(t.height-=l.height)),G&&(p&&(t.width-=r.width),O&&(t.width-=l.width)),{height:t.height/e,width:t.width/e,top:-this.workspace_.scrollY/e,left:-this.workspace_.scrollX/e}}getContentMetrics(e){e=e?1:this.workspace_.scale;const t=this.workspace_.getBlocksBoundingBox();return{height:(t.bottom-t.top)*e,width:(t.right-t.left)*e,top:t.top*e,left:t.left*e}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(e){if(!this.hasFixedEdges())return{};const t=this.workspace_.isMovableHorizontally(),r=this.workspace_.isMovableVertically();e=e||this.getViewMetrics(!1);const l={};return r||(l.top=e.top,l.bottom=e.top+e.height),t||(l.left=e.left,l.right=e.left+e.width),l}getPaddedContent_(e,t){const r=t.top+t.height,l=t.left+t.width,p=e.width;e=e.height;const v=p/2,O=e/2;return{top:Math.min(t.top-O,r-e),bottom:Math.max(r+O,t.top+e),left:Math.min(t.left-v,l-p),right:Math.max(l+v,t.left+p)}}getScrollMetrics(e,t,r){e=e?this.workspace_.scale:1,t=t||this.getViewMetrics(!1);var l=r||this.getContentMetrics();r=this.getComputedFixedEdges_(t),t=this.getPaddedContent_(t,l),l=r.top!==void 0?r.top:t.top;const p=r.left!==void 0?r.left:t.left;return{top:l/e,left:p/e,width:((r.right!==void 0?r.right:t.right)-p)/e,height:((r.bottom!==void 0?r.bottom:t.bottom)-l)/e}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){const e=this.getToolboxMetrics(),t=this.getFlyoutMetrics(!0),r=this.getSvgMetrics(),l=this.getAbsoluteMetrics(),p=this.getViewMetrics(),v=this.getContentMetrics(),O=this.getScrollMetrics(!1,p,v);return{contentHeight:v.height,contentWidth:v.width,contentTop:v.top,contentLeft:v.left,scrollHeight:O.height,scrollWidth:O.width,scrollTop:O.top,scrollLeft:O.left,viewHeight:p.height,viewWidth:p.width,viewTop:p.top,viewLeft:p.left,absoluteTop:l.top,absoluteLeft:l.left,svgHeight:r.height,svgWidth:r.width,toolboxWidth:e.width,toolboxHeight:e.height,toolboxPosition:e.position,flyoutWidth:t.width,flyoutHeight:t.height}}};i(Be.METRICS_MANAGER,Nr,qg),"Blockly"in globalThis||(globalThis.Blockly={Msg:hb});var sh=class extends Vd{constructor(){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter=null,this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=6*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=8*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(e){super.setFontConstants_(e),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(e){super.setDynamicProperties_(e),this.SELECTED_GLOW_COLOUR=e.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;const t=Number(e.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=t&&!isNaN(t)?t:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=e.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(e=Number(e.getComponentStyle("replacementGlowSize")))&&!isNaN(e)?e:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter&&mt(this.selectedGlowFilter),this.replacementGlowFilter&&mt(this.replacementGlowFilter)}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH,r=Zs("c",[ut(25,-e),ut(71,-e),ut(t,0)]);return{height:e,width:t,path:r}}makeHexagonal(){function e(r,l,p){var v=r/2;return v=v>t?t:v,p=p?-1:1,r=(l?-1:1)*r/2,hi(-p*v,r)+hi(p*v,r)}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width(r){return r/=2,r>t?t:r},height(r){return r},connectionOffsetY(r){return r/2},connectionOffsetX(r){return-r},pathDown(r){return e(r,!1,!1)},pathUp(r){return e(r,!0,!1)},pathRightDown(r){return e(r,!1,!0)},pathRightUp(r){return e(r,!1,!0)}}}makeRounded(){function e(l,p,v){const O=l>r?l-r:0;l=(l>r?r:l)/2;const G=v===p?"0":"1";return Hn("a","0 0,"+G,l,ut((v?1:-1)*l,(p?-1:1)*l))+tt("v",(p?-1:1)*O)+Hn("a","0 0,"+G,l,ut((v?-1:1)*l,(p?-1:1)*l))}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,r=2*t;return{type:this.SHAPES.ROUND,isDynamic:!0,width(l){return l/=2,l>t?t:l},height(l){return l},connectionOffsetY(l){return l/2},connectionOffsetX(l){return-l},pathDown(l){return e(l,!1,!1)},pathUp(l){return e(l,!0,!1)},pathRightDown(l){return e(l,!1,!0)},pathRightUp(l){return e(l,!1,!0)}}}makeSquared(){function e(r,l,p){r-=2*t;const v=p===l?"0":"1";return Hn("a","0 0,"+v,t,ut((p?1:-1)*t,(l?-1:1)*t))+tt("v",(l?-1:1)*r)+Hn("a","0 0,"+v,t,ut((p?-1:1)*t,(l?-1:1)*t))}const t=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width(r){return t},height(r){return r},connectionOffsetY(r){return r/2},connectionOffsetX(r){return-r},pathDown(r){return e(r,!1,!1)},pathUp(r){return e(r,!0,!1)},pathRightDown(r){return e(r,!1,!0)},pathRightUp(r){return e(r,!1,!0)}}}shapeFor(e){let t=e.getCheck();switch(!t&&e.targetConnection&&(t=e.targetConnection.getCheck()),e.type){case Ze.INPUT_VALUE:case Ze.OUTPUT_VALUE:if(e=e.getSourceBlock().getOutputShape(),e!==null)switch(e){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return t&&t.includes("Boolean")?this.HEXAGONAL:t&&t.includes("Number")?this.ROUNDED:(t&&t.includes("String"),this.ROUNDED);case Ze.PREVIOUS_STATEMENT:case Ze.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function e(Qe){return Zs("c",[ut(Qe*p/2,0),ut(Qe*p*3/4,O/2),ut(Qe*p,O)])+Mr([ut(Qe*p,v)])+Zs("c",[ut(Qe*p/4,O/2),ut(Qe*p/2,O),ut(Qe*p,O)])+tt("h",Qe*l)+Zs("c",[ut(Qe*p/2,0),ut(Qe*p*3/4,-(O/2)),ut(Qe*p,-O)])+Mr([ut(Qe*p,-v)])+Zs("c",[ut(Qe*p/4,-(O/2)),ut(Qe*p/2,-O),ut(Qe*p,-O)])}const t=this.NOTCH_WIDTH,r=this.NOTCH_HEIGHT,l=t/3,p=l/3,v=r/2,O=v/2,G=e(1),Ie=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:r,pathLeft:G,pathRight:Ie}}makeInsideCorners(){const e=this.CORNER_RADIUS,t=Hn("a","0 0,0",e,ut(-e,e)),r=Hn("a","0 0,1",e,ut(-e,e)),l=Hn("a","0 0,0",e,ut(e,e)),p=Hn("a","0 0,1",e,ut(e,e));return{width:e,height:e,pathTop:t,pathBottom:l,rightWidth:e,rightHeight:e,pathTopRight:r,pathBottomRight:p}}generateSecondaryColour_(e){return et("#000",e,.15)||e}generateTertiaryColour_(e){return et("#000",e,.25)||e}createDom(e,t,r){super.createDom(e,t,r),e=re(oe.DEFS,{},e),t=re(oe.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),re(oe.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},t),r=re(oe.FECOMPONENTTRANSFER,{result:"outBlur"},t),re(oe.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},r),re(oe.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),re(oe.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.selectedGlowFilterId=t.id,this.selectedGlowFilter=t,e=re(oe.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),re(oe.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},e),t=re(oe.FECOMPONENTTRANSFER,{result:"outBlur"},e),re(oe.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),re(oe.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),re(oe.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),re(oe.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},e),this.replacementGlowFilterId=e.id,this.replacementGlowFilter=e}getCSS_(e){return[`${e} .blocklyText,`,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyTextInputBubble textarea {`,"font-weight: normal;","}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableText>rect:not(.blocklyDropdownRect),`,`${e} .blocklyEditableText>rect:not(.blocklyDropdownRect) {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"}",`${e} .blocklyNonEditableText>text,`,`${e} .blocklyEditableText>text,`,`${e} .blocklyNonEditableText>g>text,`,`${e} .blocklyEditableText>g>text {`,"fill: #575E75;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #575E75;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #575E75;","}",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>rect,",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"color: #575E75;","}",`${e} .blocklyDropdownText {`,"fill: #fff !important;","}",`${e}.blocklyWidgetDiv .blocklyMenuItem,`,`${e}.blocklyDropDownDiv .blocklyMenuItem {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e}.blocklyDropDownDiv .blocklyMenuItemContent {`,"color: #fff;","}",`${e} .blocklyHighlightedConnectionPath {`,`stroke: ${this.SELECTED_GLOW_COLOUR};`,"}",`${e} .blocklyDisabled > .blocklyOutlinePath {`,`fill: url(#blocklyDisabledPattern${this.randomIdentifier})`,"}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},rh=class extends Fl{constructor(e,t){super(e,t)}draw(){const e=this.block_.pathObject;e.beginDrawing(),this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),e.setPath(this.outlinePath_+`
`+this.inlinePath_),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_(),this.info_.outputConnection&&(e.outputShapeType=this.info_.outputConnection.shape.type),e.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(e){if(!(0>=e.height)){if(J.isSpacer(e)){const l=e.precedesStatement;var t=e.followsStatement;if(l||t){const p=this.constants_.INSIDE_CORNERS;var r=p.rightHeight;r=e.height-(l?r:0),t=t?p.pathBottomRight:"",e=0<r?tt("V",e.yPos+r):"",this.outlinePath_+=t+e+(l?p.pathTopRight:"");return}}this.outlinePath_+=tt("V",e.yPos+e.height)}}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){const e=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=xn(e.xPos,this.info_.startY),this.outlinePath_+=tt("h",e.width)}drawFlatBottom_(){const e=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=tt("V",e.baseline),this.outlinePath_+=tt("h",-e.width)}drawInlineInput_(e){this.positionInlineInputConnection_(e);const t=e.input.name;e.connectedBlock||this.info_.isInsertionMarker||(e=is(e.xPos+e.connectionWidth,e.centerline-e.height/2)+this.getInlineInputPath(e),this.block_.pathObject.setOutlinePath(t,e))}getInlineInputPath(e){const t=e.width-2*e.connectionWidth,r=e.height;return tt("h",t)+e.shape.pathRightDown(r)+tt("h",-t)+e.shape.pathUp(r)+"z"}drawStatementInput_(e){var t=e.getLastInput();const r=t.xPos+t.notchOffset+t.shape.width,l=this.constants_.INSIDE_CORNERS,p=t.shape.pathRight+tt("h",-(t.notchOffset-l.width))+l.pathTop,v=e.height-2*l.height;t=l.pathBottom+tt("h",t.notchOffset-l.width)+(t.connectedBottomNextConnection?"":t.shape.pathLeft),this.outlinePath_+=tt("H",r)+p+tt("v",v)+t+tt("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}drawConnectionHighlightPath(e){const t=e.connectionModel;if(t.type===Ze.NEXT_STATEMENT||t.type===Ze.PREVIOUS_STATEMENT||t.type===Ze.OUTPUT_VALUE&&!e.isDynamicShape)super.drawConnectionHighlightPath(e);else{e=t.type===Ze.INPUT_VALUE?is(e.connectionWidth,-e.height/2)+this.getInlineInputPath(e):is(e.width,-e.height/2)+e.shape.pathDown(e.height);var r=t.getSourceBlock(),l,p;(p=(l=r.pathObject).addConnectionHighlight)==null||p.call(l,t,e,t.getOffsetInBlock(),r.RTL)}}},Fa=class extends vn{constructor(e,t,r,l,p,v,O){if(super(vn.SKIP_SETUP),this.imageElement=this.clickHandler=null,this.flipRtl=this.isDirty_=this.EDITABLE=!1,this.altText="",r=Number(kt(r)),t=Number(kt(t)),isNaN(r)||isNaN(t))throw Error("Height and width values of an image field must cast to numbers.");if(0>=r||0>=t)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new Jt(t,r+Fa.Y_PADDING),this.imageHeight=r,typeof p=="function"&&(this.clickHandler=p),e!==vn.SKIP_SETUP&&(O?this.configure_(O):(this.flipRtl=!!v,this.altText=kt(l)||""),this.setValue(kt(e)))}configure_(e){super.configure_(e),e.flipRtl&&(this.flipRtl=e.flipRtl),e.alt&&(this.altText=kt(e.alt))}initView(){this.imageElement=re(oe.IMAGE,{height:this.imageHeight+"px",width:this.size_.width+"px",alt:this.altText},this.fieldGroup_),this.imageElement.setAttributeNS(nr,"xlink:href",this.value_),this.clickHandler&&(this.imageElement.style.cursor="pointer")}updateSize_(){}doClassValidation_(e){return typeof e!="string"?null:e}doValueUpdate_(e){this.value_=e,this.imageElement&&this.imageElement.setAttributeNS(nr,"xlink:href",this.value_)}getFlipRtl(){return this.flipRtl}setAlt(e){e!==this.altText&&(this.altText=e||"",this.imageElement&&this.imageElement.setAttribute("alt",this.altText))}showEditor_(){this.clickHandler&&this.clickHandler(this)}setOnClickHandler(e){this.clickHandler=e}getText_(){return this.altText}static fromJson(e){if(!e.src||!e.width||!e.height)throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.");return new this(e.src,e.width,e.height,void 0,void 0,void 0,e)}};Fa.Y_PADDING=1,Ot("field_image",Fa),Fa.prototype.DEFAULT_VALUE="";var ih=class extends vn{constructor(e,t,r){super(vn.SKIP_SETUP),this.spellcheck_=!0,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=!1,this.onKeyInputWrapper=this.onKeyDownWrapper=this.valueWhenEditorWasOpened_=null,this.fullBlockClickTarget_=!1,this.workspace_=null,this.SERIALIZABLE=!0,this.CURSOR="text",e!==vn.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.spellcheck!==void 0&&(this.spellcheck_=e.spellcheck)}initView(){if(!this.getSourceBlock())throw new Gn;super.initView(),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}isFullBlockField(){const e=this.getSourceBlock();if(!e)throw new Gn;let t;return this.fullBlockClickTarget_=!((t=this.getConstants())==null||!t.FULL_BLOCK_FIELDS)&&e.isSimpleReporter()}doValueInvalid_(e,t=!0){this.isBeingEdited_&&(this.isDirty_=!0,this.isTextValid_=!1,e=this.value_,this.value_=this.valueWhenEditorWasOpened_,this.sourceBlock_&&te()&&this.value_!==e&&t&&ee(new(Ce(fe.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,e,this.value_)))}doValueUpdate_(e){this.isTextValid_=this.isDirty_=!0,this.value_=e}applyColour(){const e=this.getSourceBlock();if(!e)throw new Gn;this.getConstants().FULL_BLOCK_FIELDS&&this.fieldGroup_&&(!this.isFullBlockField()&&this.borderRect_?(this.borderRect_.style.display="block",this.borderRect_.setAttribute("stroke",e.getColourTertiary())):(this.borderRect_.style.display="none",e.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)))}getSize(){let e;return(e=this.getConstants())!=null&&e.FULL_BLOCK_FIELDS&&(this.render_(),this.isDirty_=!1),super.getSize()}onLocationChange(){this.isBeingEdited_&&this.resizeEditor_()}render_(){if(super.render_(),this.isBeingEdited_){var e=this.htmlInput_;this.isTextValid_?(pt(e,"blocklyInvalidInput"),tn(e,as.INVALID,!1)):(Fe(e,"blocklyInvalidInput"),tn(e,as.INVALID,!0))}if(e=this.getSourceBlock(),!e)throw new Gn;this.getConstants().FULL_BLOCK_FIELDS&&e.applyColour()}setSpellcheck(e){e!==this.spellcheck_&&(this.spellcheck_=e,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))}showEditor_(e,t=!1){this.workspace_=this.sourceBlock_.workspace,!t&&this.workspace_.options.modalInputs&&(_d||Qp||yd)?this.showPromptEditor():this.showInlineEditor(t)}showPromptEditor(){sc(s.Msg$$module$build$src$core$msg.CHANGE_VALUE_TITLE,this.getText(),e=>{e!==null&&this.setValue(this.getValueFromEditorText_(e)),this.onFinishEditing_(this.value_)})}showInlineEditor(e){const t=this.getSourceBlock();if(!t)throw new Gn;Bi(this,t.RTL,this.widgetDispose_.bind(this),this.workspace_),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,this.valueWhenEditorWasOpened_=this.value_,e||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}widgetCreate_(){var e=this.getSourceBlock();if(!e)throw new Gn;s.setGroup$$module$build$src$core$events$utils(!0);const t=us();var r=this.getClickTarget_();if(!r)throw Error("A click target has not been set.");Fe(r,"editing"),r=document.createElement("input"),r.className="blocklyHtmlInput",r.setAttribute("spellcheck",this.spellcheck_);const l=this.workspace_.getScale();var p=this.getConstants().FIELD_TEXT_FONTSIZE*l+"pt";return t.style.fontSize=p,r.style.fontSize=p,p=ih.BORDERRADIUS*l+"px",this.isFullBlockField()&&(p=this.getScaledBBox(),p=(p.bottom-p.top)/2+"px",e=e.getParent()?e.getParent().getColourTertiary():this.sourceBlock_.getColourTertiary(),r.style.border=1*l+"px solid "+e,t.style.borderRadius=p,t.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(t.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*l+"px")),r.style.borderRadius=p,t.appendChild(r),r.value=r.defaultValue=this.getEditorText_(this.value_),r.setAttribute("data-untyped-default-value",String(this.value_)),this.resizeEditor_(),this.bindInputEvents_(r),r}widgetDispose_(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_(this.value_),this.sourceBlock_&&te()&&this.valueWhenEditorWasOpened_!==null&&this.valueWhenEditorWasOpened_!==this.value_&&(ee(new(Ce(fe.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,this.valueWhenEditorWasOpened_,this.value_)),this.valueWhenEditorWasOpened_=null),s.setGroup$$module$build$src$core$events$utils(!1),this.unbindInputEvents_();var e=us().style;if(e.width="auto",e.height="auto",e.fontSize="",e.transition="",e.boxShadow="",this.htmlInput_=null,e=this.getClickTarget_(),!e)throw Error("A click target has not been set.");pt(e,"editing")}onFinishEditing_(e){}bindInputEvents_(e){this.onKeyDownWrapper=Ue(e,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper=Ue(e,"input",this,this.onHtmlInputChange)}unbindInputEvents_(){this.onKeyDownWrapper&&(wt(this.onKeyDownWrapper),this.onKeyDownWrapper=null),this.onKeyInputWrapper&&(wt(this.onKeyInputWrapper),this.onKeyInputWrapper=null)}onHtmlInputKeyDown_(e){e.key==="Enter"?(nn(this),Jr()):e.key==="Escape"?(this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value"),!1),nn(this),Jr()):e.key==="Tab"&&(nn(this),Jr(),this.sourceBlock_.tab(this,!e.shiftKey),e.preventDefault())}onHtmlInputChange(e){e=this.value_,this.setValue(this.getValueFromEditorText_(this.htmlInput_.value),!1),this.sourceBlock_&&te()&&this.value_!==e&&ee(new(Ce(fe.BLOCK_FIELD_INTERMEDIATE_CHANGE))(this.sourceBlock_,this.name||null,e,this.value_))}setEditorValue_(e,t=!0){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(e)),this.setValue(e,t)}resizeEditor_(){rs().then(()=>{const e=this.getSourceBlock();if(!e)throw new Gn;const t=us(),r=this.getScaledBBox();t.style.width=r.right-r.left+"px",t.style.height=r.bottom-r.top+"px";const l=r.top;t.style.left=`${e.RTL?r.right-t.offsetWidth:r.left}px`,t.style.top=`${l}px`})}repositionForWindowResize(){let e;const t=(e=this.getSourceBlock())==null?void 0:e.getRootBlock();return t instanceof Ur?(So(this.workspace_,this.workspace_.getMetricsManager().getViewMetrics(!0),t)||this.resizeEditor_(),!0):!1}isTabNavigable(){return!0}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(e){return`${e}`}getValueFromEditorText_(e){return e}};ih.BORDERRADIUS=4;var oh=class extends ih{constructor(e,t,r){super(e,t,r)}doClassValidation_(e){return e===void 0?null:`${e}`}static fromJson(e){return new this(kt(e.text),void 0,e)}};Ot("field_input",oh),oh.prototype.DEFAULT_VALUE="";var t$=class extends or{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){return!!e.outputConnection}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},ah=class extends su{constructor(e,t){if(super(e,t),this.connectedBottomNextConnection=!1,this.connectedBlock){for(e=this.connectedBlock;t=e.getNextBlock();)e=t;e.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}}},n$=class extends Ct{constructor(e){super(e),this.width=this.height=0,this.type|=J.getType("RIGHT_CONNECTION")}},s$=class extends Bg{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){const t=(e.hat?e.hat==="cap":this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection;return!!e.outputConnection||t}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},r$=class extends hs{constructor(e,t){super(e,t),this.isInline=!0,this.renderer_=e,this.constants_=this.renderer_.getConstants(),this.topRow=new s$(this.constants_),this.bottomRow=new t$(this.constants_),this.isMultiRow=!t.getInputsInline()||t.isCollapsed(),this.hasStatementInput=0<t.statementInputCount,this.rightSide=this.outputConnection?new n$(this.constants_):null,this.rightAlignedDummyInputs=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(e,t){return t?t instanceof ro||e instanceof yr||t instanceof yr?!0:e instanceof s.ValueInput$$module$build$src$core$inputs$value_input||e instanceof yi||e instanceof ro?!this.isInline||this.isMultiRow:!1:!1}getDesiredRowWidth_(e){return e.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(e)}getInRowSpacing_(e,t){return e&&t||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!e&&t&&J.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:e&&J.isLeftRoundedCorner(e)&&t&&(J.isPreviousConnection(t)||J.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&J.isLeftSquareCorner(e)&&t&&J.isHat(t)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(e,t){if(J.isTopRow(e)&&J.isBottomRow(t))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;const r=J.isInputRow(e)&&e.hasStatement,l=J.isInputRow(t)&&t.hasStatement;return l||r?(e=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),l&&r?Math.max(e,this.constants_.DUMMY_INPUT_MIN_HEIGHT):e):J.isTopRow(e)?e.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):J.isBottomRow(t)?this.outputConnection?!t.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}getSpacerRowWidth_(e,t){const r=this.width-this.startX;return J.isInputRow(e)&&e.hasStatement||J.isInputRow(t)&&t.hasStatement?Math.max(r,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):r}getElemCenterline_(e,t){if(e.hasStatement&&!J.isSpacer(t)&&!J.isStatementInput(t))return e.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(J.isInlineInput(t)&&t instanceof Mo){const r=t.connectedBlock;if(r&&r.outputConnection&&r.nextConnection)return e.yPos+r.height/2}return super.getElemCenterline_(e,t)}addInput_(e,t){if((e instanceof yi||e instanceof ro)&&t.hasDummyInput&&t.align===s.Align$$module$build$src$core$inputs$align.LEFT&&e.align===s.Align$$module$build$src$core$inputs$align.RIGHT)this.rightAlignedDummyInputs.set(t,e);else if(e instanceof yr){t.elements.push(new ah(this.constants_,e)),t.hasStatement=!0,t.align===null&&(t.align=e.align);return}super.addInput_(e,t)}addAlignmentPadding_(e,t){if(this.rightAlignedDummyInputs.get(e)){let r;for(let l=0;l<e.elements.length;l++){const p=e.elements[l];if(J.isSpacer(p)&&(r=p),J.isField(p)&&p instanceof jl&&p.parentInput===this.rightAlignedDummyInputs.get(e))break}if(r){r.width+=t,e.width+=t;return}}super.addAlignmentPadding_(e,t)}adjustXPosition_(){const e=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;let t=e;for(let p=2;p<this.rows.length-1;p+=2){var r=this.rows[p-1];const v=this.rows[p];var l=this.rows[p+1];if(r=p===2?!!this.topRow.hasPreviousConnection:!!r.followsStatement,l=p+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!l.precedesStatement,J.isInputRow(v)&&v.hasStatement){v.measure();let O,G;t=v.width-((G=(O=v.getLastInput())==null?void 0:O.width)!=null?G:0)+e}else if(r&&(p===2||l)&&J.isInputRow(v)&&!v.hasStatement){l=v.xPos,r=null;for(let O=0;O<v.elements.length;O++){const G=v.elements[O];J.isSpacer(G)&&(r=G),r&&(J.isField(G)||J.isInput(G))&&l<t&&!(J.isField(G)&&G instanceof jl&&(G.field instanceof La||G.field instanceof Fa))&&(r.width+=t-l),l+=G.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var e=this.outputConnection.shape;if("isDynamic"in e&&e.isDynamic){for(var t=0,r=0;r<this.rows.length;r++){const l=this.rows[r];l.yPos=t,t+=l.height}this.height=t,r=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,t=e.height(r),r=e.width(r),this.outputConnection.height=t,this.outputConnection.width=r,this.outputConnection.startX=r,this.outputConnection.connectionOffsetY=e.connectionOffsetY(t),this.outputConnection.connectionOffsetX=e.connectionOffsetX(r),e=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(e=r,this.rightSide.height=t,this.rightSide.width=e,this.rightSide.centerline=t/2,this.rightSide.xPos=this.width+e),this.startX=r,this.width+=r+e,this.widthWithChildren+=r+e}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var e=0,t=0;t<this.rows.length;t++){var r=this.rows[t];if(!J.isInputRow(r))continue;e=r.elements[r.elements.length-2];let l=this.getNegativeSpacing_(r.elements[1]),p=this.getNegativeSpacing_(e);e=l+p;const v=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-e<v&&(e=this.width-v,l=e/2,p=e/2),r.elements.unshift(new vr(this.constants_,-l)),r.elements.push(new vr(this.constants_,-p))}if(e)for(this.width-=e,this.widthWithChildren-=e,this.rightSide.xPos-=e,t=0;t<this.rows.length;t++)r=this.rows[t],J.isTopOrBottomRow(r)&&(r.elements[1].width-=e),r.width-=e,r.widthWithConnectedBlocks-=e}}getNegativeSpacing_(e){if(!e||!this.outputConnection)return 0;const t=this.outputConnection.width;var r=this.outputConnection.shape.type;const l=this.constants_;if(1<this.inputRows.length)switch(r){case l.SHAPES.ROUND:return r=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,r=this.height/2>r?r:this.height/2,t-r*(1-Math.sin(Math.acos((r-this.constants_.SMALL_PADDING)/r)));default:return 0}if(J.isInlineInput(e)&&e instanceof Mo){const p=e.connectedBlock;return e=p?p.pathObject.outputShapeType:e.shape.type,e==null||p&&p.outputConnection&&(p.statementInputCount||p.nextConnection)||r===l.SHAPES.HEXAGONAL&&r!==e?0:t-this.constants_.SHAPE_IN_SHAPE_PADDING[r][e]}return J.isField(e)&&e instanceof jl?r===l.SHAPES.ROUND&&e.field instanceof oh?t-2.75*l.GRID_UNIT:t-this.constants_.SHAPE_IN_SHAPE_PADDING[r][0]:J.isIcon(e)?this.constants_.SMALL_PADDING:0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let l=2;l<this.rows.length-1;l+=2){const p=this.rows[l-1],v=this.rows[l],O=this.rows[l+1];var e=l===2,t=l+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!O.precedesStatement;if(e?this.topRow.hasPreviousConnection:p.followsStatement){var r=v.elements[1];if(r=v.elements.length===3&&r instanceof jl&&(r.field instanceof La||r.field instanceof Fa),!e&&r)p.height-=this.constants_.SMALL_PADDING,O.height-=this.constants_.SMALL_PADDING,v.height-=this.constants_.MEDIUM_PADDING;else if(!e&&!t)p.height+=this.constants_.SMALL_PADDING;else if(t){for(e=!1,t=0;t<v.elements.length;t++)if(r=v.elements[t],r instanceof Mo&&J.isInlineInput(r)&&r.connectedBlock&&!r.connectedBlock.isShadow()&&40<=r.connectedBlock.getHeightWidth().height){e=!0;break}e&&(p.height-=this.constants_.SMALL_PADDING,O.height-=this.constants_.SMALL_PADDING)}}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},i$=class extends Fg{constructor(e,t,r){super(e,t,r),this.markerCircle=null}showWithInputOutput(e){const t=e.getSourceBlock();e=e.getLocation().getOffsetInBlock(),this.positionCircle(e.x,e.y),this.setParent_(t),this.showCurrent_()}showWithOutput_(e){this.showWithInputOutput(e)}showWithInput_(e){this.showWithInputOutput(e)}showWithBlock_(e){e=e.getLocation();const t=e.getHeightWidth();this.positionRect_(0,0,t.width,t.height),this.setParent_(e),this.showCurrent_()}positionCircle(e,t){let r;(r=this.markerCircle)==null||r.setAttribute("cx",`${e}`);let l;(l=this.markerCircle)==null||l.setAttribute("cy",`${t}`),this.currentMarkerSvg=this.markerCircle}hide(){super.hide(),this.markerCircle&&(this.markerCircle.style.display="none")}createDomInternal_(){if(super.createDomInternal_(),this.markerCircle=re(oe.CIRCLE,{r:this.constants_.CURSOR_RADIUS,"stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.hide(),this.isCursor()){const e=this.getBlinkProperties_();re(oe.ANIMATE,e,this.markerCircle)}return this.markerSvg_}applyColour_(e){super.applyColour_(e);let t;(t=this.markerCircle)==null||t.setAttribute("fill",this.colour_);let r;if((r=this.markerCircle)==null||r.setAttribute("stroke",this.colour_),this.isCursor()){e=this.colour_+";transparent;transparent;";let l;(l=this.markerCircle)==null||l.firstElementChild.setAttribute("values",e)}}},o$=class extends Gd{constructor(e,t,r){super(e,t,r),this.svgPathSelected=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=r}setPath(e){super.setPath(e),this.svgPathSelected&&this.svgPathSelected.setAttribute("d",e)}applyColour(e){super.applyColour(e);const t=e.getParent();e.isShadow()&&t&&this.svgPath.setAttribute("stroke",t.getColourTertiary());for(const r of this.outlines.values())r.setAttribute("fill",this.style.colourTertiary)}flipRTL(){super.flipRTL();for(const e of this.outlines.values())e.setAttribute("transform","scale(-1 1)")}updateSelected(e){this.setClass_("blocklySelected",e),e?this.svgPathSelected||(this.svgPathSelected=this.svgPath.cloneNode(!0),this.svgPathSelected.setAttribute("fill","none"),this.svgPathSelected.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected)):this.svgPathSelected&&(this.svgRoot.removeChild(this.svgPathSelected),this.svgPathSelected=null)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e),e?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter")}updateShapeForInputHighlight(e,t){e=e.getParentInput().name,(e=this.getOutlinePath(e))&&(t?e.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):e.removeAttribute("filter"))}beginDrawing(){this.remainingOutlines.clear();for(const e of this.outlines.keys())this.remainingOutlines.add(e)}endDrawing(){if(this.remainingOutlines.size)for(const e of this.remainingOutlines)this.removeOutlinePath(e);this.remainingOutlines.clear()}setOutlinePath(e,t){e=this.getOutlinePath(e),e.setAttribute("d",t),e.setAttribute("fill",this.style.colourTertiary)}getOutlinePath(e){return this.outlines.has(e)||this.outlines.set(e,re(oe.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(e),this.outlines.get(e)}removeOutlinePath(e){let t,r;(t=this.outlines.get(e))==null||(r=t.parentNode)==null||r.removeChild(this.outlines.get(e)),this.outlines.delete(e)}},Yg=class extends ou{constructor(e){super(e)}makeConstants_(){return new sh}makeRenderInfo_(e){return new r$(this,e)}makeDrawer_(e,t){return new rh(e,t)}makeMarkerDrawer(e,t){return new i$(e,this.getConstants(),t)}makePathObject(e,t){return new o$(e,t,this.getConstants())}getConstants(){return this.constants_}getConnectionPreviewMethod(e,t,r){return T("getConnectionPreviewMethod","v10","v12","an IConnectionPreviewer, if it fulfills your use case."),t.type===Ze.OUTPUT_VALUE?e.isConnected()?wr.PREVIEW_TYPE.REPLACEMENT_FADE:wr.PREVIEW_TYPE.INPUT_OUTLINE:super.getConnectionPreviewMethod(e,t,r)}};Wi("zelos",Yg);var a$=class{constructor(e){this.staticConn=this.draggedConn=this.markerConn=this.fadedBlock=null,this.workspace=e.workspace}previewReplacement(e,t,r){s.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.fadedBlock=r,r.fadeForReplacement(!0),this.workspace.getRenderer().shouldHighlightConnection(t)&&(t.highlight(),this.staticConn=t)}finally{s.enable$$module$build$src$core$events$utils()}}previewConnection(e,t){if(e!==this.draggedConn||t!==this.staticConn){s.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.shouldUseMarkerPreview(e,t)&&(this.markerConn=this.previewMarker(e,t)),this.workspace.getRenderer().shouldHighlightConnection(t)&&t.highlight(),this.draggedConn=e,this.staticConn=t}finally{s.enable$$module$build$src$core$events$utils()}}}shouldUseMarkerPreview(e,t){return t.type===Ze.PREVIOUS_STATEMENT||t.type===Ze.NEXT_STATEMENT||!(this.workspace.getRenderer()instanceof Yg)}previewMarker(e,t){const r=e.getSourceBlock(),l=this.createInsertionMarker(r),p=this.getMatchingConnection(r,l,e);if(!p)return null;l.queueRender(),Ms(),p.connect(t);const v={x:t.x-p.x,y:t.y-p.y},O=p.getOffsetInBlock().clone();return rs().then(()=>{if(!l.isDeadOrDying()){s.disable$$module$build$src$core$events$utils();try{l==null||l.positionNearConnection(p,v,O),l==null||l.getSvgRoot().setAttribute("visibility","visible")}finally{s.enable$$module$build$src$core$events$utils()}}}),p}createInsertionMarker(e){const t=Qt(e,{addCoordinates:!1,addInputBlocks:!1,addNextBlocks:!1,doFullSerialization:!1});if(!t)throw Error(`Failed to serialize source block. ${e.toDevString()}`);e=Ni(t,this.workspace);for(const r of e.getDescendants(!1))r.setInsertionMarker(!0);return e.initSvg(),e.getSvgRoot().setAttribute("visibility","hidden"),e}getMatchingConnection(e,t,r){if(e=e.getConnections_(!0),t=t.getConnections_(!0),e.length!==t.length)return null;for(let l=0;l<e.length;l++)if(e[l]===r)return t[l];return null}hidePreview(){s.disable$$module$build$src$core$events$utils();try{this.staticConn&&(this.staticConn.unhighlight(),this.staticConn=null),this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null),this.markerConn&&(this.hideInsertionMarker(this.markerConn),this.draggedConn=this.markerConn=null)}finally{s.enable$$module$build$src$core$events$utils()}}hideInsertionMarker(e){const t=e.getSourceBlock(),r=t.outputConnection;let l;if((l=t.previousConnection)!=null&&l.targetConnection||r!=null&&r.targetConnection)t.unplug(!0);else{let p;(p=e.targetBlock())==null||p.unplug(!1)}t.dispose()}dispose(){this.hidePreview()}};i(Be.CONNECTION_PREVIEWER,Nr,a$);var Po={};Po.Align=s.Align$$module$build$src$core$inputs$align,Po.DummyInput=yi,Po.EndRowInput=ro,Po.Input=No,Po.StatementInput=yr,Po.ValueInput=s.ValueInput$$module$build$src$core$inputs$value_input,Po.inputTypes=s.inputTypes$$module$build$src$core$inputs$input_types;var l$=!1,c$;s.CodeGenerator$$module$build$src$core$generator=class{constructor(e){this.forBlock=Object.create(null),this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=e,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(e){e||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),e=xe());var t=[];this.init(e),e=e.getTopBlocks(!0);for(let r=0,l;l=e[r];r++){let p=this.blockToCode(l);Array.isArray(p)&&(p=p[0]),p&&(l.outputConnection&&(p=this.scrubNakedValue(p),this.STATEMENT_PREFIX&&!l.suppressPrefixSuffix&&(p=this.injectId(this.STATEMENT_PREFIX,l)+p),this.STATEMENT_SUFFIX&&!l.suppressPrefixSuffix&&(p+=this.injectId(this.STATEMENT_SUFFIX,l))),t.push(p))}return t=t.join(`
`),t=this.finish(t),t=t.replace(/^\s+\n/,""),t=t.replace(/\n\s+$/,`
`),t=t.replace(/[ \t]+\n/g,`
`)}prefixLines(e,t){return t+e.replace(/(?!\n$)\n/g,`
`+t)}allNestedComments(e){const t=[];e=e.getDescendants(!0);for(let r=0;r<e.length;r++){const l=e[r].getCommentText();l&&t.push(l)}return t.length&&t.push(""),t.join(`
`)}blockToCode(e,t){if(this.isInitialized===!1&&console.warn("CodeGenerator init was not called before blockToCode was called."),!e)return"";if(!e.isEnabled())return t?"":this.blockToCode(e.getNextBlock());if(e.isInsertionMarker())return t?"":this.blockToCode(e.getChildren(!1)[0]);var r=this.forBlock[e.type];if(typeof r!="function")throw Error(`${this.name_} generator does not know how to generate code for block type "${e.type}".`);if(r=r.call(e,e,this),Array.isArray(r)){if(!e.outputConnection)throw TypeError("Expecting string from statement block: "+e.type);return[this.scrub_(e,r[0],t),r[1]]}if(typeof r=="string")return this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(r=this.injectId(this.STATEMENT_PREFIX,e)+r),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(r+=this.injectId(this.STATEMENT_SUFFIX,e)),this.scrub_(e,r,t);if(r===null)return"";throw SyntaxError("Invalid code generated: "+r)}valueToCode(e,t,r){if(isNaN(r))throw TypeError("Expecting valid order from block: "+e.type);var l=e.getInputTargetBlock(t);if(!l&&!e.getInput(t))throw ReferenceError(`Input "${t}" doesn't exist on "${e.type}"`);if(!l||(t=this.blockToCode(l),t===""))return"";if(!Array.isArray(t))throw TypeError(`Expecting tuple from value block: ${l.type} See developers.google.com/blockly/guides/create-custom-blocks/generating-code for more information`);if(e=t[0],t=t[1],isNaN(t))throw TypeError("Expecting valid order from value block: "+l.type);if(!e)return"";l=!1;var p=Math.floor(r);const v=Math.floor(t);if(p<=v&&(p!==v||p!==0&&p!==99)){for(l=!0,p=0;p<this.ORDER_OVERRIDES.length;p++)if(this.ORDER_OVERRIDES[p][0]===r&&this.ORDER_OVERRIDES[p][1]===t){l=!1;break}}return l&&(e="("+e+")"),e}statementToCode(e,t){const r=e.getInputTargetBlock(t);if(!r&&!e.getInput(t))throw ReferenceError(`Input "${t}" doesn't exist on "${e.type}"`);if(e=this.blockToCode(r),typeof e!="string")throw TypeError("Expecting code from statement block: "+(r&&r.type));return e&&(e=this.prefixLines(e,this.INDENT)),e}addLoopTrap(e,t){return this.INFINITE_LOOP_TRAP&&(e=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,t),this.INDENT)+e),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(e=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,t),this.INDENT)+e),this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(e+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,t),this.INDENT)),e}injectId(e,t){return t=t.id.replace(/\$/g,"$$$$"),e.replace(/%1/g,"'"+t+"'")}addReservedWords(e){this.RESERVED_WORDS_+=e+","}provideFunction_(e,t){if(!this.definitions_[e]){const r=this.nameDB_.getDistinctName(e,s.NameType$$module$build$src$core$names.PROCEDURE);this.functionNames_[e]=r,Array.isArray(t)&&(t=t.join(`
`)),t=t.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,r);let l;for(;l!==t;)l=t,t=t.replace(/^(( {2})*) {2}/gm,"$1\0");t=t.replace(/\0/g,this.INDENT),this.definitions_[e]=t}return this.functionNames_[e]}getVariableName(e){return this.getName(e,s.NameType$$module$build$src$core$names.VARIABLE)}getProcedureName(e){return this.getName(e,s.NameType$$module$build$src$core$names.PROCEDURE)}getName(e,t){if(!this.nameDB_)throw Error("Name database is not defined. You must initialize `nameDB_` in your generator class and call `init` first.");return this.nameDB_.getName(e,t)}init(e){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(e,t,r){return t}finish(e){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),e}scrubNakedValue(e){return e}},c$={},c$.CodeGenerator=s.CodeGenerator$$module$build$src$core$generator;var u$=class extends qg{constructor(e,t){super(e),this.flyout_=t}getBoundingBox(){let e;try{e=this.workspace_.getCanvas().getBBox()}catch{e={height:0,y:0,width:0,x:0}}return e}getContentMetrics(e){const t=this.getBoundingBox();return e=e?1:this.workspace_.scale,{height:t.height*e,width:t.width*e,top:t.y*e,left:t.x*e}}getScrollMetrics(e,t,r){return t=r||this.getContentMetrics(),r=this.flyout_.MARGIN*this.workspace_.scale,e=e?this.workspace_.scale:1,{height:(t.height+2*r)/e,width:(t.width+t.left+r)/e,top:0,left:0}}},Gl;(function(e){e.BLOCK="block",e.BUTTON="button"})(Gl||(Gl={}));var yy="WORKSPACE_AT_BLOCK_CAPACITY",lh=class extends Yd{constructor(e){super(),this.horizontalLayout=!1,this.boundEvents=[],this.filterWrapper=this.reflowWrapper=null,this.mats=[],this.buttons_=[],this.contents=[],this.listeners=[],this.permanentlyDisabled=[],this.recycledBlocks=[],this.autoClose=!0,this.visible=!1,this.containerVisible=!0,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,e.setMetrics=this.setMetrics_.bind(this),this.workspace_=new Cr(e),this.workspace_.setMetricsManager(new u$(this.workspace_,this)),this.workspace_.internalIsFlyout=!0,this.workspace_.setVisible(this.visible),this.id=E(),this.RTL=!!e.RTL,this.toolboxPosition_=e.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.rectMap_=new WeakMap,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=3*this.MARGIN,this.GAP_Y=3*this.MARGIN}createDom(e){return this.svgGroup_=re(e,{class:"blocklyFlyout"}),this.svgGroup_.style.display="none",this.svgBackground_=re(oe.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(e){this.targetWorkspace=e,this.workspace_.targetWorkspace=e,this.workspace_.scrollbar=new Jg(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),this.boundEvents.push(Ue(this.svgGroup_,"wheel",this,this.wheel_)),this.filterWrapper=this.filterForCapacity.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper),this.boundEvents.push(Ue(this.svgBackground_,"pointerdown",this,this.onMouseDown)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),e.getComponentManager().addComponent({component:this,weight:pn.ComponentWeight.FLYOUT_WEIGHT,capabilities:[pn.Capability.AUTOHIDEABLE,pn.Capability.DELETE_AREA,pn.Capability.DRAG_TARGET]})}dispose(){this.hide(),this.targetWorkspace.getComponentManager().removeComponent(this.id);for(const e of this.boundEvents)wt(e);this.boundEvents.length=0,this.filterWrapper&&this.targetWorkspace.removeChangeListener(this.filterWrapper),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&mt(this.svgGroup_)}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}setAutoClose(e){this.autoClose=e,this.targetWorkspace.recordDragTargets(),this.targetWorkspace.resizeContents()}autoHide(e){!e&&this.targetWorkspace.getFlyout(!0)===this&&this.autoClose&&this.hide()}getTargetWorkspace(){return this.targetWorkspace}isVisible(){return this.visible}setVisible(e){const t=e!==this.isVisible();this.visible=e,t&&(this.autoClose||this.targetWorkspace.recordDragTargets(),this.updateDisplay())}setContainerVisible(e){const t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay()}getContents(){return this.contents}setContents(e){this.contents=e}updateDisplay(){let e;e=this.containerVisible?this.isVisible():!1,this.svgGroup_&&(this.svgGroup_.style.display=e?"block":"none");let t;(t=this.workspace_.scrollbar)==null||t.setContainerVisible(e)}positionAt_(e,t,r,l){let p;(p=this.svgGroup_)==null||p.setAttribute("width",`${e}`);let v;(v=this.svgGroup_)==null||v.setAttribute("height",`${t}`),this.workspace_.setCachedParentSvgSize(e,t),this.svgGroup_&&$n(this.svgGroup_,"translate("+r+"px,"+l+"px)"),(e=this.workspace_.scrollbar)&&(e.setOrigin(r,l),e.resize(),e.hScroll&&e.hScroll.setPosition(e.hScroll.position.x,e.hScroll.position.y),e.vScroll&&e.vScroll.setPosition(e.vScroll.position.x,e.vScroll.position.y))}hide(){if(this.isVisible()){this.setVisible(!1);for(const e of this.listeners)wt(e);this.listeners.length=0,this.reflowWrapper&&(this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowWrapper=null)}}show(e){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks(),typeof e=="string"&&(e=this.getDynamicCategoryContents(e)),this.setVisible(!0),e=pe(e),e=this.createFlyoutInfo(e),Ms(this.workspace_),this.setContents(e.contents),this.layout_(e.contents,e.gaps),this.horizontalLayout?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(!0),this.reflow(),this.filterForCapacity(),this.position(),this.reflowWrapper=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper),this.emptyRecycledBlocks()}createFlyoutInfo(e){const t=[],r=[];this.permanentlyDisabled.length=0;const l=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(const p of e){if("custom"in p){e=this.getDynamicCategoryContents(p.custom),e=pe(e);const{contents:v,gaps:O}=this.createFlyoutInfo(e);t.push(...v),r.push(...O)}switch(p.kind.toUpperCase()){case"BLOCK":e=p;const v=this.createFlyoutBlock(e);t.push({type:Gl.BLOCK,block:v}),this.addBlockGap(e,r,l);break;case"SEP":this.addSeparatorGap(p,r,l);break;case"LABEL":e=this.createButton(p,!0),t.push({type:Gl.BUTTON,button:e}),r.push(l);break;case"BUTTON":e=this.createButton(p,!1),t.push({type:Gl.BUTTON,button:e}),r.push(l)}}return{contents:t,gaps:r}}getDynamicCategoryContents(e){if(e=this.workspace_.targetWorkspace.getToolboxCategoryCallback(e),typeof e!="function")throw TypeError("Couldn't find a callback function when opening a toolbox category.");return e(this.workspace_.targetWorkspace)}createButton(e,t){return new _r(this.workspace_,this.targetWorkspace,e,t)}createFlyoutBlock(e){let t;return e.blockxml?(e=typeof e.blockxml=="string"?s.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,(t=this.getRecycledBlock(e.getAttribute("type")))||(t=yo(e,this.workspace_))):(t=this.getRecycledBlock(e.type),t||(e.enabled===void 0&&(e.enabled=e.disabled!=="true"&&e.disabled!==!0),e.disabledReasons===void 0&&e.enabled===!1&&(e.disabledReasons=[Bs]),t=Wn(e,this.workspace_))),t.isEnabled()||this.permanentlyDisabled.push(t),t}getRecycledBlock(e){let t=-1;for(let r=0;r<this.recycledBlocks.length;r++)if(this.recycledBlocks[r].type===e){t=r;break}return t===-1?void 0:this.recycledBlocks.splice(t,1)[0]}addBlockGap(e,t,r){let l;e.gap?l=parseInt(String(e.gap)):e.blockxml&&(e=typeof e.blockxml=="string"?s.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,l=parseInt(e.getAttribute("gap"))),t.push(!l||isNaN(l)?r:l)}addSeparatorGap(e,t,r){e=parseInt(String(e.gap)),!isNaN(e)&&0<t.length?t[t.length-1]=e:t.push(r)}clearOldBlocks(){var e=this.workspace_.getTopBlocks(!1);for(let r=0,l;l=e[r];r++)this.blockIsRecyclable_(l)?this.recycleBlock(l):l.dispose(!1,!1);for(e=0;e<this.mats.length;e++){const r=this.mats[e];r&&(Nu(r),mt(r))}this.mats.length=0;for(let r=0,l;l=this.buttons_[r];r++)l.dispose();this.buttons_.length=0;let t;(t=this.workspace_.getPotentialVariableMap())==null||t.clear()}emptyRecycledBlocks(){for(let e=0;e<this.recycledBlocks.length;e++)this.recycledBlocks[e].dispose();this.recycledBlocks=[]}blockIsRecyclable_(e){return!1}recycleBlock(e){const t=e.getRelativeToSurfaceXY();e.moveBy(-t.x,-t.y),this.recycledBlocks.push(e)}addBlockListeners_(e,t,r){this.listeners.push(Ue(e,"pointerdown",null,this.blockMouseDown(t))),this.listeners.push(Ue(r,"pointerdown",null,this.blockMouseDown(t))),this.listeners.push(Nt(e,"pointerenter",t,()=>{this.targetWorkspace.isDragging()||t.addSelect()})),this.listeners.push(Nt(e,"pointerleave",t,()=>{this.targetWorkspace.isDragging()||t.removeSelect()})),this.listeners.push(Nt(r,"pointerenter",t,()=>{this.targetWorkspace.isDragging()||t.addSelect()})),this.listeners.push(Nt(r,"pointerleave",t,()=>{this.targetWorkspace.isDragging()||t.removeSelect()}))}blockMouseDown(e){return t=>{const r=this.targetWorkspace.getGesture(t);r&&(r.setStartBlock(e),r.handleFlyoutStart(t,this))}}onMouseDown(e){const t=this.targetWorkspace.getGesture(e);t&&t.handleFlyoutStart(e,this)}isBlockCreatable(e){return e.isEnabled()}createBlock(e){let t=null;s.disable$$module$build$src$core$events$utils();var r=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{t=this.placeNewBlock(e)}finally{s.enable$$module$build$src$core$events$utils()}if(this.targetWorkspace.hideChaff(),e=ac(this.targetWorkspace,r),te()){for(s.setGroup$$module$build$src$core$events$utils(!0),r=0;r<e.length;r++){const l=e[r];ee(new(Ce(fe.VAR_CREATE))(l))}ee(new(Ce(fe.BLOCK_CREATE))(t))}return this.autoClose?this.hide():this.filterForCapacity(),t}initFlyoutButton_(e,t,r){const l=e.createDom();e.moveTo(t,r),e.show(),this.listeners.push(Ue(l,"pointerdown",this,this.onMouseDown)),this.buttons_.push(e)}createRect_(e,t,r,l,p){return t=re(oe.RECT,{"fill-opacity":0,x:t,y:r,height:l.height,width:l.width}),t.tooltip=e,rl(t),this.workspace_.getCanvas().insertBefore(t,e.getSvgRoot()),this.rectMap_.set(e,t),this.mats[p]=t}moveRectToBlock_(e,t){const r=t.getHeightWidth();e.setAttribute("width",String(r.width)),e.setAttribute("height",String(r.height)),t=t.getRelativeToSurfaceXY(),e.setAttribute("y",String(t.y)),e.setAttribute("x",String(this.RTL?t.x-r.width:t.x))}filterForCapacity(){const e=this.workspace_.getTopBlocks(!1);for(let t=0,r;r=e[t];t++)if(!this.permanentlyDisabled.includes(r)){const l=this.targetWorkspace.isCapacityAvailable(rt(r));for(;r;)r.setDisabledReason(!l,yy),r=r.getNextBlock()}}reflow(){this.reflowWrapper&&this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowInternal_(),this.reflowWrapper&&this.workspace_.addChangeListener(this.reflowWrapper)}isScrollable(){return this.workspace_.scrollbar?this.workspace_.scrollbar.isVisible():!1}placeNewBlock(e){var t=this.targetWorkspace;if(!e.getSvgRoot())throw Error("oldBlock is not rendered");const r=this.serializeBlock(e);return t.setResizesEnabled(!1),t=Ni(r,t),this.positionNewBlock(e,t),t}serializeBlock(e){return Qt(e)}positionNewBlock(e,t){const r=this.targetWorkspace;var l=r.getOriginOffsetInPixels(),p=this.workspace_.getOriginOffsetInPixels();e=e.getRelativeToSurfaceXY(),e.scale(this.workspace_.scale),p=Le.sum(p,e),l=Le.difference(p,l),l.scale(1/r.scale),t.moveTo(new Le(l.x,l.y))}};lh.FlyoutItemType=Gl;var Xg=class extends lh{constructor(e){super(e)}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),r=t.getScrollMetrics(),l=t.getViewMetrics();t=t.getAbsoluteMetrics(),typeof e.y=="number"&&(this.workspace_.scrollY=-(r.top+(r.height-l.height)*e.y)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),r=e.getViewMetrics();return e=e.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===Rt.LEFT?e.width:r.width-this.width_:this.toolboxPosition_===Rt.LEFT?0:r.width:this.toolboxPosition_===Rt.LEFT?0:r.width+t.left-this.width_}getY(){return 0}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=e.height,this.setBackgroundPath(this.width_-this.CORNER_RADIUS,e.height-2*this.CORNER_RADIUS),e=this.getX();var t=this.getY();this.positionAt_(this.width_,this.height_,e,t)}}setBackgroundPath(e,t){const r=this.toolboxPosition_===Rt.RIGHT;var l=e+this.CORNER_RADIUS;l=["M "+(r?l:0)+",0"],l.push("h",r?-e:e),l.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,r?0:1,r?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),l.push("v",Math.max(0,t)),l.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,r?0:1,r?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),l.push("h",r?e:-e),l.push("z"),this.svgBackground_.setAttribute("d",l.join(" "))}scrollToStart(){let e;(e=this.workspace_.scrollbar)==null||e.setY(0)}wheel_(e){var t=ge(e);if(t.y){const r=this.workspace_.getMetricsManager(),l=r.getScrollMetrics();t=r.getViewMetrics().top-l.top+t.y;let p;(p=this.workspace_.scrollbar)==null||p.setY(t),gc(this.workspace_),Jr()}e.preventDefault(),e.stopPropagation()}layout_(e,t){this.workspace_.scale=this.targetWorkspace.scale;var r=this.MARGIN;const l=this.RTL?r:r+this.tabWidth_;for(let G=0,Ie;Ie=e[G];G++)if(Ie.type==="block"){var p=Ie.block;if(!p)continue;var v=p.getDescendants(!1);for(let Mn=0,On;On=v[Mn];Mn++)On.isInFlyout=!0;v=p.getSvgRoot();const Qe=p.getHeightWidth();var O=p.outputConnection?l-this.tabWidth_:l;p.moveBy(O,r),O=this.createRect_(p,this.RTL?O-Qe.width:O,r,Qe,G),this.addBlockListeners_(v,p,O),r+=Qe.height+t[G]}else Ie.type==="button"&&(p=Ie.button,this.initFlyoutButton_(p,l,r),r+=p.height+t[G])}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<t&&e>-t||e<-180+t||e>180-t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.left;return this.toolboxPosition_===Rt.LEFT?new Bt(-1e9,1e9,-1e9,t+e.width):new Bt(-1e9,1e9,t,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=0;var t=this.workspace_.getTopBlocks(!1);for(let l=0,p;p=t[l];l++){var r=p.getHeightWidth().width;p.outputConnection&&(r-=this.tabWidth_),e=Math.max(e,r)}for(let l=0,p;p=this.buttons_[l];l++)e=Math.max(e,p.width);if(e+=1.5*this.MARGIN+this.tabWidth_,e*=this.workspace_.scale,e+=Fn.scrollbarThickness,this.width_!==e){for(let l=0,p;p=t[l];l++){if(this.RTL){r=p.getRelativeToSurfaceXY().x;let v=e/this.workspace_.scale-this.MARGIN;p.outputConnection||(v-=this.tabWidth_),p.moveBy(v-r,0)}this.rectMap_.has(p)&&this.moveRectToBlock_(this.rectMap_.get(p),p)}if(this.RTL)for(let l=0,p;p=this.buttons_[l];l++)t=p.getPosition().y,p.moveTo(e/this.workspace_.scale-p.width-this.MARGIN-this.tabWidth_,t);this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==Rt.LEFT||this.targetWorkspace.translate(this.targetWorkspace.scrollX+e,this.targetWorkspace.scrollY),this.width_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};Xg.registryName="verticalFlyout",i(Be.FLYOUTS_VERTICAL_TOOLBOX,Nr,Xg);var d$=class extends lh{constructor(e){super(e),this.horizontalLayout=!0}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),r=t.getScrollMetrics(),l=t.getViewMetrics();t=t.getAbsoluteMetrics(),typeof e.x=="number"&&(this.workspace_.scrollX=-(r.left+(r.width-l.width)*e.x)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){return 0}getY(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),r=e.getViewMetrics();e=e.getToolboxMetrics();const l=this.toolboxPosition_===Rt.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?l?e.height:r.height-this.height_:l?0:r.height:l?0:r.height+t.top-this.height_}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=e.width,this.setBackgroundPath(e.width-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),e=this.getX();var t=this.getY();this.positionAt_(this.width_,this.height_,e,t)}}setBackgroundPath(e,t){const r=this.toolboxPosition_===Rt.TOP,l=["M 0,"+(r?0:this.CORNER_RADIUS)];r?(l.push("h",e+2*this.CORNER_RADIUS),l.push("v",t),l.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),l.push("h",-e),l.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(l.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),l.push("h",e),l.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),l.push("v",t),l.push("h",-e-2*this.CORNER_RADIUS)),l.push("z"),this.svgBackground_.setAttribute("d",l.join(" "))}scrollToStart(){let e;(e=this.workspace_.scrollbar)==null||e.setX(this.RTL?1/0:0)}wheel_(e){var t=ge(e);if(t=t.x||t.y){const r=this.workspace_.getMetricsManager(),l=r.getScrollMetrics();t=r.getViewMetrics().left-l.left+t;let p;(p=this.workspace_.scrollbar)==null||p.setX(t),gc(this.workspace_),Jr()}e.preventDefault(),e.stopPropagation()}layout_(e,t){this.workspace_.scale=this.targetWorkspace.scale;const r=this.MARGIN;let l=r+this.tabWidth_;this.RTL&&(e=e.reverse());for(let G=0,Ie;Ie=e[G];G++)if(Ie.type==="block"){var p=Ie.block;if(p==null)continue;var v=p.getDescendants(!1);for(let Mn=0,On;On=v[Mn];Mn++)On.isInFlyout=!0;v=p.getSvgRoot();const Qe=p.getHeightWidth();var O=p.outputConnection?this.tabWidth_:0;O=this.RTL?l+Qe.width:l-O,p.moveBy(O,r),O=this.createRect_(p,O,r,Qe,G),l+=Qe.width+t[G],this.addBlockListeners_(v,p,O)}else Ie.type==="button"&&(p=Ie.button,this.initFlyoutButton_(p,l,r),l+=p.width+t[G])}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<90+t&&e>90-t||e>-90-t&&e<-90+t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.top;return this.toolboxPosition_===Rt.TOP?new Bt(-1e9,t+e.height,-1e9,1e9):new Bt(t,1e9,-1e9,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=0;const t=this.workspace_.getTopBlocks(!1);for(let l=0,p;p=t[l];l++)e=Math.max(e,p.getHeightWidth().height);const r=this.buttons_;for(let l=0,p;p=r[l];l++)e=Math.max(e,p.height);if(e+=1.5*this.MARGIN,e*=this.workspace_.scale,e+=Fn.scrollbarThickness,this.height_!==e){for(let l=0,p;p=t[l];l++)this.rectMap_.has(p)&&this.moveRectToBlock_(this.rectMap_.get(p),p);this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==Rt.TOP||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+e),this.height_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};i(Be.FLYOUTS_HORIZONTAL_TOOLBOX,Nr,d$);var u=class extends rr{constructor(e,t,r,l,p){super(vn.SKIP_SETUP),this.defaultType="",this.variableTypes=[],this.variable=null,this.SERIALIZABLE=!0,this.menuGenerator_=u.dropdownCreate,this.defaultVariableName=typeof e=="string"?e:"",this.size_=new Jt(0,0),e!==vn.SKIP_SETUP&&(p?this.configure_(p):this.setTypes(r,l),t&&this.setValidator(t))}configure_(e){super.configure_(e),this.setTypes(e.variableTypes,e.defaultType)}initModel(){var e=this.getSourceBlock();if(!e)throw new Gn;this.variable||(e=s.getOrCreateVariablePackage$$module$build$src$core$variables(e.workspace,null,this.defaultVariableName,this.defaultType),this.doValueUpdate_(e.getId()))}shouldAddBorderRect_(){const e=this.getSourceBlock();if(!e)throw new Gn;return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||e.type!=="variables_get")}fromXml(e){var t=this.getSourceBlock();if(!t)throw new Gn;const r=e.getAttribute("id"),l=e.textContent,p=e.getAttribute("variabletype")||e.getAttribute("variableType")||"";if(t=s.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,r,l,p),p!==null&&p!==t.type)throw Error("Serialized variable type with id '"+t.getId()+"' had type "+t.type+", and does not match variable field that references it: "+ci(e)+".");this.setValue(t.getId())}toXml(e){return this.initModel(),e.id=this.variable.getId(),e.textContent=this.variable.name,this.variable.type&&e.setAttribute("variabletype",this.variable.type),e}saveState(e){var t=this.saveLegacyState(u);return t!==null||(this.initModel(),t={id:this.variable.getId()},e&&(t.name=this.variable.name,t.type=this.variable.type)),t}loadState(e){const t=this.getSourceBlock();if(!t)throw new Gn;this.loadLegacyState(u,e)||(e=s.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,e.id||null,e.name,e.type||""),this.setValue(e.getId()))}setSourceBlock(e){if(e.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(e)}getValue(){return this.variable?this.variable.getId():null}getText(){return this.variable?this.variable.name:""}getVariable(){return this.variable}getValidator(){return this.variable?this.validator_:null}doClassValidation_(e){if(e===null)return null;var t=this.getSourceBlock();if(!t)throw new Gn;return t=s.getVariable$$module$build$src$core$variables(t.workspace,e),t?(t=t.type,this.typeIsAllowed(t)?e:(console.warn("Variable type doesn't match this field!  Type was "+t),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+e),null)}doValueUpdate_(e){const t=this.getSourceBlock();if(!t)throw new Gn;this.variable=s.getVariable$$module$build$src$core$variables(t.workspace,e),super.doValueUpdate_(e)}typeIsAllowed(e){const t=this.getVariableTypes();if(!t)return!0;for(let r=0;r<t.length;r++)if(e===t[r])return!0;return!1}getVariableTypes(){var e=this.variableTypes;if(e===null&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())return this.sourceBlock_.workspace.getVariableTypes();if(e=e||[""],e.length===0)throw e=this.getText(),Error("'variableTypes' of field variable "+e+" was an empty list");return e}setTypes(e=null,t=""){if(Array.isArray(e)){let r=!1;for(let l=0;l<e.length;l++)e[l]===t&&(r=!0);if(!r)throw Error("Invalid default type '"+t+"' in the definition of a FieldVariable")}else if(e!==null)throw Error("'variableTypes' was not an array in the definition of a FieldVariable");this.defaultType=t,this.variableTypes=e}refreshVariableName(){this.forceRerender()}onItemSelected_(e,t){if(e=t.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(e===Ug){s.renameVariable$$module$build$src$core$variables(this.sourceBlock_.workspace,this.variable);return}if(e===Wg){this.sourceBlock_.workspace.deleteVariableById(this.variable.getId());return}}this.setValue(e)}referencesVariables(){return!0}static fromJson(e){return new this(kt(e.variable),void 0,void 0,void 0,e)}static dropdownCreate(){if(!this.variable)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");const e=this.getText();let t=[];if(this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())for(var r=this.getVariableTypes(),l=0;l<r.length;l++){const p=this.sourceBlock_.workspace.getVariablesOfType(r[l]);t=t.concat(p)}for(t.sort(Uc.compareByName),r=[],l=0;l<t.length;l++)r[l]=[t[l].name,t[l].getId()];return r.push([s.Msg$$module$build$src$core$msg.RENAME_VARIABLE,Ug]),s.Msg$$module$build$src$core$msg.DELETE_VARIABLE&&r.push([s.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",e),Wg]),r}};Ot("field_variable",u);var d=class extends ih{constructor(e,t,r,l,p,v){super(vn.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces=null,this.spellcheck_=!1,e!==vn.SKIP_SETUP&&(v?this.configure_(v):this.setConstraints(t,r,l),this.setValue(e),p&&this.setValidator(p))}configure_(e){super.configure_(e),this.setMinInternal(e.min),this.setMaxInternal(e.max),this.setPrecisionInternal(e.precision)}setConstraints(e,t,r){this.setMinInternal(e),this.setMaxInternal(t),this.setPrecisionInternal(r),this.setValue(this.getValue())}setMin(e){this.setMinInternal(e),this.setValue(this.getValue())}setMinInternal(e){e==null?this.min_=-1/0:(e=Number(e),isNaN(e)||(this.min_=e))}getMin(){return this.min_}setMax(e){this.setMaxInternal(e),this.setValue(this.getValue())}setMaxInternal(e){e==null?this.max_=1/0:(e=Number(e),isNaN(e)||(this.max_=e))}getMax(){return this.max_}setPrecision(e){this.setPrecisionInternal(e),this.setValue(this.getValue())}setPrecisionInternal(e){this.precision_=Number(e)||0;let t=String(this.precision_);t.includes("e")&&(t=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const r=t.indexOf(".");this.decimalPlaces=r===-1?e?0:null:t.length-r-1}getPrecision(){return this.precision_}doClassValidation_(e){return e===null||(e=`${e}`.replace(/O/gi,"0"),e=e.replace(/,/g,""),e=e.replace(/infinity/i,"Infinity"),e=Number(e||0),isNaN(e))?null:(e=Math.min(Math.max(e,this.min_),this.max_),this.precision_&&isFinite(e)&&(e=Math.round(e/this.precision_)*this.precision_),this.decimalPlaces!==null&&(e=Number(e.toFixed(this.decimalPlaces))),e)}widgetCreate_(){const e=super.widgetCreate_();return-1/0<this.min_&&(e.min=`${this.min_}`,tn(e,as.VALUEMIN,this.min_)),1/0>this.max_&&(e.max=`${this.max_}`,tn(e,as.VALUEMAX,this.max_)),e}static fromJson(e){return new this(e.value,void 0,void 0,void 0,void 0,e)}};Ot("field_number",d),d.prototype.DEFAULT_VALUE=0;var m=class extends La{constructor(e,t,r){super(String(e??""),t,r),this.EDITABLE=!1,this.SERIALIZABLE=!0}static fromJson(e){return new this(kt(e.text),void 0,e)}};Ot("field_label_serializable",m);var _=class extends vn{constructor(e,t,r){super(vn.SKIP_SETUP),this.SERIALIZABLE=!0,this.CURSOR="default",this.value_=this.value_,this.checkChar=_.CHECK_CHAR,e!==vn.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.checkCharacter&&(this.checkChar=e.checkCharacter)}saveState(){const e=this.saveLegacyState(_);return e!==null?e:this.getValueBoolean()}initView(){super.initView();const e=this.getTextElement();Fe(e,"blocklyCheckbox"),e.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar}setCheckCharacter(e){this.checkChar=e||_.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(e){return e===!0||e==="TRUE"?"TRUE":e===!1||e==="FALSE"?"FALSE":null}doValueUpdate_(e){this.value_=this.convertValueToBool(e),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool(this.value_))}convertValueToBool(e){return typeof e=="string"?e==="TRUE":!!e}static fromJson(e){return new this(e.checked,void 0,e)}};_.CHECK_CHAR="",Ot("field_checkbox",_),_.prototype.DEFAULT_VALUE=!1;var x=class{constructor(e,t){this.draggable=e,this.workspace=t,this.dragTarget=null,this.startLoc=e.getRelativeToSurfaceXY()}onDragStart(e){this.draggable.startDrag(e)}onDrag(e,t){this.moveDraggable(e,t),t=this.getRoot(this.draggable),Dn(t)&&t.setDeleteStyle(this.wouldDeleteDraggable(e,t)),this.updateDragTarget(e)}updateDragTarget(e){e=this.workspace.getDragTarget(e);const t=this.getRoot(this.draggable);if(this.dragTarget!==e){let r;(r=this.dragTarget)==null||r.onDragExit(t),e==null||e.onDragEnter(t)}e==null||e.onDragOver(t),this.dragTarget=e}moveDraggable(e,t){t=this.pixelsToWorkspaceUnits(t),t=Le.sum(this.startLoc,t),this.draggable.drag(t,e)}wouldDeleteDraggable(e,t){return(e=this.workspace.getDragTarget(e))&&this.workspace.getComponentManager().hasCapability(e.id,pn.Capability.DELETE_AREA)?e.wouldDelete(t):!1}onDragEnd(e){const t=s.getGroup$$module$build$src$core$events$utils();var r=this.workspace.getDragTarget(e);const l=this.getRoot(this.draggable);if(r){let p;(p=this.dragTarget)==null||p.onDrop(l)}this.shouldReturnToStart(e,l)&&this.draggable.revertDrag(),(r=Dn(l)&&this.wouldDeleteDraggable(e,l))&&this.draggable instanceof Ur&&Hu(this.draggable.getRootBlock()),this.draggable.endDrag(e),r&&Dn(l)&&(e=s.getGroup$$module$build$src$core$events$utils(),s.setGroup$$module$build$src$core$events$utils(t),l.dispose(),s.setGroup$$module$build$src$core$events$utils(e))}getRoot(e){return e instanceof Ur?e.getRootBlock():e}shouldReturnToStart(e,t){return(e=this.workspace.getDragTarget(e))?e.shouldPreventMove(t):!1}pixelsToWorkspaceUnits(e){return e=new Le(e.x/this.workspace.scale,e.y/this.workspace.scale),this.workspace.isMutator&&e.scale(1/this.workspace.options.parentWorkspace.scale),e}};i(Be.BLOCK_DRAGGER,Nr,x);var L={};L.BlockDragStrategy=Vb,L.BubbleDragStrategy=Ob,L.CommentDragStrategy=Eb,L.Dragger=x;var V=class extends Es{constructor(e,t,r){super(e?e.workspace.id:void 0),this.type=fe.BLOCK_DRAG,e&&(this.blockId=e.id,this.isStart=t,this.blocks=r)}toJson(){const e=super.toJson();if(this.isStart===void 0)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(this.blockId===void 0)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.isStart=this.isStart,e.blockId=this.blockId,e.blocks=this.blocks,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new V),t.isStart=e.isStart,t.blockId=e.blockId,t.blocks=e.blocks,t}};i(Be.EVENT,fe.BLOCK_DRAG,V);var Q=class extends Sa{constructor(e,t,r,l){super(e),this.type=fe.BLOCK_FIELD_INTERMEDIATE_CHANGE,this.recordUndo=!1,e&&(this.name=t,this.oldValue=r,this.newValue=l)}toJson(){const e=super.toJson();if(!this.name)throw Error("The changed field name is undefined. Either pass a name to the constructor, or call fromJson.");return e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Q),t.name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,t}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(t=t.getBlockById(this.blockId),!t)throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");e=e?this.newValue:this.oldValue,(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name)}};i(Be.EVENT,fe.BLOCK_FIELD_INTERMEDIATE_CHANGE,Q);var le=class extends Sa{constructor(e){super(e),this.type=fe.BLOCK_MOVE,e&&(e.isShadow()&&(this.recordUndo=!1),e=this.currentLocation(),this.oldParentId=e.parentId,this.oldInputName=e.inputName,this.oldCoordinate=e.coordinate)}toJson(){const e=super.toJson();return e.oldParentId=this.oldParentId,e.oldInputName=this.oldInputName,this.oldCoordinate&&(e.oldCoordinate=`${Math.round(this.oldCoordinate.x)}, ${Math.round(this.oldCoordinate.y)}`),e.newParentId=this.newParentId,e.newInputName=this.newInputName,this.newCoordinate&&(e.newCoordinate=`${Math.round(this.newCoordinate.x)}, ${Math.round(this.newCoordinate.y)}`),this.reason&&(e.reason=this.reason),this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new le),t.oldParentId=e.oldParentId,t.oldInputName=e.oldInputName,e.oldCoordinate&&(r=e.oldCoordinate.split(","),t.oldCoordinate=new Le(Number(r[0]),Number(r[1]))),t.newParentId=e.newParentId,t.newInputName=e.newInputName,e.newCoordinate&&(r=e.newCoordinate.split(","),t.newCoordinate=new Le(Number(r[0]),Number(r[1]))),e.reason!==void 0&&(t.reason=e.reason),e.recordUndo!==void 0&&(t.recordUndo=e.recordUndo),t}recordNew(){const e=this.currentLocation();this.newParentId=e.parentId,this.newInputName=e.inputName,this.newCoordinate=e.coordinate}setReason(e){this.reason=e}currentLocation(){var e=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var t=e.getBlockById(this.blockId);if(!t)throw Error("The block associated with the block move event could not be found");e={};const r=t.getParent();return r?(e.parentId=r.id,(t=r.getInputWithBlock(t))&&(e.inputName=t.name)):e.coordinate=t.getRelativeToSurfaceXY(),e}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&Le.equals(this.oldCoordinate,this.newCoordinate)}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var r=t.getBlockById(this.blockId);if(r){var l=e?this.newParentId:this.oldParentId,p=e?this.newInputName:this.oldInputName;if(e=e?this.newCoordinate:this.oldCoordinate,l){var v=t.getBlockById(l);if(!v){console.warn("Can't connect to non-existent block: "+l);return}}if(r.getParent()&&r.unplug(),e)p=r.getRelativeToSurfaceXY(),r.moveBy(e.x-p.x,e.y-p.y,this.reason);else{t=r.outputConnection,(!t||r.previousConnection&&r.previousConnection.isConnected())&&(t=r.previousConnection);let O,G;r=(G=t)==null?void 0:G.type,p?(r=v.getInput(p))&&(O=r.connection):r===Ze.PREVIOUS_STATEMENT&&(O=v.nextConnection),O&&t?t.connect(O):console.warn("Can't connect to non-existent input: "+p)}}else console.warn("Can't move non-existent block: "+this.blockId)}};i(Be.EVENT,fe.BLOCK_MOVE,le);var Me=class extends Es{constructor(e,t,r){super(e?e.workspace.id:void 0),this.type=fe.BUBBLE_OPEN,e&&(this.blockId=e.id,this.isOpen=t,this.bubbleType=r)}toJson(){const e=super.toJson();if(this.isOpen===void 0)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(!this.bubbleType)throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e.bubbleType=this.bubbleType,e.blockId=this.blockId||"",e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Me),t.isOpen=e.isOpen,t.bubbleType=e.bubbleType,t.blockId=e.blockId,t}},Ne;(function(e){e.MUTATOR="mutator",e.COMMENT="comment",e.WARNING="warning"})(Ne||(Ne={})),i(Be.EVENT,fe.BUBBLE_OPEN,Me);var Pe=class extends ba{constructor(e){super(),this.isBlank=!e,e&&(this.commentId=e.id,this.workspaceId=e.workspace.id,this.group=s.getGroup$$module$build$src$core$events$utils(),this.recordUndo=se())}toJson(){const e=super.toJson();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.commentId=this.commentId,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Pe),t.commentId=e.commentId,t}static CommentCreateDeleteHelper(e,t){const r=e.getEventWorkspace_();if(t){if(!e.json)throw Error("Encountered a comment event without proper json");ss(e.json,r)}else{if(!e.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(t=r.getCommentById(e.commentId))?t.dispose():console.warn("Can't delete non-existent comment: "+e.commentId)}}},qe=class extends Pe{constructor(e,t,r){super(e),this.type=fe.COMMENT_CHANGE,e&&(this.oldContents_=typeof t>"u"?"":t,this.newContents_=typeof r>"u"?"":r)}toJson(){const e=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newContents_)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");return e.oldContents=this.oldContents_,e.newContents=this.newContents_,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new qe),t.oldContents_=e.oldContents,t.newContents_=e.newContents,t}isNull(){return this.oldContents_===this.newContents_}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){var r=e?this.newContents_:this.oldContents_;if(r===void 0)throw Error(e?"The new contents is undefined. Either pass a value to the constructor, or call fromJson":"The old contents is undefined. Either pass a value to the constructor, or call fromJson");t.setText(r)}else console.warn("Can't change non-existent comment: "+this.commentId)}};i(Be.EVENT,fe.COMMENT_CHANGE,qe);var dt=class extends Pe{constructor(e,t){super(e),this.newCollapsed=t,this.type=fe.COMMENT_COLLAPSE}toJson(){const e=super.toJson();if(this.newCollapsed===void 0)throw Error("The new collapse value undefined. Either call recordNew, or call fromJson");return e.newCollapsed=this.newCollapsed,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new dt),t.newCollapsed=e.newCollapsed,t}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(t=t.getCommentById(this.commentId))?t.setCollapsed(e?!!this.newCollapsed:!this.newCollapsed):console.warn("Can't collapse or uncollapse non-existent comment: "+this.commentId)}};i(Be.EVENT,fe.COMMENT_COLLAPSE,dt);var $t=class extends Pe{constructor(e){super(e),this.type=fe.COMMENT_CREATE,e&&(this.xml=bc(e),this.json=In(e,{addCoordinates:!0}))}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=ci(this.xml),e.json=this.json,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new $t),t.xml=s.textToDom$$module$build$src$core$utils$xml(e.xml),t.json=e.json,t}run(e){Pe.CommentCreateDeleteHelper(this,e)}};i(Be.EVENT,fe.COMMENT_CREATE,$t);var Ut=class extends Pe{constructor(e){super(e),this.type=fe.COMMENT_DELETE,e&&(this.xml=bc(e),this.json=In(e,{addCoordinates:!0}))}run(e){Pe.CommentCreateDeleteHelper(this,!e)}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=ci(this.xml),e.json=this.json,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Ut),t.xml=s.textToDom$$module$build$src$core$utils$xml(e.xml),t.json=e.json,t}};i(Be.EVENT,fe.COMMENT_DELETE,Ut);var vt=class extends Es{constructor(e,t){super(e?e.workspace.id:void 0),this.type=fe.COMMENT_DRAG,e&&(this.commentId=e.id,this.isStart=t)}toJson(){const e=super.toJson();if(this.isStart===void 0)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(this.commentId===void 0)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.isStart=this.isStart,e.commentId=this.commentId,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new vt),t.isStart=e.isStart,t.commentId=e.commentId,t}};i(Be.EVENT,fe.COMMENT_DRAG,vt);var Xt=class extends Pe{constructor(e){super(e),this.type=fe.COMMENT_MOVE,e&&(this.comment_=e,this.oldCoordinate_=e.getRelativeToSurfaceXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getRelativeToSurfaceXY()}setReason(e){this.reason=e}setOldCoordinate(e){this.oldCoordinate_=e}toJson(){const e=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newCoordinate_)throw Error("The new comment position is undefined. Either call recordNew, or call fromJson");return e.oldCoordinate=`${Math.round(this.oldCoordinate_.x)}, ${Math.round(this.oldCoordinate_.y)}`,e.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new Xt),r=e.oldCoordinate.split(","),t.oldCoordinate_=new Le(Number(r[0]),Number(r[1])),r=e.newCoordinate.split(","),t.newCoordinate_=new Le(Number(r[0]),Number(r[1])),t}isNull(){return Le.equals(this.oldCoordinate_,this.newCoordinate_)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(e=e?this.newCoordinate_:this.oldCoordinate_,!e)throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");t.moveTo(e)}else console.warn("Can't move non-existent comment: "+this.commentId)}};i(Be.EVENT,fe.COMMENT_MOVE,Xt);var en=class extends Pe{constructor(e){super(e),this.type=fe.COMMENT_RESIZE,e&&(this.oldSize=e.getSize())}recordCurrentSizeAsNewSize(){if(this.newSize)throw Error("Tried to record the new size of a comment on the same event twice.");var e=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(e=e.getCommentById(this.commentId),!e)throw Error("The comment associated with the comment resize event could not be found");this.newSize=e.getSize()}toJson(){const e=super.toJson();if(!this.oldSize)throw Error("The old comment size is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newSize)throw Error("The new comment size is undefined. Either call recordCurrentSizeAsNewSize, or call fromJson");return e.oldWidth=Math.round(this.oldSize.width),e.oldHeight=Math.round(this.oldSize.height),e.newWidth=Math.round(this.newSize.width),e.newHeight=Math.round(this.newSize.height),e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new en),t.oldSize=new Jt(e.oldWidth,e.oldHeight),t.newSize=new Jt(e.newWidth,e.newHeight),t}isNull(){return Jt.equals(this.oldSize,this.newSize)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(e=e?this.newSize:this.oldSize,!e)throw Error("Either oldSize or newSize is undefined. Either pass a comment to the constructor and call recordCurrentSizeAsNewSize, or call fromJson");t.setSize(e)}else console.warn("Can't resize non-existent comment: "+this.commentId)}};i(Be.EVENT,fe.COMMENT_RESIZE,en);var zs=class extends Es{constructor(e,t,r){super(r),this.type=fe.TOOLBOX_ITEM_SELECT,this.oldItem=e??void 0,this.newItem=t??void 0}toJson(){const e=super.toJson();return e.oldItem=this.oldItem,e.newItem=this.newItem,e}static fromJson(e,t,r){return t=super.fromJson(e,t,r??new zs),t.oldItem=e.oldItem,t.newItem=e.newItem,t}};i(Be.EVENT,fe.TOOLBOX_ITEM_SELECT,zs);var As=class extends ba{constructor(e){super(),this.isBlank=!0,this.recordUndo=!1,this.type=fe.FINISHED_LOADING,this.isBlank=!!e,e&&(this.workspaceId=e.id)}};i(Be.EVENT,fe.FINISHED_LOADING,As);var ar,Kn,Hr,Ci,Zg,iC,oC,aC,lC,cC,uC,dC,hC,pC,gC,fC,mC,bC,$C,vC,yC,_C,wC,CC,SC,Ye;s.BLOCK_CHANGE$$module$build$src$core$events$events=fe.BLOCK_CHANGE,s.BLOCK_CREATE$$module$build$src$core$events$events=fe.BLOCK_CREATE,s.BLOCK_DELETE$$module$build$src$core$events$events=fe.BLOCK_DELETE,ar=fe.BLOCK_DRAG,s.BLOCK_MOVE$$module$build$src$core$events$events=fe.BLOCK_MOVE,Kn=fe.BLOCK_FIELD_INTERMEDIATE_CHANGE,Hr=fe.BUBBLE_OPEN,Ci=fe.BLOCK_CHANGE,Zg=fe.CLICK,iC=fe.COMMENT_CHANGE,oC=fe.COMMENT_CREATE,aC=fe.COMMENT_DELETE,lC=fe.COMMENT_MOVE,cC=fe.COMMENT_RESIZE,uC=fe.COMMENT_DRAG,dC=fe.BLOCK_CREATE,hC=fe.BLOCK_DELETE,pC=fe.FINISHED_LOADING,gC=fe.MARKER_MOVE,fC=fe.BLOCK_MOVE,mC=fe.SELECTED,bC=fe.THEME_CHANGE,$C=fe.TOOLBOX_ITEM_SELECT,vC=fe.TRASHCAN_OPEN,yC=fe.UI,_C=fe.VAR_CREATE,wC=fe.VAR_DELETE,CC=fe.VAR_RENAME,SC=fe.VIEWPORT_CHANGE,Ye={},Ye.Abstract=ba,Ye.BLOCK_CHANGE=s.BLOCK_CHANGE$$module$build$src$core$events$events,Ye.BLOCK_CREATE=s.BLOCK_CREATE$$module$build$src$core$events$events,Ye.BLOCK_DELETE=s.BLOCK_DELETE$$module$build$src$core$events$events,Ye.BLOCK_DRAG=ar,Ye.BLOCK_FIELD_INTERMEDIATE_CHANGE=Kn,Ye.BLOCK_MOVE=s.BLOCK_MOVE$$module$build$src$core$events$events,Ye.BUBBLE_OPEN=Hr,Ye.BUMP_EVENTS=Up,Ye.BlockBase=Sa,Ye.BlockChange=Xi,Ye.BlockCreate=xg,Ye.BlockDelete=Pg,Ye.BlockDrag=V,Ye.BlockFieldIntermediateChange=Q,Ye.BlockMove=le,Ye.BubbleOpen=Me,Ye.BubbleType=Ne,Ye.CHANGE=Ci,Ye.CLICK=Zg,Ye.COMMENT_CHANGE=iC,Ye.COMMENT_CREATE=oC,Ye.COMMENT_DELETE=aC,Ye.COMMENT_DRAG=uC,Ye.COMMENT_MOVE=lC,Ye.COMMENT_RESIZE=cC,Ye.CREATE=dC,Ye.Click=$a,Ye.ClickTarget=Gp,Ye.CommentBase=Pe,Ye.CommentChange=qe,Ye.CommentCollapse=dt,Ye.CommentCreate=$t,Ye.CommentDelete=Ut,Ye.CommentDrag=vt,Ye.CommentMove=Xt,Ye.CommentResize=en,Ye.DELETE=hC,Ye.FINISHED_LOADING=pC,Ye.FinishedLoading=As,Ye.MARKER_MOVE=gC,Ye.MOVE=fC,Ye.MarkerMove=jg,Ye.SELECTED=mC,Ye.Selected=Vg,Ye.THEME_CHANGE=bC,Ye.TOOLBOX_ITEM_SELECT=$C,Ye.TRASHCAN_OPEN=vC,Ye.ThemeChange=Dg,Ye.ToolboxItemSelect=zs,Ye.TrashcanOpen=Kg,Ye.UI=yC,Ye.UiBase=Es,Ye.VAR_CREATE=_C,Ye.VAR_DELETE=wC,Ye.VAR_RENAME=CC,Ye.VIEWPORT_CHANGE=SC,Ye.VarBase=zc,Ye.VarCreate=gg,Ye.VarDelete=Hg,Ye.VarRename=Kd,Ye.ViewportChange=Ag,Ye.clearPendingUndo=W,Ye.disable=s.disable$$module$build$src$core$events$utils,Ye.disableOrphans=at,Ye.enable=s.enable$$module$build$src$core$events$utils,Ye.filter=ce,Ye.fire=ee,Ye.fromJson=ze,Ye.get=Ce,Ye.getDescendantIds=Z,Ye.getGroup=s.getGroup$$module$build$src$core$events$utils,Ye.getRecordUndo=se,Ye.isEnabled=te,Ye.setGroup=s.setGroup$$module$build$src$core$events$utils,Ye.setRecordUndo=s.setRecordUndo$$module$build$src$core$events$utils;var io={};io.BottomRow=t$,io.ConstantProvider=sh,io.Drawer=rh,io.MarkerSvg=i$,io.PathObject=o$,io.RenderInfo=r$,io.Renderer=Yg,io.RightConnectionShape=n$,io.StatementInput=ah,io.TopRow=s$,gd();var ys={};ys.registerCleanup=Op,ys.registerCollapse=ad,ys.registerCollapseExpandBlock=Np,ys.registerComment=Sc,ys.registerCommentCreate=Qs,ys.registerCommentDelete=Bp,ys.registerCommentDuplicate=Pp,ys.registerCommentOptions=pd,ys.registerDefaultOptions=gd,ys.registerDelete=fa,ys.registerDeleteAll=ud,ys.registerDisable=Lp,ys.registerDuplicate=Mp,ys.registerExpand=Rp,ys.registerHelp=hd,ys.registerInline=Ht,ys.registerRedo=Cl,ys.registerUndo=id;var h$={};h$.CommentView=Bd,h$.RenderedWorkspaceComment=Pd,h$.WorkspaceComment=Xc;var Qg={};Qg.Bubble=fn,Qg.MiniWorkspaceBubble=vs,Qg.TextBubble=ir,Qg.TextInputBubble=Mb;var TC=class extends Vd{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(e){return super.getCSS_(e).concat([`${e} .blocklyInsertionMarker>.blocklyPathLight,`,`${e} .blocklyInsertionMarker>.blocklyPathDark {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"])}},kC=class{constructor(e){this.inlineSteps_=this.steps_="",this.info_=e,this.RTL_=this.info_.RTL,e=e.getRenderer(),this.constants_=e.getConstants(),this.highlightConstants_=e.getHighlightConstants(),this.highlightOffset=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+`
`+this.inlineSteps_}drawTopCorner(e){this.steps_+=xn(e.xPos,this.info_.startY);for(let t=0,r;r=e.elements[t];t++)J.isLeftSquareCorner(r)?this.steps_+=this.highlightConstants_.START_POINT:J.isLeftRoundedCorner(r)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):J.isPreviousConnection(r)?this.steps_+=this.notchPaths_.pathLeft:J.isHat(r)?this.steps_+=this.startPaths_.path(this.RTL_):J.isSpacer(r)&&r.width!==0&&(this.steps_+=tt("H",r.xPos+r.width-this.highlightOffset));this.steps_+=tt("H",e.xPos+e.width-this.highlightOffset)}drawJaggedEdge_(e){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+tt("v",e.height-this.jaggedTeethPaths_.height-this.highlightOffset))}drawValueInput(e){const t=e.getLastInput();if(this.RTL_){const r=e.height-t.connectionHeight;this.steps_+=is(t.xPos+t.width-this.highlightOffset,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+tt("v",r)}else this.steps_+=is(t.xPos+t.width,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(e){const t=e.getLastInput();if(t)if(this.RTL_){const r=e.height-2*this.insideCornerPaths_.height;this.steps_+=is(t.xPos,e.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+tt("v",r)+this.insideCornerPaths_.pathBottom(this.RTL_)+hi(e.width-t.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=is(t.xPos,e.yPos+e.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+hi(e.width-t.xPos-this.insideCornerPaths_.width,0)}drawRightSideRow(e){const t=e.xPos+e.width-this.highlightOffset;e instanceof Lg&&e.followsStatement&&(this.steps_+=tt("H",t)),this.RTL_&&(this.steps_+=tt("H",t),e.height>this.highlightOffset&&(this.steps_+=tt("V",e.yPos+e.height-this.highlightOffset)))}drawBottomRow(e){if(this.RTL_)this.steps_+=tt("V",e.baseline-this.highlightOffset);else{const t=this.info_.bottomRow.elements[0];J.isLeftSquareCorner(t)?this.steps_+=is(e.xPos+this.highlightOffset,e.baseline-this.highlightOffset):J.isLeftRoundedCorner(t)&&(this.steps_+=is(e.xPos,e.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}}drawLeft(){var e=this.info_.outputConnection;e&&(e=e.connectionOffsetY+e.height,this.RTL_?this.steps_+=is(this.info_.startX,e):(this.steps_+=is(this.info_.startX+this.highlightOffset,this.info_.bottomRow.baseline-this.highlightOffset),this.steps_+=tt("V",e)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(e=this.info_.topRow,J.isLeftRoundedCorner(e.elements[0])?this.steps_+=tt("V",this.outsideCornerPaths_.height):this.steps_+=tt("V",e.capline+this.highlightOffset))}drawInlineInput(e){const t=this.highlightOffset,r=e.xPos+e.connectionWidth;var l=e.centerline-e.height/2;const p=e.width-e.connectionWidth,v=l+t;this.RTL_?(l=e.connectionOffsetY-t,e=e.height-(e.connectionOffsetY+e.connectionHeight)+t,this.inlineSteps_+=is(r-t,v)+tt("v",l)+this.puzzleTabPaths_.pathDown(this.RTL_)+tt("v",e)+tt("h",p)):this.inlineSteps_+=is(e.xPos+e.width+t,v)+tt("v",e.height)+tt("h",-p)+is(r,l+e.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},EC=class extends Fl{constructor(e,t){super(e,t),this.highlighter_=new kC(t)}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights();const e=this.block_.pathObject;e.setPath(this.outlinePath_+`
`+this.inlinePath_),e.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(e){this.highlighter_.drawJaggedEdge_(e),super.drawJaggedEdge_(e)}drawValueInput_(e){this.highlighter_.drawValueInput(e),super.drawValueInput_(e)}drawStatementInput_(e){this.highlighter_.drawStatementInput(e),super.drawStatementInput_(e)}drawRightSideRow_(e){this.highlighter_.drawRightSideRow(e),this.outlinePath_+=tt("H",e.xPos+e.width)+tt("V",e.yPos+e.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(e){this.highlighter_.drawInlineInput(e),super.drawInlineInput_(e)}positionInlineInputConnection_(e){const t=e.centerline-e.height/2;if(e.connectionModel){let r=e.xPos+e.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(r*=-1),e.connectionModel.setOffsetInBlock(r,t+e.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(t!=null&&t.connectionModel){let r=e.xPos+e.statementEdge+t.notchOffset;r=this.info_.RTL?-1*r:r+this.constants_.DARK_PATH_OFFSET,t.connectionModel.setOffsetInBlock(r,e.yPos+this.constants_.DARK_PATH_OFFSET)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let r=e.xPos+e.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(r*=-1),t.connectionModel.setOffsetInBlock(r,e.yPos)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,r=t.xPos;t.connectionModel.setOffsetInBlock((this.info_.RTL?-r:r)+this.constants_.DARK_PATH_OFFSET/2,e.baseline+this.constants_.DARK_PATH_OFFSET)}}},IC=class{constructor(e){this.OFFSET=.5,this.constantProvider=e,this.START_POINT=xn(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,r=(1-Math.SQRT1_2)*(e+t)-t,l=xn(r,r)+Hn("a","0 0,0",e,ut(-r-t,e-r)),p=Hn("a","0 0,0",e+t,ut(e+t,e+t)),v=xn(r,-r)+Hn("a","0 0,0",e+t,ut(e-r,r+t));return{width:e+t,height:e,pathTop(O){return O?l:""},pathBottom(O){return O?p:v}}}makeOutsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,r=(1-Math.SQRT1_2)*(e-t)+t,l=xn(r,r)+Hn("a","0 0,1",e-t,ut(e-r,-r+t)),p=xn(t,e)+Hn("a","0 0,1",e-t,ut(e,-e+t)),v=-r,O=xn(r,v)+Hn("a","0 0,1",e-t,ut(-r+t,-v-e));return{height:e,topLeft(G){return G?l:p},bottomLeft(){return O}}}makePuzzleTab(){const e=this.constantProvider.TAB_WIDTH,t=this.constantProvider.TAB_HEIGHT,r=xn(-2,-t+3.4)+hi(-.45*e,-2.1),l=tt("v",2.5)+xn(.97*-e,2.5)+Zs("q",[ut(.05*-e,10),ut(.3*e,9.5)])+xn(.67*e,-1.9)+tt("v",2.5),p=tt("v",-1.5)+xn(-.92*e,-.5)+Zs("q",[ut(-.19*e,-5.5),ut(0,-11)])+xn(.92*e,1),v=xn(-5,t-.7)+hi(.46*e,-2.1);return{width:e,height:t,pathUp(O){return O?r:p},pathDown(O){return O?l:v}}}makeNotch(){return{pathLeft:tt("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:hi(5.1,2.6)+xn(-10.2,6.8)+hi(5.1,2.6),height:12,width:10.2}}makeStartHat(){const e=this.constantProvider.START_HAT.height,t=xn(25,-8.7)+Zs("c",[ut(29.7,-6.2),ut(57.2,-.5),ut(75,8.7)]),r=Zs("c",[ut(17.8,-9.2),ut(45.3,-14.9),ut(75,-8.7)])+is(100.5,e+.5);return{path(l){return l?t:r}}}},xC=class extends Mg{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},DC=class extends su{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},AC=class extends hs{constructor(e,t){super(e,t),this.renderer_=e}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof yr||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(e,t){this.isInline&&e instanceof s.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new xC(this.constants_,e)),t.hasInlineInput=!0):e instanceof yr?(t.elements.push(new DC(this.constants_,e)),t.hasStatement=!0):e instanceof s.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new cn(this.constants_,e)),t.hasExternalInput=!0):(e instanceof yi||e instanceof ro)&&(t.minHeight=Math.max(t.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),this.isInline||t.align!==null||(t.align=e.align)}addElemSpacing_(){let e=!1;for(let r=0,l;l=this.rows[r];r++)l.hasExternalInput&&(e=!0);for(let r=0,l;l=this.rows[r];r++){var t=l.elements;if(l.elements=[],l.startsWithElemSpacer()&&l.elements.push(new vr(this.constants_,this.getInRowSpacing_(null,t[0]))),t.length){for(let p=0;p<t.length-1;p++){l.elements.push(t[p]);const v=this.getInRowSpacing_(t[p],t[p+1]);l.elements.push(new vr(this.constants_,v))}l.elements.push(t[t.length-1]),l.endsWithElemSpacer()&&(t=this.getInRowSpacing_(t[t.length-1],null),e&&l.hasDummyInput&&(t+=this.constants_.TAB_WIDTH),l.elements.push(new vr(this.constants_,t)))}}}getInRowSpacing_(e,t){if(!e)return t&&J.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&J.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&J.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!J.isInput(e)&&(!t||J.isStatementInput(t)))return J.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:J.isIcon(e)?2*this.constants_.LARGE_PADDING+1:J.isHat(e)?this.constants_.NO_PADDING:J.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:J.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:J.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(J.isInput(e)&&!t){if(J.isExternalInput(e))return this.constants_.NO_PADDING;if(J.isInlineInput(e))return this.constants_.LARGE_PADDING;if(J.isStatementInput(e))return this.constants_.NO_PADDING}if(!J.isInput(e)&&t&&J.isInput(t)){if(J.isField(e)&&e.isEditable){if(J.isInlineInput(t)||J.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(J.isInlineInput(t)||J.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(J.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(J.isIcon(e)&&t&&!J.isInput(t))return this.constants_.LARGE_PADDING;if(J.isInlineInput(e)&&t&&J.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(J.isLeftSquareCorner(e)&&t){if(J.isHat(t))return this.constants_.NO_PADDING;if(J.isPreviousConnection(t))return t.notchOffset;if(J.isNextConnection(t))return t.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(J.isLeftRoundedCorner(e)&&t){if(J.isPreviousConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS;if(J.isNextConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return J.isField(e)&&t&&J.isField(t)&&e.isEditable===t.isEditable||t&&J.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return J.isTopRow(e)&&J.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:J.isTopRow(e)||J.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||!e.hasStatement&&t.hasDummyInput||e.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(J.isSpacer(t))return e.yPos+t.height/2;if(J.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,J.isNextConnection(t)?e+t.height/2:e-t.height/2;if(J.isTopRow(e))return J.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let r=e.yPos;return J.isField(t)||J.isIcon(t)?(r+=t.height/2,(e.hasInlineInput||e.hasStatement)&&t.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=e.height&&(r+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):r=J.isInlineInput(t)?r+t.height/2:r+e.height/2,r}alignRowElements_(){if(this.isInline){var e=0,t=new WeakMap,r=null;for(let l=this.rows.length-1,p;p=this.rows[l];l--)t.set(p,e),J.isInputRow(p)&&(p.hasStatement&&this.alignStatementRow_(p),r&&r.hasStatement&&p.width<r.width?t.set(p,r.width):e=p.hasStatement?p.width:Math.max(e,p.width),r=p);e=0;for(let l=0,p;p=this.rows[l];l++)p.hasStatement?e=this.getDesiredRowWidth_(p):J.isSpacer(p)?p.width=Math.max(e,t.get(p)):(r=p.width,e=Math.max(e,t.get(p))-r,0<e&&this.addAlignmentPadding_(p,e),e=p.width)}else super.alignRowElements_()}getDesiredRowWidth_(e){return this.isInline&&e.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(e)}finalize_(){let e=0,t=0;for(let l=0,p;p=this.rows[l];l++){p.yPos=t,p.xPos=this.startX,t+=p.height,e=Math.max(e,p.widthWithConnectedBlocks);var r=t-this.topRow.ascenderHeight;p===this.bottomRow&&r<this.constants_.MIN_BLOCK_HEIGHT&&(r=this.constants_.MIN_BLOCK_HEIGHT-r,this.bottomRow.height+=r,t+=r),this.recordElemPositions_(p)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(r=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,r.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=t+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},OC=class extends Gd{constructor(e,t,r){super(e,t,r),this.constants=r,this.colourDark="#000000",this.svgPathDark=re(oe.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=re(oe.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e),this.svgPathDark.setAttribute("d",e)}setHighlightPath(e){this.svgPathLight.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(e){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(e),this.svgPath.setAttribute("stroke","none")}setStyle(e){this.style=e,this.colourDark=et("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(e){e?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline")}updateShadow_(e){if(e){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(e){super.updateDisabled_(e),e&&this.svgPath.setAttribute("stroke","none")}},RC=class extends ou{constructor(e){super(e),this.highlightConstants=null}init(e,t){super.init(e,t),this.highlightConstants=this.makeHighlightConstants_(),this.highlightConstants.init()}refreshDom(e,t){super.refreshDom(e,t),this.getHighlightConstants().init()}makeConstants_(){return new TC}makeRenderInfo_(e){return new AC(this,e)}makeDrawer_(e,t){return new EC(e,t)}makePathObject(e,t){return new OC(e,t,this.getConstants())}makeHighlightConstants_(){return new IC(this.getConstants())}getHighlightConstants(){if(!this.highlightConstants)throw Error("Cannot access the highlight constants because init has not been called");return this.highlightConstants}};Wi("geras",RC);var jo={};jo.ConstantProvider=TC,jo.Drawer=EC,jo.HighlightConstantProvider=IC,jo.Highlighter=kC,jo.InlineInput=xC,jo.PathObject=OC,jo.RenderInfo=AC,jo.Renderer=RC,jo.StatementInput=DC;var MC=class extends hs{constructor(e,t){super(e,t)}getRenderer(){return this.renderer_}addElemSpacing_(){let e=!1;for(var t=0;t<this.rows.length;t++)if(this.rows[t].hasExternalInput){e=!0;break}for(t=0;t<this.rows.length;t++){const l=this.rows[t];var r=l.elements;if(l.elements=[],l.startsWithElemSpacer()&&l.elements.push(new vr(this.constants_,this.getInRowSpacing_(null,r[0]))),r.length){for(let p=0;p<r.length-1;p++){l.elements.push(r[p]);const v=this.getInRowSpacing_(r[p],r[p+1]);l.elements.push(new vr(this.constants_,v))}l.elements.push(r[r.length-1]),l.endsWithElemSpacer()&&(r=this.getInRowSpacing_(r[r.length-1],null),e&&l.hasDummyInput&&(r+=this.constants_.TAB_WIDTH),l.elements.push(new vr(this.constants_,r)))}}}getInRowSpacing_(e,t){if(!e)return t&&J.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&J.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&J.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!J.isInput(e)&&!t)return J.isField(e)&&e.isEditable?this.constants_.MEDIUM_PADDING:J.isIcon(e)?2*this.constants_.LARGE_PADDING+1:J.isHat(e)?this.constants_.NO_PADDING:J.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:J.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:J.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(J.isInput(e)&&!t){if(J.isExternalInput(e))return this.constants_.NO_PADDING;if(J.isInlineInput(e))return this.constants_.LARGE_PADDING;if(J.isStatementInput(e))return this.constants_.NO_PADDING}if(!J.isInput(e)&&t&&J.isInput(t)){if(J.isField(e)&&e.isEditable){if(J.isInlineInput(t)||J.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(J.isInlineInput(t)||J.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(J.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(J.isIcon(e)&&t&&!J.isInput(t))return this.constants_.LARGE_PADDING;if(J.isInlineInput(e)&&t&&J.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(J.isLeftSquareCorner(e)&&t){if(J.isHat(t))return this.constants_.NO_PADDING;if(J.isPreviousConnection(t)||J.isNextConnection(t))return t.notchOffset}return J.isLeftRoundedCorner(e)&&t?t.notchOffset-this.constants_.CORNER_RADIUS:J.isField(e)&&t&&J.isField(t)&&e.isEditable===t.isEditable||t&&J.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return J.isTopRow(e)&&J.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:J.isTopRow(e)||J.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||e.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(J.isSpacer(t))return e.yPos+t.height/2;if(J.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,J.isNextConnection(t)?e+t.height/2:e-t.height/2;if(J.isTopRow(e))return J.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let r=e.yPos;return r=J.isField(t)&&e.hasStatement?r+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+t.height/2):r+e.height/2}finalize_(){let e=0,t=0;for(var r=0;r<this.rows.length;r++){const p=this.rows[r];p.yPos=t,p.xPos=this.startX,t+=p.height,e=Math.max(e,p.widthWithConnectedBlocks);var l=t-this.topRow.ascenderHeight;p===this.bottomRow&&l<this.constants_.MIN_BLOCK_HEIGHT&&(l=this.constants_.MIN_BLOCK_HEIGHT-l,this.bottomRow.height+=l,t+=l),this.recordElemPositions_(p)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(r=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,r.getHeightWidth().width)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline}},NC=class extends ou{constructor(e){super(e)}makeRenderInfo_(e){return new MC(this,e)}};Wi("thrasos",NC);var _y={};_y.RenderInfo=MC,_y.Renderer=NC;var dI={colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},hI={colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}},pI=new ts("zelos",dI,hI),gI={Classic:ei,Zelos:pI},wy=class{constructor(e,t,r){this.id_=e.toolboxitemid||C(),this.level_=(this.parent_=r||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=e,this.parentToolbox_=t,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return!1}isCollapsible(){return!1}dispose(){}setVisible_(e){}},oo=class extends wy{constructor(e,t,r){super(e,t,r),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),this.toolboxItemDef_.hidden==="true"&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"}}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else if(e=e.contents)for(let t=0;t<e.length;t++){const r=e[t];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(r)}}parseCategoryDef_(e){this.name_="name"in e?kt(e.name):"",this.colour_=this.getColour_(e),Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),Ts(this.htmlDiv_,Pr.TREEITEM),tn(this.htmlDiv_,as.SELECTED,!1),tn(this.htmlDiv_,as.LEVEL,this.level_+1),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),Ts(this.iconDom_,Pr.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);const e=this.labelDom_.getAttribute("id");return e&&tn(this.htmlDiv_,as.LABELLEDBY,e),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){const e=document.createElement("div"),t=this.cssConfig_.container;return t&&Fe(e,t),e}createRowContainer_(){const e=document.createElement("div");var t=this.cssConfig_.row;return t&&Fe(e,t),t=`${oo.nestedPadding*this.getLevel()}px`,this.workspace_.RTL?e.style.paddingRight=t:e.style.paddingLeft=t,e}createRowContentsContainer_(){const e=document.createElement("div"),t=this.cssConfig_.rowcontentcontainer;return t&&Fe(e,t),e}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&Fe(e,t)}return e.style.display="inline-block",e}createLabelDom_(e){const t=document.createElement("span");return t.setAttribute("id",this.getId()+".label"),t.textContent=e,(e=this.cssConfig_.label)&&Fe(t,e),t}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(e){e&&(e=oo.borderWidth+"px solid "+(e||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=e:this.rowDiv_.style.borderLeft=e)}getColour_(e){const t=e.categorystyle||e.categoryStyle;if((e=e.colour)&&t)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(t)return this.getColourfromStyle(t);if(e)return this.parseColour(e)}return""}getColourfromStyle(e){var t=this.workspace_.getTheme();if(e&&t){if((t=t.categoryStyles[e])&&t.colour)return this.parseColour(t.colour);console.warn('Style "'+e+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour(e){if(e=kt(e),e==null||e==="")return"";var t=Number(e);return isNaN(t)?(t=Or(e))?t:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+e),""):xt(t)}openIcon_(e){if(e){var t=this.cssConfig_.closedicon;t&&It(e,t),(t=this.cssConfig_.openicon)&&Fe(e,t)}}closeIcon_(e){if(e){var t=this.cssConfig_.openicon;t&&It(e,t),(t=this.cssConfig_.closedicon)&&Fe(e,t)}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none",this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(!1)}show(){this.setVisible_(!0)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let e=this;for(;e.getParent();)if(e=e.getParent(),!e.isExpanded())return!1;return!0}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(e){}setSelected(e){if(this.rowDiv_){var t=this.cssConfig_.selected;if(e){const r=this.parseColour(oo.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||r,t&&Fe(this.rowDiv_,t)}else this.rowDiv_.style.backgroundColor="",t&&pt(this.rowDiv_,t);tn(this.htmlDiv_,as.SELECTED,e)}}setDisabled(e){this.isDisabled_=e,this.getDiv().setAttribute("disabled",`${e}`),e?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(e){this.flyoutItems_=[],this.toolboxItemDef_=typeof e=="string"?{kind:this.toolboxItemDef_.kind,custom:e,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:pe(e),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){mt(this.htmlDiv_)}};oo.registrationName="category",oo.nestedPadding=19,oo.borderWidth=8,oo.defaultBackgroundColour="#57e",we(`
.blocklyTreeRow:not(.blocklyTreeSelected):hover {
  background-color: rgba(255, 255, 255, .2);
}

.blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {
  margin: 1px 5px 1px 0;
}

.blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {
  margin: 1px 0 1px 5px;
}

.blocklyTreeRow {
  height: 22px;
  line-height: 22px;
  margin-bottom: 3px;
  padding-right: 8px;
  white-space: nowrap;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {
  margin-left: 8px;
  padding-right: 0;
}

.blocklyTreeIcon {
  background-image: url(<<<PATH>>>/sprites.png);
  height: 16px;
  vertical-align: middle;
  visibility: hidden;
  width: 16px;
}

.blocklyTreeIconClosed {
  background-position: -32px -1px;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {
  background-position: 0 -1px;
}

.blocklyTreeSelected>.blocklyTreeIconClosed {
  background-position: -32px -17px;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {
  background-position: 0 -17px;
}

.blocklyTreeIconOpen {
  background-position: -16px -1px;
}

.blocklyTreeSelected>.blocklyTreeIconOpen {
  background-position: -16px -17px;
}

.blocklyTreeLabel {
  cursor: default;
  font: 16px sans-serif;
  padding: 0 3px;
  vertical-align: middle;
}

.blocklyToolboxDelete .blocklyTreeLabel {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyTreeSelected .blocklyTreeLabel {
  color: #fff;
}
`),i(Be.TOOLBOX_ITEM,oo.registrationName,oo);var ef=class extends wy{constructor(e,t){super(e,t),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv=null,Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}init(){this.createDom_()}createDom_(){const e=document.createElement("div"),t=this.cssConfig_.container;return t&&Fe(e,t),this.htmlDiv=e}getDiv(){return this.htmlDiv}dispose(){mt(this.htmlDiv)}};ef.registrationName="sep",we(`
.blocklyTreeSeparator {
  border-bottom: solid #e5e5e5 1px;
  height: 0;
  margin: 5px 0;
}

.blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {
  border-right: solid #e5e5e5 1px;
  border-bottom: none;
  height: auto;
  margin: 0 5px 0 5px;
  padding: 5px 0;
  width: 0;
}
`),i(Be.TOOLBOX_ITEM,ef.registrationName,ef);var ch=class extends oo{constructor(e,t,r){super(e,t,r),this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[]}makeDefaultCssConfig_(){const e=super.makeDefaultCssConfig_();return e.contents="blocklyToolboxContents",e}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else{const t=e.contents;if(t){this.flyoutItems_=[],e=!0;for(let r=0;r<t.length;r++){const l=t[r];!g(Be.TOOLBOX_ITEM,l.kind)||l.kind.toLowerCase()===ef.registrationName&&e?(this.flyoutItems_.push(l),e=!0):(this.createToolboxItem(l),e=!1)}}}}createToolboxItem(e){let t=e.kind;t.toUpperCase()==="CATEGORY"&&ae(e)&&(t=ch.registrationName),e=new(b(Be.TOOLBOX_ITEM,t))(e,this.parentToolbox_,this),this.toolboxItems_.push(e)}init(){super.init(),this.setExpanded(this.toolboxItemDef_.expanded==="true"||this.toolboxItemDef_.expanded===!0)}createDom_(){super.createDom_();const e=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(e),Ts(this.subcategoriesDiv_,Pr.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.closeIcon_(this.iconDom_),tn(this.htmlDiv_,as.EXPANDED,!1),this.htmlDiv_}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&Fe(e,t),e.style.visibility="visible"}return e.style.display="inline-block",e}createSubCategoriesDom_(e){const t=document.createElement("div");t.style.display="none";var r=this.cssConfig_.contents;for(r&&Fe(t,r),r=0;r<e.length;r++){const l=e[r];l.init();const p=l.getDiv();if(t.appendChild(p),l.getClickTarget){let v;(v=l.getClickTarget())==null||v.setAttribute("id",l.getId())}}return t}setExpanded(e){if(this.expanded_!==e){if(this.expanded_=e)this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_);else{let t;(t=this.parentToolbox_.getFlyout())==null||t.setVisible(!1),this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)}tn(this.htmlDiv_,as.EXPANDED,e),this.parentToolbox_.handleToolboxItemResize()}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none";const t=this.getChildToolboxItems();for(let r=0;r<t.length;r++)t[r].setVisible_(e);this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return!0}onClick(e){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}};ch.registrationName="collapsibleCategory",i(Be.TOOLBOX_ITEM,ch.registrationName,ch);var LC=class extends Yd{constructor(e){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.contents_=[],this.height_=this.width_=0,this.previouslySelectedItem_=this.selectedItem_=this.flyout=null,this.boundEvents_=[],this.workspace_=e,this.toolboxDef_=e.options.languageTree||{contents:[]},this.horizontalLayout=e.options.horizontalLayout,this.RTL=e.options.RTL,this.contentMap_=Object.create(null),this.toolboxPosition=e.options.toolboxPosition}onShortcut(e){return!1}init(){var e=this.workspace_;const t=e.getParentSvg();this.flyout=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),Cn(this.flyout.createDom("svg"),t),this.setVisible(!0),this.flyout.init(e),this.render(this.toolboxDef_),e=e.getThemeManager(),e.subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),e.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:pn.ComponentWeight.TOOLBOX_WEIGHT,capabilities:[pn.Capability.AUTOHIDEABLE,pn.Capability.DELETE_AREA,pn.Capability.DRAG_TARGET]})}createDom_(e){e=e.getParentSvg();const t=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),this.contentsDiv_.tabIndex=0,Ts(this.contentsDiv_,Pr.TREE),t.appendChild(this.contentsDiv_),e.parentNode.insertBefore(t,e),this.attachEvents_(t,this.contentsDiv_),t}createContainer_(){const e=document.createElement("div");return e.setAttribute("layout",this.isHorizontal()?"h":"v"),Fe(e,"blocklyToolboxDiv"),e.setAttribute("dir",this.RTL?"RTL":"LTR"),e}createContentsContainer_(){const e=document.createElement("div");return Fe(e,"blocklyToolboxContents"),this.isHorizontal()&&(e.style.flexDirection="row"),e}attachEvents_(e,t){e=Ue(e,"pointerdown",this,this.onClick_,!1),this.boundEvents_.push(e),t=Ue(t,"keydown",this,this.onKeyDown_,!1),this.boundEvents_.push(t)}onClick_(e){if(ct(e)||e.target===this.HtmlDiv)xe().hideChaff(!1);else{var t=e.target.getAttribute("id");t&&(t=this.getToolboxItemById(t),t.isSelectable()&&(this.setSelectedItem(t),t.onClick(e))),xe().hideChaff(!0)}ft()}onKeyDown_(e){let t=!1;switch(e.key){case"ArrowDown":t=this.selectNext();break;case"ArrowUp":t=this.selectPrevious();break;case"ArrowLeft":t=this.selectParent();break;case"ArrowRight":t=this.selectChild();break;case"Enter":case" ":this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),t=!0);break;default:t=!1}!t&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(t=this.selectedItem_.onKeyDown(e)),t&&e.preventDefault()}createFlyout_(){const e=this.workspace_,t=new zr({parentWorkspace:e,rtl:e.RTL,oneBasedIndex:e.options.oneBasedIndex,horizontalLayout:e.horizontalLayout,renderer:e.options.renderer,rendererOverrides:e.options.rendererOverrides,move:{scrollbars:!0}});return t.toolboxPosition=e.options.toolboxPosition,new(e.horizontalLayout?w(Be.FLYOUTS_HORIZONTAL_TOOLBOX,e.options,!0):w(Be.FLYOUTS_VERTICAL_TOOLBOX,e.options,!0))(t)}render(e){this.toolboxDef_=e;for(let t=0;t<this.contents_.length;t++){const r=this.contents_[t];r&&r.dispose()}this.contents_=[],this.contentMap_=Object.create(null),this.renderContents_(e.contents),this.position(),this.handleToolboxItemResize()}renderContents_(e){const t=document.createDocumentFragment();for(let r=0;r<e.length;r++)this.createToolboxItem(e[r],t);this.contentsDiv_.appendChild(t)}createToolboxItem(e,t){var r=e.kind;r.toUpperCase()==="CATEGORY"&&ae(e)&&(r=ch.registrationName),(r=b(Be.TOOLBOX_ITEM,r.toLowerCase()))&&(e=new r(e,this),e.init(),this.addToolboxItem_(e),(r=e.getDiv())&&t.appendChild(r),e.getClickTarget()&&e.getClickTarget().setAttribute("id",e.getId()))}addToolboxItem_(e){if(this.contents_.push(e),this.contentMap_[e.getId()]=e,e.isCollapsible()){e=e.getChildToolboxItems();for(let t=0;t<e.length;t++)this.addToolboxItem_(e[t])}}getToolboxItems(){return this.contents_}addStyle(e){e&&this.HtmlDiv&&Fe(this.HtmlDiv,e)}removeStyle(e){e&&this.HtmlDiv&&pt(this.HtmlDiv,e)}getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var e=this.HtmlDiv.getBoundingClientRect();const t=e.top,r=t+e.height,l=e.left;return e=l+e.width,this.toolboxPosition===Rt.TOP?new Bt(-1e7,r,-1e7,1e7):this.toolboxPosition===Rt.BOTTOM?new Bt(t,1e7,-1e7,1e7):this.toolboxPosition===Rt.LEFT?new Bt(-1e7,1e7,-1e7,e):new Bt(-1e7,1e7,l,1e7)}wouldDelete(e){return e instanceof Ur?this.updateWouldDelete_(!e.getParent()&&e.isDeletable()):this.updateWouldDelete_(Dn(e)&&e.isDeletable()),this.wouldDelete_}onDragEnter(e){this.updateCursorDeleteStyle_(!0)}onDragExit(e){this.updateCursorDeleteStyle_(!1)}onDrop(e){this.updateCursorDeleteStyle_(!1)}updateWouldDelete_(e){e!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=e,this.updateCursorDeleteStyle_(!0))}updateCursorDeleteStyle_(e){const t=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";e?this.addStyle(t):this.removeStyle(t)}getToolboxItemById(e){return this.contentMap_[e]||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout}position(){const e=this.workspace_.getMetrics(),t=this.HtmlDiv;t&&(this.horizontalLayout?(t.style.left="0",t.style.height="auto",t.style.width="100%",this.height_=t.offsetHeight,this.width_=e.viewWidth,this.toolboxPosition===Rt.TOP?t.style.top="0":t.style.bottom="0"):(this.toolboxPosition===Rt.RIGHT?t.style.right="0":t.style.left="0",t.style.height="100%",this.width_=t.offsetWidth,this.height_=e.viewHeight),this.flyout.position())}handleToolboxItemResize(){const e=this.workspace_,t=this.HtmlDiv.getBoundingClientRect();e.translate(this.toolboxPosition===Rt.LEFT?e.scrollX+t.width:e.scrollX,this.toolboxPosition===Rt.TOP?e.scrollY+t.height:e.scrollY),Je(e)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){for(let e=0;e<this.contents_.length;e++){const t=this.contents_[e];t.refreshTheme&&t.refreshTheme()}}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout.show(this.selectedItem_.getContents())}setVisible(e){this.isVisible_!==e&&(this.HtmlDiv.style.display=e?"block":"none",this.isVisible_=e,this.workspace_.recordDragTargets())}autoHide(e){!e&&this.flyout&&this.flyout.autoClose&&this.clearSelection()}setSelectedItem(e){const t=this.selectedItem_;!e&&!t||e&&!fd(e)||(this.shouldDeselectItem_(t,e)&&t!==null&&this.deselectItem_(t),this.shouldSelectItem_(t,e)&&e!==null&&this.selectItem_(t,e),this.updateFlyout_(t,e),this.fireSelectEvent(t,e))}shouldDeselectItem_(e,t){return e!==null&&(!e.isCollapsible()||e!==t)}shouldSelectItem_(e,t){return t!==null&&t!==e}deselectItem_(e){this.selectedItem_=null,this.previouslySelectedItem_=e,e.setSelected(!1),tn(this.contentsDiv_,as.ACTIVEDESCENDANT,"")}selectItem_(e,t){this.selectedItem_=t,this.previouslySelectedItem_=e,t.setSelected(!0),tn(this.contentsDiv_,as.ACTIVEDESCENDANT,t.getId())}selectItemByPosition(e){-1<e&&e<this.contents_.length&&(e=this.contents_[e],e.isSelectable()&&this.setSelectedItem(e))}updateFlyout_(e,t){t&&(e!==t||t.isCollapsible())&&t.getContents().length?(this.flyout.show(t.getContents()),this.flyout.scrollToStart()):this.flyout.hide()}fireSelectEvent(e,t){const r=e&&e.getName();let l=t&&t.getName();e===t&&(l=null),e=new(Ce(fe.TOOLBOX_ITEM_SELECT))(r,l,this.workspace_.id),ee(e)}selectParent(){return this.selectedItem_?this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),!0):this.selectedItem_.getParent()&&this.selectedItem_.getParent().isSelectable()?(this.setSelectedItem(this.selectedItem_.getParent()),!0):!1:!1}selectChild(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;const e=this.selectedItem_;return e.isExpanded()?this.selectNext():e.toggleExpanded(),!0}selectNext(){if(!this.selectedItem_)return!1;let e=this.contents_.indexOf(this.selectedItem_)+1;if(-1<e&&e<this.contents_.length){let t=this.contents_[e];for(;t&&!t.isSelectable();)t=this.contents_[++e];if(t&&t.isSelectable())return this.setSelectedItem(t),!0}return!1}selectPrevious(){if(!this.selectedItem_)return!1;let e=this.contents_.indexOf(this.selectedItem_)-1;if(-1<e&&e<this.contents_.length){let t=this.contents_[e];for(;t&&!t.isSelectable();)t=this.contents_[--e];if(t&&t.isSelectable())return this.setSelectedItem(t),!0}return!1}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout.dispose();for(var e=0;e<this.contents_.length;e++)this.contents_[e].dispose();for(e=0;e<this.boundEvents_.length;e++)wt(this.boundEvents_[e]);this.boundEvents_=[],this.contents_=[],this.HtmlDiv&&(this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),mt(this.HtmlDiv))}};we(`
.blocklyToolboxDelete {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyToolboxGrab {
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

/* Category tree in Toolbox. */
.blocklyToolboxDiv {
  background-color: #ddd;
  overflow-x: visible;
  overflow-y: auto;
  padding: 4px 0 4px 0;
  position: absolute;
  z-index: 70;  /* so blocks go under toolbox when dragging */
  -webkit-tap-highlight-color: transparent;  /* issue #1345 */
}

.blocklyToolboxContents {
  display: flex;
  flex-wrap: wrap;
  flex-direction: column;
}

.blocklyToolboxContents:focus {
  outline: none;
}
`),i(Be.TOOLBOX,Nr,LC);var fI="11.2.2",mI=Ze.INPUT_VALUE,bI=Ze.OUTPUT_VALUE,$I=Ze.NEXT_STATEMENT,vI=Ze.PREVIOUS_STATEMENT,yI=Rt.TOP,_I=Rt.BOTTOM,wI=Rt.LEFT,CI=Rt.RIGHT;zl.prototype.newBlock=function(e,t){return new Lo(this,e,t)},Cr.prototype.newBlock=function(e,t){return new Ur(this,e,t)},zl.prototype.newComment=function(e){return new Xc(this,e)},Cr.prototype.newComment=function(e){return new Pd(this,e)},Cr.newTrashcan=function(e){return new Yb(e)},vs.prototype.newWorkspaceSvg=function(e){return new Cr(e)},s.Names$$module$build$src$core$names.prototype.populateProcedures=function(e){e=qu(e),e=e[0].concat(e[1]);for(let t=0;t<e.length;t++)this.getName(e[t][0],s.Names$$module$build$src$core$names.NameType.PROCEDURE)};var ye={};return ye.ASTNode=Oe,ye.BasicCursor=lu,ye.Block=Lo,ye.BlockSvg=Ur,ye.Blocks=tr,ye.COLLAPSED_FIELD_NAME=Dd,ye.COLLAPSED_INPUT_NAME=jc,ye.COLLAPSE_CHARS=Pa,ye.CodeGenerator=s.CodeGenerator$$module$build$src$core$generator,ye.CollapsibleToolboxCategory=ch,ye.ComponentManager=pn,ye.Connection=sn,ye.ConnectionChecker=Wb,ye.ConnectionDB=Ll,ye.ConnectionType=Ze,ye.ContextMenu=Ra,ye.ContextMenuItems=ys,ye.ContextMenuRegistry=zt,ye.Css=wd,ye.Cursor=Gg,ye.DELETE_VARIABLE_ID=Wg,ye.DeleteArea=Yd,ye.DragTarget=qb,ye.DropDownDiv=Is,ye.Events=Ye,ye.Extensions=ti,ye.Field=vn,ye.FieldCheckbox=_,ye.FieldDropdown=rr,ye.FieldImage=Fa,ye.FieldLabel=La,ye.FieldLabelSerializable=m,ye.FieldNumber=d,ye.FieldTextInput=oh,ye.FieldVariable=u,ye.Flyout=lh,ye.FlyoutButton=_r,ye.FlyoutMetricsManager=u$,ye.Generator=s.CodeGenerator$$module$build$src$core$generator,ye.Gesture=Qi,ye.Grid=eo,ye.HorizontalFlyout=d$,ye.INPUT_VALUE=mI,ye.Input=No,ye.InsertionMarkerManager=wr,ye.InsertionMarkerPreviewer=a$,ye.Marker=Gb,ye.MarkerManager=Gc,ye.Menu=ug,ye.MenuItem=xd,ye.MetricsManager=qg,ye.Msg=s.Msg$$module$build$src$core$msg,ye.NEXT_STATEMENT=$I,ye.Names=s.Names$$module$build$src$core$names,ye.OPPOSITE_TYPE=ja,ye.OUTPUT_VALUE=bI,ye.Options=zr,ye.PREVIOUS_STATEMENT=vI,ye.PROCEDURE_CATEGORY_NAME=Wd,ye.Procedures=js,ye.RENAME_VARIABLE_ID=Ug,ye.RenderedConnection=Fs,ye.Scrollbar=Fn,ye.ScrollbarPair=Jg,ye.ShortcutItems=Wr,ye.ShortcutRegistry=un,ye.TOOLBOX_AT_BOTTOM=_I,ye.TOOLBOX_AT_LEFT=wI,ye.TOOLBOX_AT_RIGHT=CI,ye.TOOLBOX_AT_TOP=yI,ye.TabNavigateCursor=Kb,ye.Theme=ts,ye.ThemeManager=Ub,ye.Themes=gI,ye.Toolbox=LC,ye.ToolboxCategory=oo,ye.ToolboxItem=wy,ye.ToolboxSeparator=ef,ye.Tooltip=br,ye.Touch=Ki,ye.Trashcan=Yb,ye.UnattachedFieldError=Gn,ye.VARIABLE_CATEGORY_NAME=fg,ye.VARIABLE_DYNAMIC_CATEGORY_NAME=zg,ye.VERSION=fI,ye.VariableMap=Jd,ye.VariableModel=Uc,ye.Variables=$s,ye.VariablesDynamic=Ba,ye.VerticalFlyout=Xg,ye.WidgetDiv=Fr,ye.Workspace=zl,ye.WorkspaceAudio=Hb,ye.WorkspaceDragger=xb,ye.WorkspaceSvg=Cr,ye.Xml=xs,ye.ZoomControls=og,ye.blockAnimations=Qc,ye.blockRendering=gn,ye.browserEvents=gt,ye.bubbles=Qg,ye.bumpObjects=qd,ye.clipboard=uu,ye.comments=h$,ye.common=ms,ye.config=s.config$$module$build$src$core$config,ye.constants=ry,ye.defineBlocksWithJsonArray=nt,ye.dialog=Yi,ye.dragging=L,ye.fieldRegistry=Fd,ye.geras=jo,ye.getMainWorkspace=xe,ye.getSelected=ne,ye.hasBubble=Ya,ye.hideChaff=Fp,ye.icons=Ro,ye.inject=zm,ye.inputs=Po,ye.isCopyable=da,ye.isDeletable=Dn,ye.isDraggable=ui,ye.isIcon=$p,ye.isObservable=Ju,ye.isPaster=jp,ye.isRenderedElement=er,ye.isSelectable=Vi,ye.isSerializable=qs,ye.isVariableBackedParameterModel=Eu,ye.layers=Ld,ye.procedures=js,ye.registry=ks,ye.renderManagement=Fc,ye.serialization=vy,ye.setLocale=pg,ye.setParentContainer=Te,ye.svgResize=Je,ye.thrasos=_y,ye.uiPosition=fr,ye.utils=Ln,ye.zelos=io,ye.__namespace__=s,ye})})(Mw);var $M=Mw.exports;const vM=Ga($M),{ASTNode:_le,BasicCursor:wle,Block:Cle,BlockSvg:Sle,Blocks:Tle,COLLAPSED_FIELD_NAME:kle,COLLAPSED_INPUT_NAME:Ele,COLLAPSE_CHARS:Ile,CodeGenerator:xle,CollapsibleToolboxCategory:Dle,ComponentManager:Ale,Connection:Ole,ConnectionChecker:Rle,ConnectionDB:Mle,ConnectionType:Nle,ContextMenu:Lle,ContextMenuItems:Ble,ContextMenuRegistry:Ple,Css:jle,Cursor:Fle,DELETE_VARIABLE_ID:zle,DeleteArea:Ule,DragTarget:Wle,DropDownDiv:Hle,Events:Vle,Extensions:Gle,Field:Kle,FieldCheckbox:Jle,FieldDropdown:qle,FieldImage:Yle,FieldLabel:Xle,FieldLabelSerializable:Zle,FieldNumber:Qle,FieldTextInput:ece,FieldVariable:tce,Flyout:nce,FlyoutButton:sce,FlyoutMetricsManager:rce,Generator:ice,Gesture:oce,Grid:ace,HorizontalFlyout:lce,INPUT_VALUE:cce,Input:uce,InsertionMarkerManager:dce,InsertionMarkerPreviewer:hce,Marker:pce,MarkerManager:gce,Menu:fce,MenuItem:mce,MetricsManager:bce,Msg:$ce,NEXT_STATEMENT:vce,Names:yce,OPPOSITE_TYPE:_ce,OUTPUT_VALUE:wce,Options:Cce,PREVIOUS_STATEMENT:Sce,PROCEDURE_CATEGORY_NAME:Tce,Procedures:kce,RENAME_VARIABLE_ID:Ece,RenderedConnection:Ice,Scrollbar:xce,ScrollbarPair:Dce,ShortcutItems:Ace,ShortcutRegistry:Oce,TOOLBOX_AT_BOTTOM:Rce,TOOLBOX_AT_LEFT:Mce,TOOLBOX_AT_RIGHT:Nce,TOOLBOX_AT_TOP:Lce,TabNavigateCursor:Bce,Theme:yM,ThemeManager:Pce,Themes:_M,Toolbox:jce,ToolboxCategory:Fce,ToolboxItem:zce,ToolboxSeparator:Uce,Tooltip:Wce,Touch:Hce,Trashcan:Vce,UnattachedFieldError:Gce,VARIABLE_CATEGORY_NAME:Kce,VARIABLE_DYNAMIC_CATEGORY_NAME:Jce,VERSION:qce,VariableMap:Yce,VariableModel:Xce,Variables:Zce,VariablesDynamic:Qce,VerticalFlyout:eue,WidgetDiv:tue,Workspace:nue,WorkspaceAudio:sue,WorkspaceDragger:rue,WorkspaceSvg:iue,Xml:oue,ZoomControls:aue,blockAnimations:lue,blockRendering:cue,browserEvents:uue,bubbles:due,bumpObjects:hue,clipboard:pue,comments:gue,common:fue,config:mue,constants:bue,defineBlocksWithJsonArray:$ue,dialog:vue,dragging:yue,fieldRegistry:_ue,geras:wue,getMainWorkspace:Cue,getSelected:Sue,hasBubble:Tue,hideChaff:kue,icons:Eue,inject:Iue,inputs:xue,isCopyable:Due,isDeletable:Aue,isDraggable:Oue,isIcon:Rue,isObservable:Mue,isPaster:Nue,isRenderedElement:Lue,isSelectable:Bue,isSerializable:Pue,isVariableBackedParameterModel:jue,layers:Fue,procedures:zue,registry:Uue,renderManagement:Wue,serialization:Hue,setLocale:Vue,setParentContainer:Gue,svgResize:Kue,thrasos:Jue,uiPosition:que,utils:Yue,zelos:Xue}=vM;/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const GS=yM.defineTheme("dark",{base:_M.Classic,componentStyles:{workspaceBackgroundColour:"#1e1e1e",toolboxBackgroundColour:"blackBackground",toolboxForegroundColour:"#fff",flyoutBackgroundColour:"#252526",flyoutForegroundColour:"#ccc",flyoutOpacity:1,scrollbarColour:"#797979",insertionMarkerColour:"#fff",insertionMarkerOpacity:.3,scrollbarOpacity:.4,cursorColour:"#d0d0d0",blackBackground:"#333"}}),of={textArea:{width:"100%",height:"100%",overflow:"auto"},textAreaLight:{background:"lightgray"},dialog:{height:"95%"},typography:{padding:16},overflowY:{overflowY:"hidden"}};class Ek extends We.Component{constructor(n){super(n),this.state={anchorEl:null,popper:""}}handleCancel(){this.props.onClose()}onCopy(n){I.Utils.copyToClipboard(this.props.text);const s=n.currentTarget;setTimeout(()=>{this.setState({popper:I.I18n.t("Copied"),anchorEl:s}),setTimeout(()=>this.setState({popper:"",anchorEl:null}),1e3)},50)}render(){const n=new Blob([this.props.text],{type:"application/xml"}),s=`${this.props.scriptId.substring(10)}.xml`;return f.jsxs(D.Dialog,{onClose:()=>!1,maxWidth:"lg",sx:{"& .MuiDialog-paper":of.dialog},fullWidth:!0,open:!0,"aria-labelledby":"export-dialog-title",children:[f.jsx(D.DialogTitle,{id:"export-dialog-title",children:I.I18n.t("Export selected blocks")}),f.jsx(D.DialogContent,{style:of.overflowY,children:f.jsx("pre",{id:"export-text",style:{...of.textArea,...this.props.themeType==="dark"?void 0:of.textAreaLight},children:this.props.text})}),f.jsxs(D.DialogActions,{children:[f.jsx(D.Button,{variant:"contained",color:"secondary",startIcon:f.jsx(G$,{}),children:f.jsx("a",{download:s,target:"_blank",rel:"noreferrer",href:URL.createObjectURL(n),style:{textDecoration:"inherit",color:"inherit"},children:I.I18n.t("Download as file")})}),f.jsx(D.Button,{variant:"contained",onClick:i=>this.onCopy(i),color:"secondary",startIcon:f.jsx(ST,{}),children:I.I18n.t("Copy to clipboard")}),f.jsx(D.Button,{variant:"contained",onClick:()=>this.handleCancel(),color:"primary",startIcon:f.jsx(Jo,{}),children:I.I18n.t("Close")}),f.jsx(D.Popper,{id:"popper",style:{zIndex:1e4},open:!!this.state.popper,placement:"top",anchorEl:this.state.anchorEl,transition:!0,children:({TransitionProps:i})=>f.jsx(D.Fade,{...i,timeout:350,children:f.jsx(D.Paper,{children:f.jsx("p",{style:of.typography,children:this.state.popper})})})}),f.jsx("textarea",{id:"copy_input",readOnly:!0,style:{position:"absolute",left:-9999},tabIndex:-1,"aria-hidden":!0,value:this.props.text})]})]},"export-dialog")}}const Ws={textArea:{width:"calc(100% - 10px)",height:"calc(80% - 20px)",resize:"none",fontFamily:"monospace",fontSize:"1em",backgroundColor:"transparent",borderRadius:4,outline:"none"},dropzone:{marginTop:20,width:"100%",borderWidth:5,borderStyle:"dashed",borderColor:"#d0cccc",textAlign:"center",boxSizing:"border-box",paddingTop:45,borderRadius:10,height:"calc(100% - 10px)"},dropzoneDiv:{width:"100%",height:"20%",position:"relative"},dropzoneRejected:{borderColor:"#970000"},dropzoneAccepted:{borderColor:"#17cd02"},icon:{height:"80%",width:"80%",opacity:.3,color:"#eeeeee",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",zIndex:0},iconError:{color:"#ffc3c6"},iconOk:{color:"#aaeebc"},text:{top:"50%",left:"50%",transform:"translate(-50%,-50%)",color:"#868686",position:"absolute",zIndex:1},dialog:{height:"95%"},fullHeight:{height:"100%",overflow:"hidden"}};class Kv extends We.Component{constructor(n){super(n),this.state={text:"",imageStatus:"",error:""}}componentDidMount(){setTimeout(()=>{var n;try{(n=window.document.getElementById("import-text-area"))==null||n.focus()}catch{}},100)}static readFileDataUrl(n,s){const i=new FileReader;i.onload=()=>{s(null,{data:i.result,name:n.name})},i.onabort=()=>{console.error("file reading was aborted"),s(I.I18n.t("file reading was aborted"))},i.onerror=a=>{console.error("file reading has failed"),s(I.I18n.t("file reading has failed: %s",a))},i.readAsText(n)}handleDropFile(n){if(!(n!=null&&n.length))return;const s=n[n.length-1];s&&Kv.readFileDataUrl(s,(i,a)=>{var c;i||!a?this.setState({error:i||"No data"}):this.setState({text:((c=a.data)==null?void 0:c.toString())||""})})}handleCancel(){this.props.onClose()}handleOk(){this.props.onClose(this.state.text)}onChange(n){this.setState({text:n.target.value})}render(){const n={...Ws.dropzone,...this.state.imageStatus==="accepted"?Ws.dropzoneAccepted:this.state.imageStatus==="rejected"?Ws.dropzoneRejected:void 0};return f.jsxs(D.Dialog,{onClose:()=>!1,maxWidth:"lg",sx:{"& .MuiDialog-paper":Ws.dialog},fullWidth:!0,open:!0,"aria-labelledby":"import-dialog-title",children:[f.jsx(D.DialogTitle,{id:"import-dialog-title",children:I.I18n.t("Import blocks")}),f.jsxs(D.DialogContent,{style:Ws.fullHeight,children:[f.jsx("textarea",{autoFocus:!0,id:"import-text-area",placeholder:I.I18n.t("Paste your blocks here"),style:{...Ws.textArea,color:this.props.themeType==="dark"?"#ffffff":"#000000"},onChange:s=>this.onChange(s),value:this.state.text}),f.jsx(U0,{maxSize:5e7,onDrop:(s,i)=>{var a,c,h;s.length?this.handleDropFile(s):window.alert(((h=(c=(a=i==null?void 0:i[0])==null?void 0:a.errors)==null?void 0:c[0])==null?void 0:h.message)||I.I18n.t("ra_Cannot upload"))},multiple:!1,accept:{"text/plain":[],"text/xml":[],"application/xml":[]},children:({getRootProps:s,getInputProps:i,isDragActive:a,isDragReject:c})=>c?(this.state.imageStatus!=="rejected"&&this.setState({imageStatus:"rejected"}),f.jsxs("div",{style:{...n,...Ws.dropzoneDiv},...s(),children:[f.jsx("input",{...i()}),f.jsx("span",{style:Ws.text,children:I.I18n.t("Some files will be rejected")},"text"),f.jsx(Iv,{style:{...Ws.icon,...Ws.iconError}},"icon")]})):a?(this.state.imageStatus!=="accepted"&&this.setState({imageStatus:"accepted"}),f.jsxs("div",{style:{...n,...Ws.dropzoneDiv},...s(),children:[f.jsx("input",{...i()}),f.jsx("span",{style:Ws.text,children:I.I18n.t("All files will be accepted")},"text"),f.jsx(Ev,{style:{...Ws.icon,...Ws.iconOk}},"icon")]})):(this.state.imageStatus!=="wait"&&this.setState({imageStatus:"wait"}),f.jsxs("div",{style:{...n,...Ws.dropzoneDiv},...s(),children:[f.jsx("input",{...i()}),f.jsx("span",{style:Ws.text,children:I.I18n.t("Drop some files here or click...")},"text"),f.jsx(W0,{style:Ws.icon},"icon")]}))})]}),f.jsxs(D.DialogActions,{children:[f.jsx(D.Button,{variant:"contained",disabled:!this.state.text,onClick:()=>this.handleOk(),color:"primary",startIcon:f.jsx(Va,{}),children:I.I18n.t("Import")}),f.jsx(D.Button,{color:"grey",variant:"contained",onClick:()=>this.handleCancel(),startIcon:f.jsx(Jo,{}),children:I.I18n.t("Close")})]})]})}}/**
 * @license
 * Copyright 2023 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yt=window.Blockly;class Uy extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}}class nv extends yt.Field{textGroup=null;borderRect_=null;maxLines_=1/0;isOverflowedY_=!1;constructor(n,s,i){super(n),n!==Symbol("SKIP_SETUP")&&(i&&this.configure_(i),this.SERIALIZABLE=!0,this.setValue((n==null?void 0:n.toString())||""),s&&this.setValidator(s))}configure_(n){super.configure_(n),n.maxLines&&this.setMaxLines(n.maxLines)}toXml(n){return n.textContent=this.getValue().replace(/\n/g,"&#10;"),n}fromXml(n){this.setValue(n.textContent.replace(/&#10;/g,`
`))}saveState(){const n=this.saveLegacyState(nv);return n!==null?n:this.getValue()}loadState(n){this.loadLegacyState(yt.Field,n)||this.setValue(n)}initView(){this.createBorderRect_(),this.textGroup=yt.utils.dom.createSvgElement(yt.utils.Svg.G,{class:"blocklyEditableText"},this.fieldGroup_)}onHtmlInputKeyDownSuper_(n){n.key==="Enter"?(yt.WidgetDiv.hideIfOwner(this),yt.dropDownDiv.hideWithoutAnimation()):n.key==="Escape"?(this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value"),!1),yt.WidgetDiv.hideIfOwner(this),yt.dropDownDiv.hideWithoutAnimation()):n.key==="Tab"&&(yt.WidgetDiv.hideIfOwner(this),yt.dropDownDiv.hideWithoutAnimation(),this.sourceBlock_.tab(this,!n.shiftKey),n.preventDefault())}onHtmlInputChange_(n){const s=this.value_;this.setValue(this.getValueFromEditorText_(this.htmlInput_.value),!1),this.sourceBlock_&&yt.Events.isEnabled()&&this.value_!==s&&yt.Events.fire(new(yt.Events.get("block_field_intermediate_change"))(this.sourceBlock_,this.name||null,s,this.value_))}onFinishEditing_(n){}getValueFromEditorText_(n){return n}bindInputEvents_(n){this.onKeyDownWrapper_=yt.browserEvents.conditionalBind(n,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=yt.browserEvents.conditionalBind(n,"input",this,this.onHtmlInputChange_)}getDisplayText_(){const n=this.getSourceBlock();if(!n)throw new Error("The field has not yet been attached to its input. Call appendField to attach it.");let s=this.getText();if(!s)return yt.Field.NBSP;const i=s.split(`
`);s="";const a=this.isOverflowedY_?this.maxLines_:i.length;for(let c=0;c<a;c++){let h=i[c]||"";h.length>this.maxDisplayLength?h=`${h.substring(0,this.maxDisplayLength-4)}...`:this.isOverflowedY_&&c===a-1&&(h=`${h.substring(0,h.length-3)}...`),h=h.replace(/\s/g,yt.Field.NBSP),s+=h,c!==a-1&&(s+=`
`)}return n.RTL&&(s+=""),s}doValueUpdate_(n){super.doValueUpdate_(n),this.value_!==null&&(this.isOverflowedY_=this.value_.split(`
`).length>this.maxLines_)}render_(){const n=this.getSourceBlock();if(!n)throw new Error("The field has not yet been attached to its input. Call appendField to attach it.");let s;const i=this.textGroup;for(;s=i.firstChild;)i.removeChild(s);const a=this.getConstants();if(!a)throw Error("Constants not found");const c=this.getDisplayText_().split(`
`);let h=0;for(let g=0;g<c.length;g++){const b=a.FIELD_TEXT_HEIGHT+a.FIELD_BORDER_RECT_Y_PADDING;yt.utils.dom.createSvgElement(yt.utils.Svg.TEXT,{class:"blocklyText blocklyMultilineText",x:a.FIELD_BORDER_RECT_X_PADDING,y:h+a.FIELD_BORDER_RECT_Y_PADDING,dy:a.FIELD_TEXT_BASELINE},i).appendChild(document.createTextNode(c[g])),h+=b}if(this.isBeingEdited_){const g=this.htmlInput_;this.isOverflowedY_?yt.utils.dom.addClass(g,"blocklyHtmlTextAreaInputOverflowedY"):yt.utils.dom.removeClass(g,"blocklyHtmlTextAreaInputOverflowedY")}if(this.updateSize_(),this.isBeingEdited_){n.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_();const g=this.htmlInput_;this.isTextValid_?(yt.utils.dom.removeClass(g,"blocklyInvalidInput"),yt.utils.aria.setState(g,yt.utils.aria.State.INVALID,!1)):(yt.utils.dom.addClass(g,"blocklyInvalidInput"),yt.utils.aria.setState(g,yt.utils.aria.State.INVALID,!0))}}updateSize_(){const n=this.getConstants();if(!n)throw Error("Constants not found");const s=this.textGroup.childNodes,i=n.FIELD_TEXT_FONTSIZE,a=n.FIELD_TEXT_FONTWEIGHT,c=n.FIELD_TEXT_FONTFAMILY;let h=0,g=0;for(let b=0;b<s.length;b++){const $=s[b],y=yt.utils.dom.getFastTextWidth($,i,a,c);y>h&&(h=y),g+=n.FIELD_TEXT_HEIGHT+(b>0?n.FIELD_BORDER_RECT_Y_PADDING:0)}if(this.isBeingEdited_){const b=String(this.value_).split(`
`),$=yt.utils.dom.createSvgElement(yt.utils.Svg.TEXT,{class:"blocklyText blocklyMultilineText"});for(let T=0;T<b.length;T++){b[T].length>this.maxDisplayLength&&(b[T]=b[T].substring(0,this.maxDisplayLength)),$.textContent=b[T];const C=yt.utils.dom.getFastTextWidth($,i,a,c);C>h&&(h=C)}const y=this.htmlInput_,w=y.offsetWidth-y.clientWidth;h+=w}this.borderRect_&&(g+=n.FIELD_BORDER_RECT_Y_PADDING*2,h+=n.FIELD_BORDER_RECT_X_PADDING*2+1,this.borderRect_.setAttribute("width",`${h}`),this.borderRect_.setAttribute("height",`${g}`)),this.size_.width=h,this.size_.height=g,this.positionBorderRect_()}showInlineEditor_(n){const s=this.getSourceBlock();if(!s)throw new Uy;yt.WidgetDiv.show(this,s.RTL,this.widgetDispose_.bind(this),this.workspace_),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,this.valueWhenEditorWasOpened_=this.value_,n||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}getEditorText_(n){return`${n}`}getScaledBBox(){let n,s,i;const a=this.getSourceBlock();if(!a)throw new Uy;if(this.isFullBlockField()){const c=this.sourceBlock_.getHeightWidth(),h=a.workspace.scale;i=this.getAbsoluteXY_(),n=(c.width+1)*h,s=(c.height+1)*h,yt.utils.userAgent.GECKO?(i.x+=1.5*h,i.y+=1.5*h):(i.x-=.5*h,i.y-=.5*h)}else{const c=this.borderRect_.getBoundingClientRect();i=yt.utils.style.getPageOffset(this.borderRect_),n=c.width,s=c.height}return new yt.utils.Rect(i.y,i.y+s,i.x,i.x+n)}resizeEditor_(){yt.renderManagement.finishQueuedRenders().then(()=>{const n=this.getSourceBlock();if(!n)throw new Uy;const s=yt.WidgetDiv.getDiv(),i=this.getScaledBBox();s.style.width=`${i.right-i.left}px`,s.style.height=`${i.bottom-i.top}px`;const a=n.RTL?i.right-s.offsetWidth:i.left,c=i.top;s.style.left=`${a}px`,s.style.top=`${c}px`})}unbindInputEvents_(){this.onKeyDownWrapper_&&(yt.browserEvents.unbind(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.onKeyInputWrapper_&&(yt.browserEvents.unbind(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}widgetDispose_(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_(this.value_),this.sourceBlock_&&yt.Events.isEnabled()&&this.valueWhenEditorWasOpened_!==null&&this.valueWhenEditorWasOpened_!==this.value_&&(yt.Events.fire(new(yt.Events.get("change"))(this.sourceBlock_,"field",this.name||null,this.valueWhenEditorWasOpened_,this.value_)),this.valueWhenEditorWasOpened_=null),yt.Events.setGroup(!1),this.unbindInputEvents_();const n=yt.WidgetDiv.getDiv().style;n.width="auto",n.height="auto",n.fontSize="",n.transition="",n.boxShadow="",this.htmlInput_=null;const s=this.getClickTarget_();if(!s)throw new Error("A click target has not been set.");yt.utils.dom.removeClass(s,"editing")}showEditor_(n,s){this.workspace_=this.sourceBlock_.workspace,!s&&this.workspace_.options.modalInputs&&(yt.utils.userAgent.MOBILE||yt.utils.userAgent.ANDROID||yt.utils.userAgent.IPAD)?this.showPromptEditor_():this.showInlineEditor_(!!s),this.forceRerender()}widgetCreate_(){const n=yt.WidgetDiv.getDiv(),s=this.workspace_.getScale(),i=this.getConstants();if(!i)throw Error("Constants not found");const a=document.createElement("textarea");a.className="blocklyHtmlInput blocklyHtmlTextAreaInput",a.setAttribute("spellcheck",String(this.spellcheck_));const c=`${i.FIELD_TEXT_FONTSIZE*s}pt`;n.style.fontSize=c,a.style.fontSize=c;const h=`${yt.FieldTextInput.BORDERRADIUS*s}px`;a.style.borderRadius=h;const g=i.FIELD_BORDER_RECT_X_PADDING*s,b=i.FIELD_BORDER_RECT_Y_PADDING*s/2;a.style.padding=`${b}px ${g}px ${b}px ${g}px`;const $=i.FIELD_TEXT_HEIGHT+i.FIELD_BORDER_RECT_Y_PADDING;return a.style.lineHeight=`${$*s}px`,n.appendChild(a),a.value=a.defaultValue=this.getEditorText_(this.value_),a.setAttribute("data-untyped-default-value",String(this.value_)),a.setAttribute("data-old-value",""),yt.utils.userAgent.GECKO?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.bindInputEvents_(a),a}setMaxLines(n){typeof n=="number"&&n>0&&n!==this.maxLines_&&(this.maxLines_=n,this.forceRerender())}getMaxLines(){return this.maxLines_}onHtmlInputKeyDown_(n){n.key!=="Enter"&&this.onHtmlInputKeyDownSuper_(n)}static fromJson(n){const s=yt.utils.parsing.replaceMessageReferences(n.text);return new this(s,void 0,n)}}yt.Css.register(`
.blocklyHtmlTextAreaInput {
  font-family: monospace;
  resize: none;
  overflow: hidden;
  height: 100%;
  text-align: left;
}

.blocklyHtmlTextAreaInputOverflowedY {
  overflow-y: scroll;
}
`);/**
 * @license
 * Copyright 2024 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ik="text_multiline",wM={type:Ik,message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:""},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]};function CM(o,n){const s=n.multiline_quote_(o.getFieldValue("TEXT")),i=s.indexOf("+")!==-1?6.2:0;return[s,i]}const SM=window.Blockly.common.createBlockDefinitionsFromJsonArray([wM]);SM[Ik];/**
 * @license
 * Copyright 2023 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Zt=window.Blockly;class F_ extends Zt.Field{picker=null;highlightedIndex=null;boundEvents=[];SERIALIZABLE=!0;CURSOR="default";isDirty_=!1;colours=["#ffffff","#cccccc","#c0c0c0","#999999","#666666","#333333","#000000","#ffcccc","#ff6666","#ff0000","#cc0000","#990000","#660000","#330000","#ffcc99","#ff9966","#ff9900","#ff6600","#cc6600","#993300","#663300","#ffff99","#ffff66","#ffcc66","#ffcc33","#cc9933","#996633","#663333","#ffffcc","#ffff33","#ffff00","#ffcc00","#999900","#666600","#333300","#99ff99","#66ff99","#33ff33","#33cc00","#009900","#006600","#003300","#99ffff","#33ffff","#66cccc","#00cccc","#339999","#336666","#003333","#ccffff","#66ffff","#33ccff","#3366ff","#3333ff","#000099","#000066","#ccccff","#9999ff","#6666cc","#6633ff","#6600cc","#333399","#330099","#ffccff","#ff99ff","#cc66cc","#cc33cc","#993399","#663366","#330033"];titles=[];columns=7;constructor(n,s,i){super(n),n!==Symbol("SKIP_SETUP")&&(i&&this.configure_(i),this.setValue(n),s&&this.setValidator(s))}configure_(n){super.configure_(n),n.colourOptions&&(this.colours=n.colourOptions),n.colourTitles&&(this.titles=n.colourTitles),n.columns&&(this.columns=n.columns)}initView(){const n=this.getConstants();if(!n)throw Error("Constants not found");this.size_=new Zt.utils.Size(n.FIELD_COLOUR_DEFAULT_WIDTH,n.FIELD_COLOUR_DEFAULT_HEIGHT),this.createBorderRect_(),this.getBorderRect().style.fillOpacity="1",this.getBorderRect().setAttribute("stroke","#fff"),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}isFullBlockField(){if(!this.getSourceBlock())throw new Zt.UnattachedFieldError;const s=this.getConstants();return this.blockIsSimpleReporter()&&!!(s!=null&&s.FIELD_COLOUR_FULL_BLOCK)}blockIsSimpleReporter(){const n=this.getSourceBlock();if(!n)throw new Zt.UnattachedFieldError;if(!n.outputConnection)return!1;for(const s of n.inputList)if(s.connection||s.fieldRow.length>1)return!1;return!0}applyColour(){const n=this.getSourceBlock();if(!n)throw new Zt.UnattachedFieldError;if(!this.fieldGroup_)return;const s=this.borderRect_;if(!s)throw new Error("The border rect has not been initialized");this.isFullBlockField()?(s.style.display="none",n.pathObject.svgPath.setAttribute("fill",this.getValue()),n.pathObject.svgPath.setAttribute("stroke","#fff")):(s.style.display="block",s.style.fill=this.getValue())}getSize(){var n;return(n=this.getConstants())!=null&&n.FIELD_COLOUR_FULL_BLOCK&&(this.render_(),this.isDirty_=!1),super.getSize()}render_(){super.render_();const n=this.getSourceBlock();if(!n)throw new Zt.UnattachedFieldError;n.applyColour()}updateSize_(n){const s=this.getConstants();if(!s)return;let i,a;this.isFullBlockField()?(i=(n??0)*2,a=s.FIELD_TEXT_HEIGHT):(i=s.FIELD_COLOUR_DEFAULT_WIDTH,a=s.FIELD_COLOUR_DEFAULT_HEIGHT),this.size_.height=a,this.size_.width=i,this.positionBorderRect_()}doClassValidation_(n){return typeof n!="string"?null:Zt.utils.colour.parse(n)}getText(){let n=this.value_;return/^#(.)\1(.)\2(.)\3$/.test(n)&&(n=`#${n[1]}${n[3]}${n[5]}`),n}setColours(n,s){return this.colours=n,s&&(this.titles=s),this}setColumns(n){return this.columns=n,this}showEditor_(){if(this.dropdownCreate(),!this.picker)throw Error("Picker not found");Zt.DropDownDiv.getContentDiv().appendChild(this.picker),Zt.DropDownDiv.showPositionedByField(this,this.dropdownDispose.bind(this)),this.picker.focus({preventScroll:!0})}onClick(n){const s=n.target,i=s==null?void 0:s.getAttribute("data-colour");i!==null&&(this.setValue(i),Zt.DropDownDiv.hideIfOwner(this))}onKeyDown(n){let s=!0,i;switch(n.key){case"ArrowUp":this.moveHighlightBy(0,-1);break;case"ArrowDown":this.moveHighlightBy(0,1);break;case"ArrowLeft":this.moveHighlightBy(-1,0);break;case"ArrowRight":this.moveHighlightBy(1,0);break;case"Enter":if(i=this.getHighlighted(),i){const a=i.getAttribute("data-colour");a!==null&&this.setValue(a)}Zt.DropDownDiv.hideWithoutAnimation();break;default:s=!1}s&&n.stopPropagation()}moveHighlightBy(n,s){if(!this.highlightedIndex)return;const i=this.colours,a=this.columns;let c=this.highlightedIndex%a,h=Math.floor(this.highlightedIndex/a);c+=n,h+=s,n<0?c<0&&h>0?(c=a-1,h--):c<0&&(c=0):n>0?c>a-1&&h<Math.floor(i.length/a)-1?(c=0,h++):c>a-1&&c--:s<0?h<0&&(h=0):s>0&&h>Math.floor(i.length/a)-1&&(h=Math.floor(i.length/a)-1);const g=this.picker.childNodes[h].childNodes[c],b=h*a+c;this.setHighlightedCell(g,b)}onMouseMove(n){const s=n.target,i=s&&Number(s.getAttribute("data-index"));i!==null&&i!==this.highlightedIndex&&this.setHighlightedCell(s,i)}onMouseEnter(){var n;(n=this.picker)==null||n.focus({preventScroll:!0})}onMouseLeave(){var s;(s=this.picker)==null||s.blur();const n=this.getHighlighted();n&&Zt.utils.dom.removeClass(n,"blocklyColourHighlighted")}getHighlighted(){var a;if(!this.highlightedIndex)return null;const n=this.highlightedIndex%this.columns,s=Math.floor(this.highlightedIndex/this.columns),i=(a=this.picker)==null?void 0:a.childNodes[s];return i?i.childNodes[n]:null}setHighlightedCell(n,s){const i=this.getHighlighted();i&&Zt.utils.dom.removeClass(i,"blocklyColourHighlighted"),Zt.utils.dom.addClass(n,"blocklyColourHighlighted"),this.highlightedIndex=s;const a=n.getAttribute("id");a&&this.picker&&Zt.utils.aria.setState(this.picker,Zt.utils.aria.State.ACTIVEDESCENDANT,a)}dropdownCreate(){const n=this.columns,s=this.colours,i=this.getValue(),a=document.createElement("table");a.className="blocklyColourTable",a.tabIndex=0,a.dir="ltr",Zt.utils.aria.setRole(a,Zt.utils.aria.Role.GRID),Zt.utils.aria.setState(a,Zt.utils.aria.State.EXPANDED,!0),Zt.utils.aria.setState(a,Zt.utils.aria.State.ROWCOUNT,Math.floor(s.length/n)),Zt.utils.aria.setState(a,Zt.utils.aria.State.COLCOUNT,n);let c=null;for(let h=0;h<s.length;h++){h%n===0&&(c=document.createElement("tr"),Zt.utils.aria.setRole(c,Zt.utils.aria.Role.ROW),a.appendChild(c));const g=document.createElement("td");c.appendChild(g),g.setAttribute("data-colour",s[h]),g.title=this.titles[h]||s[h],g.id=Zt.utils.idGenerator.getNextUniqueId(),g.setAttribute("data-index",`${h}`),Zt.utils.aria.setRole(g,Zt.utils.aria.Role.GRIDCELL),Zt.utils.aria.setState(g,Zt.utils.aria.State.LABEL,s[h]),Zt.utils.aria.setState(g,Zt.utils.aria.State.SELECTED,s[h]===i),g.style.backgroundColor=s[h],s[h]===i&&(g.className="blocklyColourSelected",this.highlightedIndex=h)}this.boundEvents.push(Zt.browserEvents.conditionalBind(a,"pointerdown",this,this.onClick,!0)),this.boundEvents.push(Zt.browserEvents.conditionalBind(a,"pointermove",this,this.onMouseMove,!0)),this.boundEvents.push(Zt.browserEvents.conditionalBind(a,"pointerenter",this,this.onMouseEnter,!0)),this.boundEvents.push(Zt.browserEvents.conditionalBind(a,"pointerleave",this,this.onMouseLeave,!0)),this.boundEvents.push(Zt.browserEvents.conditionalBind(a,"keydown",this,this.onKeyDown,!1)),this.picker=a}dropdownDispose(){for(const n of this.boundEvents)Zt.browserEvents.unbind(n);this.boundEvents.length=0,this.picker=null,this.highlightedIndex=null}static fromJson(n){return new this(n.colour,void 0,n)}}F_.prototype.DEFAULT_VALUE="#ffffff";Zt.Css.register(`
.blocklyColourTable {
  border-collapse: collapse;
  display: block;
  outline: none;
  padding: 1px;
}

.blocklyColourTable>tr>td {
  border: 0.5px solid #888;
  box-sizing: border-box;
  cursor: pointer;
  display: inline-block;
  height: 20px;
  padding: 0;
  width: 20px;
}

.blocklyColourTable>tr>td.blocklyColourHighlighted {
  border-color: #eee;
  box-shadow: 2px 2px 7px 2px rgba(0, 0, 0, 0.3);
  position: relative;
}

.blocklyColourSelected, .blocklyColourSelected:hover {
  border-color: #eee !important;
  outline: 1px solid #333;
  position: relative;
}
`);/**
 * @license
 * Copyright 2024 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const xk="colour_picker",TM={type:xk,message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]};function kM(o,n){return[n.quote_(o.getFieldValue("COLOUR")),0]}const EM=window.Blockly.common.createBlockDefinitionsFromJsonArray([TM]);EM[xk];/**
 * @license
 * Copyright 2024 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Dk="colour_random",IM={type:Dk,message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"};function xM(o,n){return[`${n.provideFunction_("colourRandom",`
function ${n.FUNCTION_NAME_PLACEHOLDER_}() {
  var num = Math.floor(Math.random() * 0x1000000);
  return '#' + ('00000' + num.toString(16)).substr(-6);
}
`)}()`,2]}const DM=window.Blockly.common.createBlockDefinitionsFromJsonArray([IM]);DM[Dk];/**
 * @license
 * Copyright 2024 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ak="colour_rgb",AM={type:Ak,message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"};function OM(o,n){const s=n.valueToCode(o,"RED",99)||0,i=n.valueToCode(o,"GREEN",99)||0,a=n.valueToCode(o,"BLUE",99)||0;return[`${n.provideFunction_("colourRgb",`
function ${n.FUNCTION_NAME_PLACEHOLDER_}(r, g, b) {
  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;
  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;
  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;
  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);
  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);
  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);
  return '#' + r + g + b;
}
`)}(${s}, ${i}, ${a})`,2]}const RM=window.Blockly.common.createBlockDefinitionsFromJsonArray([AM]);RM[Ak];/**
 * @license
 * Copyright 2024 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Ok="colour_blend",MM={type:Ok,message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"};function NM(o,n){const s=n.valueToCode(o,"COLOUR1",99)||"'#000000'",i=n.valueToCode(o,"COLOUR2",99)||"'#000000'",a=n.valueToCode(o,"RATIO",99)||.5;return[`${n.provideFunction_("colourBlend",`
function ${n.FUNCTION_NAME_PLACEHOLDER_}(c1, c2, ratio) {
  ratio = Math.max(Math.min(Number(ratio), 1), 0);
  var r1 = parseInt(c1.substring(1, 3), 16);
  var g1 = parseInt(c1.substring(3, 5), 16);
  var b1 = parseInt(c1.substring(5, 7), 16);
  var r2 = parseInt(c2.substring(1, 3), 16);
  var g2 = parseInt(c2.substring(3, 5), 16);
  var b2 = parseInt(c2.substring(5, 7), 16);
  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);
  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);
  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);
  r = ('0' + (r || 0).toString(16)).slice(-2);
  g = ('0' + (g || 0).toString(16)).slice(-2);
  b = ('0' + (b || 0).toString(16)).slice(-2);
  return '#' + r + g + b;
}
`)}(${s}, ${i}, ${a})`,2]}const LM=window.Blockly.common.createBlockDefinitionsFromJsonArray([MM]);LM[Ok];function BM(){window.Blockly.FieldMultilineInput||(window.Blockly.fieldRegistry.register("field_multilinetext",nv),window.Blockly.JavaScript.forBlock.text_multiline=CM,window.Blockly.FieldMultilineInput=nv,Object.assign(window.Blockly.Blocks,window.Blockly.common.createBlockDefinitionsFromJsonArray([{type:"text_multiline",message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:""},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]}]))),window.Blockly.FieldColour||(window.Blockly.fieldRegistry.register("field_colour",F_),window.Blockly.JavaScript.forBlock.colour_picker=kM,window.Blockly.JavaScript.forBlock.colour_blend=NM,window.Blockly.JavaScript.forBlock.colour_random=xM,window.Blockly.JavaScript.forBlock.colour_rgb=OM,window.Blockly.FieldColour=F_,Object.assign(window.Blockly.Blocks,window.Blockly.common.createBlockDefinitionsFromJsonArray([{type:"colour_picker",message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]}])),Object.assign(window.Blockly.Blocks,window.Blockly.common.createBlockDefinitionsFromJsonArray([{type:"colour_random",message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"}])),Object.assign(window.Blockly.Blocks,window.Blockly.common.createBlockDefinitionsFromJsonArray([{type:"colour_rgb",message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"}])),Object.assign(window.Blockly.Blocks,window.Blockly.common.createBlockDefinitionsFromJsonArray([{type:"colour_blend",message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"}])))}let $$=!1,v$=!1,Wy=null,Hy=null;const KS=[];function Rk(o,n,s,i){var a;if(i=i||[],(o.tagName==="BLOCK"||o.tagName==="block")&&(s=o.id),o.tagName==="FIELD"||o.tagName==="field")for(let c=0;c<o.attributes.length;c++){const h=(o.attributes[c].value||"").toLowerCase();o.attributes[c].nodeName==="name"&&(h==="oid"||h==="text"||h==="var")&&s&&(a=o.innerHTML)!=null&&a.toLowerCase().includes(n)&&i.push(s)}return o.childNodes.forEach(c=>Rk(c,n,s,i)),i}class dn extends We.Component{blockly=null;blocklyWorkspace=null;originalCode;someSelected=null;changeTimer=null;someSelectedTime=0;ignoreChanges=!1;blinkBlock;onResizeBind;didUpdate=null;lastCommand="";lastSearch;static Blockly=window.Blockly;constructor(n){super(n),this.state={languageOwnLoaded:v$,languageBlocklyLoaded:$$,changed:!1,message:"",error:"",themeType:this.props.themeType,exportText:"",importText:!1,searchText:this.props.searchText||"",showInputPrompt:null},this.originalCode=n.code||"",this.someSelected=null,this.onResizeBind=this.onResize.bind(this),this.lastSearch=this.props.searchText||"",this.blinkBlock=null,BM(),dn.Blockly.dialog.setPrompt(this.onShowNameDialog),this.loadLanguages()}onShowNameDialog=(n,s,i)=>{this.setState({showInputPrompt:{promptText:n,defaultText:s,callback:i,value:s}})};static loadJS(n,s,i){const a=document.createElement("script");try{a.src=n,a.onload=s,a.onerror=s,(i||window.document.body).appendChild(a)}catch(c){console.error(`Cannot load ${n}: ${c}`),s&&s()}}static loadScripts(n,s){if(!(n!=null&&n.length)){s&&s();return}const i=n.pop();i&&!KS.includes(i)?(KS.push(i),dn.loadJS(`../../adapter/${i}/blockly.js`,()=>setTimeout(()=>dn.loadScripts(n,s),0))):setTimeout(()=>dn.loadScripts(n,s),0)}static loadCustomBlockly(n,s){var a;const i=[];for(const c in n)!Object.prototype.hasOwnProperty.call(n,c)||!n[c]||!c.match(/^system\.adapter\./)||n[c].type!=="adapter"||(a=n[c].common)!=null&&a.blockly&&(console.log(`Detected custom blockly: ${n[c].common.name}`),i.push(n[c].common.name));dn.loadScripts(i,s)}static loadXMLDoc(n){let s;return window.DOMParser?s=i=>new window.DOMParser().parseFromString(i,"text/xml"):typeof window.ActiveXObject<"u"&&new window.ActiveXObject("Microsoft.XMLDOM")?s=i=>{const a=new window.ActiveXObject("Microsoft.XMLDOM");return a.async="false",a.loadXML(i),a}:s=()=>null,s(n)}searchBlocks(n){if(this.blocklyWorkspace){const s=dn.Blockly.Xml.workspaceToDom(this.blocklyWorkspace),i=Rk(s,n.toLowerCase());return console.log(`Search "${n}" found blocks: ${i.length?JSON.stringify(i):"none"}`),i}return[]}searchId(){const n=this.lastSearch?this.searchBlocks(this.lastSearch):null;n!=null&&n.length?(this.someSelected=n,this.someSelected.forEach(s=>{var i;return(i=this.blocklyWorkspace)==null?void 0:i.highlightBlock(s,!0)}),this.someSelectedTime=Date.now()):this.someSelected&&(this.someSelected.forEach(s=>{var i;return(i=this.blocklyWorkspace)==null?void 0:i.highlightBlock(s,!1)}),this.someSelected=null)}UNSAFE_componentWillReceiveProps(n){n.command&&this.lastCommand!==n.command&&(this.lastCommand=n.command,setTimeout(()=>this.lastCommand="",300),this.lastCommand==="check"?this.blocklyCheckBlocks((s,i)=>{s?(i&&dn.blocklyBlinkBlock(i),this.setState({error:{text:I.I18n.t(s),title:I.I18n.t("Error was found")}}),this.blinkBlock=i):this.setState({message:I.I18n.t("Ok")})}):this.lastCommand==="export"?this.exportBlocks():this.lastCommand==="import"&&this.importBlocks()),n.searchText!==this.lastSearch&&(this.lastSearch=n.searchText,this.searchId()),this.state.themeType!==n.themeType&&this.setState({themeType:n.themeType},()=>this.updateBackground()),this.originalCode!==n.code&&(this.originalCode=n.code||"",this.loadCode(),this.searchId())}loadLanguages(){if(!$$){const n=window.document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",`google-blockly/msg/js/${I.I18n.getLanguage()}.js`),n.onload=()=>{$$=!0,this.setState({languageBlocklyLoaded:$$})},window.document.getElementsByTagName("head")[0].appendChild(n)}if(!v$){const n=window.document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",`google-blockly/own/msg/${I.I18n.getLanguage()}.js`),n.onload=()=>{v$=!0,this.setState({languageOwnLoaded:v$})},window.document.getElementsByTagName("head")[0].appendChild(n)}}onResize(){this.blocklyWorkspace&&dn.Blockly.svgResize(this.blocklyWorkspace)}static jsCode2Blockly(n){n=n||"";const s=n.split(/[\r\n]+|\r|\n/g);let i="";for(let c=s.length-1;c>=0;c--)if(s[c].substring(0,2)==="//"){i=s[c].substring(2);break}if(i.substring(0,4)==="<xml")return i;let a;try{a=window.decodeURIComponent(window.atob(i))}catch(c){a=null,console.error(`cannot decode: ${i}`),console.error(c)}return a}static blocklyBlinkBlock(n){for(let s=300;s<3e3;s+=300)setTimeout(()=>n.select(),s),setTimeout(()=>n.unselect(),s+150)}blocklyRemoveOrphanedShadows(){if(this.blocklyWorkspace){const n=this.blocklyWorkspace.getAllBlocks();let s;for(let i=0;s=n[i];i++)if(s.isShadow()){const a=s.getConnections_(!0);let c;for(let h=0;c=a[h];h++)if(!c.targetConnection){s.dispose();break}}}}blocklyCheckBlocks(n){let s;if(!this.blocklyWorkspace||this.blocklyWorkspace.getAllBlocks().length===0)return n&&n("no blocks found"),!1;let i=this.blocklyGetUnconnectedBlock();return i?s="not properly connected":(i=this.blocklyGetBlockWithWarning(),i&&(s="warning on this block")),i?(n?n(s,i):dn.blocklyBlinkBlock(i),!1):(n(),!0)}blocklyGetUnconnectedBlock(){var i;const n=(i=this.blocklyWorkspace)==null?void 0:i.getAllBlocks();let s;if(n)for(let a=0;s=n[a];a++){const c=s.getConnections_(!0);let h;for(let g=0;h=c[g];g++)if(!h.sourceBlock_||(h.type===dn.Blockly.INPUT_VALUE||h.type===dn.Blockly.OUTPUT_VALUE)&&!h.targetConnection&&!h._optional)return s}return null}blocklyGetBlockWithWarning(){var i;const n=(i=this.blocklyWorkspace)==null?void 0:i.getAllBlocks();let s;if(n){for(let a=0;s=n[a];a++)if(s.warning)return s}return null}blocklyCode2JSCode(n){if(!this.blocklyWorkspace)return"";let s=dn.Blockly.JavaScript.workspaceToCode(this.blocklyWorkspace);if(!n){s+=`
`;const i=dn.Blockly.Xml.workspaceToDom(this.blocklyWorkspace),a=dn.Blockly.Xml.domToText(i);s+=`//${btoa(encodeURIComponent(a))}`}return s}exportBlocks(){if(!this.blocklyWorkspace)return;let n;const s=dn.Blockly.getSelected();if(s){const i=dn.Blockly.Xml.blockToDom(s),a=s.getRelativeToSurfaceXY();i.setAttribute("x",(s.RTL?-a.x:a.x).toString()),i.setAttribute("y",a.y.toString()),n=dn.Blockly.Xml.domToPrettyText(i)}else{const i=dn.Blockly.Xml.workspaceToDom(this.blocklyWorkspace);n=dn.Blockly.Xml.domToPrettyText(i)}this.setState({exportText:n})}importBlocks(){this.setState({importText:!0})}onImportBlocks(n){if(this.blocklyWorkspace&&(n=(n||"").trim(),n))try{n.startsWith("<xml")||(n=`<xml xmlns="https://developers.google.com/blockly/xml">${n}</xml>`),n=n.replace(/[\n\r]/g,"").replace(/<variables>.*<\/variables>/g,""),window.scripts.loading=!0;const s=dn.Blockly.utils.xml.textToDom(n);if(s.nodeName==="xml")for(let i=0;i<s.children.length;i++)dn.Blockly.Xml.appendDomToWorkspace(s,this.blocklyWorkspace);else dn.Blockly.Xml.appendDomToWorkspace(s,this.blocklyWorkspace);window.scripts.loading=!1,this.onBlocklyChanged()}catch(s){this.setState({error:{text:s.toString(),title:I.I18n.t("Import error")}})}}loadCode(){if(this.blocklyWorkspace){this.ignoreChanges=!0,this.blocklyWorkspace.clear();try{const n=dn.jsCode2Blockly(this.originalCode)||'<xml xmlns="https://developers.google.com/blockly/xml"></xml>';window.scripts.loading=!0;const s=dn.Blockly.utils.xml.textToDom(n);dn.Blockly.Xml.domToWorkspace(s,this.blocklyWorkspace),window.scripts.loading=!1}catch(n){console.error(n),setTimeout(()=>this.setState({error:I.I18n.t("Cannot extract Blockly code!")}))}setTimeout(()=>this.ignoreChanges=!1,100)}}onBlocklyChanged(){this.blocklyRemoveOrphanedShadows(),this.setState({changed:!0}),this.onChange()}async componentDidUpdate(){if(!this.blockly||(this.didUpdate&&(clearTimeout(this.didUpdate),this.didUpdate=null),this.blocklyWorkspace))return;window.addEventListener("resize",this.onResizeBind,!1),Wy=Wy||await this.getToolbox(),Hy=Hy||dn.Blockly.utils.xml.textToDom(Wy),this.blocklyWorkspace=dn.Blockly.inject(this.blockly,{renderer:"thrasos",theme:this.state.themeType==="dark"?GS:"classic",media:"google-blockly/media/",toolbox:Hy,zoom:{controls:!0,wheel:!1,startScale:1,maxScale:3,minScale:.3,scaleSpeed:1.2,pinch:!0},move:{scrollbars:{horizontal:!0,vertical:!0},drag:!0,wheel:!0},trashcan:!0,grid:{spacing:25,length:1,snap:!0},sounds:!1}),window.scripts={blocklyWorkspace:this.blocklyWorkspace},this.blocklyWorkspace.registerToolboxCategoryCallback("PROCEDURE",window.Blockly.Procedures.flyoutCategoryNew),this.blocklyWorkspace.addChangeListener(s=>{var i;if(this.someSelected&&Date.now()-this.someSelectedTime>500){const a=(i=this.blocklyWorkspace)==null?void 0:i.getAllBlocks();this.someSelected=null,a==null||a.forEach(c=>c.removeSelect())}[dn.Blockly.Events.UI,dn.Blockly.Events.CREATE,dn.Blockly.Events.VIEWPORT_CHANGE].includes(s.type)||this.ignoreChanges||(this.changeTimer&&clearTimeout(this.changeTimer),this.changeTimer=setTimeout(()=>{this.changeTimer=null,this.onBlocklyChanged()},200))}),this.loadCode(),this.onResize();const n=document.getElementsByClassName("blocklyToolboxDiv")[0];this.blockly.appendChild(n),this.updateBackground(),setTimeout(()=>this.searchId(),200)}updateBackground(){var n;this.state.themeType==="dark"?(n=this.blocklyWorkspace)==null||n.setTheme(GS):this.blocklyWorkspace&&(this.blocklyWorkspace.getThemeManager(),this.blocklyWorkspace.setTheme(dn.Blockly.Themes.Classic))}componentWillUnmount(){this.blocklyWorkspace&&(this.blocklyWorkspace.dispose(),this.blocklyWorkspace=null,this.changeTimer&&clearTimeout(this.changeTimer),this.changeTimer=null,window.removeEventListener("resize",this.onResizeBind))}onChange(){this.originalCode=this.blocklyCode2JSCode(),this.props.onChange&&this.props.onChange(this.originalCode)}async getToolbox(n){const s=window.document.getElementById("toolbox");let i=s==null?void 0:s.outerHTML;if(!i)return n?(console.error("Cannot load blocks!"),""):new Promise(a=>{setTimeout(()=>a(this.getToolbox(!0)),500)});if(i=i.replace(/{(\w+)}/g,(a,c)=>window.MSG[c]),window.Blockly.CustomBlocks){let a="";const c=I.I18n.getLanguage();for(let h=0;h<window.Blockly.CustomBlocks.length;h++){const g=window.Blockly.CustomBlocks[h],b=window.Blockly[g];a+=`<category name="${window.Blockly.Words[g][c]}" colour="${b.HUE}">`;for(const $ in b.blocks)Object.prototype.hasOwnProperty.call(b.blocks,$)&&(a+=b.blocks[$]);a+="</category>"}i=i.replace("<category><block>%%CUSTOM_BLOCKS%%</block></category>",a)}return i}renderMessageDialog(){return this.state.message?f.jsx(I.Message,{text:typeof this.state.message=="object"?this.state.message.text:this.state.message,title:typeof this.state.message=="object"?this.state.message.title:"",onClose:()=>this.setState({message:""})},"dialogMessage"):null}renderErrorDialog(){return this.state.error?f.jsx(Hf,{text:typeof this.state.error=="object"?this.state.error.text.toString():this.state.error,title:typeof this.state.error=="object"?this.state.error.title:"",onClose:()=>{this.blinkBlock&&(dn.blocklyBlinkBlock(this.blinkBlock),this.blinkBlock=null),this.setState({error:""})}},"dialogError"):null}renderExportDialog(){return this.state.exportText?f.jsx(Ek,{themeType:this.state.themeType,onClose:()=>this.setState({exportText:""}),text:this.state.exportText,scriptId:this.props.scriptId},"dialogExport"):null}renderImportDialog(){return this.state.importText?f.jsx(Kv,{themeType:this.props.themeType,onClose:n=>{this.setState({importText:!1}),this.onImportBlocks(n)}},"dialogImport"):null}renderDialogPrompt(){return this.state.showInputPrompt?f.jsxs(D.Dialog,{onClose:()=>{var s;const n=(s=this.state.showInputPrompt)==null?void 0:s.callback;n&&n(null),this.setState({showInputPrompt:null})},maxWidth:"sm",fullWidth:!0,open:!0,children:[f.jsx(D.DialogTitle,{children:this.state.showInputPrompt.promptText}),f.jsx(D.DialogContent,{children:f.jsx(D.TextField,{variant:"standard",fullWidth:!0,value:this.state.showInputPrompt.value,onKeyUp:n=>{var s,i;if(n.key==="Enter"){const a=(s=this.state.showInputPrompt)==null?void 0:s.callback,c=(i=this.state.showInputPrompt)==null?void 0:i.value;a&&a(c===void 0?null:c),this.setState({showInputPrompt:null})}},onChange:n=>{var i,a;const s={...this.state.showInputPrompt};(i=this.state.showInputPrompt)!=null&&i.callback&&(s.callback=(a=this.state.showInputPrompt)==null?void 0:a.callback),s.value=n.target.value,this.setState({showInputPrompt:s})}})}),f.jsxs(D.DialogActions,{children:[f.jsx(D.Button,{variant:"contained",disabled:!this.state.showInputPrompt.value,onClick:()=>{var i,a;const n=(i=this.state.showInputPrompt)==null?void 0:i.callback,s=(a=this.state.showInputPrompt)==null?void 0:a.value;n&&n(s===void 0?null:s),this.setState({showInputPrompt:null})},color:"primary",startIcon:f.jsx(Va,{}),children:I.I18n.t("Apply")}),f.jsx(D.Button,{color:"grey",variant:"contained",onClick:()=>{var s;const n=(s=this.state.showInputPrompt)==null?void 0:s.callback;n&&n(null),this.setState({showInputPrompt:null})},startIcon:f.jsx(Jo,{}),children:I.I18n.t("Close")})]})]},"inputDialog"):null}render(){return this.state.languageBlocklyLoaded&&this.state.languageOwnLoaded?(this.didUpdate=setTimeout(()=>{this.didUpdate=null,this.componentDidUpdate()},100),[f.jsx("div",{ref:n=>this.blockly=n,style:{width:"100%",height:"100%",position:"relative"}},"blocklyDOM"),this.renderDialogPrompt(),this.renderMessageDialog(),this.renderErrorDialog(),this.renderExportDialog(),this.renderImportDialog()]):null}}const fh={textArea:{width:"calc(100% - 10px)",resize:"none"},dialog:{height:"95%"},fullHeight:{height:"100%",overflow:"hidden"},args:o=>({color:o.palette.mode==="dark"?"white":"black",height:30,width:"100%",fontSize:16}),argsTitle:o=>({color:o.palette.mode==="dark"?"white":"black",fontWeight:"bold"})};class PM extends We.Component{constructor(n){super(n),this.state={changed:!1,source:!n.source&&n.isReturn?`
return false`:n.source}}componentDidMount(){setTimeout(()=>{var n;try{(n=window.document.getElementById("source-text-area"))==null||n.focus()}catch{}},100)}handleCancel(){this.props.onClose(!1)}handleOk(){(!this.props.isReturn||this.state.source.includes("return "))&&this.props.onClose(this.state.source)}onChange(n){this.setState({changed:!0,source:n})}render(){return f.jsxs(D.Dialog,{onClose:()=>!1,maxWidth:"lg",sx:{"& .MuiDialog-paper":fh.dialog},fullWidth:!0,open:!0,"aria-labelledby":"source-dialog-title",children:[f.jsx(D.DialogTitle,{id:"source-dialog-title",children:I.I18n.t("Function editor")}),f.jsxs(D.DialogContent,{style:fh.fullHeight,children:[this.props.args&&f.jsxs(D.Box,{sx:fh.args,children:[f.jsx(D.Box,{component:"span",sx:fh.argsTitle,children:I.I18n.t("function (")}),this.props.args,f.jsx(D.Box,{component:"span",sx:fh.argsTitle,children:")"})]},"arguments"),f.jsx(Gv,{triggerPrettier:1,adapterName:this.props.adapterName,runningInstances:this.props.runningInstances,style:{...fh.textArea,height:this.props.args?"calc(100% - 30px)":"100%"},name:"blockly",socket:this.props.socket,readOnly:!1,checkJs:!1,changed:this.state.changed,code:this.state.source,isDark:this.props.themeType==="dark",onChange:n=>this.onChange(n),language:"javascript"},"scriptEditor")]}),f.jsxs(D.DialogActions,{children:[f.jsx(D.Button,{variant:"contained",onClick:()=>this.handleOk(),color:"primary",startIcon:f.jsx(KI,{}),children:I.I18n.t("Save")}),f.jsx(D.Button,{color:"grey",variant:"contained",onClick:()=>this.handleCancel(),startIcon:f.jsx(Jo,{}),children:I.I18n.t("Cancel")})]})]})}}const jM="_wrapperRules_nnott_1",FM="_rootWrapper_nnott_9",zM="_addClass_nnott_14",Vy={wrapperRules:jM,rootWrapper:FM,addClass:zM},UM="_switchesItem_10ls3_1",WM="_switchesItemActive_10ls3_28",HM="_iconTheme_10ls3_36",Gy={switchesItem:UM,switchesItemActive:WM,iconTheme:HM},Ky={},VM={Shuffle:XA,Apps:WA,Functions:GA,Language:JI,AddBox:UA,Pause:KA,Subject:QA,PlayForWork:qA,Brightness3:HA,HelpOutline:dw,Storage:ZA,AccessTime:zA,PlayArrow:JA,FlashOn:VA};function $u({iconName:o,className:n,adapter:s,socket:i,onClick:a,style:c}){const[h,g]=ve.useState("");if(ve.useEffect(()=>{s&&i&&(Ky[s]instanceof Promise||(Ky[s]=i.getObject(`system.adapter.${s}`)),Ky[s].then($=>{var y;return((y=$==null?void 0:$.common)==null?void 0:y.icon)&&g(`../../adapter/${s}/${$.common.icon}`)}))},[s,i]),s)return f.jsx("img",{onClick:$=>a&&a($),src:h||"",className:n,style:c,alt:""});const b=o&&VM[o]||qI;return f.jsx(b,{className:n,style:c,onClick:$=>a&&a($)})}const Mk=({name:o,id:n,active:s,icon:i,adapter:a,socket:c,onDoubleClick:h,title:g,onTouchMove:b,style:$})=>f.jsxs("div",{onDoubleClick:h,onTouchMove:b,title:g?I.I18n.t(g):void 0,className:I.Utils.clsx(Gy.switchesItem,s&&Gy.switchesItemActive,`block-${n}`),children:[f.jsx($u,{iconName:i,className:Gy.iconTheme,adapter:a,socket:c,style:$}),f.jsx("span",{children:o?I.I18n.t(o):""})]},n),GM="_cardStyle_8rq8v_1",KM="_cardStyleActive_8rq8v_17",JM="_controlMenu_8rq8v_22",qM="_closeBtn_8rq8v_31",YM="_isDelete_8rq8v_73",XM="_drag_mobile_8rq8v_90",mh={cardStyle:GM,cardStyleActive:KM,controlMenu:JM,closeBtn:qM,isDelete:YM,drag_mobile:XM};function Rh(o,n,s){let i;switch(o){case"actions":if(s==="else")return i={...n,actions:{...n[o],else:[...n[o].else]}},i;if(s==="then")return i={...n,actions:{...n[o],then:[...n[o].then]}},i;throw console.error(`Unknown additionalParameter: ${s}`),new Error(`Unknown additionalParameter: ${s}`);case"triggers":return i={...n,triggers:[...n.triggers]},i;case"conditions":return i={...n,conditions:[...n.conditions]},i;default:throw new Error(`Unknown name: ${o}`)}}function du(o,n,s,i){var a;switch(o){case"actions":return n.actions[s]=n.actions[s].filter(c=>c._id!==i),n;case"conditions":return n.conditions[s]=(a=n.conditions[s])==null?void 0:a.filter(c=>c._id!==i),n;case"triggers":default:return n.triggers=n.triggers.filter(c=>c._id!==i),n}}const ZM="_nameCard_15el3_28",QM="_iconThemCard_15el3_40",eN="_iconThemCardSelectable_15el3_49",tN="_iconHelp_15el3_53",nN="_blockName_15el3_64",sN="_controlMenuTop_15el3_123",rN="_debugInfo_15el3_132",iN="_tagCard_15el3_142",oN="_displayFlex_15el3_161",aN="_blockMarginTop_15el3_166",lN="_nameBlock_15el3_167",cN="_frontText_15el3_171",uN="_backText_15el3_177",dN="_iconTag_15el3_181",hN="_displayItalic_15el3_191",ot={nameCard:ZM,iconThemCard:QM,iconThemCardSelectable:eN,iconHelp:tN,blockName:nN,controlMenuTop:sN,debugInfo:rN,tagCard:iN,displayFlex:oN,blockMarginTop:aN,nameBlock:lN,frontText:cN,backText:uN,iconTag:dN,displayItalic:hN},pN="_root_1dr6a_1",gN="_square_1dr6a_11",fN="_icon_1dr6a_16",Jy={root:pN,square:gN,icon:fN},wf=({fullWidth:o,size:n,onClick:s,style:i,className:a,value:c,square:h,icon:g})=>f.jsx(D.Button,{variant:"outlined",color:"primary",onClick:s,fullWidth:o,style:i,className:I.Utils.clsx(Jy.root,a,h?Jy.square:""),size:n||"medium",children:g?f.jsx(I.Icon,{className:Jy.icon,src:g}):c}),mN="_root_1ucda_1",bN={root:mN},$N=({size:o,value:n,title:s,onChange:i,className:a,customValue:c,disabled:h})=>{const[g,b]=ve.useState(!1);return f.jsxs(f.Fragment,{children:[f.jsx(D.Checkbox,{disabled:h,checked:!!(c?n:g),className:I.Utils.clsx(bN.root,a),onChange:$=>{c&&b($.target.checked),i&&i($.target.checked)},size:o||"medium"}),s||null]})},Nk=ve.memo($N),vN="_root_19roy_1",JS={root:vN},Yl=o=>{const[n,s]=ve.useState(""),{value:i,type:a,error:c,className:h,icon:g,label:b,style:$,onChange:y,fullWidth:w,autoComplete:T,customValue:C,autoFocus:E,rows:k,size:A,variant:P,multiline:N,disabled:B}=Object.assign({value:"",type:"text",error:"",className:null,table:!1,native:{},variant:"standard",size:"medium",component:null,styleComponentBlock:null,fullWidth:!1,autoComplete:"",customValue:!1,autoFocus:!1,rows:1},o);return f.jsx(D.TextField,{error:!!c,autoFocus:E,fullWidth:w,label:b,disabled:B,variant:P,multiline:N,rows:k,value:C?i:n,type:a,helperText:c,style:$,className:I.Utils.clsx(JS.root,h),autoComplete:T,onChange:S=>{!C&&s(S.target.value),y&&y(S.target.value)},slotProps:{input:{endAdornment:g?f.jsx(D.InputAdornment,{position:"end",children:f.jsx(I.Icon,{className:JS.icon,src:g})}):null}},margin:"normal",size:A})},yN={formControl:{m:"10px 0","& .MuiFormControl-marginNormal":{mt:0,mb:0},"& > *":{color:"#2d0440 !important"},"& .MuiSelect-icon":{color:"#81688c"},"& label.Mui-focused":{color:"#81688c"},"& .MuiInput-underline:after":{borderBottomColor:"#510573"},"& .MuiInput-underline:before":{borderBottomColor:"#81688c"},"& .MuiInput-underline:hover:before":{borderBottomColor:"#81688c"}}},_N=({multiple:o,value:n,customValue:s,socket:i,title:a,attr:c,adapter:h,style:g,onChange:b,onInstanceHide:$})=>{const[y,w]=ve.useState(n||"test1"),[T,C]=ve.useState([]);return ve.useEffect(()=>{i==null||i.getAdapterInstances(h).then(E=>{const k=E.map(A=>({value:A._id.replace("system.adapter.",""),title:A._id.replace("system.adapter.","")}));k.length===1?$(k[0].value):k.unshift({value:h,title:I.I18n.t("All")}),C(k)})},[i,h,$]),f.jsxs(D.FormControl,{sx:yN.formControl,fullWidth:!0,style:g,children:[f.jsx(D.Select,{variant:"standard",value:(s?n:y)||"_",fullWidth:!0,multiple:o,renderValue:E=>o&&Array.isArray(E)?E.join(", "):E,onChange:E=>{!s&&w(E.target.value),b(E.target.value)},input:c?f.jsx(D.Input,{name:c,id:`${c}-helper`}):f.jsx(D.Input,{name:c}),children:T.map(E=>f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:E.value||"_",children:I.I18n.t(E.title)},`key-${E.value}`))}),a?f.jsx(D.FormHelperText,{children:I.I18n.t(a)}):null]})},wN="_modalWrapper_587ci_33",CN="_modalDialog_587ci_40",qS={modalWrapper:wN,modalDialog:CN},z_=({onClose:o,children:n,titleButtonApply:s,titleButtonClose:i,onApply:a,className:c,textInput:h,defaultValue:g,disabled:b})=>{const[$,y]=ve.useState(g||""),[w]=ve.useState(g||"");return f.jsxs(D.Dialog,{open:!0,maxWidth:"md",disableEscapeKeyDown:!1,onClose:o,classes:{paper:qS.modalDialog},className:qS.modalWrapper,children:[f.jsxs(D.DialogContent,{children:[h&&f.jsx(Yl,{className:c,autoComplete:"off",fullWidth:!0,variant:"outlined",size:"medium",rows:10,multiline:!0,value:$,onChange:y,customValue:!0}),!h&&n]}),f.jsxs(D.DialogActions,{children:[f.jsx(D.Button,{disabled:b===void 0?w===$:b,onClick:()=>a(h?$:null),variant:"contained",color:"primary",children:I.I18n.t(s||"Ok")}),f.jsx(D.Button,{color:"grey",onClick:o,variant:"contained",children:I.I18n.t(i||"Cancel")})]})]})},SN="_root_15mo1_1",TN={root:SN},kN=({multiple:o,value:n,customValue:s,title:i,attr:a,options:c,style:h,onChange:g,className:b,doNotTranslate:$,doNotTranslate2:y})=>{const[w,T]=ve.useState(n===void 0?c[0].value:n),C=s?n:w,E=C===""||C===null||C===void 0?"_":C;return f.jsxs(D.FormControl,{variant:"standard",className:I.Utils.clsx(TN.root,b),fullWidth:!0,style:h,children:[f.jsxs(D.Select,{variant:"standard",value:E,fullWidth:!0,multiple:o,renderValue:k=>{if(o&&Array.isArray(k)){k.sort();let P=k.indexOf("0");P!==-1&&(k.splice(P,1),k.push("0")),P=k.indexOf("_"),P!==-1&&(k.splice(P,1),k.unshift("_"));const N=c.find(S=>S.only);return N&&k.includes(N.value)?N.titleShort?$?N.titleShort:I.I18n.t(N.titleShort):$?N.title:I.I18n.t(N.title):k.map(S=>c.find(H=>H.value===S||S==="_"&&H.value==="")||S).map(S=>typeof S=="object"?S.titleShort?$?S.titleShort:I.I18n.t(S.titleShort):$?S.title:I.I18n.t(S.title):$?S:I.I18n.t(S)).join(", ")}const A=c?c.find(P=>P.value===k||k==="_"&&P.value===""):null;return A!=null&&A.title?$?A==null?void 0:A.title:I.I18n.t(A==null?void 0:A.title):k},onChange:k=>{if(s||T(k.target.value),o){const A=k.target.value,P=c.find(N=>N.only);if(P){const N=P.value;if(A.length===c.length-1&&A.includes(N))return g(A.filter(B=>B!==N),a);if(A.includes(N))return g(c.map(B=>B.value),a)}}g(k.target.value,a)},input:a?f.jsx(D.Input,{name:a,id:`${a}-helper`}):f.jsx(D.Input,{name:a}),children:[!o&&(c==null?void 0:c.map(k=>f.jsxs(D.MenuItem,{style:{placeContent:"space-between"},value:k.value===""||k.value===null||k.value===void 0?"_":k.value,children:[$?k.title:I.I18n.t(k.title),k.title2&&f.jsx("div",{children:y?k.title2:I.I18n.t(k.title2)})]},`key-${k.value}`))),o&&(c==null?void 0:c.map(k=>f.jsxs(D.MenuItem,{style:{placeContent:"space-between"},value:k.value||"_",children:[$?k.title:I.I18n.t(k.title)," ",f.jsx(Nk,{customValue:!0,value:n==null?void 0:n.includes(k.value)})]},`key-${k.value}`)))]}),i?f.jsx(D.FormHelperText,{children:I.I18n.t(i)}):null]})},EN="_root_1gt4d_1",IN="_mark_1gt4d_27",YS={root:EN,mark:IN},xN=({size:o,value:n,style:s,onChange:i,className:a,customValue:c,min:h,max:g,step:b,unit:$})=>{const[y,w]=ve.useState(0);h=h!==void 0?h:0,g=g!==void 0?g:0,b=b!==void 0?b:(g-h)/100;const T=[{value:h,label:h+($||"")},{value:g,label:g+($||"")}];return f.jsx(D.Slider,{defaultValue:c?n:y,"aria-labelledby":"discrete-slider",valueLabelDisplay:"auto",classes:{mark:YS.mark},marks:T,step:b,min:h,max:g,value:c?n:y,style:s,className:I.Utils.clsx(YS.root,a),onChange:(C,E)=>{Array.isArray(E)?(!c&&w(E[0]),i(E[0])):(!c&&w(E),i(E))},size:o||"medium"})},DN="_root_rzul6_1",AN={root:DN},ON=({label:o,size:n,value:s,style:i,onChange:a,className:c,customValue:h})=>{const[g,b]=ve.useState(!1);return f.jsx(D.FormControlLabel,{className:AN.root,control:f.jsx(D.Switch,{checked:h?s:g,style:i,className:c,onChange:$=>{h||b($.target.checked),a($.target.checked)},size:n||"medium"}),label:o??"all"})},RN=ve.memo(ON),MN="_root_135pm_1",NN={root:MN},LN=({value:o,style:n,onChange:s,className:i})=>f.jsx(D.TextField,{variant:"standard",id:"time",type:"time",onChange:a=>s(a.currentTarget.value),value:o,className:I.Utils.clsx(NN.root,i),fullWidth:!0,style:n,slotProps:{htmlInput:{step:300},inputLabel:{shrink:!0}}}),BN="_root_135pm_1",y$={root:BN},qy=[31,29,31,30,31,30,31,31,30,31,30,31],PN=({value:o,onChange:n,className:s,style:i})=>{const[a,c]=(o||"01.01").toString().split(".");let h=parseInt(c,10)||0,g=parseInt(a,10)||0;g>12?g=12:g<0&&(g=0),h>qy[g]?h=qy[g]:h<0&&(h=0);const b=[];for(let $=0;$<qy[g];$++)b.push($+1);return f.jsxs("div",{children:[f.jsx(D.FormControl,{variant:"standard",className:I.Utils.clsx(y$.root,s),style:i,children:f.jsxs(D.Select,{variant:"standard",className:I.Utils.clsx(y$.root,s),margin:"dense",label:I.I18n.t("Month"),onChange:$=>n(`${$.target.value.toString().padStart(2,"0")}.${h.toString().padStart(2,"0")}`),value:g,children:[f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:0,children:I.I18n.t("Any month")},0),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:1,children:I.I18n.t("January")},1),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:2,children:I.I18n.t("February")},2),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:3,children:I.I18n.t("March")},3),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:4,children:I.I18n.t("April")},4),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:5,children:I.I18n.t("May")},5),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:6,children:I.I18n.t("June")},6),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:7,children:I.I18n.t("July")},7),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:8,children:I.I18n.t("August")},8),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:9,children:I.I18n.t("September")},9),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:10,children:I.I18n.t("October")},10),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:11,children:I.I18n.t("November")},11),f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:12,children:I.I18n.t("December")},12)]})}),f.jsx(D.FormControl,{variant:"standard",className:I.Utils.clsx(y$.root,s),style:i,children:f.jsxs(D.Select,{variant:"standard",className:I.Utils.clsx(y$.root,s),margin:"dense",label:I.I18n.t("Date"),onChange:$=>n(`${g.toString().padStart(2,"0")}.${$.target.value.toString().padStart(2,"0")}`),value:h,children:[f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:0,children:I.I18n.t("Any")},"A"),b.map($=>f.jsx(D.MenuItem,{style:{placeContent:"space-between"},value:$,children:$},$))]})})]})};let Yy;function jN(o){return Yy=Yy||I.I18n.getLanguage(),o&&typeof o=="object"?o[Yy]||o.en:o||""}function Dh(o){return o===null?"null":o===void 0?"undefined":Array.isArray(o)?o.join(", "):typeof o=="object"?JSON.stringify(o):o.toString()}const Ss={selectTriggers:0,addScheduleByDoubleClick:1,openTagsMenu:2,selectIntervalTag:3,selectActions:4,addActionPrintText:5,showJavascript:6,switchBackToRules:7,saveTheScript:8},FN=[{selector:".blocks-triggers",content:"Select triggers"},{selector:".block-TriggerScheduleBlock",content:"Double click to add the block"},{selector:".tag-card",content:"Open drop down menu"},{selector:".tag-card-interval",content:"Select interval"},{selector:".blocks-actions",content:"Select action blocks"},{selector:".block-ActionPrintText",content:"Double click to add the block"},{selector:".button-js-code",content:"Check the script"},{selector:".button-js-code",content:"Switch back to rules"},{selector:".button-save",content:"Save the script"}];class yn extends ve.Component{debugHideTimeout=null;lastObjectIdChange=0;enableSimulationProcessing=!1;lastDebugMessage=0;debugMessageTimeout=null;static getStaticData(){return{acceptedBy:"actions",name:"Not found",id:"ActionEmpty",icon:"Shuffle"}}static compile(n,s){return""}constructor(n,s){super(n),s||={};const i=n.settings||{tagCard:s.tagCardArray?typeof s.tagCardArray[0]!="string"?s.tagCardArray[0].title:s.tagCardArray[0]:""};!i.tagCard&&s.tagCardArray&&(i.tagCard=typeof s.tagCardArray[0]!="string"?s.tagCardArray[0].title:s.tagCardArray[0]),this.state={inputs:s.inputs||n.inputs||[],name:s.name||n.name||"",icon:s.icon||n.icon||"",adapter:s.adapter||n.adapter||"",helpDialog:s.helpDialog||n.helpDialog||"",tagCardArray:s.tagCardArray||[],openTagMenu:!1,openModal:!1,iconTag:!1,error:"",helpText:"",instanceSelectionOptions:[],instanceSelectionDef:"",hideAttributes:[],settings:i,debugMessage:null,enableSimulation:this.props.enableSimulation}}componentWillUnmount(){this.debugMessageTimeout&&(clearTimeout(this.debugMessageTimeout),this.debugMessageTimeout=null),this.debugHideTimeout&&(clearTimeout(this.debugHideTimeout),this.debugHideTimeout=null)}onTagChange(n,s,i,a,c){let h=!1;const g=JSON.parse(JSON.stringify(this.state.settings));this.state.inputs.forEach(b=>{const $=b.attr,y=b.defaultValue;$&&y!==void 0&&g[$]===void 0&&(h=!0,g[$]=y)}),h?(this.setState({settings:g},()=>s==null?void 0:s()),this.props.onChange(g)):s&&s()}onUpdate(){}onValueChanged(n,s){}renderText(n,s,i){const{className:a}=this.props,{attr:c,frontText:h,backText:g,nameBlock:b,name:$,doNotTranslate:y,doNotTranslateBack:w}=n;return f.jsxs(ve.Fragment,{children:[f.jsxs("div",{className:I.Utils.clsx(ot.displayFlex,ot.blockMarginTop),children:[h&&f.jsx("div",{className:ot.frontText,children:y?h:I.I18n.t(h)}),f.jsx(Yl,{className:a,autoComplete:"off",label:jN($),variant:"outlined",size:"small",fullWidth:!0,value:s,onChange:i,customValue:!0}),g&&f.jsx("div",{className:ot.backText,children:w?g:I.I18n.t(g)})]}),b&&f.jsx("div",{className:ot.nameBlock,children:I.I18n.t(b)})]},c)}renderSwitch(n,s,i){const{className:a}=this.props,{attr:c,frontText:h,backText:g,nameBlock:b,doNotTranslate:$,doNotTranslateBack:y}=n;return f.jsxs("div",{children:[f.jsxs("div",{className:I.Utils.clsx(ot.displayFlex,ot.blockMarginTop),children:[h&&f.jsx("div",{className:ot.frontText,children:$?h:I.I18n.t(h)}),f.jsx(RN,{className:a,label:"",customValue:!0,value:s,onChange:i}),g&&f.jsx("div",{className:ot.backText,children:y?g:I.I18n.t(g)})]}),b&&f.jsx("div",{className:ot.nameBlock,children:I.I18n.t(b)})]},c)}renderNameText({attr:n,signature:s,doNotTranslate:i,defaultValue:a},c){return f.jsx("div",{className:I.Utils.clsx(s?ot.displayItalic:ot.displayFlex,ot.blockMarginTop),children:c?i?c:I.I18n.t(c):i?a:I.I18n.t(a)},n)}renderNumber(n,s,i){const{className:a}=this.props,{settings:c}=this.state,{attr:h,backText:g,frontText:b,openCheckbox:$,doNotTranslate:y,doNotTranslateBack:w}=n;let T=!0;return $&&(T=typeof c.offset=="boolean"?c.offset:!0),T?f.jsxs("div",{className:I.Utils.clsx(ot.displayFlex,ot.blockMarginTop),children:[b&&f.jsx("div",{className:ot.frontText,children:y?b:I.I18n.t(b)}),f.jsx(Yl,{className:I.Utils.clsx(a,n.className),fullWidth:!0,autoComplete:"off",label:n.noHelperText?"":"number",variant:"outlined",size:"small",type:"number",value:s,onChange:i,customValue:!0}),g&&f.jsx("div",{className:ot.backText,children:w?g:I.I18n.t(g)})]},h):null}renderColor(n,s,i){const{className:a}=this.props,{attr:c,backText:h,frontText:g,doNotTranslate:b,doNotTranslateBack:$}=n;return f.jsxs("div",{className:I.Utils.clsx(ot.displayFlex,ot.blockMarginTop),children:[g&&f.jsx("div",{className:ot.frontText,children:b?g:I.I18n.t(g)}),f.jsx(Yl,{className:a,autoComplete:"off",fullWidth:!0,variant:"outlined",size:"small",type:"color",value:s,onChange:i}),h&&f.jsx("div",{className:ot.backText,children:$?h:I.I18n.t(h)})]},c)}renderCheckbox(n,s,i){const{className:a}=this.props,{settings:c}=this.state,{attr:h,backText:g,frontText:b,defaultValue:$,doNotTranslate:y,doNotTranslateBack:w}=n;return f.jsxs("div",{className:ot.displayFlex,children:[b&&f.jsx("div",{className:ot.frontText,children:y?b:I.I18n.t(b)}),f.jsx(Nk,{className:a,size:"small",value:typeof c[h]=="boolean"?!!c[h]:!!$,customValue:!0,onChange:i}),g&&f.jsx("div",{onClick:()=>i(typeof c[h]=="boolean"?!c[h]:!$),className:ot.backText,children:w?g:I.I18n.t(g)})]},h)}renderSlider(n,s,i){const{className:a}=this.props,{attr:c,frontText:h,backText:g,nameBlock:b,min:$,max:y,step:w,unit:T,doNotTranslate:C,doNotTranslateBack:E}=n;return f.jsxs("div",{children:[f.jsxs("div",{className:ot.displayFlex,style:{marginRight:20},children:[h&&f.jsx("div",{className:ot.frontText,children:C?h:I.I18n.t(h)}),f.jsx(xN,{customValue:!0,min:$,max:y,step:w,unit:T,className:a,autoComplete:"off",label:"number",variant:"outlined",size:"small",value:s,onChange:k=>{console.log(k),i(k)}}),g&&f.jsx("div",{style:{marginLeft:20},className:ot.backText,children:E?g:I.I18n.t(g)})]}),b&&f.jsx("div",{className:ot.nameBlock,children:I.I18n.t(b)})]},c)}renderButton(n,s,i){const{className:a}=this.props,{attr:c,frontText:h,backText:g,doNotTranslate:b,doNotTranslateBack:$}=n;return f.jsxs("div",{className:I.Utils.clsx(ot.displayFlex,ot.blockMarginTop),children:[h&&f.jsx("div",{className:ot.frontText,children:b?h:I.I18n.t(h)}),f.jsx(wf,{fullWidth:!0,value:s.toString(),className:a,onClick:()=>i(s)}),g&&f.jsx("div",{className:ot.backText,children:$?g:I.I18n.t(g)})]},c)}async findIcon(n){var s;if(!n)return null;if((s=n.common)!=null&&s.icon)return I.getSelectIdIcon(n,"../..");if(n.type==="state"||n.type==="channel"){const i=n._id.split(".");i.pop();const a=i.join(".");try{const c=await this.props.socket.getObject(a);return await this.findIcon(c)}catch{return null}}return null}renderObjectID(n,s,i){const{attr:a,openCheckbox:c,checkReadOnly:h}=n,{settings:g}=this.state,b=this.state[`showSelectId${a}`],{className:$,socket:y,style:w}=this.props;let T=!0;c&&(T=typeof g.offset=="boolean"?g.offset:!0);const C=g[a],E=C?this.state[C]:void 0;return C&&!E&&E!==!1&&setTimeout(async k=>{var B;const A=await y.getObject(s),P=await this.findIcon(A),N={[k]:A||!1,[`${k}___icon`]:P,error:h&&this.lastObjectIdChange&&Date.now()-this.lastObjectIdChange<1e3&&((B=A==null?void 0:A.common)==null?void 0:B.write)===!1?I.I18n.t("Read only ID selected: %s",g[k]):""};this.setState(N)},0,C),T?f.jsxs("div",{className:ot.blockMarginTop,children:[f.jsxs("div",{className:ot.displayFlex,children:[n.title?f.jsx("div",{children:I.I18n.t(n.title)}):null,f.jsx(Yl,{className:$,style:w,autoComplete:"off",fullWidth:!0,disabled:!0,variant:"outlined",size:"small",value:s,customValue:!0}),f.jsx(wf,{icon:this.state[`${C}___icon`],square:!0,style:{...w||void 0,marginLeft:7},value:"...",className:$,onClick:()=>{const k={};k[`showSelectId${a}`]=!0,this.setState(k)}})]}),E?f.jsx("div",{className:I.Utils.clsx(ot.nameBlock,ot.displayItalic),children:I.Utils.getObjectNameFromObj(E,I.I18n.getLanguage())}):null,b?f.jsx(I.DialogSelectID,{theme:this.props.theme,imagePrefix:"../..",dialogName:"javascript",themeType:I.Utils.getThemeName(),socket:y,selected:s,onClose:()=>{const k={};k[`showSelectId${a}`]=!1,this.setState(k)},onOk:(k,A)=>{const P={};P[`showSelectId${a}`]=!1;const N=Array.isArray(k)?k[0]:k;this.setState(P,async()=>{var S,H,q,se,ee,K,Y,X,ce,W;const B=N?await y.getObject(N):void 0;this.lastObjectIdChange=Date.now(),i({[a]:k,[`${a}Role`]:(S=B==null?void 0:B.common)==null?void 0:S.role,[`${a}Type`]:(H=B==null?void 0:B.common)==null?void 0:H.type,[`${a}Unit`]:(q=B==null?void 0:B.common)==null?void 0:q.unit,[`${a}States`]:(se=B==null?void 0:B.common)==null?void 0:se.states,[`${a}Min`]:(ee=B==null?void 0:B.common)==null?void 0:ee.min,[`${a}Max`]:(K=B==null?void 0:B.common)==null?void 0:K.max,[`${a}Step`]:(Y=B==null?void 0:B.common)==null?void 0:Y.step,[`${a}Def`]:(X=B==null?void 0:B.common)==null?void 0:X.def,[`${a}Write`]:(ce=B==null?void 0:B.common)==null?void 0:ce.write,[`${a}Read`]:(W=B==null?void 0:B.common)==null?void 0:W.read},()=>this.props.setOnUpdate&&this.props.setOnUpdate(!0))})}}):null]},a):null}renderIconTag(){return f.jsx("div",{className:ot.iconTag,onClick:n=>{this.state.settings.tagCard&&(this.state.tagCardArray.length<3?this.onChangeTag():this.setState({openTagMenu:n.currentTarget}))},children:this.state.settings.tagCard})}renderTime(n,s,i){const{attr:a,backText:c,frontText:h,doNotTranslate:g,doNotTranslateBack:b}=n;return f.jsxs("div",{className:ot.displayFlex,style:{whiteSpace:"nowrap"},children:[h&&f.jsx("div",{className:ot.frontText,children:g?h:I.I18n.t(h)}),f.jsx(LN,{value:s,onChange:i}),c&&f.jsx("div",{className:ot.backText,children:b?c:I.I18n.t(c)})]},a)}renderSelect(n,s,i){const{className:a,style:c}=this.props,{name:h,options:g,frontText:b,backText:$,attr:y,multiple:w,doNotTranslate:T,doNotTranslate2:C,doNotTranslateBack:E}=n;return f.jsxs("div",{className:I.Utils.clsx(ot.displayFlex,ot.blockMarginTop),style:{whiteSpace:"nowrap"},children:[b&&f.jsx("div",{className:ot.frontText,children:I.I18n.t(b)}),f.jsx(kN,{attr:y,doNotTranslate:T,doNotTranslate2:C,title:h,className:a,style:c,options:g,value:s,onChange:i,multiple:w,customValue:!0}),$&&f.jsx("div",{className:ot.backText,children:E?$:I.I18n.t($)})]},y)}renderInstance(n,s,i){const{socket:a}=this.props,{name:c,frontText:h,backText:g,attr:b,adapter:$,doNotTranslate:y,doNotTranslateBack:w}=n;return this.state.hideAttributes.includes(b)?null:f.jsxs("div",{className:I.Utils.clsx(ot.displayFlex,ot.blockMarginTop),style:{whiteSpace:"nowrap"},children:[h&&f.jsx("div",{className:ot.frontText,children:y?h:I.I18n.t(h)}),f.jsx(_N,{attr:b,socket:a,adapter:$,title:c,value:s,onChange:T=>{i(Array.isArray(T)?T[0]:T)},customValue:!0,onInstanceHide:T=>this.setState({hideAttributes:[...this.state.hideAttributes,b]},()=>i(T))}),g&&f.jsx("div",{className:ot.backText,children:w?g:I.I18n.t(g)})]},b)}renderDialog(n){const{onShowDialog:s,frontText:i,backText:a,attr:c,icon:h,doNotTranslate:g,doNotTranslateBack:b}=n;return f.jsxs("div",{className:I.Utils.clsx(ot.displayFlex,ot.blockMarginTop),style:{whiteSpace:"nowrap"},children:[i&&f.jsx("div",{className:ot.frontText,children:g?i:I.I18n.t(i)}),f.jsx($u,{iconName:h,className:I.Utils.clsx(ot.iconDialog),onClick:()=>s&&s()}),a&&f.jsx("div",{className:ot.backText,children:b?a:I.I18n.t(a)})]},c)}renderModalInput(n,s,i){const{openModal:a}=this.state,{className:c}=this.props,{attr:h,nameBlock:g,frontText:b,backText:$,noTextEdit:y,doNotTranslate:w,doNotTranslateBack:T}=n;return f.jsxs("div",{children:[f.jsxs("div",{className:I.Utils.clsx(ot.displayFlex,ot.blockMarginTop),children:[b&&f.jsx("div",{className:ot.frontText,children:w?b:I.I18n.t(b)}),f.jsx(Yl,{disabled:!!y,className:c,autoComplete:"off",fullWidth:!0,variant:"outlined",size:"small",value:s,onChange:i,customValue:!0}),f.jsx(wf,{square:!0,style:{marginLeft:5},value:"...",className:c,onClick:()=>this.setState({openModal:!0})}),$&&f.jsx("div",{className:ot.backText,children:T?$:I.I18n.t($)})]}),a?f.jsx(z_,{onApply:C=>this.setState({openModal:!1},()=>C!=null&&i(C)),onClose:()=>this.setState({openModal:!1}),defaultValue:s,textInput:!0}):null,g&&f.jsx("div",{className:ot.nameBlock,children:I.I18n.t(g)})]},h)}renderDate(n,s,i){const{attr:a,backText:c,frontText:h,doNotTranslate:g,doNotTranslateBack:b}=n;return f.jsxs("div",{className:ot.displayFlex,style:{whiteSpace:"nowrap"},children:[h&&f.jsx("div",{className:ot.frontText,children:g?h:I.I18n.t(h)}),f.jsx(PN,{value:s,onChange:i}),c&&f.jsx("div",{className:ot.backText,children:b?c:I.I18n.t(c)})]},a)}static getReplacesInText(n){var i;let s="";return(i=n.trigger)!=null&&i.oidType?s=".replace(/%s/g, obj.state.val).replace(/%id/g, obj.id).replace(/%name/g, obj.common && obj.common.name).replace(/%old/g, obj.oldState.val)":n.conditionsStates.length&&(s=`.replace(/%s/g, ${n.conditionsStates[0].name}).replace(/%id/g, "${n.conditionsStates[0].id}")`),s}renderTags(){const{tagCardArray:n,openTagMenu:s}=this.state,{tagCard:i}=this.state.settings;let a=i!=="="&&i!=="<>"&&i!==">="&&i!=="()"&&i!=="."&&i!=="<="&&i!=="<"&&i!==">"&&i?I.I18n.t(i):i;return n.length>=3&&(a=f.jsxs("div",{children:[f.jsx("div",{"aria-controls":"simple-menu","aria-haspopup":"true",onClick:c=>{this.setState({openTagMenu:c.currentTarget},()=>{this.props.isTourOpen&&this.props.tourStep===Ss.openTagsMenu&&setTimeout(()=>this.props.setTourStep&&this.props.setTourStep(Ss.selectIntervalTag),300)})},children:a}),f.jsx(D.Menu,{id:"simple-menu",anchorEl:s,keepMounted:!0,open:!!s,onClose:()=>this.setState({openTagMenu:null}),children:n.map((c,h)=>{let g;return typeof c!="string"?g=c.title:g=c,f.jsxs(D.MenuItem,{selected:g===i,className:`tag-card-${g}`,style:{placeContent:"space-between"},onClick:b=>{b.stopPropagation(),this.props.isTourOpen&&(this.props.tourStep===Ss.openTagsMenu||this.props.tourStep===Ss.selectIntervalTag)&&g==="interval"&&setTimeout(()=>{var y,w;return(w=(y=this.props).setTourStep)==null?void 0:w.call(y,Ss.selectActions)},500);const $=JSON.parse(JSON.stringify(this.state.settings));$.tagCard=g,this.setState({openTagMenu:null,settings:$},()=>{this.props.onChange(this.state.settings),this.onTagChange(this.state.settings.tagCard)})},children:[g.search(/>|<|<>|<=|>=|=/)!==-1?g:I.I18n.t(g),typeof c!="string"&&c.title2&&f.jsx("div",{style:{marginLeft:4},children:I.I18n.t(c.title2)})]},`${g}_${h}`)})})]})),a}getData(){return{acceptedBy:"triggers",name:"",id:""}}onChangeTag(){const{tagCardArray:n,settings:s,settings:{tagCard:i}}=this.state;let a;if(typeof n[0]!="string"?a=n.map(c=>c.title):a=[...n],i&&a.length<3){const c={...s},h=a[(a.indexOf(i)+1)%a.length];c.tagCard=h,this.setState({settings:c},()=>{this.props.onChange(c),this.onTagChange(h)})}}componentDidMount(){this.onTagChange()}componentDidUpdate(){this.props.acceptedBy!=="triggers"&&this.props.onUpdate&&setTimeout(()=>this.onUpdate(),0)}onChangeInput(n){return(s,i,a)=>{const c=JSON.parse(JSON.stringify(this.state.settings));typeof s=="object"&&(!i||typeof i=="function")?(Object.keys(s).forEach(h=>c[h]=s[h]),typeof i=="function"&&(a=i,i=void 0)):c[i||n]=s,c.id=this.getData().id,c._id=this.props._id,this.setState({settings:c},()=>{this.onValueChanged(s,i||n),this.props.onChange(c),a==null||a()})}}renderSpecific(){return null}renderDebug(n){return""}renderDebugInfo(){return this.state.debugMessage?f.jsx("div",{className:ot.debugInfo,style:{opacity:1,height:22,bottom:-22},children:this.renderDebug?this.renderDebug(this.state.debugMessage):I.I18n.t("executed")},this.state.debugMessage.ts):null}renderCron(n,s,i){return null}renderWizard(n,s,i){return null}renderWriteState(){return null}renderInputElement(n,s){const{nameRender:i,defaultValue:a,attr:c}=n,{settings:h}=this.state;let g=c?h[c]:void 0;switch(g===void 0&&(g=a),i){case"renderTime":return c?this.renderTime(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderTime")},`invalid_${s}`);case"renderNameText":return this.renderNameText(n,a);case"renderSelect":return c?this.renderSelect(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderSelect")},`invalid_${s}`);case"renderModalInput":return c?this.renderModalInput(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderModalInput")},`invalid_${s}`);case"renderObjectID":return c?this.renderObjectID(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderObjectID")},`invalid_${s}`);case"renderDialog":return c?this.renderDialog(n):f.jsx("div",{children:I.I18n.t("Invalid renderDialog")},`invalid_${s}`);case"renderInstance":return c?this.renderInstance(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderInstance")},`invalid_${s}`);case"renderText":return c?this.renderText(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderText")},`invalid_${s}`);case"renderSlider":return c?this.renderSlider(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderSlider")},`invalid_${s}`);case"renderCheckbox":return c?this.renderCheckbox(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderCheckbox")},`invalid_${s}`);case"renderButton":return c?this.renderButton(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderButton")},`invalid_${s}`);case"renderColor":return c?this.renderColor(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderColor")},`invalid_${s}`);case"renderSwitch":return c?this.renderSwitch(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderSwitch")},`invalid_${s}`);case"renderDate":return c?this.renderDate(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderDate")},`invalid_${s}`);case"renderCron":return c?this.renderCron(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderCron")},`invalid_${s}`);case"renderWizard":return c?this.renderWizard(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderWizard")},`invalid_${s}`);case"renderWriteState":return this.renderWriteState();case"renderNumber":return c?this.renderNumber(n,g,this.onChangeInput(c)):f.jsx("div",{children:I.I18n.t("Invalid renderNumber")},`invalid_${s}`);default:return this[i]?this[i](n,g,c?this.onChangeInput(c):null):f.jsx("div",{children:I.I18n.t("Invalid input type: %s",i)},`invalid_${s}`)}}render(){var T;const{inputs:n,name:s,icon:i,iconTag:a,settings:c,adapter:h,settings:{tagCard:g},helpDialog:b}=this.state,{socket:$,notFound:y}=this.props;this.state.settings&&!this.state.settings.tagCard&&((T=this.state.tagCardArray)!=null&&T.length)&&setTimeout(()=>{const C=JSON.parse(JSON.stringify(this.state.settings));C.tagCard=typeof this.state.tagCardArray[0]!="string"?this.state.tagCardArray[0].title:this.state.tagCardArray[0],this.setState({settings:C})},50),this.state.enableSimulation!==this.props.enableSimulation&&!this.enableSimulationProcessing&&(this.enableSimulationProcessing=!0,setTimeout(()=>{this.setState({enableSimulation:this.props.enableSimulation},()=>{this.enableSimulationProcessing=!1})},50));let w;if(this.props.onDebugMessage)for(let C=this.props.onDebugMessage.length-1;C>=0;C--){const E=this.props.onDebugMessage[C];if(E.blockId===this.props._id&&E.ts>this.lastDebugMessage&&E.ts>Date.now()-1e3){w=E;break}}return w&&(this.lastDebugMessage=w.ts,this.debugMessageTimeout&&clearTimeout(this.debugMessageTimeout),this.debugHideTimeout&&(clearTimeout(this.debugHideTimeout),this.debugHideTimeout=null),this.debugMessageTimeout=setTimeout(C=>{const E=JSON.parse(C),k=E.hideTimeout||5e3;this.debugMessageTimeout=null,this.setState({debugMessage:E},()=>{this.debugHideTimeout&&clearTimeout(this.debugHideTimeout),this.debugHideTimeout=setTimeout(()=>{this.debugHideTimeout=null,this.setState({debugMessage:null})},k)})},50,JSON.stringify(w))),f.jsxs(ve.Fragment,{children:[a?this.renderIconTag():f.jsx($u,{iconName:i,className:I.Utils.clsx(ot.iconThemCard,g&&this.state.tagCardArray.length&&ot.iconThemCardSelectable),adapter:h,socket:$,onClick:C=>{g&&(this.state.tagCardArray.length<3?this.onChangeTag():this.setState({openTagMenu:C.currentTarget}))}}),f.jsxs("div",{className:ot.blockName,children:[f.jsxs("span",{className:ot.nameCard,children:[I.I18n.t(s),y?I.I18n.t("%s not found",c.id):"",b?f.jsx(D.IconButton,{className:ot.iconHelp,size:"small",onClick:()=>this.setState({helpText:I.I18n.t(b)}),children:f.jsx(dw,{})}):null]}),n.map((C,E)=>this.renderInputElement(C,E))]}),g&&f.jsx("div",{className:ot.controlMenuTop,style:{opacity:1,height:22,top:-22},children:f.jsx("div",{onClick:()=>this.onChangeTag(),className:I.Utils.clsx(ot.tagCard,"tag-card"),children:this.renderTags()})}),this.renderDebugInfo(),this.state.error?f.jsx(I.DialogError,{title:I.I18n.t("Warning"),text:this.state.error,onClose:()=>this.setState({error:""})}):null,this.state.helpText?f.jsx(I.DialogMessage,{title:I.I18n.t("Instructions"),text:this.state.helpText,onClose:()=>this.setState({helpText:""})}):null,this.renderSpecific()]})}}const XS={en:{name:"Google - English",engine:"google",params:[]},de:{name:"Google - Deutsch",engine:"google",params:[]},ru:{name:"Google - ",engine:"google",params:[]},it:{name:"Google - Italiano",engine:"google",params:[]},es:{name:"Google - Espaniol",engine:"google",params:[]},fr:{name:"Google - Franais",engine:"google",params:[]},ru_YA:{name:"Yandex - ",engine:"yandex",params:["key","voice","emotion","ill","drunk","robot"],voice:["jane","zahar"],emotion:["none","good","neutral","evil","mixed"]},ru_YA_CLOUD:{name:"Yandex Cloud - ",engine:"yandexCloud",params:["key","folderID","voice","emotion"],voice:["alyss","oksana","jane","zahar"],emotion:["good","neutral","evil"]},"en-US":{name:"PicoTTS - Englisch US",engine:"PicoTTS",params:[]},"en-GB":{name:"PicoTTS - Englisch GB",engine:"PicoTTS",params:[]},"de-DE":{name:"PicoTTS - Deutsch",engine:"PicoTTS",params:[]},"it-IT":{name:"PicoTTS - Italiano",engine:"PicoTTS",params:[]},"es-ES":{name:"PicoTTS - Espaniol",engine:"PicoTTS",params:[]},"fr-FR":{name:"PicoTTS - Franais",engine:"PicoTTS",params:[]},"ru-RU_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"ru-RU",ename:"Tatyana",ssml:!0,name:"Cloud -  - "},"ru-RU_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"ru-RU",ename:"Maxim",ssml:!0,name:"Cloud -  - "},"de-DE_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"de-DE",ename:"Marlene",ssml:!0,name:"Cloud - Deutsch - Marlene"},"de-DE_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"de-DE",ename:"Hans",ssml:!0,name:"Cloud - Deutsch - Hans"},"en-US_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"en-US",ename:"Salli",ssml:!0,name:"Cloud - en-US - Female - Salli"},"en-US_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"en-US",ename:"Joey",ssml:!0,name:"Cloud - en-US - Male - Joey"},"da-DK_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"da-DK",ename:"Naja",ssml:!0,name:"Cloud - da-DK - Female - Naja"},"da-DK_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"da-DK",ename:"Mads",ssml:!0,name:"Cloud - da-DK - Male - Mads"},"en-AU_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"en-AU",ename:"Nicole",ssml:!0,name:"Cloud - en-AU - Female - Nicole"},"en-AU_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"en-AU",ename:"Russell",ssml:!0,name:"Cloud - en-AU - Male - Russell"},"en-GB_CLOUD_Female_Amy":{gender:"Female",engine:"cloud",params:["cloud"],language:"en-GB",ename:"Amy",ssml:!0,name:"Cloud - en-GB - Female - Amy"},"en-GB_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"en-GB",ename:"Brian",ssml:!0,name:"Cloud - en-GB - Male - Brian"},"en-GB_CLOUD_Female_Emma":{gender:"Female",engine:"cloud",params:["cloud"],language:"en-GB",ename:"Emma",ssml:!0,name:"Cloud - en-GB - Female - Emma"},"en-GB-WLS_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"en-GB-WLS",ename:"Gwyneth",ssml:!0,name:"Cloud - en-GB-WLS - Female - Gwyneth"},"en-GB-WLS_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"en-GB-WLS",ename:"Geraint",ssml:!0,name:"Cloud - en-GB-WLS - Male - Geraint"},"cy-GB_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"cy-GB",ename:"Gwyneth",ssml:!0,name:"Cloud - cy-GB - Female - Gwyneth"},"cy-GB_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"cy-GB",ename:"Geraint",ssml:!0,name:"Cloud - cy-GB - Male - Geraint"},"en-IN_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"en-IN",ename:"Raveena",ssml:!0,name:"Cloud - en-IN - Female - Raveena"},"en-US_CLOUD_Male_Chipmunk":{gender:"Male",engine:"cloud",params:["cloud"],language:"en-US",ename:"Chipmunk",ssml:!0,name:"Cloud - en-US - Male - Chipmunk"},"en-US_CLOUD_Male_Eric":{gender:"Male",engine:"cloud",params:["cloud"],language:"en-US",ename:"Eric",ssml:!0,name:"Cloud - en-US - Male - Eric"},"en-US_CLOUD_Female_Ivy":{gender:"Female",engine:"cloud",params:["cloud"],language:"en-US",ename:"Ivy",ssml:!0,name:"Cloud - en-US - Female - Ivy"},"en-US_CLOUD_Female_Jennifer":{gender:"Female",engine:"cloud",params:["cloud"],language:"en-US",ename:"Jennifer",ssml:!0,name:"Cloud - en-US - Female - Jennifer"},"en-US_CLOUD_Male_Justin":{gender:"Male",engine:"cloud",params:["cloud"],language:"en-US",ename:"Justin",ssml:!0,name:"Cloud - en-US - Male - Justin"},"en-US_CLOUD_Female_Kendra":{gender:"Female",engine:"cloud",params:["cloud"],language:"en-US",ename:"Kendra",ssml:!0,name:"Cloud - en-US - Female - Kendra"},"en-US_CLOUD_Female_Kimberly":{gender:"Female",engine:"cloud",params:["cloud"],language:"en-US",ename:"Kimberly",ssml:!0,name:"Cloud - en-US - Female - Kimberly"},"es-ES_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"es-ES",ename:"Conchita",ssml:!0,name:"Cloud - es-ES - Female - Conchita"},"es-ES_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"es-ES",ename:"Enrique",ssml:!0,name:"Cloud - es-ES - Male - Enrique"},"es-US_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"es-US",ename:"Penelope",ssml:!0,name:"Cloud - es-US - Female - Penelope"},"es-US_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"es-US",ename:"Miguel",ssml:!0,name:"Cloud - es-US - Male - Miguel"},"fr-CA_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"fr-CA",ename:"Chantal",ssml:!0,name:"Cloud - fr-CA - Female - Chantal"},"fr-FR_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"fr-FR",ename:"Celine",ssml:!0,name:"Cloud - fr-FR - Female - Celine"},"fr-FR_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"fr-FR",ename:"Mathieu",ssml:!0,name:"Cloud - fr-FR - Male - Mathieu"},"is-IS_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"is-IS",ename:"Dora",ssml:!0,name:"Cloud - is-IS - Female - Dora"},"is-IS_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"is-IS",ename:"Karl",ssml:!0,name:"Cloud - is-IS - Male - Karl"},"it-IT_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"it-IT",ename:"Carla",ssml:!0,name:"Cloud - it-IT - Female - Carla"},"it-IT_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"it-IT",ename:"Giorgio",ssml:!0,name:"Cloud - it-IT - Male - Giorgio"},"nb-NO_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"nb-NO",ename:"Liv",ssml:!0,name:"Cloud - nb-NO - Female - Liv"},"nl-NL_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"nl-NL",ename:"Lotte",ssml:!0,name:"Cloud - nl-NL - Female - Lotte"},"nl-NL_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"nl-NL",ename:"Ruben",ssml:!0,name:"Cloud - nl-NL - Male - Ruben"},"pl-PL_CLOUD_Female_Agnieszka":{gender:"Female",engine:"cloud",params:["cloud"],language:"pl-PL",ename:"Agnieszka",ssml:!0,name:"Cloud - pl-PL - Female - Agnieszka"},"pl-PL_CLOUD_Male_Jacek":{gender:"Male",engine:"cloud",params:["cloud"],language:"pl-PL",ename:"Jacek",ssml:!0,name:"Cloud - pl-PL - Male - Jacek"},"pl-PL_CLOUD_Female_Ewa":{gender:"Female",engine:"cloud",params:["cloud"],language:"pl-PL",ename:"Ewa",ssml:!0,name:"Cloud - pl-PL - Female - Ewa"},"pl-PL_CLOUD_Male_Jan":{gender:"Male",engine:"cloud",params:["cloud"],language:"pl-PL",ename:"Jan",ssml:!0,name:"Cloud - pl-PL - Male - Jan"},"pl-PL_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"pl-PL",ename:"Maja",ssml:!0,name:"Cloud - pl-PL - Female - Maja"},"pt-BR_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"pt-BR",ename:"Vitoria",ssml:!0,name:"Cloud - pt-BR - Female - Vitoria"},"pt-BR_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"pt-BR",ename:"Ricardo",ssml:!0,name:"Cloud - pt-BR - Male - Ricardo"},"pt-PT_CLOUD_Male":{gender:"Male",engine:"cloud",params:["cloud"],language:"pt-PT",ename:"Cristiano",ssml:!0,name:"Cloud - pt-PT - Male - Cristiano"},"pt-PT_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"pt-PT",ename:"Ines",ssml:!0,name:"Cloud - pt-PT - Female - Ines"},"ro-RO_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"ro-RO",ename:"Carmen",ssml:!0,name:"Cloud - ro-RO - Female - Carmen"},"sv-SE_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"sv-SE",ename:"Astrid",ssml:!0,name:"Cloud - sv-SE - Female - Astrid"},"tr-TR_CLOUD_Female":{gender:"Female",engine:"cloud",params:["cloud"],language:"tr-TR",ename:"Filiz",ssml:!0,name:"Cloud - tr-TR - Female - Filiz"},"ru-RU_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"ru-RU",ename:"Tatyana",ssml:!0,name:"AWS Polly -  - "},"ru-RU_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"ru-RU",ename:"Maxim",ssml:!0,name:"AWS Polly -  - "},"de-DE_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"de-DE",ename:"Marlene",ssml:!0,name:"AWS Polly - Deutsch - Marlene"},"de-DE_AP_Female_Vicky":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"de-DE",ename:"Vicky",ssml:!0,name:"AWS Polly - Deutsch - Vicky"},"de-DE_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"de-DE",ename:"Hans",ssml:!0,name:"AWS Polly - Deutsch - Hans"},"en-US_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"en-US",ename:"Salli",ssml:!0,name:"AWS Polly - en-US - Female - Salli"},"en-US_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"en-US",ename:"Joey",ssml:!0,name:"AWS Polly - en-US - Male - Joey"},"da-DK_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"da-DK",ename:"Naja",ssml:!0,name:"AWS Polly - da-DK - Female - Naja"},"da-DK_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"da-DK",ename:"Mads",ssml:!0,name:"AWS Polly - da-DK - Male - Mads"},"en-AU_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"en-AU",ename:"Nicole",ssml:!0,name:"AWS Polly - en-AU - Female - Nicole"},"en-AU_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"en-AU",ename:"Russell",ssml:!0,name:"AWS Polly - en-AU - Male - Russell"},"en-GB_AP_Female_Amy":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"en-GB",ename:"Amy",ssml:!0,name:"AWS Polly - en-GB - Female - Amy"},"en-GB_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"en-GB",ename:"Brian",ssml:!0,name:"AWS Polly - en-GB - Male - Brian"},"en-GB_AP_Female_Emma":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"en-GB",ename:"Emma",ssml:!0,name:"AWS Polly - en-GB - Female - Emma"},"en-GB-WLS_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"en-GB-WLS",ename:"Gwyneth",ssml:!0,name:"AWS Polly - en-GB-WLS - Female - Gwyneth"},"en-GB-WLS_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"en-GB-WLS",ename:"Geraint",ssml:!0,name:"AWS Polly - en-GB-WLS - Male - Geraint"},"cy-GB_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"cy-GB",ename:"Gwyneth",ssml:!0,name:"AWS Polly - cy-GB - Female - Gwyneth"},"cy-GB_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"cy-GB",ename:"Geraint",ssml:!0,name:"AWS Polly - cy-GB - Male - Geraint"},"en-IN_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"en-IN",ename:"Raveena",ssml:!0,name:"AWS Polly - en-IN - Female - Raveena"},"en-US_AP_Male_Chipmunk":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"en-US",ename:"Chipmunk",ssml:!0,name:"AWS Polly - en-US - Male - Chipmunk"},"en-US_AP_Male_Eric":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"en-US",ename:"Eric",ssml:!0,name:"AWS Polly - en-US - Male - Eric"},"en-US_AP_Female_Ivy":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"en-US",ename:"Ivy",ssml:!0,name:"AWS Polly - en-US - Female - Ivy"},"en-US_AP_Female_Jennifer":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"en-US",ename:"Jennifer",ssml:!0,name:"AWS Polly - en-US - Female - Jennifer"},"en-US_AP_Male_Justin":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"en-US",ename:"Justin",ssml:!0,name:"AWS Polly - en-US - Male - Justin"},"en-US_AP_Female_Kendra":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"en-US",ename:"Kendra",ssml:!0,name:"AWS Polly - en-US - Female - Kendra"},"en-US_AP_Female_Kimberly":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"en-US",ename:"Kimberly",ssml:!0,name:"AWS Polly - en-US - Female - Kimberly"},"es-ES_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"es-ES",ename:"Conchita",ssml:!0,name:"AWS Polly - es-ES - Female - Conchita"},"es-ES_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"es-ES",ename:"Enrique",ssml:!0,name:"AWS Polly - es-ES - Male - Enrique"},"es-US_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"es-US",ename:"Penelope",ssml:!0,name:"AWS Polly - es-US - Female - Penelope"},"es-US_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"es-US",ename:"Miguel",ssml:!0,name:"AWS Polly - es-US - Male - Miguel"},"fr-CA_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"fr-CA",ename:"Chantal",ssml:!0,name:"AWS Polly - fr-CA - Female - Chantal"},"fr-FR_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"fr-FR",ename:"Celine",ssml:!0,name:"AWS Polly - fr-FR - Female - Celine"},"fr-FR_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"fr-FR",ename:"Mathieu",ssml:!0,name:"AWS Polly - fr-FR - Male - Mathieu"},"is-IS_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"is-IS",ename:"Dora",ssml:!0,name:"AWS Polly - is-IS - Female - Dora"},"is-IS_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"is-IS",ename:"Karl",ssml:!0,name:"AWS Polly - is-IS - Male - Karl"},"it-IT_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"it-IT",ename:"Carla",ssml:!0,name:"AWS Polly - it-IT - Female - Carla"},"it-IT_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"it-IT",ename:"Giorgio",ssml:!0,name:"AWS Polly - it-IT - Male - Giorgio"},"nb-NO_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"nb-NO",ename:"Liv",ssml:!0,name:"AWS Polly - nb-NO - Female - Liv"},"nl-NL_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"nl-NL",ename:"Lotte",ssml:!0,name:"AWS Polly - nl-NL - Female - Lotte"},"nl-NL_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"nl-NL",ename:"Ruben",ssml:!0,name:"AWS Polly - nl-NL - Male - Ruben"},"pl-PL_AP_Female_Agnieszka":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"pl-PL",ename:"Agnieszka",ssml:!0,name:"AWS Polly - pl-PL - Female - Agnieszka"},"pl-PL_AP_Male_Jacek":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"pl-PL",ename:"Jacek",ssml:!0,name:"AWS Polly - pl-PL - Male - Jacek"},"pl-PL_AP_Female_Ewa":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"pl-PL",ename:"Ewa",ssml:!0,name:"AWS Polly - pl-PL - Female - Ewa"},"pl-PL_AP_Male_Jan":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"pl-PL",ename:"Jan",ssml:!0,name:"AWS Polly - pl-PL - Male - Jan"},"pl-PL_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"pl-PL",ename:"Maja",ssml:!0,name:"AWS Polly - pl-PL - Female - Maja"},"pt-BR_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"pt-BR",ename:"Vitoria",ssml:!0,name:"AWS Polly - pt-BR - Female - Vitoria"},"pt-BR_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"pt-BR",ename:"Ricardo",ssml:!0,name:"AWS Polly - pt-BR - Male - Ricardo"},"pt-PT_AP_Male":{gender:"Male",engine:"polly",params:["accessKey","secretKey","region"],language:"pt-PT",ename:"Cristiano",ssml:!0,name:"AWS Polly - pt-PT - Male - Cristiano"},"pt-PT_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"pt-PT",ename:"Ines",ssml:!0,name:"AWS Polly - pt-PT - Female - Ines"},"ro-RO_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"ro-RO",ename:"Carmen",ssml:!0,name:"AWS Polly - ro-RO - Female - Carmen"},"sv-SE_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"sv-SE",ename:"Astrid",ssml:!0,name:"AWS Polly - sv-SE - Female - Astrid"},"tr-TR_AP_Female":{gender:"Female",engine:"polly",params:["accessKey","secretKey","region"],language:"tr-TR",ename:"Filiz",ssml:!0,name:"AWS Polly - tr-TR - Female - Filiz"}};class sv extends yn{constructor(n){super(n,sv.getStaticData())}static compile(n,s){return n.text?`// Sayit ${n.text||""}
		const subActionVar${n._id} = "${n.language&&n.language!=="_"?`${n.language};`:""}${n.volume?`${n.volume};`:""}${(n.text||"").replace(/"/g,'\\"')}"${yn.getReplacesInText(s)};
		_sendToFrontEnd(${n._id}, {text: subActionVar${n._id}});
		await setStateAsync("${n.instance}.tts.text", subActionVar${n._id});`:`// no text defined
_sendToFrontEnd(${n._id}, {text: 'No text defined'});`}renderDebug(n){return`${I.I18n.t("Say:")} ${n.data.text}`}onTagChange(){const n=I.I18n.getLanguage(),i=Object.keys(XS).filter(a=>a.startsWith(n)).map(a=>({title:XS[a].name,value:a}));i.unshift({title:"Default",value:"_"}),this.setState({inputs:[{attr:"instance",nameRender:"renderInstance",adapter:"sayit",defaultValue:"sayit.0",frontText:"Instance:"},{nameRender:"renderSelect",frontText:"Language:",options:i,defaultValue:"_",attr:"language"},{nameRender:"renderNameText",defaultValue:"Volume",attr:"textVol"},{nameRender:"renderSlider",attr:"volume",defaultValue:100,min:0,max:100},{attr:"text",nameRender:"renderModalInput",defaultValue:"Hallo",nameBlock:"",frontText:"Text:"}]},()=>super.onTagChange())}static getStaticData(){return{acceptedBy:"actions",name:"Say It",id:"ActionSayText",adapter:"sayit",title:"Say some text via sayit adapter",helpDialog:"You can use %s in the text to display current trigger value or %id to display the triggered object ID"}}getData(){return sv.getStaticData()}}class rv extends yn{constructor(n){super(n,rv.getStaticData())}static compile(n,s){const i=(n.text||"").replace(/"/g,'\\"');return i?`// Pushover ${n.text||""}
		const subActionVar${n._id} = "${i}"${yn.getReplacesInText(s)};
		_sendToFrontEnd(${n._id}, {text: subActionVar${n._id}});            
		sendTo("${n.instance}", "send", {
		    message: subActionVar${n._id},
		    title: "${(n.title||"").replace(/"/g,'\\"')}"${yn.getReplacesInText(s)},
		    sound: "${n.sound}",
		    priority: ${n.priority}
		});`:`// no text defined
_sendToFrontEnd(${n._id}, {text: 'No text defined'});`}renderDebug(n){return`Sent: ${n.data.text}`}onTagChange(){this.setState({inputs:[{nameRender:"renderInstance",adapter:"pushover",frontText:"Instance:",defaultValue:"pushover.0",attr:"instance"},{nameRender:"renderModalInput",attr:"text",defaultValue:"Hello",nameBlock:"",frontText:"Text:"},{nameRender:"renderText",attr:"title",defaultValue:"ioBroker",frontText:"Title:"},{nameRender:"renderSelect",attr:"sound",defaultValue:"magic",frontText:"Sound:",doNotTranslate:!0,options:[{value:"pushover",title:"pushover"},{value:"bike",title:"bike"},{value:"bugle",title:"bugle"},{value:"cashregister",title:"cashregister"},{value:"classical",title:"classical"},{value:"cosmic",title:"cosmic"},{value:"falling",title:"falling"},{value:"gamelan",title:"gamelan"},{value:"incoming",title:"incoming"},{value:"intermission",title:"intermission"},{value:"magic",title:"magic"},{value:"mechanical",title:"mechanical"},{value:"pianobar",title:"pianobar"},{value:"siren",title:"siren"},{value:"spacealarm",title:"spacealarm"},{value:"tugboat",title:"tugboat"},{value:"alien",title:"alien"},{value:"climb",title:"climb"},{value:"persistent",title:"persistent"},{value:"echo",title:"echo"},{value:"updown",title:"updown"},{value:"none",title:"none"}]},{nameRender:"renderSelect",attr:"priority",defaultValue:-1,frontText:"Priority:",options:[{value:-1,title:"quiet"},{value:0,title:"normal"},{value:1,title:"high-priority"},{value:2,title:"acknowledgment"}]}]},()=>super.onTagChange())}static getStaticData(){return{acceptedBy:"actions",name:"Pushover",id:"ActionPushover",adapter:"pushover",title:"Sends message via pushover",helpDialog:"You can use %s in the text to display current trigger value or %id to display the triggered object ID"}}getData(){return rv.getStaticData()}}class iv extends yn{constructor(n){super(n,iv.getStaticData())}static compile(n,s){const i=(n.text||"").replace(/"/g,'\\"');return i?`// whatsapp ${i||""}
		const subActionVar${n._id} = "${(i||"").replace(/"/g,'\\"')}"${yn.getReplacesInText(s)};
		_sendToFrontEnd(${n._id}, {text: subActionVar${n._id}});
		sendTo("${n.instance}", "send", {text: subActionVar${n._id}${n.phone?`, phone: "${n.phone.replace(/"/g,'\\"')}"`:""}});`:`// no text defined
_sendToFrontEnd(${n._id}, {text: 'No text defined'});`}renderDebug(n){return`${I.I18n.t("Sent:")} ${n.data.text}`}onTagChange(){this.setState({inputs:[{nameRender:"renderInstance",adapter:"whatsapp-cmb",frontText:"Instance:",defaultValue:"whatsapp-cmb.0",attr:"instance"},{nameRender:"renderModalInput",attr:"text",defaultValue:"Hello",nameBlock:"",frontText:"Text:"},{nameRender:"renderText",attr:"phone",defaultValue:"",frontText:"Phone:",backText:"(optional)"}]},()=>super.onTagChange())}static getStaticData(){return{acceptedBy:"actions",name:"Whatsapp-cmb",id:"ActionWhatsappcmb",adapter:"whatsapp-cmb",title:"Sends message via whatsapp-cmb",helpDialog:"You can use %s in the text to display current trigger value or %id to display the triggered object ID"}}getData(){return iv.getStaticData()}}class ov extends yn{constructor(n){super(n,ov.getStaticData())}static compile(n,s){const i=(n.text||"").replace(/"/g,'\\"');return i?`// Pushsafer ${n.text||""}
		const subActionVar${n._id} = "${i}"${yn.getReplacesInText(s)};
		_sendToFrontEnd(${n._id}, {text: subActionVar${n._id}});            
		sendTo("${n.instance}", "send", {
		    message: subActionVar${n._id},
		    title: "${(n.title||"").replace(/"/g,'\\"')}"${yn.getReplacesInText(s)},
		    ${n.sound&&n.sound!=="_"?`sound: "${n.sound}",`:""}
		    priority: ${n.priority},
		    ${n.vibration&&n.vibration!=="_"?`vibration: ${n.vibration},`:""}
		});`:`// no text defined
_sendToFrontEnd(${n._id}, {text: 'No text defined'});`}renderDebug(n){return`Sent: ${n.data.text}`}onTagChange(){this.setState({inputs:[{nameRender:"renderInstance",adapter:"pushsafer",frontText:"Instance:",defaultValue:"pushsafer.0",attr:"instance"},{nameRender:"renderModalInput",attr:"text",defaultValue:"Hello",nameBlock:"",frontText:"Text:"},{nameRender:"renderText",attr:"title",defaultValue:"ioBroker",frontText:"Title:"},{nameRender:"renderSelect",attr:"sound",defaultValue:"magic",frontText:"Sound:",doNotTranslate:!0,options:[{value:"_",title:"Device Default"},{value:"0",title:"Silent"},{value:"1",title:"Ahem (IM)"},{value:"2",title:"Applause (Mail)"},{value:"3",title:"Arrow (Reminder)"},{value:"4",title:"Baby (SMS)"},{value:"5",title:"Bell (Alarm)"},{value:"6",title:"Bicycle (Alarm2)"},{value:"7",title:"Boing (Alarm3)"},{value:"8",title:"Buzzer (Alarm4)"},{value:"9",title:"Camera (Alarm5)"},{value:"10",title:"Car Horn (Alarm6)"},{value:"11",title:"Cash Register (Alarm7)"},{value:"12",title:"Chime (Alarm8)"},{value:"13",title:"Creaky Door (Alarm9)"},{value:"14",title:"Cuckoo Clock (Alarm10)"},{value:"15",title:"Disconnect (Call)"},{value:"16",title:"Dog (Call2)"},{value:"17",title:"Doorbell (Call3)"},{value:"18",title:"Fanfare (Call4)"},{value:"19",title:"Gun Shot (Call5)"},{value:"20",title:"Honk (Call6)"},{value:"21",title:"Jaw Harp (Call7)"},{value:"22",title:"Morse (Call8)"},{value:"23",title:"Electricity (Call9)"},{value:"24",title:"Radio Tuner (Call10)"},{value:"25",title:"Sirens"},{value:"26",title:"Military Trumpets"},{value:"27",title:"Ufo"},{value:"28",title:"Whah Whah Whah"},{value:"29",title:"Man Saying Goodbye"},{value:"30",title:"Man Saying Hello"},{value:"31",title:"Man Saying No"},{value:"32",title:"Man Saying Ok"},{value:"33",title:"Man Saying Ooohhhweee"},{value:"34",title:"Man Saying Warning"},{value:"35",title:"Man Saying Welcome"},{value:"36",title:"Man Saying Yeah"},{value:"37",title:"Man Saying Yes"},{value:"38",title:"Beep short"},{value:"39",title:"Weeeee short"},{value:"40",title:"Cut in and out short"},{value:"41",title:"Finger flicking glas short"},{value:"42",title:"Wa Wa Waaaa short"},{value:"43",title:"Laser short"},{value:"44",title:"Wind Chime short"},{value:"45",title:"Echo short"},{value:"46",title:"Zipper short"},{value:"47",title:"HiHat short"},{value:"48",title:"Beep 2 short"},{value:"49",title:"Beep 3 short"},{value:"50",title:"Beep 4 short"},{value:"51",title:"The Alarm is armed"},{value:"52",title:"The Alarm is disarmed"},{value:"53",title:"The Backup is ready"},{value:"54",title:"The Door is closed"},{value:"55",title:"The Door is opend"},{value:"56",title:"The Window is closed"},{value:"57",title:"The Window is open"},{value:"58",title:"The Light is off"},{value:"59",title:"The Light is on"},{value:"60",title:"The Doorbell rings"},{value:"61",title:"Pager short"},{value:"62",title:"Pager long"}]},{nameRender:"renderSelect",attr:"priority",defaultValue:0,frontText:"Priority:",options:[{value:-2,title:"lowest priority"},{value:-1,title:"lower priority"},{value:0,title:"normal priority"},{value:1,title:"high priority"},{value:2,title:"highest priority"}]},{nameRender:"renderSelect",attr:"vibration",defaultValue:0,frontText:"Vibration:",options:[{value:"_",title:"default"},{value:1,title:"1"},{value:2,title:"2"},{value:3,title:"3"}]}]},()=>super.onTagChange())}static getStaticData(){return{acceptedBy:"actions",name:"Pushsafer",id:"ActionPushsafer",adapter:"pushsafer",title:"Sends message via Pushsafer",helpDialog:"You can use %s in the text to display current trigger value or %id to display the triggered object ID"}}getData(){return ov.getStaticData()}}const Lk=`async function (obj) {
    "__%%DEBUG_TRIGGER%%__";
    __%%CONDITIONS_VARS%%__
    const _cond = __%%CONDITION%%__;
    
    "__%%DEBUG_CONDITIONS%%__";
    
    if (_cond) {
__%%THEN%%__
    } else {
__%%ELSE%%__
    }
}`,Bk=`async function (obj) {
    "__%%DEBUG_TRIGGER%%__";
    __%%CONDITIONS_VARS%%__
    const _cond = __%%CONDITION%%__;
    
    "__%%DEBUG_CONDITIONS%%__";
    
    if (__%%STATE%%__ === false && _cond) {
        __%%STATE%%__ = true;    
__%%THEN%%__
    } else if (__%%STATE%%__ === true && !_cond) {
        __%%STATE%%__ = false;    
__%%ELSE%%__
    }
}`,zN=`"__%%DEBUG_TRIGGER%%__";
__%%CONDITIONS_VARS%%__
const _cond = __%%CONDITION%%__;

"__%%DEBUG_CONDITIONS%%__";

if (_cond) {
__%%THEN%%__
} else {
__%%ELSE%%__
}`,Xy={triggers:[],conditions:[[]],justCheck:!1,actions:{then:[],else:[]}};function UN(o,n,s){const i=[];let a=o.triggers;a.length||(a=[{id:"TriggerScriptSave"}]);const c=[],h=[],g=o.conditions.find($=>$.find(y=>y.tagCard==="()"));a.forEach(($,y)=>{var T;const w=Nw($.id,s);if(w){const C={trigger:$,condition:{index:0},justCheck:g?!1:o.justCheck||!o.conditions.length||!o.conditions[0].length,conditionsDebug:[],conditionsVars:[],conditionsStates:[]},E=w.compile($,C),k=WN(o.conditions,C,s),A=ZS(o.actions.then,C,s),P=ZS(o.actions.else,C,s);c.push(`cond${y}`),(T=C.prelines)!=null&&T.length&&C.prelines.forEach(N=>h.push(N)),E.includes("    __%%CONDITIONS_VARS%%__")&&(C.conditionsVars=C.conditionsVars.map((N,B)=>B?`    ${N}`:N),C.conditionsDebug=C.conditionsDebug.map((N,B)=>B?`    ${N}`:N)),i.push(E.replace("__%%CONDITIONS_VARS%%__",C.conditionsVars.join(`
`)).replace('"__%%DEBUG_CONDITIONS%%__";',C.conditionsDebug.join(`
`)).replace("__%%CONDITION%%__",k).replace("__%%THEN%%__",A||"// ignore").replace("__%%ELSE%%__",P||"// ignore").replace(/__%%STATE%%__/g,`cond${y}`))}});let b=i.join(`

`);return(!o.justCheck||g)&&(b=`${c.map($=>`let ${$} = false;`).join(`
`)}

${b}`),h&&(b=`${h.join(`
`)}

${b}`),b}function Nw(o,n){return n.find(s=>s.getStaticData&&s.getStaticData().id===o)}function ZS(o,n,s){const i=[];return o==null||o.forEach(a=>{const c=Nw(a.id,s);c&&i.push(c.compile(a,n))}),`		${i.join(`

		`)}`}function WN(o,n,s){const i=[];let a=0;return o==null||o.forEach(c=>{const h=[];c==null||c.forEach(g=>{const b=Nw(g.id,s);b&&(n.condition.index=a++,h.push(b.compile(g,n)))}),i.push(`(${h.join(`) &&
                  (`)})`)}),i.length?i.length===1?i[0]||"true":`(${i.join(") || (")})`:"true"}function HN(o,n){return UN(o,null,n)}function QS(o){if(!o)return Xy;const n=o.split(`
`);try{const s=(n.pop()||"").replace(/^\/\//,"");let i=JSON.parse(s);return i.triggers||(i=Xy),i}catch{return Xy}}function VN(o,n){let s="";const i=HN(o,n);return s+=i,s+=`
/*
const demo = ${JSON.stringify(o,null,2).replace(/\*\//g,"* /")};
*/
`,`${s}
//${JSON.stringify(o)}`}class av extends yn{constructor(n){super(n,av.getStaticData())}static compile(n,s){return zN.replace('"__%%DEBUG_TRIGGER%%__"',`_sendToFrontEnd(${n._id}, {trigger: true})`)}renderDebug(){return I.I18n.t("Triggered")}onTagChange(n){this.setState({inputs:[{nameRender:"renderNameText",defaultValue:"On script save or adapter start",attr:"script"}]},()=>super.onTagChange())}static getStaticData(){return{acceptedBy:"triggers",name:"Start script",id:"TriggerScriptSave",icon:"PlayArrow",title:"Triggers the on script saving or the javascript instance restart"}}getData(){return av.getStaticData()}}var Pk={exports:{}};(function(o,n){(function(){var s=Math.PI,i=Math.sin,a=Math.cos,c=Math.tan,h=Math.asin,g=Math.atan2,b=Math.acos,$=s/180,y=1e3*60*60*24,w=2440588,T=2451545;function C(he){return he.valueOf()/y-.5+w}function E(he){return new Date((he+.5-w)*y)}function k(he){return C(he)-T}var A=$*23.4397;function P(he,Ae){return g(i(he)*a(A)-c(Ae)*i(A),a(he))}function N(he,Ae){return h(i(Ae)*a(A)+a(Ae)*i(A)*i(he))}function B(he,Ae,de){return g(i(he),a(he)*i(Ae)-c(de)*a(Ae))}function S(he,Ae,de){return h(i(Ae)*i(de)+a(Ae)*a(de)*a(he))}function H(he,Ae){return $*(280.16+360.9856235*he)-Ae}function q(he){return he<0&&(he=0),2967e-7/Math.tan(he+.00312536/(he+.08901179))}function se(he){return $*(357.5291+.98560028*he)}function ee(he){var Ae=$*(1.9148*i(he)+.02*i(2*he)+3e-4*i(3*he)),de=$*102.9372;return he+Ae+de+s}function K(he){var Ae=se(he),de=ee(Ae);return{dec:N(de,0),ra:P(de,0)}}var Y={};Y.getPosition=function(he,Ae,de){var Se=$*-de,xe=$*Ae,He=k(he),ne=K(He),Ke=H(He,Se)-ne.ra;return{azimuth:B(Ke,xe,ne.dec),altitude:S(Ke,xe,ne.dec)}};var X=Y.times=[[-.833,"sunrise","sunset"],[-.3,"sunriseEnd","sunsetStart"],[-6,"dawn","dusk"],[-12,"nauticalDawn","nauticalDusk"],[-18,"nightEnd","night"],[6,"goldenHourEnd","goldenHour"]];Y.addTime=function(he,Ae,de){X.push([he,Ae,de])};var ce=9e-4;function W(he,Ae){return Math.round(he-ce-Ae/(2*s))}function te(he,Ae,de){return ce+(he+Ae)/(2*s)+de}function ke(he,Ae,de){return T+he+.0053*i(Ae)-.0069*i(2*de)}function Z(he,Ae,de){return b((i(he)-i(Ae)*i(de))/(a(Ae)*a(de)))}function ze(he,Ae,de,Se,xe,He,ne){var Ke=Z(he,de,Se),Te=te(Ke,Ae,xe);return ke(Te,He,ne)}Y.getTimes=function(he,Ae,de){var Se=$*-de,xe=$*Ae,He=k(he),ne=W(He,Se),Ke=te(0,Se,ne),Te=se(Ke),Je=ee(Te),rt=N(Je,0),ht=ke(Ke,Te,Je),nt,Wt,St,lt,ft,st={solarNoon:E(ht),nadir:E(ht+.5)};for(nt=0,Wt=X.length;nt<Wt;nt+=1)St=X[nt],lt=ze(St[0]*$,Se,xe,rt,ne,Te,Je),ft=ht-(lt-ht),st[St[1]]=E(ft),st[St[2]]=E(lt);return st};function Ce(he){var Ae=$*(218.316+13.176396*he),de=$*(134.963+13.064993*he),Se=$*(93.272+13.22935*he),xe=Ae+$*6.289*i(de),He=$*5.128*i(Se),ne=385001-20905*a(de);return{ra:P(xe,He),dec:N(xe,He),dist:ne}}Y.getMoonPosition=function(he,Ae,de){var Se=$*-de,xe=$*Ae,He=k(he),ne=Ce(He),Ke=H(He,Se)-ne.ra,Te=S(Ke,xe,ne.dec),Je=g(i(Ke),c(xe)*a(ne.dec)-i(ne.dec)*a(Ke));return Te=Te+q(Te),{azimuth:B(Ke,xe,ne.dec),altitude:Te,distance:ne.dist,parallacticAngle:Je}},Y.getMoonIllumination=function(he){var Ae=k(he||new Date),de=K(Ae),Se=Ce(Ae),xe=149598e3,He=b(i(de.dec)*i(Se.dec)+a(de.dec)*a(Se.dec)*a(de.ra-Se.ra)),ne=g(xe*i(He),Se.dist-xe*a(He)),Ke=g(a(de.dec)*i(de.ra-Se.ra),i(de.dec)*a(Se.dec)-a(de.dec)*i(Se.dec)*a(de.ra-Se.ra));return{fraction:(1+a(ne))/2,phase:.5+.5*ne*(Ke<0?-1:1)/Math.PI,angle:Ke}};function at(he,Ae){return new Date(he.valueOf()+Ae*y/24)}Y.getMoonTimes=function(he,Ae,de,Se){var xe=new Date(he);Se?xe.setUTCHours(0,0,0,0):xe.setHours(0,0,0,0);for(var He=.133*$,ne=Y.getMoonPosition(xe,Ae,de).altitude-He,Ke,Te,Je,rt,ht,nt,Wt,St,lt,ft,st,At,mn,Ue=1;Ue<=24&&(Ke=Y.getMoonPosition(at(xe,Ue),Ae,de).altitude-He,Te=Y.getMoonPosition(at(xe,Ue+1),Ae,de).altitude-He,ht=(ne+Te)/2-Ke,nt=(Te-ne)/2,Wt=-nt/(2*ht),St=(ht*Wt+nt)*Wt+Ke,lt=nt*nt-4*ht*Ke,ft=0,lt>=0&&(mn=Math.sqrt(lt)/(Math.abs(ht)*2),st=Wt-mn,At=Wt+mn,Math.abs(st)<=1&&ft++,Math.abs(At)<=1&&ft++,st<-1&&(st=At)),ft===1?ne<0?Je=Ue+st:rt=Ue+st:ft===2&&(Je=Ue+(St<0?At:st),rt=Ue+(St<0?st:At)),!(Je&&rt));Ue+=2)ne=Te;var Nt={};return Je&&(Nt.rise=at(xe,Je)),rt&&(Nt.set=at(xe,rt)),!Je&&!rt&&(Nt[St>0?"alwaysUp":"alwaysDown"]=!0),Nt},o.exports=Y})()})(Pk);var GN=Pk.exports;const jk=Ga(GN),KN='{"time":{"start":"00:00","end":"24:00","mode":"hours","interval":1},"period":{"days":1}}';class pu extends yn{coordinates=null;constructor(n){super(n,pu.getStaticData())}static compile(n,s){var c;let i="",a=s.justCheck?Lk:Bk;if(a=a.replace('"__%%DEBUG_TRIGGER%%__"',`_sendToFrontEnd(${n._id}, {trigger: true})`),n.tagCard==="interval")i=`setInterval(${a}, ${n.interval||1} * ${n.unit==="s"?1e3:n.unit==="m"?6e4:36e5});`;else if(n.tagCard==="cron")i=`schedule("${n.cron}", ${a});`;else if(n.tagCard==="at"){const[h,g]=(n.at||"").split(":");let b="*";if((c=n==null?void 0:n.dow)!=null&&c.length&&!n.dow.includes("_")){const $=[...n.dow].map(C=>parseInt(C,10));$.sort();const y=[];let w=$[0],T=1;for(;T<$.length;T++)$[T]-$[T-1]>1?(w===$[T-1]?y.push(w.toString()):$[T-1]-w===1?y.push(`${w},${$[T-1]}`):y.push(`${w}-${$[T-1]}`),w=$[T]):T===$.length-1&&(w===$[T-1]||$[T]-w===1?y.push(`${w},${$[T]}`):y.push(`${w}-${$[T]}`));b=y.join(",")}i=`schedule("${g||"0"} ${h||"0"} * * ${b}", ${a});`}else n.tagCard==="astro"?i=`schedule({astro: "${n.astro}", shift: ${n.offset?n.offsetValue:0}}, ${a});`:n.tagCard==="wizard"&&(i=`schedule('${n.wizard}', ${a});`);return i}static _time2String(n){return n?`${n.getHours().toString().padStart(2,"0")}:${n.getMinutes().toString().padStart(2,"0")}`:"--:--"}async _setAstro(n,s,i){var b,$;if(n||=this.state.settings.astro||"solarNoon",s??=this.state.settings.offset,i??=this.state.settings.offsetValue,i=parseInt(i,10)||0,!this.coordinates){const y=await this.props.socket.getObject("system.adapter.javascript.0"),w=(b=y==null?void 0:y.native)==null?void 0:b.latitude,T=($=y==null?void 0:y.native)==null?void 0:$.longitude;if(!w&&!T){const C=await this.props.socket.getObject("system.config");C!=null&&C.common&&(C.common.latitude||C.common.longitude)?this.coordinates={latitude:parseFloat(C.common.latitude),longitude:parseFloat(C.common.longitude)}:this.coordinates=null}else this.coordinates={latitude:parseFloat(w),longitude:parseFloat(T)}}const a=this.coordinates&&jk.getTimes(new Date,this.coordinates.latitude,this.coordinates.longitude),c=a?Object.keys(a).map(y=>({value:y,title:y,title2:`[${pu._time2String(a[y])}]`,order:a?pu._time2String(a[y]):"??:??"})):[];c.sort((y,w)=>y.order>w.order?1:y.order<w.order?-1:0);let h="--:--";if(n&&a&&a[n]){const y=new Date(a[n]);s&&y.setMinutes(y.getMinutes()+parseInt(i,10)),h=I.I18n.t("(at %s)",pu._time2String(y))}let g;s?g=[{frontText:"at",attr:"astro",nameRender:"renderSelect",options:c,defaultValue:"solarNoon",doNotTranslate2:!0},{backText:"with offset",nameRender:"renderCheckbox",attr:"offset"},{backText:i===1?"minute":"minutes",frontText:"offset",nameRender:"renderNumber",defaultValue:0,attr:"offsetValue",noHelperText:!0},{nameRender:"renderNameText",attr:"textTime",defaultValue:h,doNotTranslate:!0}]:g=[{frontText:"at",attr:"astro",nameRender:"renderSelect",options:c,doNotTranslate2:!0,defaultValue:"solarNoon"},{backText:"with offset",nameRender:"renderCheckbox",attr:"offset"},{nameRender:"renderNameText",attr:"textTime1",defaultValue:h,doNotTranslate:!0}],this.setState({inputs:g},()=>super.onTagChange())}_setInterval(n){n=parseInt(n||this.state.settings.interval,10)||30;let s;n===1?s=[{value:"s",title:"second"},{value:"m",title:"minute"},{value:"h",title:"hour"}]:s=[{value:"s",title:"seconds"},{value:"m",title:"minutes"},{value:"h",title:"hours"}],this.setState({inputs:[{nameRender:"renderNumber",attr:"interval",frontText:"every",defaultValue:30,className:"block-input-interval"},{nameRender:"renderSelect",attr:"unit",defaultValue:"s",options:s}]},()=>super.onTagChange())}renderDebug(n){return I.I18n.t("Triggered")}onValueChanged(n,s){this.state.settings.tagCard==="astro"?s==="astro"?this._setAstro(n):s==="offset"?this._setAstro(void 0,n):s==="offsetValue"&&this._setAstro(void 0,void 0,n):this.state.settings.tagCard==="interval"&&s==="interval"&&this._setInterval(n)}renderCron(n,s,i){const{className:a}=this.props;return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",alignItems:"baseline"},children:[f.jsx("div",{style:{width:"100%"},children:this.renderText({nameRender:"renderText",attr:"cron",defaultValue:s},this.state.settings.cron||s,i)}),f.jsx(wf,{square:!0,style:{marginLeft:7},value:"...",className:a,onClick:()=>this.setState({openDialog:!0,textCron:this.state.settings.cron})})]}),this.state.openDialog?f.jsx(z_,{disabled:this.state.settings.cron===this.state.textCron,onApply:()=>{const c=this.state.textCron;i(c,"cron",()=>{i(I.convertCronToText(c,I.I18n.getLanguage()),"addText"),this.setState({openDialog:!1})})},onClose:()=>this.setState({openDialog:!1,textCron:""}),children:f.jsx(I.ComplexCron,{cronExpression:this.state.settings.cron,onChange:c=>this.setState({textCron:c}),language:I.I18n.getLanguage()})}):null,this.renderNameText({nameRender:"renderNameText",defaultValue:I.I18n.t("every hour at 0 minutes"),attr:"addText",signature:!0,doNotTranslate:!0},this.state.settings.addText||I.I18n.t("every hour at 0 minutes"))]},"cron")}renderWizard(n,s,i){const{className:a}=this.props;return f.jsxs("div",{children:[f.jsxs("div",{style:{display:"flex",alignItems:"center",marginTop:7},children:[f.jsx(Yl,{className:a,autoComplete:"off",fullWidth:!0,variant:"outlined",size:"small",multiline:!0,rows:2,value:this.state.settings.wizardText,onChange:c=>i(c),customValue:!0}),f.jsx(wf,{square:!0,style:{marginLeft:7},value:"...",className:a,onClick:()=>this.setState({openDialog:!0,wizard:this.state.settings.wizard,wizardText:I.Schedule.state2text(this.state.settings.wizard)})})]}),this.state.openDialog?f.jsx(z_,{disabled:this.state.settings.wizard===this.state.wizard,onApply:()=>this.setState({openDialog:!1},()=>{const c=JSON.parse(this.state.wizard);c.valid||={from:I.Schedule.now2string()},c.valid.from||=I.Schedule.now2string(),i({wizardText:this.state.wizardText,wizard:JSON.stringify(c)})}),onClose:()=>this.setState({openDialog:!1}),children:f.jsx(I.Schedule,{theme:this.props.theme,schedule:s,onChange:(c,h)=>this.setState({wizardText:h||"",wizard:c})})}):null]},"wizard")}onTagChange(n){switch(n||=this.state.settings.tagCard,n){case"interval":this._setInterval();break;case"cron":this.setState({inputs:[{nameRender:"renderCron",attr:"cron",defaultValue:"0 * * * *"}]},()=>super.onTagChange());break;case"wizard":{const s=JSON.parse(KN);s.valid||={from:I.Schedule.now2string()},s.valid.from||=I.Schedule.now2string(),this.setState({inputs:[{nameRender:"renderWizard",attr:"wizard",defaultValue:JSON.stringify(s)}]},()=>super.onTagChange(null,()=>{const i=I.Schedule.state2text(this.state.settings.wizard||s);if(this.state.settings.wizard!==i){const a=JSON.parse(JSON.stringify(this.state.settings));a.wizardText=i,this.setState({settings:a}),this.props.onChange(a)}}));break}case"at":this.setState({inputs:[{nameRender:"renderTime",prefix:"at",attr:"at",defaultValue:"07:30"},{nameRender:"renderSelect",attr:"dow",default:"",multiple:!0,defaultValue:["_","1","2","3","4","5","6","0"],options:[{value:"_",title:"Every day",only:!0},{value:"1",title:"Monday",titleShort:"Mo"},{value:"2",title:"Tuesday",titleShort:"Tu"},{value:"3",title:"Wednesday",titleShort:"We"},{value:"4",title:"Thursday",titleShort:"Th"},{value:"5",title:"Friday",titleShort:"Fr"},{value:"6",title:"Saturday",titleShort:"Sa"},{value:"0",title:"Sunday",titleShort:"Su"}]}]},()=>super.onTagChange());break;case"astro":this._setAstro();break}}static getStaticData(){return{acceptedBy:"triggers",name:"Schedule",id:"TriggerScheduleBlock",icon:"AccessTime",tagCardArray:["cron","wizard","interval","at","astro"],title:"Triggers the rule periodically or on some specific time"}}getData(){return pu.getStaticData()}}const bh={valueAck:{color:"#b02323"},valueNotAck:{color:"#12ac15"}},Fk=We.forwardRef((o,n)=>f.jsx(D.Slide,{direction:"up",ref:n,...o}));Fk.displayName="Transition";class lv extends yn{inputRef;constructor(n){super(n,lv.getStaticData()),this.inputRef=We.createRef()}static compile(n,s){let i=s.justCheck?Lk:Bk;return i=i.replace('"__%%DEBUG_TRIGGER%%__"',`_sendToFrontEnd(${n._id}, {val: obj.state.val, ack: obj.state.ack, valOld: obj.oldState && obj.oldState.val, ackOld: obj.oldState && obj.oldState.ack})`),`on({id: "${n.oid||""}", change: "${n.tagCard==="on update"?"any":"ne"}"}, ${i});`}renderDebug(n){return n.data.valOld!==void 0?f.jsxs("span",{children:[I.I18n.t("Triggered")," ",f.jsx("span",{style:n.data.ackOld?bh.valueAck:bh.valueNotAck,children:Dh(n.data.valOld)})," ",""," ",f.jsx("span",{style:n.data.ack?bh.valueAck:bh.valueNotAck,children:Dh(n.data.val)})]}):f.jsxs("span",{children:[I.I18n.t("Triggered")," ",f.jsx("span",{style:n.data.ack?bh.valueAck:bh.valueNotAck,children:Dh(n.data.val)})]})}onWriteValue(){this.setState({openSimulate:!1});let n=this.state.simulateValue;window.localStorage.setItem(`javascript.app.${this.state.settings.oid}_ack`,this.state.simulateAck?"true":"false"),this.state.settings.oidType==="boolean"?(n=n===!0||n==="true"||n==="1",window.localStorage.setItem(`javascript.app.${this.state.settings.oid}`,n?"true":"false")):this.state.settings.oidType==="number"?(n=parseFloat(n)||0,window.localStorage.setItem(`javascript.app.${this.state.settings.oid}`,n.toString())):window.localStorage.setItem(`javascript.app.${this.state.settings.oid}`,(n==null?void 0:n.toString())||""),this.props.socket.setState(this.state.settings.oid,{val:n,ack:!!this.state.simulateAck})}renderWriteState(){return[f.jsx(D.Button,{disabled:!this.state.settings.oid||!this.state.enableSimulation,variant:"contained",color:"primary",onClick:()=>{this.setState({openSimulate:!0,simulateValue:this.state.settings.oidType==="boolean"?window.localStorage.getItem(`javascript.app.${this.state.settings.oid}`)==="true":window.localStorage.getItem(`javascript.app.${this.state.settings.oid}`)||"",simulateAck:window.localStorage.getItem(`javascript.app.${this.state.settings.oid}_ack`)==="true"}),setTimeout(()=>{var n;return(n=this.inputRef.current)==null?void 0:n.focus()},200)},children:I.I18n.t("Simulate")},"buttonWrite"),f.jsxs(D.Dialog,{open:!!this.state.openSimulate,TransitionComponent:Fk,keepMounted:!0,onClose:()=>this.setState({openSimulate:!1}),"aria-labelledby":"simulate-dialog-slide-title","aria-describedby":"simulate-dialog-slide-description",children:[f.jsx(D.DialogTitle,{id:"simulate-dialog-slide-title",children:I.I18n.t("Trigger with value")}),f.jsxs(D.DialogContent,{children:[this.state.settings.oidType==="boolean"?f.jsx(D.FormControlLabel,{control:f.jsx(D.Switch,{inputRef:this.inputRef,onKeyUp:n=>n.key==="Enter"&&this.onWriteValue(),value:!!this.state.simulateValue,onChange:n=>this.setState({simulateValue:n.target.checked})}),label:I.I18n.t("Value")}):f.jsx(D.TextField,{variant:"standard",inputRef:this.inputRef,label:I.I18n.t("Value"),fullWidth:!0,onKeyUp:n=>n.key==="Enter"&&this.onWriteValue(),value:!this.state.simulateValue&&this.state.simulateValue!==0?"":this.state.simulateValue,onChange:n=>this.setState({simulateValue:n.target.value})}),f.jsx("br",{}),f.jsx(D.FormControlLabel,{control:f.jsx(D.Checkbox,{checked:!!this.state.simulateAck,onChange:n=>this.setState({simulateAck:n.target.checked}),color:"primary"}),label:I.I18n.t("Ack")})]}),f.jsxs(D.DialogActions,{children:[f.jsxs(D.Button,{variant:"contained",onClick:()=>this.onWriteValue(),color:"primary",children:[f.jsx(b_,{}),I.I18n.t("Write")]}),f.jsxs(D.Button,{color:"grey",variant:"contained",onClick:()=>this.setState({openSimulate:!1}),children:[f.jsx(Iv,{}),I.I18n.t("Close")]})]})]},"dialogWrite")]}onTagChange(n){this.setState({inputs:[{nameRender:"renderObjectID",attr:"oid",defaultValue:""},{nameRender:"renderWriteState"}]},()=>{super.onTagChange()})}static getStaticData(){return{acceptedBy:"triggers",name:"State",id:"TriggerState",icon:"FlashOn",tagCardArray:["on change","on update"],title:"Triggers the rule on update or change of some state"}}getData(){return lv.getStaticData()}}const JN=""+new URL("hysteresis-CLhhemcG.png",import.meta.url).href,e0=`function __hysteresis(val, limit, state, hist, comp) {
    let cond1, cond2;
    if (comp === '>') {
        cond1 = val > limit + hist;
        cond2 = val <= limit - hist;
    } else if (comp === '<') {
        cond1 = val < limit - hist;
        cond2 = val >= limit + hist;
    } else if (comp === '>=') {
        cond1 = val >= limit + hist;
        cond2 = val < limit - hist;
    } else if (comp === '<=') {
        cond1 = val <= limit - hist;
        cond2 = val > limit + hist;
    } else if (comp === '=') {
        cond1 = val <= limit + hist && val > limit - hist;
        cond2 = val > limit + hist || val <= limit - hist;
    } else if (comp === '<>') {
        cond1 = val > limit + hist || val <= limit - hist;
        cond2 = val <= limit + hist && val > limit - hist;
    }
     
    if (!state && cond1) {
        return true;
    } else if (state && cond2) {
        return false;
    } else {
        return state;
    }
}`;class Cf extends yn{constructor(n){super(n,Cf.getStaticData())}isAllTriggersOnState(){var n,s,i,a;return!!((s=(n=this.props.userRules)==null?void 0:n.triggers)!=null&&s.find(c=>c.id==="TriggerState"))&&!((a=(i=this.props.userRules)==null?void 0:i.triggers)!=null&&a.find(c=>c.id!=="TriggerState"))}static compile(n,s){var h,g;let i=n.value;i==null&&(i=!1);let a,c;if(n.tagCard==="()")s.prelines=s.prelines||[],!s.prelines.find(b=>b!==e0)&&s.prelines.push(e0),n.useTrigger?(a="obj.state.val",i===""&&(i=0),c=`__hysteresis(subCondVar${n._id}, ${i}, __%%STATE%%__, ${n.hist}, "${n.histComp}")`):(a=`(await getStateAsync("${n.oid}")).val`,i===""&&(i=0),typeof i=="string"&&parseFloat(i.trim()).toString()!==i.trim()&&(i=`"${i}"`),c=`__hysteresis(subCondVar${n._id}, ${i}, __%%STATE%%__, ${n.hist}, "${n.histComp}")`);else if(n.tagCard!=="includes"){const b=n.tagCard==="="?"==":n.tagCard==="<>"?"!=":n.tagCard;n.useTrigger?(a="obj.state.val",((h=s==null?void 0:s.trigger)==null?void 0:h.oidType)==="string"?(i=i.replace(/"/g,'\\"'),c=`subCondVar${n._id} ${b} "${i}"`):(i===""&&(i=0),typeof i=="string"&&parseFloat(i.trim()).toString()!==i.trim()&&(i=`"${i}"`),c=`subCondVar${n._id} ${b} ${i}`)):(a=`(await getStateAsync("${n.oid}")).val`,n.oidType==="string"?(i=i.replace(/"/g,'\\"'),c=`subCondVar${n._id} ${b} "${i}"`):(i===""&&(i=0),typeof i=="string"&&parseFloat(i.trim()).toString()!==i.trim()&&(i=`"${i}"`),c=`subCondVar${n._id} ${b} ${i}`))}else n.useTrigger?(a="obj.state.val",((g=s==null?void 0:s.trigger)==null?void 0:g.oidType)==="string"?(i=i.replace(/"/g,'\\"'),c=`obj.state.val.includes("${i}")`):c="false"):(a=`(await getStateAsync("${n.oid}")).val`,n.oidType==="string"?(i=i.replace(/"/g,'\\"'),c=`subCondVar${n._id}.includes("${i}")`):c="false");return s.conditionsStates.push({name:`subCondVar${n._id}`,id:n.oid}),s.conditionsVars.push(`const subCondVar${n._id} = ${a};`),s.conditionsVars.push(`const subCond${n._id} = ${c};`),s.conditionsDebug.push(`_sendToFrontEnd(${n._id}, {result: subCond${n._id}, value: subCondVar${n._id}, compareWith: "${i}"});`),`subCond${n._id}`}renderDebug(n){const s=this.state.settings.tagCard;return s!=="()"?`${n.data.result.toString().toUpperCase()} [${n.data.value} ${s} ${n.data.compareWith}]`:I.I18n.t("Triggered")}onShowHelp=()=>this.setState({showHysteresisHelp:!0});_setInputs(n,s,i,a,c){var k,A;const h=this.isAllTriggersOnState();s=s||this.state.settings.tagCard,i=i||this.state.settings.oidType,a=a||this.state.settings.oidUnit,c=c||this.state.settings.oidStates,n===void 0&&(n=this.state.settings.useTrigger),h&&n&&((A=(k=this.props.userRules)==null?void 0:k.triggers)==null?void 0:A.length)===1&&(i=this.props.userRules.triggers[0].oidType,a=this.props.userRules.triggers[0].oidUnit,c=this.props.userRules.triggers[0].oidStates);const g=Cf.getStaticData().tagCardArray,b=g.find(P=>P.title===s)||g[0];let $,y=null;i==="number"?($=[{title:"=",title2:"[equal]",text:"equal to"},{title:">=",title2:"[greater or equal]",text:"greater or equal"},{title:">",title2:"[greater]",text:"greater than"},{title:"<=",title2:"[less or equal]",text:"less or equal"},{title:"<",title2:"[less]",text:"less than"},{title:"<>",title2:"[not equal]",text:"not equal to"},{title:"()",title2:"[hysteresis]",text:"hysteresis"}],c&&(y=Object.keys(c).map(P=>c?{value:P,title:c[P]}:null).filter(P=>P))):i==="boolean"?($=[{title:"=",title2:"[equal]",text:"equal to"},{title:"<>",title2:"[not equal]",text:"not equal to"}],y=[{title:"false",value:!1},{title:"true",value:!0}]):($=[{title:"=",title2:"[equal]",text:"equal to"},{title:">=",title2:"[greater or equal]",text:"greater or equal"},{title:">",title2:"[greater]",text:"greater than"},{title:"<=",title2:"[less or equal]",text:"less or equal"},{title:"<",title2:"[less]",text:"less than"},{title:"<>",title2:"[not equal]",text:"not equal to"},{title:".",title2:"[includes]",text:"includes"}],c&&(y=Object.keys(c).map(P=>({value:P,title:c?c[P]:P.toString()}))));let w=null;$.find(P=>P.title===s)||(s=$[0].title,w=w||{...this.state.settings},w.tagCard=s);let T,C={nameRender:"renderText",defaultValue:"",attr:"value",frontText:s==="()"?"Limit":(b==null?void 0:b.text)||"compare with",doNotTranslateBack:!0,backText:a};y&&(C={nameRender:"renderSelect",defaultValue:y[0].value,options:y,attr:"value",frontText:(b==null?void 0:b.text)||"compare with",doNotTranslateBack:!0,backText:a},y.find(P=>P.value===this.state.settings.value)||(w=w||{...this.state.settings},w.value=y[0].value),y.length<=2&&($=[{title:"=",title2:"[equal]",text:"equal to"},{title:"<>",title2:"[not equal]",text:"not equal to"}])),h&&n?T=[{backText:"use trigger value",nameRender:"renderCheckbox",attr:"useTrigger",defaultValue:!1},C]:h?T=[{backText:"use trigger value",nameRender:"renderCheckbox",attr:"useTrigger"},{nameRender:"renderObjectID",attr:"oid",defaultValue:""},C]:T=[{nameRender:"renderObjectID",attr:"oid",defaultValue:""},C],s==="()"&&(T.splice(1,0,{nameRender:"renderDialog",icon:"HelpOutline",frontText:"Explanation",onShowDialog:this.onShowHelp}),T.splice(2,0,{nameRender:"renderSelect",attr:"histComp",defaultValue:">",frontText:"Condition",doNotTranslate:!0,options:[{title:">",value:">"},{title:">=",value:">="},{title:"<",value:"<"},{title:"<=",value:"<="},{title:"=",value:"="},{title:"<>",value:"<>"}]}),T.push({frontText:"",doNotTranslate:!0,nameRender:"renderNumber",noHelperText:!0,attr:"hist",defaultValue:1,doNotTranslateBack:!0,backText:a}));const E={iconTag:!0,tagCardArray:$,inputs:T};this.setState(E,()=>super.onTagChange(null,()=>{w&&(this.setState({settings:w}),this.props.onChange(w))}))}onValueChanged(n,s){typeof n=="object"?this._setInputs(n.useTrigger,n.tagCard,n.oidType,n.states):s==="useTrigger"?this._setInputs(n):s==="oidType"?this._setInputs(void 0,void 0,n):s==="oidUnit"?this._setInputs(void 0,void 0,void 0,n):s==="oidStates"&&this._setInputs(void 0,void 0,void 0,void 0,n)}onUpdate(){this._setInputs(this.state.settings.useTrigger)}onTagChange(n){this._setInputs(this.state.settings.useTrigger,n)}static getStaticData(){return{acceptedBy:"conditions",name:"State condition",id:"ConditionState",icon:"Shuffle",tagCardArray:[{title:"=",title2:"[equal]",text:"equal to"},{title:">=",title2:"[greater or equal]",text:"greater or equal"},{title:">",title2:"[greater]",text:"greater than"},{title:"<=",title2:"[less or equal]",text:"less or equal"},{title:"<",title2:"[less]",text:"less than"},{title:"<>",title2:"[not equal]",text:"not equal to"},{title:".",title2:"[includes]",text:"includes"},{title:"()",title2:"[hysteresis]",text:"hysteresis"}],title:"Compares the state value with user defined value"}}getData(){return Cf.getStaticData()}renderSpecific(){return this.state.showHysteresisHelp?f.jsxs(D.Dialog,{open:!0,maxWidth:"md",onClose:()=>this.setState({showHysteresisHelp:!1}),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[f.jsx(D.DialogContent,{children:f.jsx(D.DialogContentText,{id:"alert-dialog-description",children:f.jsx("img",{src:JN,alt:"Hysteresis"})})}),f.jsx(D.DialogActions,{children:f.jsx(D.Button,{onClick:()=>this.setState({showHysteresisHelp:!1}),color:"primary",autoFocus:!0,children:I.I18n.t("OK")})})]}):null}}const t0=[31,29,31,30,31,30,31,31,30,31,30,31];class Sf extends yn{constructor(n){super(n,Sf.getStaticData())}static compile(n,s){const i=n.tagCard==="="?"===":n.tagCard==="<>"?"!==":n.tagCard;let a;if(n.withDate){const[c,h]=(n.date||"01.01").toString().split(".");let g=parseInt(h,10)||0,b=parseInt(c,10)||0;b>12?b=12:b<0&&(b=0),g>t0[b]?g=t0[b]:g<0&&(g=0),g&&b?a=`formatDate(Date.now(), 'MM.DD-hh:mm') ${i} "${n.date}-${n.time}"`:g===0&&b?a=`formatDate(Date.now(), 'MM-hh:mm') ${i} "${b.toString().padStart(2,"0")}-${n.time}"`:b===0&&g?a=`formatDate(Date.now(), 'DD-hh:mm') ${i} "${g.toString().padStart(2,"0")}-${n.time}"`:a=`formatDate(Date.now(), 'hh:mm') ${i} "${n.time}"`}else a=`formatDate(Date.now(), 'hh:mm') ${i} "${n.time}"`;return s.conditionsVars.push(`const subCond${n._id} = ${a};`),s.conditionsDebug.push(`_sendToFrontEnd(${n._id}, {result: subCond${n._id}});`),`subCond${n._id}`}_setInputs(n,s){s=s===void 0?this.state.settings.withDate:s,n=n||this.state.settings.tagCard;const i=Sf.getStaticData().tagCardArray,a=i==null?void 0:i.find(h=>h.title===n),c=[{nameRender:"renderNameText",attr:"interval",defaultValue:"Actual time of day"},{frontText:(a==null?void 0:a.text)||n,nameRender:"renderTime",attr:"time",defaultValue:"12:00"},{frontText:"with date",nameRender:"renderCheckbox",attr:"withDate",defaultValue:!1}];s&&c.push({nameRender:"renderDate",attr:"date",defaultValue:"01.01"}),this.setState({inputs:c,iconTag:!0},()=>super.onTagChange())}onValueChanged(n,s){s==="withDate"&&this._setInputs(void 0,n)}onTagChange(n){this._setInputs(n)}static getStaticData(){return{acceptedBy:"conditions",name:"Time condition",id:"ConditionTime",icon:"Shuffle",tagCardArray:[{title:"=",title2:"[equal]",text:"equal to"},{title:">=",title2:"[greater or equal]",text:"greater or equal"},{title:">",title2:"[greater]",text:"greater than"},{title:"<=",title2:"[less or equal]",text:"less or equal"},{title:"<",title2:"[less]",text:"less than"},{title:"<>",title2:"[not equal]",text:"not equal to"}],title:"Compares current time with the user specific time"}}getData(){return Sf.getStaticData()}}class ql extends yn{coordinates=null;constructor(n){super(n,ql.getStaticData())}static compile(n,s){const i=n.tagCard==="="?"===":n.tagCard==="<>"?"!==":n.tagCard;let a;n.offset&&(a=parseInt(n.offsetValue,10)||0);const c=`formatDate(Date.now(), 'hh:mm') ${i} formatDate(getAstroDate("${n.astro}"${a?`, undefined, ${a}`:""}), 'hh:mm')`;return s.conditionsVars.push(`const subCond${n._id} = ${c};`),s.conditionsDebug.push(`_sendToFrontEnd(${n._id}, {result: ${c}});`),c}static _time2String(n){return n?`${n.getHours().toString().padStart(2,"0")}:${n.getMinutes().toString().padStart(2,"0")}`:"--:--"}onValueChanged(n,s){s==="astro"?this._setAstro(n):s==="offset"?this._setAstro(void 0,n):s==="offsetValue"&&this._setAstro(void 0,void 0,n)}async _setAstro(n,s,i){if(n=n||this.state.settings.astro||"solarNoon",s=s===void 0?this.state.settings.offset:s,i=i===void 0?this.state.settings.offsetValue:i,i=parseInt(i,10)||0,!this.coordinates){const y=await this.props.socket.getObject("system.adapter.javascript.0");if(!(y!=null&&y.native.latitude)&&!(y!=null&&y.native.longitude)){const w=await this.props.socket.getObject("system.config");w&&(w.common.latitude||w.common.longitude)?this.coordinates={latitude:w.common.latitude,longitude:w.common.longitude}:this.coordinates=null}else this.coordinates={latitude:y==null?void 0:y.native.latitude,longitude:y==null?void 0:y.native.longitude}}const a=this.coordinates?jk.getTimes(new Date,this.coordinates.latitude,this.coordinates.longitude):null,c=a?Object.keys(a).map(y=>({value:y,title:y,title2:`[${ql._time2String(a[y])}]`,order:ql._time2String(a[y])})):[];c.sort((y,w)=>y.order>w.order?1:y.order<w.order?-1:0);const h=ql.getStaticData().tagCardArray,g=h.find(y=>y.title===this.state.settings.tagCard)||h[0];let b="--:--";if(n&&a&&a[n]){const y=new Date(a[n]);s&&y.setMinutes(y.getMinutes()+parseInt(i,10)),b=`(${I.I18n.t(g.text)} ${ql._time2String(y)})`}let $;s?$=[{nameRender:"renderNameText",defaultValue:"Actual time of day",attr:"text"},{frontText:g.text,attr:"astro",nameRender:"renderSelect",options:c,doNotTranslate2:!0,defaultValue:"solarNoon"},{backText:"with offset",nameRender:"renderCheckbox",attr:"offset"},{backText:i===1?"minute":"minutes",frontText:"offset",nameRender:"renderNumber",defaultValue:0,attr:"offsetValue",noHelperText:!0},{nameRender:"renderNameText",attr:"textTime",doNotTranslate:!0,defaultValue:b}]:$=[{nameRender:"renderNameText",defaultValue:"Actual time of day",attr:"text"},{frontText:g.text,attr:"astro",nameRender:"renderSelect",options:c,doNotTranslate2:!0,defaultValue:"solarNoon"},{backText:"with offset",nameRender:"renderCheckbox",attr:"offset"},{nameRender:"renderNameText",attr:"textTime",doNotTranslate:!0,defaultValue:b}],this.setState({inputs:$},()=>super.onTagChange())}onTagChange(){this._setAstro()}static getStaticData(){return{acceptedBy:"conditions",name:"Astronomical",id:"ConditionAstronomical",icon:"Brightness3",tagCardArray:[{title:"=",title2:"[equal]",text:"equal to"},{title:">=",title2:"[greater or equal]",text:"greater or equal to"},{title:">",title2:"[greater]",text:"greater than"},{title:"<=",title2:"[less or equal]",text:"less or equal to"},{title:"<",title2:"[less]",text:"less than"},{title:"<>",title2:"[not equal]",text:"not equal to"}],title:"Compares current time with astronomical event"}}getData(){return ql.getStaticData()}}const n0={valueAck:{color:"#b02323"},valueNotAck:{color:"#12ac15"}};class cv extends yn{constructor(n){super(n,cv.getStaticData())}isAllTriggersOnState(){var n,s,i,a;return!!((s=(n=this.props.userRules)==null?void 0:n.triggers)!=null&&s.find(c=>c.id==="TriggerState"))&&!((a=(i=this.props.userRules)==null?void 0:i.triggers)!=null&&a.find(c=>c.id!=="TriggerState"))}static compile(n,s){let i=n.value;n.useTrigger?i=n.toggle?"!obj.state.val":"obj.state.val":(i==null&&(i=""),typeof n.value=="string"&&parseFloat(n.value).toString()!==n.value&&n.value!=="true"&&n.value!=="false"&&(i=`"${i.replace(/"/g,'\\"')}"${yn.getReplacesInText(s)}`));let a;return n.toggle&&!n.useTrigger?a=`const subActionVar${n._id} = !(await getStateAsync("${n.oid}")).val`:a=`const subActionVar${n._id} = ${i}`,`// set state ${n.oid} to ${n.toggle&&!n.useTrigger?"toggle":i} 
		${a};
		_sendToFrontEnd(${n._id}, {val: subActionVar${n._id}, ack: ${n.tagCard==="update"}});
		await setStateAsync("${n.oid}", subActionVar${n._id}, ${n.tagCard==="update"});`}renderDebug(n){return f.jsxs("span",{children:[I.I18n.t("Set:")," ",f.jsx("span",{style:n.data.ack?n0.valueAck:n0.valueNotAck,children:Dh(n.data.val)})]})}_setInputs(n,s){const i=this.isAllTriggersOnState();s=s===void 0?this.state.settings.toggle:s,n=n===void 0?this.state.settings.useTrigger:n;let a="",c;const{oidType:h,oidUnit:g,oidStates:b,oidMax:$,oidMin:y,oidRole:w,oidWrite:T,oidStep:C}=this.state.settings;let E;h&&(h==="number"?(a="number",$!==void 0&&y!==void 0&&(a="slider")):h==="boolean"?(a="boolean",w&&w.includes("button")&&T&&(a="button")):(a="",w&&w.includes("color")&&(a="color")),b&&(c=Object.keys(b).map(A=>({value:A,title:b[A]})),a="select"));let k;if(i&&n)k=[{backText:"use trigger value",nameRender:"renderCheckbox",attr:"useTrigger",defaultValue:!1}],a==="boolean"&&k.push({backText:"toggle value",attr:"toggle",nameRender:"renderCheckbox",defaultValue:!1});else{switch(a){case"number":k=[{backText:g||"",frontText:"with",nameRender:"renderNumber",defaultValue:$===void 0?0:$,attr:"value"}],this.state.settings.value!==void 0&&isNaN(parseFloat(this.state.settings.value))&&(E={value:$===void 0?0:$});break;case"slider":{k=[{nameRender:"renderSlider",defaultValue:$,min:y,max:$,unit:g,step:C,attr:"value"}];const A=parseFloat(this.state.settings.value);this.state.settings.value!==void 0&&(isNaN(A)||A<y||A>$)&&(E={value:$});break}case"select":k=[{nameRender:"renderSelect",frontText:"with",options:c,defaultValue:(c==null?void 0:c[0].value)||"",attr:"value"}],this.state.settings.value!==void 0&&!(c!=null&&c.find(A=>A.value===this.state.settings.value))&&(E={value:(c==null?void 0:c[0].value)||""});break;case"boolean":k=[{backText:"toggle value",attr:"toggle",nameRender:"renderCheckbox",defaultValue:!1}],s||k.push({backText:"true",frontText:"false",nameRender:"renderSwitch",defaultValue:!1,attr:"value"}),this.state.settings.value!==void 0&&this.state.settings.value!==!1&&this.state.settings.value!==!0&&(E={value:!1});break;case"button":k=[{nameRender:"renderButton",defaultValue:!0,attr:"value"}],this.state.settings.value!==void 0&&this.state.settings.value!==!0&&(E={value:!0});break;case"color":k=[{nameRender:"renderColor",frontText:"with",defaultValue:"#FFFFFF",attr:"value"}],this.state.settings.value!==void 0&&(typeof this.state.settings.value!="string"||!this.state.settings.value.startsWith("#")&&!this.state.settings.value.startsWith("rgb"))&&(E={value:"#FFFFFF"});break;default:k=[{backText:g||"",frontText:"with",nameRender:"renderText",defaultValue:"",attr:"value"}];break}i&&k.unshift({backText:"use trigger value",nameRender:"renderCheckbox",attr:"useTrigger"})}return{inputs:k,newSettings:E}}onTagChange(n,s,i,a,c){c=c===void 0?this.state.settings.useTrigger:c;const{inputs:h,newSettings:g}=this._setInputs(c,a);h.unshift({nameRender:"renderObjectID",attr:"oid",defaultValue:"",checkReadOnly:!0}),this.setState({inputs:h},()=>super.onTagChange(null,()=>{if(g){const b=JSON.parse(JSON.stringify(this.state.settings));Object.assign(b,g),this.setState(b),this.props.onChange(b)}}))}onValueChanged(n,s){this.onTagChange(void 0,void 0,void 0,s==="toggle"?n:void 0,s==="useTrigger"?n:void 0)}onUpdate(){this.onTagChange()}static getStaticData(){return{acceptedBy:"actions",name:"Set state action",id:"ActionSetState",icon:"PlayForWork",tagCardArray:["control","update"],title:"Control or update some state",helpDialog:"You can use %s in the value to use the current trigger value or %id to display the triggered object ID"}}getData(){return cv.getStaticData()}}class uv extends yn{constructor(n){super(n,uv.getStaticData())}static compile(n,s){return`// exec "${n.exec}"
		const subActionVar${n._id} = "${(n.exec||"").replace(/"/g,'\\"')}"${yn.getReplacesInText(s)};
		_sendToFrontEnd(${n._id}, {exec: subActionVar${n._id}});
		console.log(subActionVar${n._id});`}renderDebug(n){return`Exec: ${n.data.exec}`}onTagChange(n){this.setState({inputs:[{nameRender:"renderModalInput",attr:"exec",defaultValue:"ls /opt/iobroker",nameBlock:"Shell command"}]},()=>super.onTagChange(n))}static getStaticData(){return{acceptedBy:"actions",name:"Exec",id:"ActionExec",icon:"Apps",title:"Executes some shell command",helpDialog:"You can use %s in the command to use current trigger value or %id to use the triggered object ID"}}getData(){return uv.getStaticData()}}class dv extends yn{constructor(n){super(n,dv.getStaticData())}static compile(n,s){return`// HTTP request ${n.url}
		const subActionVar${n._id} = "${(n.url||"").replace(/"/g,'\\"')}"${yn.getReplacesInText(s)};
		_sendToFrontEnd(${n._id}, {url: subActionVar${n._id}});
		request(subActionVar${n._id});`}renderDebug(n){return`URL: ${n.data.url}`}onTagChange(n){this.setState({inputs:[{nameRender:"renderModalInput",attr:"url",defaultValue:"http://mydevice.com?...",nameBlock:"URL"}]},()=>super.onTagChange(n))}static getStaticData(){return{acceptedBy:"actions",name:"HTTP Call",id:"ActionHTTPCall",icon:"Language",title:"Make a HTTP get request",helpDialog:"You can use %s in the URL to use current trigger value or %id to use the triggered object ID"}}getData(){return dv.getStaticData()}}class hv extends yn{constructor(n){super(n,hv.getStaticData())}static compile(n,s){return`// Log ${n.text}
		const subActionVar${n._id} = "${(n.text||"").replace(/"/g,'\\"')}"${yn.getReplacesInText(s)};
		_sendToFrontEnd(${n._id}, {text: subActionVar${n._id}});
		console.log(subActionVar${n._id});`}renderDebug(n){return I.I18n.t("Log: %s",n.data.text)}onTagChange(){this.setState({inputs:[{nameRender:"renderModalInput",attr:"text",defaultValue:"My device triggered",nameBlock:"Log text"}]},()=>super.onTagChange())}static getStaticData(){return{acceptedBy:"actions",name:"Log text",id:"ActionPrintText",icon:"Subject",title:"Print some text in log",helpDialog:"You can use %s in the text to display current trigger value or %id to display the triggered object ID"}}getData(){return hv.getStaticData()}}class pv extends yn{constructor(n){super(n,pv.getStaticData())}static compile(n){const s=n.unit==="ms"?1:n.unit==="s"?1e3:n.unit==="m"?6e4:36e5;return`// pause for ${s}ms
		_sendToFrontEnd(${n._id}, {paused: true});

		await wait(${n.pause} * ${s});

		_sendToFrontEnd(${n._id}, {paused: false});`}renderDebug(n){return I.I18n.t("Paused: %s",n.data.paused)}_getOptions(n){return n=n===void 0?this.state.settings.pause:n,n===1||n==="1"?[{value:"ms",title:"millisecond"},{value:"s",title:"second"},{value:"m",title:"minute"},{value:"h",title:"hour"}]:[{value:"ms",title:"milliseconds"},{value:"s",title:"seconds"},{value:"m",title:"minutes"},{value:"h",title:"hours"}]}_setInputs(n){this.setState({inputs:[{nameRender:"renderNumber",attr:"pause",defaultValue:100,noHelperText:!0},{nameRender:"renderSelect",attr:"unit",defaultValue:"ms",options:this._getOptions(n)}]},()=>super.onTagChange())}onValueChanged(n,s){s==="pause"&&this._setInputs(n)}onTagChange(){this._setInputs()}static getStaticData(){return{acceptedBy:"actions",name:"Pause",id:"ActionPause",icon:"Pause",title:"Make a pause between actions"}}getData(){return pv.getStaticData()}}class gv extends yn{constructor(n){super(n,gv.getStaticData())}static compile(n){const s=(n.func||"").split(`
`).map(i=>`        ${i}`);return s.unshift(`		_sendToFrontEnd(${n._id}, {func: 'executed'});`),s.unshift("// user function"),s.join(`
`)}renderDebug(){return I.I18n.t("Function: executed")}onTagChange(n){this.setState({inputs:[{nameRender:"renderModalInput",attr:"func",noTextEdit:!0,defaultValue:'console.log("Test")',nameBlock:"Function"}]},()=>super.onTagChange(n))}static getStaticData(){return{acceptedBy:"actions",name:"User function",id:"ActionFunction",icon:"Functions",title:"Write your own code",helpDialog:"This is advances option. You can write your own code here and it will be executed on trigger"}}getData(){return gv.getStaticData()}}class fv extends yn{constructor(n){super(n,fv.getStaticData())}isAllTriggersOnState(){var n,s,i,a;return!!((s=(n=this.props.userRules)==null?void 0:n.triggers)!=null&&s.find(c=>c.id==="TriggerState"))&&!((a=(i=this.props.userRules)==null?void 0:i.triggers)!=null&&a.find(c=>c.id!=="TriggerState"))}static compile(n,s){let i=n.value;n.useTrigger?i=n.toggle?"!obj.state.val":"obj.state.val":(i==null&&(i=""),typeof n.value=="string"&&parseFloat(n.value).toString()!==n.value&&n.value!=="true"&&n.value!=="false"&&(i=`"${i.replace(/"/g,'\\"')}"${yn.getReplacesInText(s)}`));let a;return n.toggle&&!n.useTrigger?a=`const subActionVar${n._id} = !(await getStateAsync("${n.oid}")).val`:a=`const subActionVar${n._id} = ${i}`,`// set delayed state ${n.oid} to ${n.toggle&&!n.useTrigger?"toggle":i} with delay of ${n.delay}ms
		${a};
		_sendToFrontEnd(${n._id}, {val: subActionVar${n._id}, ack: ${n.tagCard==="update"}});
		setStateDelayed("${n.oid}", subActionVar${n._id}, ${n.tagCard==="update"}, ${parseInt(n.delay,10)}, ${n.clearRunning?"true":"false"});`}renderDebug(n){var s,i;return f.jsxs("span",{children:[I.I18n.t("Set:")," ",f.jsx("span",{className:n.data.ack?(s=this.props.classes)==null?void 0:s.valueAck:(i=this.props.classes)==null?void 0:i.valueNotAck,children:Dh(n.data.val)})]})}_setInputs(n,s){const i=this.isAllTriggersOnState();s=s===void 0?this.state.settings.toggle:s,n=n===void 0?this.state.settings.useTrigger:n;let a="",c;const{oidType:h,oidUnit:g,oidStates:b,oidMax:$,oidMin:y,oidRole:w,oidWrite:T,oidStep:C}=this.state.settings;let E;h&&(h==="number"?(a="number",$!==void 0&&y!==void 0&&(a="slider")):h==="boolean"?(a="boolean",w&&w.includes("button")&&T&&(a="button")):(a="",w&&w.includes("color")&&(a="color")),b&&(c=Object.keys(b).map(A=>({value:A,title:b[A]})),a="select"));let k;if(i&&n)k=[{backText:"use trigger value",nameRender:"renderCheckbox",attr:"useTrigger",defaultValue:!1}],a==="boolean"&&k.push({backText:"toggle value",attr:"toggle",nameRender:"renderCheckbox",defaultValue:!1});else{switch(a){case"number":k=[{backText:g||"",frontText:"with",nameRender:"renderNumber",defaultValue:$===void 0?0:$,attr:"value"}],this.state.settings.value!==void 0&&isNaN(parseFloat(this.state.settings.value))&&(E={value:$===void 0?0:$});break;case"slider":{k=[{nameRender:"renderSlider",defaultValue:$,min:y,max:$,unit:g,step:C,attr:"value"}];const A=parseFloat(this.state.settings.value);this.state.settings.value!==void 0&&(isNaN(A)||A<y||A>$)&&(E={value:$});break}case"select":k=[{nameRender:"renderSelect",frontText:"with",options:c,defaultValue:(c==null?void 0:c[0].value)||"",attr:"value"}],this.state.settings.value!==void 0&&!(c!=null&&c.find(A=>A.value===this.state.settings.value))&&(E={value:(c==null?void 0:c[0].value)||""});break;case"boolean":k=[{backText:"toggle value",attr:"toggle",nameRender:"renderCheckbox",defaultValue:!1}],s||k.push({backText:"true",frontText:"false",nameRender:"renderSwitch",defaultValue:!1,attr:"value"}),this.state.settings.value!==void 0&&this.state.settings.value!==!1&&this.state.settings.value!==!0&&(E={value:!1});break;case"button":k=[{nameRender:"renderButton",defaultValue:!0,attr:"value"}],this.state.settings.value!==void 0&&this.state.settings.value!==!0&&(E={value:!0});break;case"color":k=[{nameRender:"renderColor",frontText:"with",defaultValue:"#FFFFFF",attr:"value"}],this.state.settings.value!==void 0&&(typeof this.state.settings.value!="string"||!this.state.settings.value.startsWith("#")&&!this.state.settings.value.startsWith("rgb"))&&(E={value:"#FFFFFF"});break;default:k=[{backText:g||"",frontText:"with",nameRender:"renderText",defaultValue:"",attr:"value"}];break}i&&k.unshift({backText:"use trigger value",nameRender:"renderCheckbox",attr:"useTrigger"})}return k.push({backText:"ms",frontText:"Delay",nameRender:"renderNumber",defaultValue:1e3,noHelperText:!0,attr:"delay"}),k.push({backText:"clear running",nameRender:"renderCheckbox",defaultValue:!0,attr:"clearRunning"}),{inputs:k,newSettings:E}}onTagChange(n,s,i,a,c){c=c===void 0?this.state.settings.useTrigger:c;const{inputs:h,newSettings:g}=this._setInputs(c,a);h.unshift({nameRender:"renderObjectID",attr:"oid",defaultValue:"",checkReadOnly:!0}),this.setState({inputs:h},()=>super.onTagChange(null,()=>{if(g){const b=JSON.parse(JSON.stringify(this.state.settings));Object.assign(b,g),this.setState(b),this.props.onChange(b)}}))}onValueChanged(n,s){this.onTagChange(void 0,void 0,void 0,s==="toggle"?n:void 0,s==="useTrigger"?n:void 0)}onUpdate(){this.onTagChange()}static getStaticData(){return{acceptedBy:"actions",name:"Set with delay",id:"ActionSetStateDelayed",icon:"PlayForWork",tagCardArray:["control","update"],title:"Control or update some state with delay",helpDialog:"You can use %s in the value to use the current trigger value or %id to display the triggered object ID"}}getData(){return fv.getStaticData()}}class mv extends yn{constructor(n){super(n,mv.getStaticData())}isAllTriggersOnState(){var n,s,i,a;return!!((s=(n=this.props.userRules)==null?void 0:n.triggers)!=null&&s.find(c=>c.id==="TriggerState"))&&!((a=(i=this.props.userRules)==null?void 0:i.triggers)!=null&&a.find(c=>c.id!=="TriggerState"))}static compile(n){const s=`const val2_${n._id} = (await getStateAsync("${n.oid1}")).val;`,i=`const val1_${n._id} = (await getStateAsync("${n.oid2}")).val;`;return`// ${n.oid1} ${n.operation} ${n.oid2} => ${n.oidResult}
		 ${s}
		 ${i}
		_sendToFrontEnd(${n._id}, {val: val1_${n._id} ${n.operation} val2_${n._id}, ack: ${n.tagCard==="update"}});
		await setStateAsync("${n.oidResult}", val1_${n._id} ${n.operation} val2_${n._id}, ${n.tagCard==="update"});`}renderDebug(n){var s,i;return f.jsxs("span",{children:[I.I18n.t("Set:")," ",f.jsx("span",{className:n.data.ack?(s=this.props.classes)==null?void 0:s.valueAck:(i=this.props.classes)==null?void 0:i.valueNotAck,children:Dh(n.data.val)})]})}onTagChange(){const n=[];n.push({nameRender:"renderObjectID",title:"ID1",attr:"oid1",defaultValue:"",checkReadOnly:!1}),n.push({nameRender:"renderSelect",options:[{value:"+",title:"+"},{value:"-",title:"-"},{value:"*",title:"*"},{value:"/",title:"/"}],doNotTranslate:!0,defaultValue:"+",attr:"operation"}),n.push({nameRender:"renderObjectID",title:"ID2",attr:"oid2",defaultValue:"",checkReadOnly:!1}),n.push({nameRender:"renderNameText",defaultValue:"store in",attr:"textEqual"}),n.push({nameRender:"renderObjectID",attr:"oidResult",defaultValue:"",checkReadOnly:!0}),this.setState({inputs:n},()=>super.onTagChange(null,()=>{const s=JSON.parse(JSON.stringify(this.state.settings));this.props.onChange(s)}))}onValueChanged(n,s){this.onTagChange()}onUpdate(){this.onTagChange()}static getStaticData(){return{acceptedBy:"actions",name:"Operate two states",id:"ActionOperateStates",icon:"AddBox",tagCardArray:["control","update"],title:"Operations with two states"}}getData(){return mv.getStaticData()}}const qN=[pu,av,lv,Cf,Sf,ql,cv,uv,dv,hv,pv,gv,fv,mv],_$={sayit:sv,pushover:rv,"whatsapp-cmb":iv,pushsafer:ov},Gf=ve.createContext({blocks:null,socket:null,onUpdate:!1,setOnUpdate:o=>{},setOnDebugMessage:o=>{},onDebugMessage:[],enableSimulation:!1,setEnableSimulation:o=>{}}),YN=({children:o,socket:n})=>{const[s,i]=ve.useState(null),[a,c]=ve.useState(!1),[h,g]=ve.useState([]),[b,$]=ve.useState(!1);return ve.useEffect(()=>{a&&c(!1)},[a]),ve.useEffect(()=>{(async()=>{const y=await n.getAdapterInstances(),w=Object.keys(_$).filter(A=>y.find(P=>{var N;return((N=P==null?void 0:P.common)==null?void 0:N.name)===A})),T=[],C=y.filter(A=>A.common.javascriptRules),E=[];for(const A of C){if(E.includes(A.common.name)||!A.common.javascriptRules)continue;let P;if(A.common.javascriptRules.url.startsWith("http:")||A.common.javascriptRules.url.startsWith("https:")?P=A.common.javascriptRules.url:A.common.javascriptRules.url.startsWith("./")?P=`${window.location.protocol}//${window.location.host}${A.common.javascriptRules.url.replace(/^\./,"")}`:P=`${window.location.protocol}//${window.location.host}/adapter/${A.common.name}/${A.common.javascriptRules.url}`,A.common.javascriptRules.i18n===!0){const N=P.lastIndexOf("/");let B;N!==-1?B=P.substring(0,N):B=P;const S=I.I18n.getLanguage(),H=`${B}/i18n/${S}.json`;await fetch(H).then(q=>q.json()).then(q=>I.I18n.extendTranslations(q,S)).catch(q=>{if(S!=="en")return fetch(`${B}/i18n/en.json`).then(se=>se.json()).then(se=>I.I18n.extendTranslations(se,S)).catch(se=>console.error(`Cannot load i18n "${H}": ${se}`));console.log(`Cannot load i18n "${H}": ${q}`)})}else if(A.common.javascriptRules.i18n&&typeof A.common.javascriptRules.i18n=="object")try{I.I18n.extendTranslations(A.common.javascriptRules.i18n)}catch(N){console.error(`Cannot import i18n for "${A.common.javascriptRules.name}": ${N}`)}try{p_.registerRemotes([{name:A.common.javascriptRules.name,entry:P,type:A.common.javascriptRules.type}]);const N=(await p_.loadRemote(`${A.common.javascriptRules.name}/${A.common.javascriptRules.name}`)).default;N&&(T.push(N),E.push(A.common.name),_$[A.common.name]=null)}catch(N){console.error(`Cannot load component "${A.common.javascriptRules.name}": ${N}`)}}const k=w.filter(A=>_$[A]).map(A=>_$[A]);i([...qN,...k,...T])})()},[]),f.jsx(Gf.Provider,{value:{blocks:s,socket:n,onUpdate:a,setOnUpdate:c,onDebugMessage:h,setOnDebugMessage:g,enableSimulation:b,setEnableSimulation:$},children:o})};function XN(o,n,s){const{_id:i,acceptedBy:a}=o;let c;if(!a||!n[a])return console.warn(`Cannot find ${a}`),n;switch(a){case"actions":if(c=n.actions[s].find(h=>h._id===i),!c)console.warn(`Cannot find ${i}`);else{const h=n.actions[s].indexOf(c);n.actions[s][h]=o}return n;case"conditions":if(c=n.conditions[s].find(h=>h._id===i),!c)console.warn(`Cannot find ${i}`);else{const h=n.conditions[s].indexOf(c);n.conditions[s][h]=o}return n;default:if(c=n.triggers.find(h=>h._id===i),!c)console.warn(`Cannot find ${i}`);else{const h=n.triggers.indexOf(c);n.triggers[h]=o}return n}}const zk=ve.memo(o=>{var Y;const{setUserRules:n,userRules:s,_id:i,id:a,blockValue:c,active:h,acceptedBy:g,isTourOpen:b,setTourStep:$,tourStep:y}=o,[w,T]=ve.useState(null),{blocks:C,socket:E,onUpdate:k,setOnUpdate:A,onDebugMessage:P,enableSimulation:N}=ve.useContext(Gf),B=ve.useCallback(X=>C==null?void 0:C.find(ce=>ce.getStaticData().id===X),[C]),S=ve.useCallback(X=>{const ce=XN(X,s,c);ce&&n(ce)},[s]),H=X=>{X.currentTarget!==w&&T(X.currentTarget)},q=()=>T(null),se=ve.useMemo(()=>{const X=B(a)||yn;return f.jsx(X,{...o,notFound:!B(a),isTourOpen:b,setTourStep:$,tourStep:y,onUpdate:k,setOnUpdate:A,enableSimulation:N,onDebugMessage:P,onChange:S,className:void 0,socket:E})},[s,k,P,N]),[ee,K]=ve.useState(!1);return f.jsxs("div",{onMouseMove:H,onMouseEnter:H,onMouseLeave:q,onMouseDown:X=>{if(X.ctrlKey){let ce;const W=Rh(g,s,c);g==="conditions"?(ce=W.conditions[c].find(te=>te._id===i),ce&&W.conditions[c].splice(W.conditions[c].indexOf(ce),0,{...ce,_id:Date.now()})):g==="actions"?(ce=W.actions[c].find(te=>te._id===i),ce&&W.actions[c].splice(W.actions[c].indexOf(ce),0,{...ce,_id:Date.now()})):(ce=W.triggers.find(te=>te._id===i),ce&&W.triggers.splice(W[g].indexOf(ce),0,{...ce,_id:Date.now()})),n(W)}},id:"height",style:h?{width:(((Y=document.getElementById("width"))==null?void 0:Y.clientWidth)||0)-70}:void 0,className:`${mh.cardStyle} ${h?mh.cardStyleActive:null} ${ee?mh.isDelete:null}`,children:[f.jsx("div",{className:mh.drag_mobile}),se,n&&f.jsx("div",{className:mh.controlMenu,style:w?{opacity:1}:{opacity:0},children:f.jsx("div",{onClick:()=>{let X=Rh(g,s,c);X=du(g,X,c,i),K(!0),setTimeout(()=>{g==="triggers"&&A(!0),n(X)},300)},className:mh.closeBtn})})]})}),ZN={position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0,width:"100%",height:"100%"},QN=(o,n,s)=>{if(!o||!n)return{display:"none"};let{x:i,y:a}=n;const c=`translate(${i}px, ${a}px)`;return{transform:c,WebkitTransform:c}},eL=o=>{const{itemType:n,isDragging:s,item:i,initialOffset:a,currentOffset:c,targetIds:h}=vA(b=>({item:b.getItem(),itemType:b.getItemType(),initialOffset:b.getInitialSourceClientOffset(),currentOffset:b.getSourceClientOffset(),isDragging:b.isDragging(),targetIds:b.getTargetIds()})),g=()=>{switch(n){case"box":return h.length?f.jsx(zk,{active:!0,...i,allBlocks:o.allBlocks}):f.jsx(Mk,{active:!0,...i,socket:o.socket});default:return null}};return s?f.jsx("div",{style:ZN,children:f.jsx("div",{style:QN(a,c),children:g()})}):null},tL="_border_wrpm3_1",nL="_emptyBlockStyle_wrpm3_6",sL="_emptyBlock_wrpm3_6",rL="_selectOnChange_wrpm3_22",iL="_selectOnChangeHelp_wrpm3_28",oL="_selectOnChangeHelpIcon_wrpm3_34",aL="_emptyBlockNone_wrpm3_49",lL="_mainBlockItemRules_wrpm3_55",cL="_nameBlockItems_wrpm3_63",uL="_contentBlockItem_wrpm3_73",dL="_wrapperMargin_wrpm3_81",hL="_contentHeightOn_wrpm3_87",pL="_contentHeightOff_wrpm3_99",gL="_cardAdd_wrpm3_105",fL="_blockCardAdd_wrpm3_125",mL="_addClassOverflow_wrpm3_136",bL="_addClassHeight_wrpm3_140",ps={border:tL,emptyBlockStyle:nL,emptyBlock:sL,selectOnChange:rL,selectOnChangeHelp:iL,selectOnChangeHelpIcon:oL,emptyBlockNone:aL,mainBlockItemRules:lL,nameBlockItems:cL,contentBlockItem:uL,wrapperMargin:dL,contentHeightOn:hL,contentHeightOff:pL,cardAdd:gL,blockCardAdd:fL,addClassOverflow:mL,addClassHeight:bL};function U_(o,n){const[s,i]=ve.useState(window.localStorage.getItem(n)?JSON.parse(window.localStorage.getItem(n)||""):o);return[s,c=>{window.localStorage.setItem(n,JSON.stringify(c)),i(c)},!!window.localStorage.getItem(n)]}var bv={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var $L=bv.exports;(function(o,n){(function(){var s,i="4.17.21",a=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",g="Invalid `variable` option passed into `_.template`",b="__lodash_hash_undefined__",$=500,y="__lodash_placeholder__",w=1,T=2,C=4,E=1,k=2,A=1,P=2,N=4,B=8,S=16,H=32,q=64,se=128,ee=256,K=512,Y=30,X="...",ce=800,W=16,te=1,ke=2,Z=3,ze=1/0,Ce=9007199254740991,at=17976931348623157e292,he=NaN,Ae=4294967295,de=Ae-1,Se=Ae>>>1,xe=[["ary",se],["bind",A],["bindKey",P],["curry",B],["curryRight",S],["flip",K],["partial",H],["partialRight",q],["rearg",ee]],He="[object Arguments]",ne="[object Array]",Ke="[object AsyncFunction]",Te="[object Boolean]",Je="[object Date]",rt="[object DOMException]",ht="[object Error]",nt="[object Function]",Wt="[object GeneratorFunction]",St="[object Map]",lt="[object Number]",ft="[object Null]",st="[object Object]",At="[object Promise]",mn="[object Proxy]",Ue="[object RegExp]",Nt="[object Set]",wt="[object String]",qt="[object Symbol]",ct="[object Undefined]",me="[object WeakMap]",ge="[object WeakSet]",ue="[object ArrayBuffer]",we="[object DataView]",Ve="[object Float32Array]",re="[object Float64Array]",Fe="[object Int8Array]",It="[object Int16Array]",pt="[object Int32Array]",En="[object Uint8Array]",mt="[object Uint8ClampedArray]",Cn="[object Uint16Array]",$n="[object Uint32Array]",zn=/\b__p \+= '';/g,Jn=/\b(__p \+=) '' \+/g,Gs=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ns=/&(?:amp|lt|gt|quot|#39);/g,Rn=/[&<>"']/g,Kt=RegExp(ns.source),Pn=RegExp(Rn.source),cs=/<%-([\s\S]+?)%>/g,Ks=/<%([\s\S]+?)%>/g,jn=/<%=([\s\S]+?)%>/g,Un=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Rs=/^\w*$/,ii=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ir=/[\\^$.*+?()[\]{}|]/g,ec=RegExp(Ir.source),xr=/^\s+/,Ka=/\s/,tc=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,nc=/\{\n\/\* \[wrapped with (.+)\] \*/,Tu=/,? & /,Yo=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,z=/[()=,{}\[\]\/\s]/,U=/\\(\\)?/g,R=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,j=/\w*$/,F=/^[-+]0x[0-9a-f]+$/i,pe=/^0b[01]+$/i,Ee=/^\[object .+?Constructor\]$/,_e=/^0o[0-7]+$/i,ae=/^(?:0|[1-9]\d*)$/,je=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,it=/($^)/,Ft=/['\n\r\u2028\u2029\\]/g,Yt="\\ud800-\\udfff",on="\\u0300-\\u036f",Lt="\\ufe20-\\ufe2f",an="\\u20d0-\\u20ff",_n=on+Lt+an,Tt="\\u2700-\\u27bf",In="a-z\\xdf-\\xf6\\xf8-\\xff",ss="\\xac\\xb1\\xd7\\xf7",Js="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Xo="\\u2000-\\u206f",Dr=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ho="A-Z\\xc0-\\xd6\\xd8-\\xde",Ts="\\ufe0e\\ufe0f",tn=ss+Js+Xo+Dr,qs="[']",Oi="["+Yt+"]",rs="["+tn+"]",Ms="["+_n+"]",po="\\d+",Zo="["+Tt+"]",Ri="["+In+"]",go="[^"+Yt+tn+po+Tt+In+ho+"]",fo="\\ud83c[\\udffb-\\udfff]",oi="(?:"+Ms+"|"+fo+")",Mi="[^"+Yt+"]",ku="(?:\\ud83c[\\udde6-\\uddff]){2}",Ja="[\\ud800-\\udbff][\\udc00-\\udfff]",Qo="["+ho+"]",Nh="\\u200d",sc="(?:"+Ri+"|"+go+")",Xf="(?:"+Qo+"|"+go+")",ea="(?:"+qs+"(?:d|ll|m|re|s|t|ve))?",Lh="(?:"+qs+"(?:D|LL|M|RE|S|T|VE))?",Eu=oi+"?",rc="["+Ts+"]?",Bh="(?:"+Nh+"(?:"+[Mi,ku,Ja].join("|")+")"+rc+Eu+")*",Ph="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Zf="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ic=rc+Eu+Bh,qa="(?:"+[Zo,ku,Ja].join("|")+")"+ic,Iu="(?:"+[Mi+Ms+"?",Ms,ku,Ja,Oi].join("|")+")",Qf=RegExp(qs,"g"),jh=RegExp(Ms,"g"),oc=RegExp(fo+"(?="+fo+")|"+Iu+ic,"g"),em=RegExp([Qo+"?"+Ri+"+"+ea+"(?="+[rs,Qo,"$"].join("|")+")",Xf+"+"+Lh+"(?="+[rs,Qo+sc,"$"].join("|")+")",Qo+"?"+sc+"+"+ea,Qo+"+"+Lh,Zf,Ph,po,qa].join("|"),"g"),tm=RegExp("["+Nh+Yt+_n+Ts+"]"),ta=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,nm=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ac=-1,Qt={};Qt[Ve]=Qt[re]=Qt[Fe]=Qt[It]=Qt[pt]=Qt[En]=Qt[mt]=Qt[Cn]=Qt[$n]=!0,Qt[He]=Qt[ne]=Qt[ue]=Qt[Te]=Qt[we]=Qt[Je]=Qt[ht]=Qt[nt]=Qt[St]=Qt[lt]=Qt[st]=Qt[Ue]=Qt[Nt]=Qt[wt]=Qt[me]=!1;var Sn={};Sn[He]=Sn[ne]=Sn[ue]=Sn[we]=Sn[Te]=Sn[Je]=Sn[Ve]=Sn[re]=Sn[Fe]=Sn[It]=Sn[pt]=Sn[St]=Sn[lt]=Sn[st]=Sn[Ue]=Sn[Nt]=Sn[wt]=Sn[qt]=Sn[En]=Sn[mt]=Sn[Cn]=Sn[$n]=!0,Sn[ht]=Sn[nt]=Sn[me]=!1;var sm={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},rm={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},im={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},om={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},am=parseFloat,lm=parseInt,xu=typeof Vo=="object"&&Vo&&Vo.Object===Object&&Vo,Ni=typeof self=="object"&&self&&self.Object===Object&&self,Wn=xu||Ni||Function("return this")(),lc=n&&!n.nodeType&&n,mo=lc&&!0&&o&&!o.nodeType&&o,Fh=mo&&mo.exports===lc,Du=Fh&&xu.process,hr=function(){try{var ie=mo&&mo.require&&mo.require("util").types;return ie||Du&&Du.binding&&Du.binding("util")}catch{}}(),zh=hr&&hr.isArrayBuffer,Uh=hr&&hr.isDate,Wh=hr&&hr.isMap,Hh=hr&&hr.isRegExp,Vh=hr&&hr.isSet,Au=hr&&hr.isTypedArray;function Ys(ie,De,be){switch(be.length){case 0:return ie.call(De);case 1:return ie.call(De,be[0]);case 2:return ie.call(De,be[0],be[1]);case 3:return ie.call(De,be[0],be[1],be[2])}return ie.apply(De,be)}function Ya(ie,De,be,et){for(var xt=-1,rn=ie==null?0:ie.length;++xt<rn;){var qn=ie[xt];De(et,qn,be(qn),ie)}return et}function Ns(ie,De){for(var be=-1,et=ie==null?0:ie.length;++be<et&&De(ie[be],be,ie)!==!1;);return ie}function cm(ie,De){for(var be=ie==null?0:ie.length;be--&&De(ie[be],be,ie)!==!1;);return ie}function na(ie,De){for(var be=-1,et=ie==null?0:ie.length;++be<et;)if(!De(ie[be],be,ie))return!1;return!0}function ai(ie,De){for(var be=-1,et=ie==null?0:ie.length,xt=0,rn=[];++be<et;){var qn=ie[be];De(qn,be,ie)&&(rn[xt++]=qn)}return rn}function Xa(ie,De){var be=ie==null?0:ie.length;return!!be&&bo(ie,De,0)>-1}function cc(ie,De,be){for(var et=-1,xt=ie==null?0:ie.length;++et<xt;)if(be(De,ie[et]))return!0;return!1}function wn(ie,De){for(var be=-1,et=ie==null?0:ie.length,xt=Array(et);++be<et;)xt[be]=De(ie[be],be,ie);return xt}function Kr(ie,De){for(var be=-1,et=De.length,xt=ie.length;++be<et;)ie[xt+be]=De[be];return ie}function uc(ie,De,be,et){var xt=-1,rn=ie==null?0:ie.length;for(et&&rn&&(be=ie[++xt]);++xt<rn;)be=De(be,ie[xt],xt,ie);return be}function um(ie,De,be,et){var xt=ie==null?0:ie.length;for(et&&xt&&(be=ie[--xt]);xt--;)be=De(be,ie[xt],xt,ie);return be}function dc(ie,De){for(var be=-1,et=ie==null?0:ie.length;++be<et;)if(De(ie[be],be,ie))return!0;return!1}var Gh=el("length");function Kh(ie){return ie.split("")}function Jh(ie){return ie.match(Yo)||[]}function Ou(ie,De,be){var et;return be(ie,function(xt,rn,qn){if(De(xt,rn,qn))return et=rn,!1}),et}function Za(ie,De,be,et){for(var xt=ie.length,rn=be+(et?1:-1);et?rn--:++rn<xt;)if(De(ie[rn],rn,ie))return rn;return-1}function bo(ie,De,be){return De===De?tp(ie,De,be):Za(ie,Qa,be)}function dm(ie,De,be,et){for(var xt=be-1,rn=ie.length;++xt<rn;)if(et(ie[xt],De))return xt;return-1}function Qa(ie){return ie!==ie}function Ru(ie,De){var be=ie==null?0:ie.length;return be?hc(ie,De)/be:he}function el(ie){return function(De){return De==null?s:De[ie]}}function tl(ie){return function(De){return ie==null?s:ie[De]}}function Jr(ie,De,be,et,xt){return xt(ie,function(rn,qn,kt){be=et?(et=!1,rn):De(be,rn,qn,kt)}),be}function qh(ie,De){var be=ie.length;for(ie.sort(De);be--;)ie[be]=ie[be].value;return ie}function hc(ie,De){for(var be,et=-1,xt=ie.length;++et<xt;){var rn=De(ie[et]);rn!==s&&(be=be===s?rn:be+rn)}return be}function sa(ie,De){for(var be=-1,et=Array(ie);++be<ie;)et[be]=De(be);return et}function Yh(ie,De){return wn(De,function(be){return[be,ie[be]]})}function Mu(ie){return ie&&ie.slice(0,sp(ie)+1).replace(xr,"")}function Xs(ie){return function(De){return ie(De)}}function nl(ie,De){return wn(De,function(be){return ie[be]})}function ra(ie,De){return ie.has(De)}function Xh(ie,De){for(var be=-1,et=ie.length;++be<et&&bo(De,ie[be],0)>-1;);return be}function Zh(ie,De){for(var be=ie.length;be--&&bo(De,ie[be],0)>-1;);return be}function hm(ie,De){for(var be=ie.length,et=0;be--;)ie[be]===De&&++et;return et}var pm=tl(sm),gm=tl(rm);function sl(ie){return"\\"+om[ie]}function Qh(ie,De){return ie==null?s:ie[De]}function $o(ie){return tm.test(ie)}function rl(ie){return ta.test(ie)}function Nu(ie){for(var De,be=[];!(De=ie.next()).done;)be.push(De.value);return be}function Lu(ie){var De=-1,be=Array(ie.size);return ie.forEach(function(et,xt){be[++De]=[xt,et]}),be}function ep(ie,De){return function(be){return ie(De(be))}}function li(ie,De){for(var be=-1,et=ie.length,xt=0,rn=[];++be<et;){var qn=ie[be];(qn===De||qn===y)&&(ie[be]=y,rn[xt++]=be)}return rn}function il(ie){var De=-1,be=Array(ie.size);return ie.forEach(function(et){be[++De]=et}),be}function Li(ie){var De=-1,be=Array(ie.size);return ie.forEach(function(et){be[++De]=[et,et]}),be}function tp(ie,De,be){for(var et=be-1,xt=ie.length;++et<xt;)if(ie[et]===De)return et;return-1}function np(ie,De,be){for(var et=be+1;et--;)if(ie[et]===De)return et;return et}function ia(ie){return $o(ie)?rp(ie):Gh(ie)}function Ar(ie){return $o(ie)?mm(ie):Kh(ie)}function sp(ie){for(var De=ie.length;De--&&Ka.test(ie.charAt(De)););return De}var fm=tl(im);function rp(ie){for(var De=oc.lastIndex=0;oc.test(ie);)++De;return De}function mm(ie){return ie.match(oc)||[]}function ip(ie){return ie.match(em)||[]}var bm=function ie(De){De=De==null?Wn:Or.defaults(Wn.Object(),De,Or.pick(Wn,nm));var be=De.Array,et=De.Date,xt=De.Error,rn=De.Function,qn=De.Math,kt=De.Object,Bu=De.RegExp,ol=De.String,us=De.TypeError,pc=be.prototype,op=rn.prototype,Bi=kt.prototype,Pi=De["__core-js_shared__"],al=op.toString,nn=Bi.hasOwnProperty,gc=0,Pu=function(){var u=/[^.]+$/.exec(Pi&&Pi.keys&&Pi.keys.IE_PROTO||"");return u?"Symbol(src)_1."+u:""}(),ll=Bi.toString,$m=al.call(kt),vm=Wn._,ym=Bu("^"+al.call(nn).replace(Ir,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),cl=Fh?De.Buffer:s,ji=De.Symbol,ul=De.Uint8Array,dl=cl?cl.allocUnsafe:s,fc=ep(kt.getPrototypeOf,kt),ap=kt.create,lp=Bi.propertyIsEnumerable,mc=pc.splice,hl=ji?ji.isConcatSpreadable:s,oa=ji?ji.iterator:s,Fi=ji?ji.toStringTag:s,aa=function(){try{var u=pn(kt,"defineProperty");return u({},"",{}),u}catch{}}(),ju=De.clearTimeout!==Wn.clearTimeout&&De.clearTimeout,_m=et&&et.now!==Wn.Date.now&&et.now,bc=De.setTimeout!==Wn.setTimeout&&De.setTimeout,pl=qn.ceil,vo=qn.floor,Fu=kt.getOwnPropertySymbols,wm=cl?cl.isBuffer:s,zi=De.isFinite,cp=pc.join,ci=ep(kt.keys,kt),Xn=qn.max,fs=qn.min,up=et.now,Cm=De.parseInt,yo=qn.random,dp=pc.reverse,zu=pn(De,"DataView"),gl=pn(De,"Map"),Uu=pn(De,"Promise"),la=pn(De,"Set"),fl=pn(De,"WeakMap"),ca=pn(kt,"create"),$c=fl&&new fl,ua={},Wu=fr(zu),Sm=fr(gl),Tm=fr(Uu),hp=fr(la),Hu=fr(fl),ml=ji?ji.prototype:s,_o=ml?ml.valueOf:s,Vu=ml?ml.toString:s;function M(u){if(Tn(u)&&!jt(u)&&!(u instanceof Ot)){if(u instanceof Zn)return u;if(nn.call(u,"__wrapped__"))return og(u)}return new Zn(u)}var qr=function(){function u(){}return function(d){if(!An(d))return{};if(ap)return ap(d);u.prototype=d;var m=new u;return u.prototype=s,m}}();function ui(){}function Zn(u,d){this.__wrapped__=u,this.__actions__=[],this.__chain__=!!d,this.__index__=0,this.__values__=s}M.templateSettings={escape:cs,evaluate:Ks,interpolate:jn,variable:"",imports:{_:M}},M.prototype=ui.prototype,M.prototype.constructor=M,Zn.prototype=qr(ui.prototype),Zn.prototype.constructor=Zn;function Ot(u){this.__wrapped__=u,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ae,this.__views__=[]}function km(){var u=new Ot(this.__wrapped__);return u.__actions__=Vn(this.__actions__),u.__dir__=this.__dir__,u.__filtered__=this.__filtered__,u.__iteratees__=Vn(this.__iteratees__),u.__takeCount__=this.__takeCount__,u.__views__=Vn(this.__views__),u}function Em(){if(this.__filtered__){var u=new Ot(this);u.__dir__=-1,u.__filtered__=!0}else u=this.clone(),u.__dir__*=-1;return u}function Im(){var u=this.__wrapped__.value(),d=this.__dir__,m=jt(u),_=d<0,x=m?u.length:0,L=Nc(0,x,this.__views__),V=L.start,Q=L.end,le=Q-V,Me=_?Q:V-1,Ne=this.__iteratees__,Pe=Ne.length,qe=0,dt=fs(le,this.__takeCount__);if(!m||!_&&x==le&&dt==le)return Gi(u,this.__actions__);var $t=[];e:for(;le--&&qe<dt;){Me+=d;for(var Ut=-1,vt=u[Me];++Ut<Pe;){var Xt=Ne[Ut],en=Xt.iteratee,zs=Xt.type,As=en(vt);if(zs==ke)vt=As;else if(!As){if(zs==te)continue e;break e}}$t[qe++]=vt}return $t}Ot.prototype=qr(ui.prototype),Ot.prototype.constructor=Ot;function Ui(u){var d=-1,m=u==null?0:u.length;for(this.clear();++d<m;){var _=u[d];this.set(_[0],_[1])}}function Gu(){this.__data__=ca?ca(null):{},this.size=0}function xm(u){var d=this.has(u)&&delete this.__data__[u];return this.size-=d?1:0,d}function Dm(u){var d=this.__data__;if(ca){var m=d[u];return m===b?s:m}return nn.call(d,u)?d[u]:s}function Am(u){var d=this.__data__;return ca?d[u]!==s:nn.call(d,u)}function pp(u,d){var m=this.__data__;return this.size+=this.has(u)?0:1,m[u]=ca&&d===s?b:d,this}Ui.prototype.clear=Gu,Ui.prototype.delete=xm,Ui.prototype.get=Dm,Ui.prototype.has=Am,Ui.prototype.set=pp;function Rr(u){var d=-1,m=u==null?0:u.length;for(this.clear();++d<m;){var _=u[d];this.set(_[0],_[1])}}function gp(){this.__data__=[],this.size=0}function Ku(u){var d=this.__data__,m=$l(d,u);if(m<0)return!1;var _=d.length-1;return m==_?d.pop():mc.call(d,m,1),--this.size,!0}function Om(u){var d=this.__data__,m=$l(d,u);return m<0?s:d[m][1]}function Rm(u){return $l(this.__data__,u)>-1}function Mm(u,d){var m=this.__data__,_=$l(m,u);return _<0?(++this.size,m.push([u,d])):m[_][1]=d,this}Rr.prototype.clear=gp,Rr.prototype.delete=Ku,Rr.prototype.get=Om,Rr.prototype.has=Rm,Rr.prototype.set=Mm;function di(u){var d=-1,m=u==null?0:u.length;for(this.clear();++d<m;){var _=u[d];this.set(_[0],_[1])}}function ut(){this.size=0,this.__data__={hash:new Ui,map:new(gl||Rr),string:new Ui}}function Zs(u){var d=Rc(this,u).delete(u);return this.size-=d?1:0,d}function is(u){return Rc(this,u).get(u)}function xn(u){return Rc(this,u).has(u)}function hi(u,d){var m=Rc(this,u),_=m.size;return m.set(u,d),this.size+=m.size==_?0:1,this}di.prototype.clear=ut,di.prototype.delete=Zs,di.prototype.get=is,di.prototype.has=xn,di.prototype.set=hi;function Mr(u){var d=-1,m=u==null?0:u.length;for(this.__data__=new di;++d<m;)this.add(u[d])}function tt(u){return this.__data__.set(u,b),this}function Hn(u){return this.__data__.has(u)}Mr.prototype.add=Mr.prototype.push=tt,Mr.prototype.has=Hn;function pr(u){var d=this.__data__=new Rr(u);this.size=d.size}function Nm(){this.__data__=new Rr,this.size=0}function wo(u){var d=this.__data__,m=d.delete(u);return this.size=d.size,m}function Ju(u){return this.__data__.get(u)}function qu(u){return this.__data__.has(u)}function fp(u,d){var m=this.__data__;if(m instanceof Rr){var _=m.__data__;if(!gl||_.length<a-1)return _.push([u,d]),this.size=++m.size,this;m=this.__data__=new di(_)}return m.set(u,d),this.size=m.size,this}pr.prototype.clear=Nm,pr.prototype.delete=wo,pr.prototype.get=Ju,pr.prototype.has=qu,pr.prototype.set=fp;function mp(u,d){var m=jt(u),_=!m&&eo(u),x=!m&&!_&&ei(u),L=!m&&!_&&!x&&Oo(u),V=m||_||x||L,Q=V?sa(u.length,ol):[],le=Q.length;for(var Me in u)(d||nn.call(u,Me))&&!(V&&(Me=="length"||x&&(Me=="offset"||Me=="parent")||L&&(Me=="buffer"||Me=="byteLength"||Me=="byteOffset")||oe(Me,le)))&&Q.push(Me);return Q}function Yu(u){var d=u.length;return d?u[dd(0,d-1)]:s}function Xu(u,d){return Br(Vn(u),Co(d,0,u.length))}function bp(u){return Br(Vn(u))}function vc(u,d,m){(m!==s&&!Qr(u[d],m)||m===s&&!(d in u))&&pi(u,d,m)}function bl(u,d,m){var _=u[d];(!(nn.call(u,d)&&Qr(_,m))||m===s&&!(d in u))&&pi(u,d,m)}function $l(u,d){for(var m=u.length;m--;)if(Qr(u[m][0],d))return m;return-1}function Lm(u,d,m,_){return Hi(u,function(x,L,V){d(_,x,m(x),V)}),_}function yc(u,d){return u&&Xr(d,ls(d),u)}function Bm(u,d){return u&&Xr(d,hs(d),u)}function pi(u,d,m){d=="__proto__"&&aa?aa(u,d,{configurable:!0,enumerable:!0,value:m,writable:!0}):u[d]=m}function Zu(u,d){for(var m=-1,_=d.length,x=be(_),L=u==null;++m<_;)x[m]=L?s:Fl(u,d[m]);return x}function Co(u,d,m){return u===u&&(m!==s&&(u=u<=m?u:m),d!==s&&(u=u>=d?u:d)),u}function gr(u,d,m,_,x,L){var V,Q=d&w,le=d&T,Me=d&C;if(m&&(V=x?m(u,_,x,L):m(u)),V!==s)return V;if(!An(u))return u;var Ne=jt(u);if(Ne){if(V=Ji(u),!Q)return Vn(u,V)}else{var Pe=Le(u),qe=Pe==nt||Pe==Wt;if(ei(u))return Wp(u,Q);if(Pe==st||Pe==He||qe&&!x){if(V=le||qe?{}:Lr(u),!Q)return le?Gm(u,Bm(V,u)):Ic(u,yc(V,u))}else{if(!Sn[Pe])return x?u:{};V=ng(u,Pe,Q)}}L||(L=new pr);var dt=L.get(u);if(dt)return dt;L.set(u,V),Rg(u)?u.forEach(function(vt){V.add(gr(vt,d,m,vt,u,L))}):Rb(u)&&u.forEach(function(vt,Xt){V.set(Xt,gr(vt,d,m,Xt,u,L))});var $t=Me?le?_d:Ac:le?hs:ls,Ut=Ne?s:$t(u);return Ns(Ut||u,function(vt,Xt){Ut&&(Xt=vt,vt=u[Xt]),bl(V,Xt,gr(vt,d,m,Xt,u,L))}),V}function $p(u){var d=ls(u);return function(m){return vp(m,u,d)}}function vp(u,d,m){var _=m.length;if(u==null)return!_;for(u=kt(u);_--;){var x=m[_],L=d[x],V=u[x];if(V===s&&!(x in u)||!L(V))return!1}return!0}function vl(u,d,m){if(typeof u!="function")throw new us(h);return Il(function(){u.apply(s,m)},d)}function Wi(u,d,m,_){var x=-1,L=Xa,V=!0,Q=u.length,le=[],Me=d.length;if(!Q)return le;m&&(d=wn(d,Xs(m))),_?(L=cc,V=!1):d.length>=a&&(L=ra,V=!1,d=new Mr(d));e:for(;++x<Q;){var Ne=u[x],Pe=m==null?Ne:m(Ne);if(Ne=_||Ne!==0?Ne:0,V&&Pe===Pe){for(var qe=Me;qe--;)if(d[qe]===Pe)continue e;le.push(Ne)}else L(d,Pe,_)||le.push(Ne)}return le}var Hi=Sl(Yr),Qu=Sl(So,!0);function yp(u,d){var m=!0;return Hi(u,function(_,x,L){return m=!!d(_,x,L),m}),m}function yl(u,d,m){for(var _=-1,x=u.length;++_<x;){var L=u[_],V=d(L);if(V!=null&&(Q===s?V===V&&!ir(V):m(V,Q)))var Q=V,le=L}return le}function _p(u,d,m,_){var x=u.length;for(m=Ct(m),m<0&&(m=-m>x?0:x+m),_=_===s||_>x?x:Ct(_),_<0&&(_+=x),_=m>_?0:Pl(_);m<_;)u[m++]=d;return u}function _c(u,d){var m=[];return Hi(u,function(_,x,L){d(_,x,L)&&m.push(_)}),m}function os(u,d,m,_,x){var L=-1,V=u.length;for(m||(m=ds),x||(x=[]);++L<V;){var Q=u[L];d>0&&m(Q)?d>1?os(Q,d-1,m,_,x):Kr(x,Q):_||(x[x.length]=Q)}return x}var ed=Vp(),wp=Vp(!0);function Yr(u,d){return u&&ed(u,d,ls)}function So(u,d){return u&&wp(u,d,ls)}function _l(u,d){return ai(d,function(m){return vs(u[m])})}function To(u,d){d=ks(d,u);for(var m=0,_=d.length;u!=null&&m<_;)u=u[bs(d[m++])];return m&&m==_?u:s}function wc(u,d,m){var _=d(u);return jt(u)?_:Kr(_,m(u))}function Dn(u){return u==null?u===s?ct:ft:Fi&&Fi in kt(u)?tg(u):Bc(u)}function td(u,d){return u>d}function ko(u,d){return u!=null&&nn.call(u,d)}function Cp(u,d){return u!=null&&d in kt(u)}function Pm(u,d,m){return u>=fs(d,m)&&u<Xn(d,m)}function da(u,d,m){for(var _=m?cc:Xa,x=u[0].length,L=u.length,V=L,Q=be(L),le=1/0,Me=[];V--;){var Ne=u[V];V&&d&&(Ne=wn(Ne,Xs(d))),le=fs(Ne.length,le),Q[V]=!m&&(d||x>=120&&Ne.length>=120)?new Mr(V&&Ne):s}Ne=u[0];var Pe=-1,qe=Q[0];e:for(;++Pe<x&&Me.length<le;){var dt=Ne[Pe],$t=d?d(dt):dt;if(dt=m||dt!==0?dt:0,!(qe?ra(qe,$t):_(Me,$t,m))){for(V=L;--V;){var Ut=Q[V];if(!(Ut?ra(Ut,$t):_(u[V],$t,m)))continue e}qe&&qe.push($t),Me.push(dt)}}return Me}function Sp(u,d,m,_){return Yr(u,function(x,L,V){d(_,m(x),L,V)}),_}function ha(u,d,m){d=ks(d,u),u=rg(u,d);var _=u==null?u:u[bs(sr(d))];return _==null?s:Ys(_,u,m)}function nd(u){return Tn(u)&&Dn(u)==He}function Tp(u){return Tn(u)&&Dn(u)==ue}function kp(u){return Tn(u)&&Dn(u)==Je}function pa(u,d,m,_,x){return u===d?!0:u==null||d==null||!Tn(u)&&!Tn(d)?u!==u&&d!==d:Ep(u,d,m,_,pa,x)}function Ep(u,d,m,_,x,L){var V=jt(u),Q=jt(d),le=V?ne:Le(u),Me=Q?ne:Le(d);le=le==He?st:le,Me=Me==He?st:Me;var Ne=le==st,Pe=Me==st,qe=le==Me;if(qe&&ei(u)){if(!ei(d))return!1;V=!0,Ne=!1}if(qe&&!Ne)return L||(L=new pr),V||Oo(u)?Zp(u,d,m,_,x,L):Qp(u,d,le,m,_,x,L);if(!(m&E)){var dt=Ne&&nn.call(u,"__wrapped__"),$t=Pe&&nn.call(d,"__wrapped__");if(dt||$t){var Ut=dt?u.value():u,vt=$t?d.value():d;return L||(L=new pr),x(Ut,vt,m,_,L)}}return qe?(L||(L=new pr),yd(u,d,m,_,x,L)):!1}function Ip(u){return Tn(u)&&Le(u)==St}function Cc(u,d,m,_){var x=m.length,L=x,V=!_;if(u==null)return!L;for(u=kt(u);x--;){var Q=m[x];if(V&&Q[2]?Q[1]!==u[Q[0]]:!(Q[0]in u))return!1}for(;++x<L;){Q=m[x];var le=Q[0],Me=u[le],Ne=Q[1];if(V&&Q[2]){if(Me===s&&!(le in u))return!1}else{var Pe=new pr;if(_)var qe=_(Me,Ne,le,u,d,Pe);if(!(qe===s?pa(Ne,Me,E|k,_,Pe):qe))return!1}}return!0}function sd(u){if(!An(u)||Zm(u))return!1;var d=vs(u)?ym:Ee;return d.test(fr(u))}function jm(u){return Tn(u)&&Dn(u)==Ue}function Fm(u){return Tn(u)&&Le(u)==Nt}function zm(u){return Tn(u)&&Na(u.length)&&!!Qt[Dn(u)]}function xp(u){return typeof u=="function"?u:u==null?Ds:typeof u=="object"?jt(u)?id(u[0],u[1]):Ap(u):nh(u)}function rd(u){if(!Lc(u))return ci(u);var d=[];for(var m in kt(u))nn.call(u,m)&&m!="constructor"&&d.push(m);return d}function Um(u){if(!An(u))return Td(u);var d=Lc(u),m=[];for(var _ in u)_=="constructor"&&(d||!nn.call(u,_))||m.push(_);return m}function wl(u,d){return u<d}function Dp(u,d){var m=-1,_=ts(u)?be(u.length):[];return Hi(u,function(x,L,V){_[++m]=d(x,L,V)}),_}function Ap(u){var d=Zr(u);return d.length==1&&d[0][2]?Fn(d[0][0],d[0][1]):function(m){return m===u||Cc(m,u,d)}}function id(u,d){return Jt(u)&&Io(d)?Fn(bs(u),d):function(m){var _=Fl(m,u);return _===s&&_===d?No(m,u):pa(d,_,E|k)}}function Cl(u,d,m,_,x){u!==d&&ed(d,function(L,V){if(x||(x=new pr),An(L))Op(u,d,V,m,Cl,_,x);else{var Q=_?_(xo(u,V),L,V+"",u,d,x):s;Q===s&&(Q=L),vc(u,V,Q)}},hs)}function Op(u,d,m,_,x,L,V){var Q=xo(u,m),le=xo(d,m),Me=V.get(le);if(Me){vc(u,m,Me);return}var Ne=L?L(Q,le,m+"",u,d,V):s,Pe=Ne===s;if(Pe){var qe=jt(le),dt=!qe&&ei(le),$t=!qe&&!dt&&Oo(le);Ne=le,qe||dt||$t?jt(Q)?Ne=Q:Yn(Q)?Ne=Vn(Q):dt?(Pe=!1,Ne=Wp(le,!0)):$t?(Pe=!1,Ne=bd(le,!0)):Ne=[]:Bl(le)||eo(le)?(Ne=Q,eo(Q)?Ne=vi(Q):(!An(Q)||vs(Q))&&(Ne=Lr(le))):Pe=!1}Pe&&(V.set(le,Ne),x(Ne,le,_,L,V),V.delete(le)),vc(u,m,Ne)}function od(u,d){var m=u.length;if(m)return d+=d<0?m:0,oe(d,m)?u[d]:s}function ad(u,d,m){d.length?d=wn(d,function(L){return jt(L)?function(V){return To(V,L.length===1?L[0]:L)}:L}):d=[Ds];var _=-1;d=wn(d,Xs(gt()));var x=Dp(u,function(L,V,Q){var le=wn(d,function(Me){return Me(L)});return{criteria:le,index:++_,value:L}});return qh(x,function(L,V){return Ec(L,V,m)})}function Rp(u,d){return ld(u,d,function(m,_){return No(u,_)})}function ld(u,d,m){for(var _=-1,x=d.length,L={};++_<x;){var V=d[_],Q=To(u,V);m(Q,V)&&fa(L,ks(V,u),Q)}return L}function cd(u){return function(d){return To(d,u)}}function ga(u,d,m,_){var x=_?dm:bo,L=-1,V=d.length,Q=u;for(u===d&&(d=Vn(d)),m&&(Q=wn(u,Xs(m)));++L<V;)for(var le=0,Me=d[L],Ne=m?m(Me):Me;(le=x(Q,Ne,le,_))>-1;)Q!==u&&mc.call(Q,le,1),mc.call(u,le,1);return u}function ud(u,d){for(var m=u?d.length:0,_=m-1;m--;){var x=d[m];if(m==_||x!==L){var L=x;oe(x)?mc.call(u,x,1):fd(u,x)}}return u}function dd(u,d){return u+vo(yo()*(d-u+1))}function Mp(u,d,m,_){for(var x=-1,L=Xn(pl((d-u)/(m||1)),0),V=be(L);L--;)V[_?L:++x]=u,u+=m;return V}function Sc(u,d){var m="";if(!u||d<1||d>Ce)return m;do d%2&&(m+=u),d=vo(d/2),d&&(u+=u);while(d);return m}function Ht(u,d){return Rt(El(u,d,Ds),u+"")}function Np(u){return Yu(Pa(u))}function Lp(u,d){var m=Pa(u);return Br(m,Co(d,0,m.length))}function fa(u,d,m,_){if(!An(u))return u;d=ks(d,u);for(var x=-1,L=d.length,V=L-1,Q=u;Q!=null&&++x<L;){var le=bs(d[x]),Me=m;if(le==="__proto__"||le==="constructor"||le==="prototype")return u;if(x!=V){var Ne=Q[le];Me=_?_(Ne,le,Q):s,Me===s&&(Me=An(Ne)?Ne:oe(d[x+1])?[]:{})}bl(Q,le,Me),Q=Q[le]}return u}var hd=$c?function(u,d){return $c.set(u,d),u}:Ds,Bp=aa?function(u,d){return aa(u,"toString",{configurable:!0,enumerable:!1,value:eh(d),writable:!0})}:Ds;function Pp(u){return Br(Pa(u))}function Qs(u,d,m){var _=-1,x=u.length;d<0&&(d=-d>x?0:x+d),m=m>x?x:m,m<0&&(m+=x),x=d>m?0:m-d>>>0,d>>>=0;for(var L=be(x);++_<x;)L[_]=u[_+d];return L}function Wm(u,d){var m;return Hi(u,function(_,x,L){return m=d(_,x,L),!m}),!!m}function Tc(u,d,m){var _=0,x=u==null?_:u.length;if(typeof d=="number"&&d===d&&x<=Se){for(;_<x;){var L=_+x>>>1,V=u[L];V!==null&&!ir(V)&&(m?V<=d:V<d)?_=L+1:x=L}return x}return pd(u,d,Ds,m)}function pd(u,d,m,_){var x=0,L=u==null?0:u.length;if(L===0)return 0;d=m(d);for(var V=d!==d,Q=d===null,le=ir(d),Me=d===s;x<L;){var Ne=vo((x+L)/2),Pe=m(u[Ne]),qe=Pe!==s,dt=Pe===null,$t=Pe===Pe,Ut=ir(Pe);if(V)var vt=_||$t;else Me?vt=$t&&(_||qe):Q?vt=$t&&qe&&(_||!dt):le?vt=$t&&qe&&!dt&&(_||!Ut):dt||Ut?vt=!1:vt=_?Pe<=d:Pe<d;vt?x=Ne+1:L=Ne}return fs(L,de)}function gd(u,d){for(var m=-1,_=u.length,x=0,L=[];++m<_;){var V=u[m],Q=d?d(V):V;if(!m||!Qr(Q,le)){var le=Q;L[x++]=V===0?0:V}}return L}function jp(u){return typeof u=="number"?u:ir(u)?he:+u}function er(u){if(typeof u=="string")return u;if(jt(u))return wn(u,er)+"";if(ir(u))return Vu?Vu.call(u):"";var d=u+"";return d=="0"&&1/u==-ze?"-0":d}function Vi(u,d,m){var _=-1,x=Xa,L=u.length,V=!0,Q=[],le=Q;if(m)V=!1,x=cc;else if(L>=a){var Me=d?null:qp(u);if(Me)return il(Me);V=!1,x=ra,le=new Mr}else le=d?[]:Q;e:for(;++_<L;){var Ne=u[_],Pe=d?d(Ne):Ne;if(Ne=m||Ne!==0?Ne:0,V&&Pe===Pe){for(var qe=le.length;qe--;)if(le[qe]===Pe)continue e;d&&le.push(Pe),Q.push(Ne)}else x(le,Pe,m)||(le!==Q&&le.push(Pe),Q.push(Ne))}return Q}function fd(u,d){return d=ks(d,u),u=rg(u,d),u==null||delete u[bs(sr(d))]}function Fp(u,d,m,_){return fa(u,d,m(To(u,d)),_)}function Re(u,d,m,_){for(var x=u.length,L=_?x:-1;(_?L--:++L<x)&&d(u[L],L,u););return m?Qs(u,_?0:L,_?L+1:x):Qs(u,_?L+1:0,_?x:L)}function Gi(u,d){var m=u;return m instanceof Ot&&(m=m.value()),uc(d,function(_,x){return x.func.apply(x.thisArg,Kr([_],x.args))},m)}function zp(u,d,m){var _=u.length;if(_<2)return _?Vi(u[0]):[];for(var x=-1,L=be(_);++x<_;)for(var V=u[x],Q=-1;++Q<_;)Q!=x&&(L[x]=Wi(L[x]||V,u[Q],d,m));return Vi(os(L,1),d,m)}function kc(u,d,m){for(var _=-1,x=u.length,L=d.length,V={};++_<x;){var Q=_<L?d[_]:s;m(V,u[_],Q)}return V}function Nr(u){return Yn(u)?u:[]}function Be(u){return typeof u=="function"?u:Ds}function ks(u,d){return jt(u)?u:Jt(u,d)?[u]:wa(cn(u))}var tr=Ht;function fe(u,d,m){var _=u.length;return m=m===s?_:m,!d&&m>=_?u:Qs(u,d,m)}var Up=ju||function(u){return Wn.clearTimeout(u)};function Wp(u,d){if(d)return u.slice();var m=u.length,_=dl?dl(m):new u.constructor(m);return u.copy(_),_}function md(u){var d=new u.constructor(u.byteLength);return new ul(d).set(new ul(u)),d}function Hm(u,d){var m=d?md(u.buffer):u.buffer;return new u.constructor(m,u.byteOffset,u.byteLength)}function Vm(u){var d=new u.constructor(u.source,j.exec(u));return d.lastIndex=u.lastIndex,d}function ty(u){return _o?kt(_o.call(u)):{}}function bd(u,d){var m=d?md(u.buffer):u.buffer;return new u.constructor(m,u.byteOffset,u.length)}function Hp(u,d){if(u!==d){var m=u!==s,_=u===null,x=u===u,L=ir(u),V=d!==s,Q=d===null,le=d===d,Me=ir(d);if(!Q&&!Me&&!L&&u>d||L&&V&&le&&!Q&&!Me||_&&V&&le||!m&&le||!x)return 1;if(!_&&!L&&!Me&&u<d||Me&&m&&x&&!_&&!L||Q&&m&&x||!V&&x||!le)return-1}return 0}function Ec(u,d,m){for(var _=-1,x=u.criteria,L=d.criteria,V=x.length,Q=m.length;++_<V;){var le=Hp(x[_],L[_]);if(le){if(_>=Q)return le;var Me=m[_];return le*(Me=="desc"?-1:1)}}return u.index-d.index}function $d(u,d,m,_){for(var x=-1,L=u.length,V=m.length,Q=-1,le=d.length,Me=Xn(L-V,0),Ne=be(le+Me),Pe=!_;++Q<le;)Ne[Q]=d[Q];for(;++x<V;)(Pe||x<L)&&(Ne[m[x]]=u[x]);for(;Me--;)Ne[Q++]=u[x++];return Ne}function vd(u,d,m,_){for(var x=-1,L=u.length,V=-1,Q=m.length,le=-1,Me=d.length,Ne=Xn(L-Q,0),Pe=be(Ne+Me),qe=!_;++x<Ne;)Pe[x]=u[x];for(var dt=x;++le<Me;)Pe[dt+le]=d[le];for(;++V<Q;)(qe||x<L)&&(Pe[dt+m[V]]=u[x++]);return Pe}function Vn(u,d){var m=-1,_=u.length;for(d||(d=be(_));++m<_;)d[m]=u[m];return d}function Xr(u,d,m,_){var x=!m;m||(m={});for(var L=-1,V=d.length;++L<V;){var Q=d[L],le=_?_(m[Q],u[Q],Q,m,u):s;le===s&&(le=u[Q]),x?pi(m,Q,le):bl(m,Q,le)}return m}function Ic(u,d){return Xr(u,Mc(u),d)}function Gm(u,d){return Xr(u,wd(u),d)}function gi(u,d){return function(m,_){var x=jt(m)?Ya:Lm,L=d?d():{};return x(m,u,gt(_,2),L)}}function ma(u){return Ht(function(d,m){var _=-1,x=m.length,L=x>1?m[x-1]:s,V=x>2?m[2]:s;for(L=u.length>3&&typeof L=="function"?(x--,L):s,V&&Bt(m[0],m[1],V)&&(L=x<3?s:L,x=1),d=kt(d);++_<x;){var Q=m[_];Q&&u(d,Q,_,L)}return d})}function Sl(u,d){return function(m,_){if(m==null)return m;if(!ts(m))return u(m,_);for(var x=m.length,L=d?x:-1,V=kt(m);(d?L--:++L<x)&&_(V[L],L,V)!==!1;);return m}}function Vp(u){return function(d,m,_){for(var x=-1,L=kt(d),V=_(d),Q=V.length;Q--;){var le=V[u?Q:++x];if(m(L[le],le,L)===!1)break}return d}}function ms(u,d,m){var _=d&A,x=$a(u);function L(){var V=this&&this!==Wn&&this instanceof L?x:u;return V.apply(_?m:this,arguments)}return L}function ba(u){return function(d){d=cn(d);var m=$o(d)?Ar(d):s,_=m?m[0]:d.charAt(0),x=m?fe(m,1).join(""):d.slice(1);return _[u]()+x}}function Es(u){return function(d){return uc(Zd(Jd(d).replace(Qf,"")),u,"")}}function $a(u){return function(){var d=arguments;switch(d.length){case 0:return new u;case 1:return new u(d[0]);case 2:return new u(d[0],d[1]);case 3:return new u(d[0],d[1],d[2]);case 4:return new u(d[0],d[1],d[2],d[3]);case 5:return new u(d[0],d[1],d[2],d[3],d[4]);case 6:return new u(d[0],d[1],d[2],d[3],d[4],d[5]);case 7:return new u(d[0],d[1],d[2],d[3],d[4],d[5],d[6])}var m=qr(u.prototype),_=u.apply(m,d);return An(_)?_:m}}function Gp(u,d,m){var _=$a(u);function x(){for(var L=arguments.length,V=be(L),Q=L,le=_a(x);Q--;)V[Q]=arguments[Q];var Me=L<3&&V[0]!==le&&V[L-1]!==le?[]:li(V,le);if(L-=Me.length,L<m)return Dc(u,d,va,x.placeholder,s,V,Me,s,s,m-L);var Ne=this&&this!==Wn&&this instanceof x?_:u;return Ys(Ne,this,V)}return x}function Km(u){return function(d,m,_){var x=kt(d);if(!ts(d)){var L=gt(m,3);d=ls(d),m=function(Q){return L(x[Q],Q,x)}}var V=u(d,m,_);return V>-1?x[L?d[V]:V]:s}}function Kp(u){return mi(function(d){var m=d.length,_=m,x=Zn.prototype.thru;for(u&&d.reverse();_--;){var L=d[_];if(typeof L!="function")throw new us(h);if(x&&!V&&Oc(L)=="wrapper")var V=new Zn([],!0)}for(_=V?_:m;++_<m;){L=d[_];var Q=Oc(L),le=Q=="wrapper"?eg(L):s;le&&$i(le[0])&&le[1]==(se|B|H|ee)&&!le[4].length&&le[9]==1?V=V[Oc(le[0])].apply(V,le[3]):V=L.length==1&&$i(L)?V[Q]():V.thru(L)}return function(){var Me=arguments,Ne=Me[0];if(V&&Me.length==1&&jt(Ne))return V.plant(Ne).value();for(var Pe=0,qe=m?d[Pe].apply(this,Me):Ne;++Pe<m;)qe=d[Pe].call(this,qe);return qe}})}function va(u,d,m,_,x,L,V,Q,le,Me){var Ne=d&se,Pe=d&A,qe=d&P,dt=d&(B|S),$t=d&K,Ut=qe?s:$a(u);function vt(){for(var Xt=arguments.length,en=be(Xt),zs=Xt;zs--;)en[zs]=arguments[zs];if(dt)var As=_a(vt),ar=hm(en,As);if(_&&(en=$d(en,_,x,dt)),L&&(en=vd(en,L,V,dt)),Xt-=ar,dt&&Xt<Me){var Kn=li(en,As);return Dc(u,d,va,vt.placeholder,m,en,Kn,Q,le,Me-Xt)}var Hr=Pe?m:this,Ci=qe?Hr[u]:u;return Xt=en.length,Q?en=ny(en,Q):$t&&Xt>1&&en.reverse(),Ne&&le<Xt&&(en.length=le),this&&this!==Wn&&this instanceof vt&&(Ci=Ut||$a(Ci)),Ci.apply(Hr,en)}return vt}function Eo(u,d){return function(m,_){return Sp(m,u,d(_),{})}}function ya(u,d){return function(m,_){var x;if(m===s&&_===s)return d;if(m!==s&&(x=m),_!==s){if(x===s)return _;typeof m=="string"||typeof _=="string"?(m=er(m),_=er(_)):(m=jp(m),_=jp(_)),x=u(m,_)}return x}}function Ki(u){return mi(function(d){return d=wn(d,Xs(gt())),Ht(function(m){var _=this;return u(d,function(x){return Ys(x,_,m)})})})}function Tl(u,d){d=d===s?" ":er(d);var m=d.length;if(m<2)return m?Sc(d,u):d;var _=Sc(d,pl(u/ia(d)));return $o(d)?fe(Ar(_),0,u).join(""):_.slice(0,u)}function Jm(u,d,m,_){var x=d&A,L=$a(u);function V(){for(var Q=-1,le=arguments.length,Me=-1,Ne=_.length,Pe=be(Ne+le),qe=this&&this!==Wn&&this instanceof V?L:u;++Me<Ne;)Pe[Me]=_[Me];for(;le--;)Pe[Me++]=arguments[++Q];return Ys(qe,x?m:this,Pe)}return V}function Jp(u){return function(d,m,_){return _&&typeof _!="number"&&Bt(d,m,_)&&(m=_=s),d=J(d),m===s?(m=d,d=0):m=J(m),_=_===s?d<m?1:-1:J(_),Mp(d,m,_,u)}}function xc(u){return function(d,m){return typeof d=="string"&&typeof m=="string"||(d=or(d),m=or(m)),u(d,m)}}function Dc(u,d,m,_,x,L,V,Q,le,Me){var Ne=d&B,Pe=Ne?V:s,qe=Ne?s:V,dt=Ne?L:s,$t=Ne?s:L;d|=Ne?H:q,d&=~(Ne?q:H),d&N||(d&=-4);var Ut=[u,d,x,dt,Pe,$t,qe,Q,le,Me],vt=m.apply(s,Ut);return $i(u)&&kd(vt,Ut),vt.placeholder=_,ig(vt,u,d)}function kl(u){var d=qn[u];return function(m,_){if(m=or(m),_=_==null?0:fs(Ct(_),292),_&&zi(m)){var x=(cn(m)+"e").split("e"),L=d(x[0]+"e"+(+x[1]+_));return x=(cn(L)+"e").split("e"),+(x[0]+"e"+(+x[1]-_))}return d(m)}}var qp=la&&1/il(new la([,-0]))[1]==ze?function(u){return new la(u)}:Wr;function Yp(u){return function(d){var m=Le(d);return m==St?Lu(d):m==Nt?Li(d):Yh(d,u(d))}}function fi(u,d,m,_,x,L,V,Q){var le=d&P;if(!le&&typeof u!="function")throw new us(h);var Me=_?_.length:0;if(Me||(d&=-97,_=x=s),V=V===s?V:Xn(Ct(V),0),Q=Q===s?Q:Ct(Q),Me-=x?x.length:0,d&q){var Ne=_,Pe=x;_=x=s}var qe=le?s:eg(u),dt=[u,d,m,_,x,Ne,Pe,L,V,Q];if(qe&&sg(dt,qe),u=dt[0],d=dt[1],m=dt[2],_=dt[3],x=dt[4],Q=dt[9]=dt[9]===s?le?0:u.length:Xn(dt[9]-Me,0),!Q&&d&(B|S)&&(d&=-25),!d||d==A)var $t=ms(u,d,m);else d==B||d==S?$t=Gp(u,d,Q):(d==H||d==(A|H))&&!x.length?$t=Jm(u,d,m,_):$t=va.apply(s,dt);var Ut=qe?hd:kd;return ig(Ut($t,dt),u,d)}function Xp(u,d,m,_){return u===s||Qr(u,Bi[m])&&!nn.call(_,m)?d:u}function qm(u,d,m,_,x,L){return An(u)&&An(d)&&(L.set(d,u),Cl(u,d,s,qm,L),L.delete(d)),u}function Ym(u){return Bl(u)?s:u}function Zp(u,d,m,_,x,L){var V=m&E,Q=u.length,le=d.length;if(Q!=le&&!(V&&le>Q))return!1;var Me=L.get(u),Ne=L.get(d);if(Me&&Ne)return Me==d&&Ne==u;var Pe=-1,qe=!0,dt=m&k?new Mr:s;for(L.set(u,d),L.set(d,u);++Pe<Q;){var $t=u[Pe],Ut=d[Pe];if(_)var vt=V?_(Ut,$t,Pe,d,u,L):_($t,Ut,Pe,u,d,L);if(vt!==s){if(vt)continue;qe=!1;break}if(dt){if(!dc(d,function(Xt,en){if(!ra(dt,en)&&($t===Xt||x($t,Xt,m,_,L)))return dt.push(en)})){qe=!1;break}}else if(!($t===Ut||x($t,Ut,m,_,L))){qe=!1;break}}return L.delete(u),L.delete(d),qe}function Qp(u,d,m,_,x,L,V){switch(m){case we:if(u.byteLength!=d.byteLength||u.byteOffset!=d.byteOffset)return!1;u=u.buffer,d=d.buffer;case ue:return!(u.byteLength!=d.byteLength||!L(new ul(u),new ul(d)));case Te:case Je:case lt:return Qr(+u,+d);case ht:return u.name==d.name&&u.message==d.message;case Ue:case wt:return u==d+"";case St:var Q=Lu;case Nt:var le=_&E;if(Q||(Q=il),u.size!=d.size&&!le)return!1;var Me=V.get(u);if(Me)return Me==d;_|=k,V.set(u,d);var Ne=Zp(Q(u),Q(d),_,x,L,V);return V.delete(u),Ne;case qt:if(_o)return _o.call(u)==_o.call(d)}return!1}function yd(u,d,m,_,x,L){var V=m&E,Q=Ac(u),le=Q.length,Me=Ac(d),Ne=Me.length;if(le!=Ne&&!V)return!1;for(var Pe=le;Pe--;){var qe=Q[Pe];if(!(V?qe in d:nn.call(d,qe)))return!1}var dt=L.get(u),$t=L.get(d);if(dt&&$t)return dt==d&&$t==u;var Ut=!0;L.set(u,d),L.set(d,u);for(var vt=V;++Pe<le;){qe=Q[Pe];var Xt=u[qe],en=d[qe];if(_)var zs=V?_(en,Xt,qe,d,u,L):_(Xt,en,qe,u,d,L);if(!(zs===s?Xt===en||x(Xt,en,m,_,L):zs)){Ut=!1;break}vt||(vt=qe=="constructor")}if(Ut&&!vt){var As=u.constructor,ar=d.constructor;As!=ar&&"constructor"in u&&"constructor"in d&&!(typeof As=="function"&&As instanceof As&&typeof ar=="function"&&ar instanceof ar)&&(Ut=!1)}return L.delete(u),L.delete(d),Ut}function mi(u){return Rt(El(u,s,Pr),u+"")}function Ac(u){return wc(u,ls,Mc)}function _d(u){return wc(u,hs,wd)}var eg=$c?function(u){return $c.get(u)}:Wr;function Oc(u){for(var d=u.name+"",m=ua[d],_=nn.call(ua,d)?m.length:0;_--;){var x=m[_],L=x.func;if(L==null||L==u)return x.name}return d}function _a(u){var d=nn.call(M,"placeholder")?M:u;return d.placeholder}function gt(){var u=M.iteratee||cu;return u=u===cu?xp:u,arguments.length?u(arguments[0],arguments[1]):u}function Rc(u,d){var m=u.__data__;return Xm(d)?m[typeof d=="string"?"string":"hash"]:m.map}function Zr(u){for(var d=ls(u),m=d.length;m--;){var _=d[m],x=u[_];d[m]=[_,x,Io(x)]}return d}function pn(u,d){var m=Qh(u,d);return sd(m)?m:s}function tg(u){var d=nn.call(u,Fi),m=u[Fi];try{u[Fi]=s;var _=!0}catch{}var x=ll.call(u);return _&&(d?u[Fi]=m:delete u[Fi]),x}var Mc=Fu?function(u){return u==null?[]:(u=kt(u),ai(Fu(u),function(d){return lp.call(u,d)}))}:sh,wd=Fu?function(u){for(var d=[];u;)Kr(d,Mc(u)),u=fc(u);return d}:sh,Le=Dn;(zu&&Le(new zu(new ArrayBuffer(1)))!=we||gl&&Le(new gl)!=St||Uu&&Le(Uu.resolve())!=At||la&&Le(new la)!=Nt||fl&&Le(new fl)!=me)&&(Le=function(u){var d=Dn(u),m=d==st?u.constructor:s,_=m?fr(m):"";if(_)switch(_){case Wu:return we;case Sm:return St;case Tm:return At;case hp:return Nt;case Hu:return me}return d});function Nc(u,d,m){for(var _=-1,x=m.length;++_<x;){var L=m[_],V=L.size;switch(L.type){case"drop":u+=V;break;case"dropRight":d-=V;break;case"take":d=fs(d,u+V);break;case"takeRight":u=Xn(u,d-V);break}}return{start:u,end:d}}function bi(u){var d=u.match(nc);return d?d[1].split(Tu):[]}function nr(u,d,m){d=ks(d,u);for(var _=-1,x=d.length,L=!1;++_<x;){var V=bs(d[_]);if(!(L=u!=null&&m(u,V)))break;u=u[V]}return L||++_!=x?L:(x=u==null?0:u.length,!!x&&Na(x)&&oe(V,x)&&(jt(u)||eo(u)))}function Ji(u){var d=u.length,m=new u.constructor(d);return d&&typeof u[0]=="string"&&nn.call(u,"index")&&(m.index=u.index,m.input=u.input),m}function Lr(u){return typeof u.constructor=="function"&&!Lc(u)?qr(fc(u)):{}}function ng(u,d,m){var _=u.constructor;switch(d){case ue:return md(u);case Te:case Je:return new _(+u);case we:return Hm(u,m);case Ve:case re:case Fe:case It:case pt:case En:case mt:case Cn:case $n:return bd(u,m);case St:return new _;case lt:case wt:return new _(u);case Ue:return Vm(u);case Nt:return new _;case qt:return ty(u)}}function Cd(u,d){var m=d.length;if(!m)return u;var _=m-1;return d[_]=(m>1?"& ":"")+d[_],d=d.join(m>2?", ":" "),u.replace(tc,`{
/* [wrapped with `+d+`] */
`)}function ds(u){return jt(u)||eo(u)||!!(hl&&u&&u[hl])}function oe(u,d){var m=typeof u;return d=d??Ce,!!d&&(m=="number"||m!="symbol"&&ae.test(u))&&u>-1&&u%1==0&&u<d}function Bt(u,d,m){if(!An(m))return!1;var _=typeof d;return(_=="number"?ts(m)&&oe(d,m.length):_=="string"&&d in m)?Qr(m[d],u):!1}function Jt(u,d){if(jt(u))return!1;var m=typeof u;return m=="number"||m=="symbol"||m=="boolean"||u==null||ir(u)?!0:Rs.test(u)||!Un.test(u)||d!=null&&u in kt(d)}function Xm(u){var d=typeof u;return d=="string"||d=="number"||d=="symbol"||d=="boolean"?u!=="__proto__":u===null}function $i(u){var d=Oc(u),m=M[d];if(typeof m!="function"||!(d in Ot.prototype))return!1;if(u===m)return!0;var _=eg(m);return!!_&&u===_[0]}function Zm(u){return!!Pu&&Pu in u}var Qm=Pi?vs:rh;function Lc(u){var d=u&&u.constructor,m=typeof d=="function"&&d.prototype||Bi;return u===m}function Io(u){return u===u&&!An(u)}function Fn(u,d){return function(m){return m==null?!1:m[u]===d&&(d!==s||u in kt(m))}}function Sd(u){var d=Ma(u,function(_){return m.size===$&&m.clear(),_}),m=d.cache;return d}function sg(u,d){var m=u[1],_=d[1],x=m|_,L=x<(A|P|se),V=_==se&&m==B||_==se&&m==ee&&u[7].length<=d[8]||_==(se|ee)&&d[7].length<=d[8]&&m==B;if(!(L||V))return u;_&A&&(u[2]=d[2],x|=m&A?0:N);var Q=d[3];if(Q){var le=u[3];u[3]=le?$d(le,Q,d[4]):Q,u[4]=le?li(u[3],y):d[4]}return Q=d[5],Q&&(le=u[5],u[5]=le?vd(le,Q,d[6]):Q,u[6]=le?li(u[5],y):d[6]),Q=d[7],Q&&(u[7]=Q),_&se&&(u[8]=u[8]==null?d[8]:fs(u[8],d[8])),u[9]==null&&(u[9]=d[9]),u[0]=d[0],u[1]=x,u}function Td(u){var d=[];if(u!=null)for(var m in kt(u))d.push(m);return d}function Bc(u){return ll.call(u)}function El(u,d,m){return d=Xn(d===s?u.length-1:d,0),function(){for(var _=arguments,x=-1,L=Xn(_.length-d,0),V=be(L);++x<L;)V[x]=_[d+x];x=-1;for(var Q=be(d+1);++x<d;)Q[x]=_[x];return Q[d]=m(V),Ys(u,this,Q)}}function rg(u,d){return d.length<2?u:To(u,Qs(d,0,-1))}function ny(u,d){for(var m=u.length,_=fs(d.length,m),x=Vn(u);_--;){var L=d[_];u[_]=oe(L,m)?x[L]:s}return u}function xo(u,d){if(!(d==="constructor"&&typeof u[d]=="function")&&d!="__proto__")return u[d]}var kd=qi(hd),Il=bc||function(u,d){return Wn.setTimeout(u,d)},Rt=qi(Bp);function ig(u,d,m){var _=d+"";return Rt(u,Cd(_,Ls(bi(_),m)))}function qi(u){var d=0,m=0;return function(){var _=up(),x=W-(_-m);if(m=_,x>0){if(++d>=ce)return arguments[0]}else d=0;return u.apply(s,arguments)}}function Br(u,d){var m=-1,_=u.length,x=_-1;for(d=d===s?_:d;++m<d;){var L=dd(m,x),V=u[L];u[L]=u[m],u[m]=V}return u.length=d,u}var wa=Sd(function(u){var d=[];return u.charCodeAt(0)===46&&d.push(""),u.replace(ii,function(m,_,x,L){d.push(x?L.replace(U,"$1"):_||m)}),d});function bs(u){if(typeof u=="string"||ir(u))return u;var d=u+"";return d=="0"&&1/u==-ze?"-0":d}function fr(u){if(u!=null){try{return al.call(u)}catch{}try{return u+""}catch{}}return""}function Ls(u,d){return Ns(xe,function(m){var _="_."+m[0];d&m[1]&&!Xa(u,_)&&u.push(_)}),u.sort()}function og(u){if(u instanceof Ot)return u.clone();var d=new Zn(u.__wrapped__,u.__chain__);return d.__actions__=Vn(u.__actions__),d.__index__=u.__index__,d.__values__=u.__values__,d}function eb(u,d,m){(m?Bt(u,d,m):d===s)?d=1:d=Xn(Ct(d),0);var _=u==null?0:u.length;if(!_||d<1)return[];for(var x=0,L=0,V=be(pl(_/d));x<_;)V[L++]=Qs(u,x,x+=d);return V}function tb(u){for(var d=-1,m=u==null?0:u.length,_=0,x=[];++d<m;){var L=u[d];L&&(x[_++]=L)}return x}function nb(){var u=arguments.length;if(!u)return[];for(var d=be(u-1),m=arguments[0],_=u;_--;)d[_-1]=arguments[_];return Kr(jt(m)?Vn(m):[m],os(d,1))}var sb=Ht(function(u,d){return Yn(u)?Wi(u,os(d,1,Yn,!0)):[]}),sy=Ht(function(u,d){var m=sr(d);return Yn(m)&&(m=s),Yn(u)?Wi(u,os(d,1,Yn,!0),gt(m,2)):[]}),ag=Ht(function(u,d){var m=sr(d);return Yn(m)&&(m=s),Yn(u)?Wi(u,os(d,1,Yn,!0),s,m):[]});function rb(u,d,m){var _=u==null?0:u.length;return _?(d=m||d===s?1:Ct(d),Qs(u,d<0?0:d,_)):[]}function Ed(u,d,m){var _=u==null?0:u.length;return _?(d=m||d===s?1:Ct(d),d=_-d,Qs(u,0,d<0?0:d)):[]}function lg(u,d){return u&&u.length?Re(u,gt(d,3),!0,!0):[]}function Id(u,d){return u&&u.length?Re(u,gt(d,3),!0):[]}function cg(u,d,m,_){var x=u==null?0:u.length;return x?(m&&typeof m!="number"&&Bt(u,d,m)&&(m=0,_=x),_p(u,d,m,_)):[]}function ib(u,d,m){var _=u==null?0:u.length;if(!_)return-1;var x=m==null?0:Ct(m);return x<0&&(x=Xn(_+x,0)),Za(u,gt(d,3),x)}function ob(u,d,m){var _=u==null?0:u.length;if(!_)return-1;var x=_-1;return m!==s&&(x=Ct(m),x=m<0?Xn(_+x,0):fs(x,_-1)),Za(u,gt(d,3),x,!0)}function Pr(u){var d=u==null?0:u.length;return d?os(u,1):[]}function as(u){var d=u==null?0:u.length;return d?os(u,ze):[]}function Pc(u,d){var m=u==null?0:u.length;return m?(d=d===s?1:Ct(d),os(u,d)):[]}function ug(u){for(var d=-1,m=u==null?0:u.length,_={};++d<m;){var x=u[d];_[x[0]]=x[1]}return _}function xd(u){return u&&u.length?u[0]:s}function jc(u,d,m){var _=u==null?0:u.length;if(!_)return-1;var x=m==null?0:Ct(m);return x<0&&(x=Xn(_+x,0)),bo(u,d,x)}function Dd(u){var d=u==null?0:u.length;return d?Qs(u,0,-1):[]}var Bs=Ht(function(u){var d=wn(u,Nr);return d.length&&d[0]===u[0]?da(d):[]}),ry=Ht(function(u){var d=sr(u),m=wn(u,Nr);return d===sr(m)?d=s:m.pop(),m.length&&m[0]===u[0]?da(m,gt(d,2)):[]}),Ad=Ht(function(u){var d=sr(u),m=wn(u,Nr);return d=typeof d=="function"?d:s,d&&m.pop(),m.length&&m[0]===u[0]?da(m,s,d):[]});function dg(u,d){return u==null?"":cp.call(u,d)}function sr(u){var d=u==null?0:u.length;return d?u[d-1]:s}function xl(u,d,m){var _=u==null?0:u.length;if(!_)return-1;var x=_;return m!==s&&(x=Ct(m),x=x<0?Xn(_+x,0):fs(x,_-1)),d===d?np(u,d,x):Za(u,Qa,x,!0)}function hg(u,d){return u&&u.length?od(u,Ct(d)):s}var ab=Ht(Fc);function Fc(u,d){return u&&u.length&&d&&d.length?ga(u,d):u}function lb(u,d,m){return u&&u.length&&d&&d.length?ga(u,d,gt(m,2)):u}function cb(u,d,m){return u&&u.length&&d&&d.length?ga(u,d,s,m):u}var ub=mi(function(u,d){var m=u==null?0:u.length,_=Zu(u,d);return ud(u,wn(d,function(x){return oe(x,m)?+x:x}).sort(Hp)),_});function db(u,d){var m=[];if(!(u&&u.length))return m;var _=-1,x=[],L=u.length;for(d=gt(d,3);++_<L;){var V=u[_];d(V,_,u)&&(m.push(V),x.push(_))}return ud(u,x),m}function Yi(u){return u==null?u:dp.call(u)}function pg(u,d,m){var _=u==null?0:u.length;return _?(m&&typeof m!="number"&&Bt(u,d,m)?(d=0,m=_):(d=d==null?0:Ct(d),m=m===s?_:Ct(m)),Qs(u,d,m)):[]}function hb(u,d){return Tc(u,d)}function zc(u,d,m){return pd(u,d,gt(m,2))}function gg(u,d){var m=u==null?0:u.length;if(m){var _=Tc(u,d);if(_<m&&Qr(u[_],d))return _}return-1}function Uc(u,d){return Tc(u,d,!0)}function fg(u,d,m){return pd(u,d,gt(m,2),!0)}function mg(u,d){var m=u==null?0:u.length;if(m){var _=Tc(u,d,!0)-1;if(Qr(u[_],d))return _}return-1}function pb(u){return u&&u.length?gd(u):[]}function $s(u,d){return u&&u.length?gd(u,gt(d,2)):[]}function Dl(u){var d=u==null?0:u.length;return d?Qs(u,1,d):[]}function gb(u,d,m){return u&&u.length?(d=m||d===s?1:Ct(d),Qs(u,0,d<0?0:d)):[]}function Wc(u,d,m){var _=u==null?0:u.length;return _?(d=m||d===s?1:Ct(d),d=_-d,Qs(u,d<0?0:d,_)):[]}function fb(u,d){return u&&u.length?Re(u,gt(d,3),!1,!0):[]}function mb(u,d){return u&&u.length?Re(u,gt(d,3)):[]}var bb=Ht(function(u){return Vi(os(u,1,Yn,!0))}),Ca=Ht(function(u){var d=sr(u);return Yn(d)&&(d=s),Vi(os(u,1,Yn,!0),gt(d,2))}),$b=Ht(function(u){var d=sr(u);return d=typeof d=="function"?d:s,Vi(os(u,1,Yn,!0),s,d)});function Hc(u){return u&&u.length?Vi(u):[]}function Qn(u,d){return u&&u.length?Vi(u,gt(d,2)):[]}function Sa(u,d){return d=typeof d=="function"?d:s,u&&u.length?Vi(u,s,d):[]}function Xi(u){if(!(u&&u.length))return[];var d=0;return u=ai(u,function(m){if(Yn(m))return d=Xn(m.length,d),!0}),sa(d,function(m){return wn(u,el(m))})}function Vc(u,d){if(!(u&&u.length))return[];var m=Xi(u);return d==null?m:wn(m,function(_){return Ys(d,s,_)})}var Od=Ht(function(u,d){return Yn(u)?Wi(u,d):[]}),vb=Ht(function(u){return zp(ai(u,Yn))}),yb=Ht(function(u){var d=sr(u);return Yn(d)&&(d=s),zp(ai(u,Yn),gt(d,2))}),bg=Ht(function(u){var d=sr(u);return d=typeof d=="function"?d:s,zp(ai(u,Yn),s,d)}),Rd=Ht(Xi);function $g(u,d){return kc(u||[],d||[],bl)}function Ta(u,d){return kc(u||[],d||[],fa)}var Al=Ht(function(u){var d=u.length,m=d>1?u[d-1]:s;return m=typeof m=="function"?(u.pop(),m):s,Vc(u,m)});function ka(u){var d=M(u);return d.__chain__=!0,d}function ln(u,d){return d(u),u}function Zi(u,d){return d(u)}var Ea=mi(function(u){var d=u.length,m=d?u[0]:0,_=this.__wrapped__,x=function(L){return Zu(L,u)};return d>1||this.__actions__.length||!(_ instanceof Ot)||!oe(m)?this.thru(x):(_=_.slice(m,+m+(d?1:0)),_.__actions__.push({func:Zi,args:[x],thisArg:s}),new Zn(_,this.__chain__).thru(function(L){return d&&!L.length&&L.push(s),L}))});function vg(){return ka(this)}function Do(){return new Zn(this.value(),this.__chain__)}function _b(){this.__values__===s&&(this.__values__=Lb(this.value()));var u=this.__index__>=this.__values__.length,d=u?s:this.__values__[this.__index__++];return{done:u,value:d}}function yg(){return this}function Is(u){for(var d,m=this;m instanceof ui;){var _=og(m);_.__index__=0,_.__values__=s,d?x.__wrapped__=_:d=_;var x=_;m=m.__wrapped__}return x.__wrapped__=u,d}function Gc(){var u=this.__wrapped__;if(u instanceof Ot){var d=u;return this.__actions__.length&&(d=new Ot(this)),d=d.reverse(),d.__actions__.push({func:Zi,args:[Yi],thisArg:s}),new Zn(d,this.__chain__)}return this.thru(Yi)}function Ol(){return Gi(this.__wrapped__,this.__actions__)}var Md=gi(function(u,d,m){nn.call(u,m)?++u[m]:pi(u,m,1)});function Kc(u,d,m){var _=jt(u)?na:yp;return m&&Bt(u,d,m)&&(d=s),_(u,gt(d,3))}function Rl(u,d){var m=jt(u)?ai:_c;return m(u,gt(d,3))}var wb=Km(ib),Cb=Km(ob);function Ia(u,d){return os(xa(u,d),1)}function _g(u,d){return os(xa(u,d),ze)}function wg(u,d,m){return m=m===s?1:Ct(m),os(xa(u,d),m)}function mr(u,d){var m=jt(u)?Ns:Hi;return m(u,gt(d,3))}function Ml(u,d){var m=jt(u)?cm:Qu;return m(u,gt(d,3))}var Cg=gi(function(u,d,m){nn.call(u,m)?u[m].push(d):pi(u,m,[d])});function Sg(u,d,m,_){u=ts(u)?u:Pa(u),m=m&&!_?Ct(m):0;var x=u.length;return m<0&&(m=Xn(x+m,0)),tu(u)?m<=x&&u.indexOf(d,m)>-1:!!x&&bo(u,d,m)>-1}var Sb=Ht(function(u,d,m){var _=-1,x=typeof d=="function",L=ts(u)?be(u.length):[];return Hi(u,function(V){L[++_]=x?Ys(d,V,m):ha(V,d,m)}),L}),Tb=gi(function(u,d,m){pi(u,m,d)});function xa(u,d){var m=jt(u)?wn:Dp;return m(u,gt(d,3))}function es(u,d,m,_){return u==null?[]:(jt(d)||(d=d==null?[]:[d]),m=_?s:m,jt(m)||(m=m==null?[]:[m]),ad(u,d,m))}var br=gi(function(u,d,m){u[m?0:1].push(d)},function(){return[[],[]]});function Tg(u,d,m){var _=jt(u)?uc:Jr,x=arguments.length<3;return _(u,gt(d,4),m,x,Hi)}function kg(u,d,m){var _=jt(u)?um:Jr,x=arguments.length<3;return _(u,gt(d,4),m,x,Qu)}function kb(u,d){var m=jt(u)?ai:_c;return m(u,Ld(gt(d,3)))}function jr(u){var d=jt(u)?Yu:Np;return d(u)}function Jc(u,d,m){(m?Bt(u,d,m):d===s)?d=1:d=Ct(d);var _=jt(u)?Xu:Lp;return _(u,d)}function vn(u){var d=jt(u)?bp:Pp;return d(u)}function Gn(u){if(u==null)return 0;if(ts(u))return tu(u)?ia(u):u.length;var d=Le(u);return d==St||d==Nt?u.size:rd(u).length}function Nl(u,d,m){var _=jt(u)?dc:Wm;return m&&Bt(u,d,m)&&(d=s),_(u,gt(d,3))}var Eg=Ht(function(u,d){if(u==null)return[];var m=d.length;return m>1&&Bt(u,d[0],d[1])?d=[]:m>2&&Bt(d[0],d[1],d[2])&&(d=[d[0]]),ad(u,os(d,1),[])}),Da=_m||function(){return Wn.Date.now()};function Nd(u,d){if(typeof d!="function")throw new us(h);return u=Ct(u),function(){if(--u<1)return d.apply(this,arguments)}}function Aa(u,d,m){return d=m?s:d,d=u&&d==null?u.length:d,fi(u,se,s,s,s,s,d)}function Oa(u,d){var m;if(typeof d!="function")throw new us(h);return u=Ct(u),function(){return--u>0&&(m=d.apply(this,arguments)),u<=1&&(d=s),m}}var $r=Ht(function(u,d,m){var _=A;if(m.length){var x=li(m,_a($r));_|=H}return fi(u,_,d,m,x)}),Fr=Ht(function(u,d,m){var _=A|P;if(m.length){var x=li(m,_a(Fr));_|=H}return fi(d,_,u,m,x)});function qc(u,d,m){d=m?s:d;var _=fi(u,B,s,s,s,s,s,d);return _.placeholder=qc.placeholder,_}function Ig(u,d,m){d=m?s:d;var _=fi(u,S,s,s,s,s,s,d);return _.placeholder=Ig.placeholder,_}function Yc(u,d,m){var _,x,L,V,Q,le,Me=0,Ne=!1,Pe=!1,qe=!0;if(typeof u!="function")throw new us(h);d=or(d)||0,An(m)&&(Ne=!!m.leading,Pe="maxWait"in m,L=Pe?Xn(or(m.maxWait)||0,d):L,qe="trailing"in m?!!m.trailing:qe);function dt(Kn){var Hr=_,Ci=x;return _=x=s,Me=Kn,V=u.apply(Ci,Hr),V}function $t(Kn){return Me=Kn,Q=Il(Xt,d),Ne?dt(Kn):V}function Ut(Kn){var Hr=Kn-le,Ci=Kn-Me,Zg=d-Hr;return Pe?fs(Zg,L-Ci):Zg}function vt(Kn){var Hr=Kn-le,Ci=Kn-Me;return le===s||Hr>=d||Hr<0||Pe&&Ci>=L}function Xt(){var Kn=Da();if(vt(Kn))return en(Kn);Q=Il(Xt,Ut(Kn))}function en(Kn){return Q=s,qe&&_?dt(Kn):(_=x=s,V)}function zs(){Q!==s&&Up(Q),Me=0,_=le=x=Q=s}function As(){return Q===s?V:en(Da())}function ar(){var Kn=Da(),Hr=vt(Kn);if(_=arguments,x=this,le=Kn,Hr){if(Q===s)return $t(le);if(Pe)return Up(Q),Q=Il(Xt,d),dt(le)}return Q===s&&(Q=Il(Xt,d)),V}return ar.cancel=zs,ar.flush=As,ar}var Ra=Ht(function(u,d){return vl(u,1,d)}),zt=Ht(function(u,d,m){return vl(u,or(d)||0,m)});function Ao(u){return fi(u,K)}function Ma(u,d){if(typeof u!="function"||d!=null&&typeof d!="function")throw new us(h);var m=function(){var _=arguments,x=d?d.apply(this,_):_[0],L=m.cache;if(L.has(x))return L.get(x);var V=u.apply(this,_);return m.cache=L.set(x,V)||L,V};return m.cache=new(Ma.Cache||di),m}Ma.Cache=di;function Ld(u){if(typeof u!="function")throw new us(h);return function(){var d=arguments;switch(d.length){case 0:return!u.call(this);case 1:return!u.call(this,d[0]);case 2:return!u.call(this,d[0],d[1]);case 3:return!u.call(this,d[0],d[1],d[2])}return!u.apply(this,d)}}function Eb(u){return Oa(2,u)}var Ib=tr(function(u,d){d=d.length==1&&jt(d[0])?wn(d[0],Xs(gt())):wn(os(d,1),Xs(gt()));var m=d.length;return Ht(function(_){for(var x=-1,L=fs(_.length,m);++x<L;)_[x]=d[x].call(this,_[x]);return Ys(u,this,_)})}),Bd=Ht(function(u,d){var m=li(d,_a(Bd));return fi(u,H,s,d,m)}),Xc=Ht(function(u,d){var m=li(d,_a(Xc));return fi(u,q,s,d,m)}),Pd=mi(function(u,d){return fi(u,ee,s,s,s,d)});function xs(u,d){if(typeof u!="function")throw new us(h);return d=d===s?d:Ct(d),Ht(u,d)}function xg(u,d){if(typeof u!="function")throw new us(h);return d=d==null?0:Xn(Ct(d),0),Ht(function(m){var _=m[d],x=fe(m,0,d);return _&&Kr(x,_),Ys(u,this,x)})}function iy(u,d,m){var _=!0,x=!0;if(typeof u!="function")throw new us(h);return An(m)&&(_="leading"in m?!!m.leading:_,x="trailing"in m?!!m.trailing:x),Yc(u,d,{leading:_,maxWait:d,trailing:x})}function Dg(u){return Aa(u,1)}function Ag(u,d){return Bd(Be(d),u)}function Ze(){if(!arguments.length)return[];var u=arguments[0];return jt(u)?u:[u]}function Ll(u){return gr(u,C)}function jd(u,d){return d=typeof d=="function"?d:s,gr(u,C,d)}function Zc(u){return gr(u,w|C)}function Qc(u,d){return d=typeof d=="function"?d:s,gr(u,w|C,d)}function xb(u,d){return d==null||vp(u,d,ls(d))}function Qr(u,d){return u===d||u!==u&&d!==d}var oy=xc(td),Qi=xc(function(u,d){return u>=d}),eo=nd(function(){return arguments}())?nd:function(u){return Tn(u)&&nn.call(u,"callee")&&!lp.call(u,"callee")},jt=be.isArray,Db=zh?Xs(zh):Tp;function ts(u){return u!=null&&Na(u.length)&&!vs(u)}function Yn(u){return Tn(u)&&ts(u)}function ay(u){return u===!0||u===!1||Tn(u)&&Dn(u)==Te}var ei=wm||rh,zr=Uh?Xs(Uh):kp;function Ab(u){return Tn(u)&&u.nodeType===1&&!Bl(u)}function Fd(u){if(u==null)return!0;if(ts(u)&&(jt(u)||typeof u=="string"||typeof u.splice=="function"||ei(u)||Oo(u)||eo(u)))return!u.length;var d=Le(u);if(d==St||d==Nt)return!u.size;if(Lc(u))return!rd(u).length;for(var m in u)if(nn.call(u,m))return!1;return!0}function rr(u,d){return pa(u,d)}function Ob(u,d,m){m=typeof m=="function"?m:s;var _=m?m(u,d):s;return _===s?pa(u,d,s,m):!!_}function Ps(u){if(!Tn(u))return!1;var d=Dn(u);return d==ht||d==rt||typeof u.message=="string"&&typeof u.name=="string"&&!Bl(u)}function fn(u){return typeof u=="number"&&zi(u)}function vs(u){if(!An(u))return!1;var d=Dn(u);return d==nt||d==Wt||d==Ke||d==mn}function eu(u){return typeof u=="number"&&u==Ct(u)}function Na(u){return typeof u=="number"&&u>-1&&u%1==0&&u<=Ce}function An(u){var d=typeof u;return u!=null&&(d=="object"||d=="function")}function Tn(u){return u!=null&&typeof u=="object"}var Rb=Wh?Xs(Wh):Ip;function ti(u,d){return u===d||Cc(u,d,Zr(d))}function Vt(u,d,m){return m=typeof m=="function"?m:s,Cc(u,d,Zr(d),m)}function to(u){return zd(u)&&u!=+u}function Ln(u){if(Qm(u))throw new xt(c);return sd(u)}function Mb(u){return u===null}function Og(u){return u==null}function zd(u){return typeof u=="number"||Tn(u)&&Dn(u)==lt}function Bl(u){if(!Tn(u)||Dn(u)!=st)return!1;var d=fc(u);if(d===null)return!0;var m=nn.call(d,"constructor")&&d.constructor;return typeof m=="function"&&m instanceof m&&al.call(m)==$m}var Ud=Hh?Xs(Hh):jm;function no(u){return eu(u)&&u>=-Ce&&u<=Ce}var Rg=Vh?Xs(Vh):Fm;function tu(u){return typeof u=="string"||!jt(u)&&Tn(u)&&Dn(u)==wt}function ir(u){return typeof u=="symbol"||Tn(u)&&Dn(u)==qt}var Oo=Au?Xs(Au):zm;function so(u){return u===s}function Ro(u){return Tn(u)&&Le(u)==me}function Nb(u){return Tn(u)&&Dn(u)==ge}var Wd=xc(wl),js=xc(function(u,d){return u<=d});function Lb(u){if(!u)return[];if(ts(u))return tu(u)?Ar(u):Vn(u);if(oa&&u[oa])return Nu(u[oa]());var d=Le(u),m=d==St?Lu:d==Nt?il:Pa;return m(u)}function J(u){if(!u)return u===0?u:0;if(u=or(u),u===ze||u===-ze){var d=u<0?-1:1;return d*at}return u===u?u:0}function Ct(u){var d=J(u),m=d%1;return d===d?m?d-m:d:0}function Pl(u){return u?Co(Ct(u),0,Ae):0}function or(u){if(typeof u=="number")return u;if(ir(u))return he;if(An(u)){var d=typeof u.valueOf=="function"?u.valueOf():u;u=An(d)?d+"":d}if(typeof u!="string")return u===0?u:+u;u=Mu(u);var m=pe.test(u);return m||_e.test(u)?lm(u.slice(2),m?2:8):F.test(u)?he:+u}function vi(u){return Xr(u,hs(u))}function Mo(u){return u?Co(Ct(u),-Ce,Ce):u===0?u:0}function cn(u){return u==null?"":er(u)}var jl=ma(function(u,d){if(Lc(d)||ts(d)){Xr(d,ls(d),u);return}for(var m in d)nn.call(d,m)&&bl(u,m,d[m])}),Hd=ma(function(u,d){Xr(d,hs(d),u)}),nu=ma(function(u,d,m,_){Xr(d,hs(d),u,_)}),vr=ma(function(u,d,m,_){Xr(d,ls(d),u,_)}),Mg=mi(Zu);function su(u,d){var m=qr(u);return d==null?m:yc(m,d)}var Ng=Ht(function(u,d){u=kt(u);var m=-1,_=d.length,x=_>2?d[2]:s;for(x&&Bt(d[0],d[1],x)&&(_=1);++m<_;)for(var L=d[m],V=hs(L),Q=-1,le=V.length;++Q<le;){var Me=V[Q],Ne=u[Me];(Ne===s||Qr(Ne,Bi[Me])&&!nn.call(u,Me))&&(u[Me]=L[Me])}return u}),Bb=Ht(function(u){return u.push(s,qm),Ys(_r,s,u)});function Pb(u,d){return Ou(u,gt(d,3),Yr)}function jb(u,d){return Ou(u,gt(d,3),So)}function Fb(u,d){return u==null?u:ed(u,gt(d,3),hs)}function ru(u,d){return u==null?u:wp(u,gt(d,3),hs)}function Lg(u,d){return u&&Yr(u,gt(d,3))}function iu(u,d){return u&&So(u,gt(d,3))}function Bg(u){return u==null?[]:_l(u,ls(u))}function Vd(u){return u==null?[]:_l(u,hs(u))}function Fl(u,d,m){var _=u==null?s:To(u,d);return _===s?m:_}function La(u,d){return u!=null&&nr(u,d,ko)}function No(u,d){return u!=null&&nr(u,d,Cp)}var yi=Eo(function(u,d,m){d!=null&&typeof d.toString!="function"&&(d=ll.call(d)),u[d]=m},eh(Ds)),ro=Eo(function(u,d,m){d!=null&&typeof d.toString!="function"&&(d=ll.call(d)),nn.call(u,d)?u[d].push(m):u[d]=[m]},gt),yr=Ht(ha);function ls(u){return ts(u)?mp(u):rd(u)}function hs(u){return ts(u)?mp(u,!0):Um(u)}function Pg(u,d){var m={};return d=gt(d,3),Yr(u,function(_,x,L){pi(m,d(_,x,L),_)}),m}function sn(u,d){var m={};return d=gt(d,3),Yr(u,function(_,x,L){pi(m,x,d(_,x,L))}),m}var Lo=ma(function(u,d,m){Cl(u,d,m)}),_r=ma(function(u,d,m,_){Cl(u,d,m,_)}),Oe=mi(function(u,d){var m={};if(u==null)return m;var _=!1;d=wn(d,function(L){return L=ks(L,u),_||(_=L.length>1),L}),Xr(u,_d(u),m),_&&(m=gr(m,w|T|C,Ym));for(var x=d.length;x--;)fd(m,d[x]);return m});function jg(u,d){return zb(u,Ld(gt(d)))}var ly=mi(function(u,d){return u==null?{}:Rp(u,d)});function zb(u,d){if(u==null)return{};var m=wn(_d(u),function(_){return[_]});return d=gt(d),ld(u,m,function(_,x){return d(_,x[0])})}function cy(u,d,m){d=ks(d,u);var _=-1,x=d.length;for(x||(x=1,u=s);++_<x;){var L=u==null?s:u[bs(d[_])];L===s&&(_=x,L=m),u=vs(L)?L.call(u):L}return u}function Fg(u,d,m){return u==null?u:fa(u,d,m)}function Gd(u,d,m,_){return _=typeof _=="function"?_:s,u==null?u:fa(u,d,m,_)}var wr=Yp(ls),ou=Yp(hs);function gn(u,d,m){var _=jt(u),x=_||ei(u)||Oo(u);if(d=gt(d,4),m==null){var L=u&&u.constructor;x?m=_?new L:[]:An(u)?m=vs(L)?qr(fc(u)):{}:m={}}return(x?Ns:Yr)(u,function(V,Q,le){return d(m,V,Q,le)}),m}function Ub(u,d){return u==null?!0:fd(u,d)}function zg(u,d,m){return u==null?u:Fp(u,d,Be(m))}function Ba(u,d,m,_){return _=typeof _=="function"?_:s,u==null?u:Fp(u,d,Be(m),_)}function Pa(u){return u==null?[]:nl(u,ls(u))}function ja(u){return u==null?[]:nl(u,hs(u))}function Ug(u,d,m){return m===s&&(m=d,d=s),m!==s&&(m=or(m),m=m===m?m:0),d!==s&&(d=or(d),d=d===d?d:0),Co(or(u),d,m)}function Wg(u,d,m){return d=J(d),m===s?(m=d,d=0):m=J(m),u=or(u),Pm(u,d,m)}function Wb(u,d,m){if(m&&typeof m!="boolean"&&Bt(u,d,m)&&(d=m=s),m===s&&(typeof d=="boolean"?(m=d,d=s):typeof u=="boolean"&&(m=u,u=s)),u===s&&d===s?(u=0,d=1):(u=J(u),d===s?(d=u,u=0):d=J(d)),u>d){var _=u;u=d,d=_}if(m||u%1||d%1){var x=yo();return fs(u+x*(d-u+am("1e-"+((x+"").length-1))),d)}return dd(u,d)}var Hg=Es(function(u,d,m){return d=d.toLowerCase(),u+(m?Kd(d):d)});function Kd(u){return Hl(cn(u).toLowerCase())}function Jd(u){return u=cn(u),u&&u.replace(je,pm).replace(jh,"")}function zl(u,d,m){u=cn(u),d=er(d);var _=u.length;m=m===s?_:Co(Ct(m),0,_);var x=m;return m-=d.length,m>=0&&u.slice(m,x)==d}function uy(u){return u=cn(u),u&&Pn.test(u)?u.replace(Rn,gm):u}function Hb(u){return u=cn(u),u&&ec.test(u)?u.replace(Ir,"\\$&"):u}var dy=Es(function(u,d,m){return u+(m?"-":"")+d.toLowerCase()}),Cr=Es(function(u,d,m){return u+(m?" ":"")+d.toLowerCase()}),Vg=ba("toLowerCase");function au(u,d,m){u=cn(u),d=Ct(d);var _=d?ia(u):0;if(!d||_>=d)return u;var x=(d-_)/2;return Tl(vo(x),m)+u+Tl(pl(x),m)}function qd(u,d,m){u=cn(u),d=Ct(d);var _=d?ia(u):0;return d&&_<d?u+Tl(d-_,m):u}function Vb(u,d,m){u=cn(u),d=Ct(d);var _=d?ia(u):0;return d&&_<d?Tl(d-_,m)+u:u}function Gb(u,d,m){return m||d==null?d=0:d&&(d=+d),Cm(cn(u).replace(xr,""),d||0)}function Gg(u,d,m){return(m?Bt(u,d,m):d===s)?d=1:d=Ct(d),Sc(cn(u),d)}function lu(){var u=arguments,d=cn(u[0]);return u.length<3?d:d.replace(u[1],u[2])}var Kb=Es(function(u,d,m){return u+(m?"_":"")+d.toLowerCase()});function Jb(u,d,m){return m&&typeof m!="number"&&Bt(u,d,m)&&(d=m=s),m=m===s?Ae:m>>>0,m?(u=cn(u),u&&(typeof d=="string"||d!=null&&!Ud(d))&&(d=er(d),!d&&$o(u))?fe(Ar(u),0,m):u.split(d,m)):[]}var Fs=Es(function(u,d,m){return u+(m?" ":"")+Hl(d)});function Ur(u,d,m){return u=cn(u),m=m==null?0:Co(Ct(m),0,u.length),d=er(d),u.slice(m,m+d.length)==d}function qb(u,d,m){var _=M.templateSettings;m&&Bt(u,d,m)&&(d=s),u=cn(u),d=nu({},d,_,Xp);var x=nu({},d.imports,_.imports,Xp),L=ls(x),V=nl(x,L),Q,le,Me=0,Ne=d.interpolate||it,Pe="__p += '",qe=Bu((d.escape||it).source+"|"+Ne.source+"|"+(Ne===jn?R:it).source+"|"+(d.evaluate||it).source+"|$","g"),dt="//# sourceURL="+(nn.call(d,"sourceURL")?(d.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ac+"]")+`
`;u.replace(qe,function(vt,Xt,en,zs,As,ar){return en||(en=zs),Pe+=u.slice(Me,ar).replace(Ft,sl),Xt&&(Q=!0,Pe+=`' +
__e(`+Xt+`) +
'`),As&&(le=!0,Pe+=`';
`+As+`;
__p += '`),en&&(Pe+=`' +
((__t = (`+en+`)) == null ? '' : __t) +
'`),Me=ar+vt.length,vt}),Pe+=`';
`;var $t=nn.call(d,"variable")&&d.variable;if(!$t)Pe=`with (obj) {
`+Pe+`
}
`;else if(z.test($t))throw new xt(g);Pe=(le?Pe.replace(zn,""):Pe).replace(Jn,"$1").replace(Gs,"$1;"),Pe="function("+($t||"obj")+`) {
`+($t?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(Q?", __e = _.escape":"")+(le?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Pe+`return __p
}`;var Ut=Qd(function(){return rn(L,dt+"return "+Pe).apply(s,V)});if(Ut.source=Pe,Ps(Ut))throw Ut;return Ut}function Yd(u){return cn(u).toLowerCase()}function Kg(u){return cn(u).toUpperCase()}function Yb(u,d,m){if(u=cn(u),u&&(m||d===s))return Mu(u);if(!u||!(d=er(d)))return u;var _=Ar(u),x=Ar(d),L=Xh(_,x),V=Zh(_,x)+1;return fe(_,L,V).join("")}function Ul(u,d,m){if(u=cn(u),u&&(m||d===s))return u.slice(0,sp(u)+1);if(!u||!(d=er(d)))return u;var _=Ar(u),x=Zh(_,Ar(d))+1;return fe(_,0,x).join("")}function Xd(u,d,m){if(u=cn(u),u&&(m||d===s))return u.replace(xr,"");if(!u||!(d=er(d)))return u;var _=Ar(u),x=Xh(_,Ar(d));return fe(_,x).join("")}function Wl(u,d){var m=Y,_=X;if(An(d)){var x="separator"in d?d.separator:x;m="length"in d?Ct(d.length):m,_="omission"in d?er(d.omission):_}u=cn(u);var L=u.length;if($o(u)){var V=Ar(u);L=V.length}if(m>=L)return u;var Q=m-ia(_);if(Q<1)return _;var le=V?fe(V,0,Q).join(""):u.slice(0,Q);if(x===s)return le+_;if(V&&(Q+=le.length-Q),Ud(x)){if(u.slice(Q).search(x)){var Me,Ne=le;for(x.global||(x=Bu(x.source,cn(j.exec(x))+"g")),x.lastIndex=0;Me=x.exec(Ne);)var Pe=Me.index;le=le.slice(0,Pe===s?Q:Pe)}}else if(u.indexOf(er(x),Q)!=Q){var qe=le.lastIndexOf(x);qe>-1&&(le=le.slice(0,qe))}return le+_}function Xb(u){return u=cn(u),u&&Kt.test(u)?u.replace(ns,fm):u}var hy=Es(function(u,d,m){return u+(m?" ":"")+d.toUpperCase()}),Hl=ba("toUpperCase");function Zd(u,d,m){return u=cn(u),d=m?s:d,d===s?rl(u)?ip(u):Jh(u):u.match(d)||[]}var Qd=Ht(function(u,d){try{return Ys(u,s,d)}catch(m){return Ps(m)?m:new xt(m)}}),py=mi(function(u,d){return Ns(d,function(m){m=bs(m),pi(u,m,$r(u[m],u))}),u});function gy(u){var d=u==null?0:u.length,m=gt();return u=d?wn(u,function(_){if(typeof _[1]!="function")throw new us(h);return[m(_[0]),_[1]]}):[],Ht(function(_){for(var x=-1;++x<d;){var L=u[x];if(Ys(L[0],this,_))return Ys(L[1],this,_)}})}function fy(u){return $p(gr(u,w))}function eh(u){return function(){return u}}function my(u,d){return u==null||u!==u?d:u}var Zb=Kp(),un=Kp(!0);function Ds(u){return u}function cu(u){return xp(typeof u=="function"?u:gr(u,w))}function by(u){return Ap(gr(u,w))}function uu(u,d){return id(u,gr(d,w))}var _i=Ht(function(u,d){return function(m){return ha(m,u,d)}}),Bo=Ht(function(u,d){return function(m){return ha(u,m,d)}});function wi(u,d,m){var _=ls(d),x=_l(d,_);m==null&&!(An(d)&&(x.length||!_.length))&&(m=d,d=u,u=this,x=_l(d,ls(d)));var L=!(An(m)&&"chain"in m)||!!m.chain,V=vs(u);return Ns(x,function(Q){var le=d[Q];u[Q]=le,V&&(u.prototype[Q]=function(){var Me=this.__chain__;if(L||Me){var Ne=u(this.__wrapped__),Pe=Ne.__actions__=Vn(this.__actions__);return Pe.push({func:le,args:arguments,thisArg:u}),Ne.__chain__=Me,Ne}return le.apply(u,Kr([this.value()],arguments))})}),u}function Vl(){return Wn._===this&&(Wn._=vm),this}function Wr(){}function $y(u){return u=Ct(u),Ht(function(d){return od(d,u)})}var th=Ki(wn),Qb=Ki(na),e$=Ki(dc);function nh(u){return Jt(u)?el(bs(u)):cd(u)}function vy(u){return function(d){return u==null?s:To(u,d)}}var Jg=Jp(),qg=Jp(!0);function sh(){return[]}function rh(){return!1}function Fa(){return{}}function ih(){return""}function oh(){return!0}function t$(u,d){if(u=Ct(u),u<1||u>Ce)return[];var m=Ae,_=fs(u,Ae);d=gt(d),u-=Ae;for(var x=sa(_,d);++m<u;)d(m);return x}function ah(u){return jt(u)?wn(u,bs):ir(u)?[u]:Vn(wa(cn(u)))}function n$(u){var d=++gc;return cn(u)+d}var s$=ya(function(u,d){return u+d},0),r$=kl("ceil"),i$=ya(function(u,d){return u/d},1),o$=kl("floor");function Yg(u){return u&&u.length?yl(u,Ds,td):s}function a$(u,d){return u&&u.length?yl(u,gt(d,2),td):s}function Po(u){return Ru(u,Ds)}function l$(u,d){return Ru(u,gt(d,2))}function c$(u){return u&&u.length?yl(u,Ds,wl):s}function u$(u,d){return u&&u.length?yl(u,gt(d,2),wl):s}var Gl=ya(function(u,d){return u*d},1),yy=kl("round"),lh=ya(function(u,d){return u-d},0);function Xg(u){return u&&u.length?hc(u,Ds):0}function d$(u,d){return u&&u.length?hc(u,gt(d,2)):0}return M.after=Nd,M.ary=Aa,M.assign=jl,M.assignIn=Hd,M.assignInWith=nu,M.assignWith=vr,M.at=Mg,M.before=Oa,M.bind=$r,M.bindAll=py,M.bindKey=Fr,M.castArray=Ze,M.chain=ka,M.chunk=eb,M.compact=tb,M.concat=nb,M.cond=gy,M.conforms=fy,M.constant=eh,M.countBy=Md,M.create=su,M.curry=qc,M.curryRight=Ig,M.debounce=Yc,M.defaults=Ng,M.defaultsDeep=Bb,M.defer=Ra,M.delay=zt,M.difference=sb,M.differenceBy=sy,M.differenceWith=ag,M.drop=rb,M.dropRight=Ed,M.dropRightWhile=lg,M.dropWhile=Id,M.fill=cg,M.filter=Rl,M.flatMap=Ia,M.flatMapDeep=_g,M.flatMapDepth=wg,M.flatten=Pr,M.flattenDeep=as,M.flattenDepth=Pc,M.flip=Ao,M.flow=Zb,M.flowRight=un,M.fromPairs=ug,M.functions=Bg,M.functionsIn=Vd,M.groupBy=Cg,M.initial=Dd,M.intersection=Bs,M.intersectionBy=ry,M.intersectionWith=Ad,M.invert=yi,M.invertBy=ro,M.invokeMap=Sb,M.iteratee=cu,M.keyBy=Tb,M.keys=ls,M.keysIn=hs,M.map=xa,M.mapKeys=Pg,M.mapValues=sn,M.matches=by,M.matchesProperty=uu,M.memoize=Ma,M.merge=Lo,M.mergeWith=_r,M.method=_i,M.methodOf=Bo,M.mixin=wi,M.negate=Ld,M.nthArg=$y,M.omit=Oe,M.omitBy=jg,M.once=Eb,M.orderBy=es,M.over=th,M.overArgs=Ib,M.overEvery=Qb,M.overSome=e$,M.partial=Bd,M.partialRight=Xc,M.partition=br,M.pick=ly,M.pickBy=zb,M.property=nh,M.propertyOf=vy,M.pull=ab,M.pullAll=Fc,M.pullAllBy=lb,M.pullAllWith=cb,M.pullAt=ub,M.range=Jg,M.rangeRight=qg,M.rearg=Pd,M.reject=kb,M.remove=db,M.rest=xs,M.reverse=Yi,M.sampleSize=Jc,M.set=Fg,M.setWith=Gd,M.shuffle=vn,M.slice=pg,M.sortBy=Eg,M.sortedUniq=pb,M.sortedUniqBy=$s,M.split=Jb,M.spread=xg,M.tail=Dl,M.take=gb,M.takeRight=Wc,M.takeRightWhile=fb,M.takeWhile=mb,M.tap=ln,M.throttle=iy,M.thru=Zi,M.toArray=Lb,M.toPairs=wr,M.toPairsIn=ou,M.toPath=ah,M.toPlainObject=vi,M.transform=gn,M.unary=Dg,M.union=bb,M.unionBy=Ca,M.unionWith=$b,M.uniq=Hc,M.uniqBy=Qn,M.uniqWith=Sa,M.unset=Ub,M.unzip=Xi,M.unzipWith=Vc,M.update=zg,M.updateWith=Ba,M.values=Pa,M.valuesIn=ja,M.without=Od,M.words=Zd,M.wrap=Ag,M.xor=vb,M.xorBy=yb,M.xorWith=bg,M.zip=Rd,M.zipObject=$g,M.zipObjectDeep=Ta,M.zipWith=Al,M.entries=wr,M.entriesIn=ou,M.extend=Hd,M.extendWith=nu,wi(M,M),M.add=s$,M.attempt=Qd,M.camelCase=Hg,M.capitalize=Kd,M.ceil=r$,M.clamp=Ug,M.clone=Ll,M.cloneDeep=Zc,M.cloneDeepWith=Qc,M.cloneWith=jd,M.conformsTo=xb,M.deburr=Jd,M.defaultTo=my,M.divide=i$,M.endsWith=zl,M.eq=Qr,M.escape=uy,M.escapeRegExp=Hb,M.every=Kc,M.find=wb,M.findIndex=ib,M.findKey=Pb,M.findLast=Cb,M.findLastIndex=ob,M.findLastKey=jb,M.floor=o$,M.forEach=mr,M.forEachRight=Ml,M.forIn=Fb,M.forInRight=ru,M.forOwn=Lg,M.forOwnRight=iu,M.get=Fl,M.gt=oy,M.gte=Qi,M.has=La,M.hasIn=No,M.head=xd,M.identity=Ds,M.includes=Sg,M.indexOf=jc,M.inRange=Wg,M.invoke=yr,M.isArguments=eo,M.isArray=jt,M.isArrayBuffer=Db,M.isArrayLike=ts,M.isArrayLikeObject=Yn,M.isBoolean=ay,M.isBuffer=ei,M.isDate=zr,M.isElement=Ab,M.isEmpty=Fd,M.isEqual=rr,M.isEqualWith=Ob,M.isError=Ps,M.isFinite=fn,M.isFunction=vs,M.isInteger=eu,M.isLength=Na,M.isMap=Rb,M.isMatch=ti,M.isMatchWith=Vt,M.isNaN=to,M.isNative=Ln,M.isNil=Og,M.isNull=Mb,M.isNumber=zd,M.isObject=An,M.isObjectLike=Tn,M.isPlainObject=Bl,M.isRegExp=Ud,M.isSafeInteger=no,M.isSet=Rg,M.isString=tu,M.isSymbol=ir,M.isTypedArray=Oo,M.isUndefined=so,M.isWeakMap=Ro,M.isWeakSet=Nb,M.join=dg,M.kebabCase=dy,M.last=sr,M.lastIndexOf=xl,M.lowerCase=Cr,M.lowerFirst=Vg,M.lt=Wd,M.lte=js,M.max=Yg,M.maxBy=a$,M.mean=Po,M.meanBy=l$,M.min=c$,M.minBy=u$,M.stubArray=sh,M.stubFalse=rh,M.stubObject=Fa,M.stubString=ih,M.stubTrue=oh,M.multiply=Gl,M.nth=hg,M.noConflict=Vl,M.noop=Wr,M.now=Da,M.pad=au,M.padEnd=qd,M.padStart=Vb,M.parseInt=Gb,M.random=Wb,M.reduce=Tg,M.reduceRight=kg,M.repeat=Gg,M.replace=lu,M.result=cy,M.round=yy,M.runInContext=ie,M.sample=jr,M.size=Gn,M.snakeCase=Kb,M.some=Nl,M.sortedIndex=hb,M.sortedIndexBy=zc,M.sortedIndexOf=gg,M.sortedLastIndex=Uc,M.sortedLastIndexBy=fg,M.sortedLastIndexOf=mg,M.startCase=Fs,M.startsWith=Ur,M.subtract=lh,M.sum=Xg,M.sumBy=d$,M.template=qb,M.times=t$,M.toFinite=J,M.toInteger=Ct,M.toLength=Pl,M.toLower=Yd,M.toNumber=or,M.toSafeInteger=Mo,M.toString=cn,M.toUpper=Kg,M.trim=Yb,M.trimEnd=Ul,M.trimStart=Xd,M.truncate=Wl,M.unescape=Xb,M.uniqueId=n$,M.upperCase=hy,M.upperFirst=Hl,M.each=mr,M.eachRight=Ml,M.first=xd,wi(M,function(){var u={};return Yr(M,function(d,m){nn.call(M.prototype,m)||(u[m]=d)}),u}(),{chain:!1}),M.VERSION=i,Ns(["bind","bindKey","curry","curryRight","partial","partialRight"],function(u){M[u].placeholder=M}),Ns(["drop","take"],function(u,d){Ot.prototype[u]=function(m){m=m===s?1:Xn(Ct(m),0);var _=this.__filtered__&&!d?new Ot(this):this.clone();return _.__filtered__?_.__takeCount__=fs(m,_.__takeCount__):_.__views__.push({size:fs(m,Ae),type:u+(_.__dir__<0?"Right":"")}),_},Ot.prototype[u+"Right"]=function(m){return this.reverse()[u](m).reverse()}}),Ns(["filter","map","takeWhile"],function(u,d){var m=d+1,_=m==te||m==Z;Ot.prototype[u]=function(x){var L=this.clone();return L.__iteratees__.push({iteratee:gt(x,3),type:m}),L.__filtered__=L.__filtered__||_,L}}),Ns(["head","last"],function(u,d){var m="take"+(d?"Right":"");Ot.prototype[u]=function(){return this[m](1).value()[0]}}),Ns(["initial","tail"],function(u,d){var m="drop"+(d?"":"Right");Ot.prototype[u]=function(){return this.__filtered__?new Ot(this):this[m](1)}}),Ot.prototype.compact=function(){return this.filter(Ds)},Ot.prototype.find=function(u){return this.filter(u).head()},Ot.prototype.findLast=function(u){return this.reverse().find(u)},Ot.prototype.invokeMap=Ht(function(u,d){return typeof u=="function"?new Ot(this):this.map(function(m){return ha(m,u,d)})}),Ot.prototype.reject=function(u){return this.filter(Ld(gt(u)))},Ot.prototype.slice=function(u,d){u=Ct(u);var m=this;return m.__filtered__&&(u>0||d<0)?new Ot(m):(u<0?m=m.takeRight(-u):u&&(m=m.drop(u)),d!==s&&(d=Ct(d),m=d<0?m.dropRight(-d):m.take(d-u)),m)},Ot.prototype.takeRightWhile=function(u){return this.reverse().takeWhile(u).reverse()},Ot.prototype.toArray=function(){return this.take(Ae)},Yr(Ot.prototype,function(u,d){var m=/^(?:filter|find|map|reject)|While$/.test(d),_=/^(?:head|last)$/.test(d),x=M[_?"take"+(d=="last"?"Right":""):d],L=_||/^find/.test(d);x&&(M.prototype[d]=function(){var V=this.__wrapped__,Q=_?[1]:arguments,le=V instanceof Ot,Me=Q[0],Ne=le||jt(V),Pe=function(Xt){var en=x.apply(M,Kr([Xt],Q));return _&&qe?en[0]:en};Ne&&m&&typeof Me=="function"&&Me.length!=1&&(le=Ne=!1);var qe=this.__chain__,dt=!!this.__actions__.length,$t=L&&!qe,Ut=le&&!dt;if(!L&&Ne){V=Ut?V:new Ot(this);var vt=u.apply(V,Q);return vt.__actions__.push({func:Zi,args:[Pe],thisArg:s}),new Zn(vt,qe)}return $t&&Ut?u.apply(this,Q):(vt=this.thru(Pe),$t?_?vt.value()[0]:vt.value():vt)})}),Ns(["pop","push","shift","sort","splice","unshift"],function(u){var d=pc[u],m=/^(?:push|sort|unshift)$/.test(u)?"tap":"thru",_=/^(?:pop|shift)$/.test(u);M.prototype[u]=function(){var x=arguments;if(_&&!this.__chain__){var L=this.value();return d.apply(jt(L)?L:[],x)}return this[m](function(V){return d.apply(jt(V)?V:[],x)})}}),Yr(Ot.prototype,function(u,d){var m=M[d];if(m){var _=m.name+"";nn.call(ua,_)||(ua[_]=[]),ua[_].push({name:d,func:m})}}),ua[va(s,P).name]=[{name:"wrapper",func:s}],Ot.prototype.clone=km,Ot.prototype.reverse=Em,Ot.prototype.value=Im,M.prototype.at=Ea,M.prototype.chain=vg,M.prototype.commit=Do,M.prototype.next=_b,M.prototype.plant=Is,M.prototype.reverse=Gc,M.prototype.toJSON=M.prototype.valueOf=M.prototype.value=Ol,M.prototype.first=M.prototype.head,oa&&(M.prototype[oa]=yg),M},Or=bm();mo?((mo.exports=Or)._=Or,lc._=Or):Wn._=Or}).call($L)})(bv,bv.exports);var vL=bv.exports;const W_=Ga(vL),Zy=W_.throttle((o,n)=>o(n),0);function L$(o,n){const s=n.find(i=>i._id===o);return{card:s,index:s?n.indexOf(s):-1}}function Qy(o,n,s,i,a,c,h,g,b){const{card:$,index:y}=L$(o,s);if(!(y<n&&g<b)&&!(y>n&&g>b)&&$&&y!==n){const w=W_.clone(s);w.splice(y,1),w.splice(n,0,$);const T=W_.clone(a);switch(c){case"actions":T.actions[h]=w,Zy(i,T);return;case"conditions":T.conditions[h]=w,Zy(i,T);return;default:T.triggers=w,Zy(i,T);return}}}const yL="_drag_7xfhc_1",_L="_root_7xfhc_11",s0={drag:yL,root:_L},Uk=({typeBlock:o,allProperties:n,id:s,isActive:i,setUserRules:a,userRules:c,children:h,_id:g,blockValue:b})=>{const{setOnUpdate:$}=ve.useContext(Gf),[{opacity:y},w,T]=hT({type:"box",item:()=>({...n,id:s,isActive:i,_id:g}),end:(A,P)=>{const{acceptedBy:N}=A,B=P.getDropResult();let S;if(!B)return typeof g=="number"&&!P.getTargetIds().length&&(S=Rh(N,c,b),S=du(N,S,b,g),a(S)),null;if(B.blockValue!==b){const H=typeof g=="number"?g:Date.now();S=Rh(N,c,B.blockValue);const q={id:A.id,acceptedBy:A.acceptedBy};switch(N){case"actions":return b&&(S=du("actions",S,b,H)),S=du("actions",S,B.blockValue,H),S.actions[B.blockValue].push({...q,_id:H}),a(S);case"conditions":return typeof b=="number"&&(S=du("conditions",S,b,H)),S=du("conditions",S,B.blockValue,H),S.conditions[B.blockValue].push({...q,_id:H}),a(S);default:return $(!0),S=du("triggers",S,B.blockValue,H),S.triggers.push({...q,_id:H}),a(S)}}},collect:A=>({opacity:A.isDragging()?.4:1,isDragging:A.isDragging()})}),C=ve.useRef(null),[,E]=uw({accept:"box",canDrop:()=>!1,hover({_id:A,acceptedBy:P},N){var se;if(!C.current||o!==P)return;const B=(se=C.current)==null?void 0:se.getBoundingClientRect(),S=(B.bottom-B.top)/2,H=N.getClientOffset(),q=((H==null?void 0:H.y)||0)-B.top;if(g&&A!==g)switch(P){case"actions":if(b==="then"||b==="else"){const{index:ee}=L$(g,c.actions[b]);ee!==A&&Qy(A,ee,c[P][b],a,c,P,b,q,S)}return;case"conditions":if(typeof b=="number"){const{index:ee}=L$(g,c[P][b]);ee!==A&&Qy(A,ee,c[P][b],a,c,P,b,q,S)}return;default:{const{index:ee}=L$(g,c[P]);ee!==A&&Qy(A,ee,c[P],a,c,P,void 0,q,S);return}}}});ve.useEffect(()=>{T(FA(),{captureDraggingState:!0})},[]),w(E(C));const k=window.innerWidth<600;return f.jsxs("div",{ref:k&&g?null:C,className:s0.root,style:{opacity:y},children:[f.jsx("div",{className:g?s0.drag:null,ref:g&&k?C:null}),h]})},wL=({onClose:o,open:n})=>f.jsxs(D.Dialog,{open:n,onClose:o,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[f.jsx(D.DialogContent,{children:f.jsxs("div",{style:{fontSize:"1rem",fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif',fontWeight:400,lineHeight:1.5,letterSpacing:"0.00938em"},children:[f.jsx("h3",{children:I.I18n.t("On condition change")}),f.jsx("div",{children:I.I18n.t("help_on_change")}),f.jsx("h3",{children:I.I18n.t("Just check")}),f.jsx("div",{children:I.I18n.t("help_just_check")})]})}),f.jsx(D.DialogActions,{children:f.jsx(D.Button,{onClick:o,color:"primary",autoFocus:!0,startIcon:f.jsx(Va,{}),children:I.I18n.t("OK")})})]}),CL=({onClose:o,open:n})=>f.jsxs(D.Dialog,{open:n,onClose:o,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[f.jsx(D.DialogContent,{children:f.jsxs(D.DialogContentText,{id:"alert-dialog-description",children:[f.jsx("h3",{children:I.I18n.t("On condition change")}),f.jsx("div",{children:I.I18n.t("help_on_change")}),f.jsx("h3",{children:I.I18n.t("Just check")}),f.jsx("div",{children:I.I18n.t("help_just_check")})]})}),f.jsx(D.DialogActions,{children:f.jsx(D.Button,{onClick:o,color:"primary",autoFocus:!0,children:I.I18n.t("OK")})})]}),r0=({size:o,blockValue:n,boolean:s,typeBlock:i,userRules:a,setUserRules:c,animation:h,setTourStep:g,tourStep:b,isTourOpen:$,theme:y,themeType:w,themeName:T})=>{var ke;const[C,E]=ve.useState(!1),[k,A]=ve.useState(!1),[P,N]=ve.useState(!1),[B,S]=ve.useState("");s===void 0&&(s=!0);const H=uw({accept:"box",drop:()=>({blockValue:n}),hover:({acceptedBy:Z,_id:ze},Ce)=>{E(Z===i),N(!!ze),S(Ce.getHandlerId()||"")},canDrop:({acceptedBy:Z})=>(A(Z===i),Z===i),collect:Z=>{var ze;return{isOver:Z.isOver(),canDrop:((ze=Z.getItem())==null?void 0:ze.acceptedBy)===i,offset:Z.getClientOffset(),targetId:Z.getHandlerId()}}}),q=H[0],{canDrop:se,isOver:ee,offset:K,targetId:Y}=q,X=H[1];ve.useEffect(()=>{S("")},[K]);const ce=se&&ee;let W="";ce?W=C?"#00fb003d":"#fb00002e":se?W=k?"#00fb003d":"#fb00002e":K&&(W=Y===B?"#fb00002e":"");let te;return i==="actions"?te=a.actions[n]:i==="conditions"?te=a.conditions[n]:te=a.triggers,f.jsx("div",{ref:X,style:{backgroundColor:W},className:`${I.Utils.clsx(ps.contentBlockItem,o&&ps.addClassHeight)} ${s?h?ps.contentHeightOn:null:ps.contentHeightOff}`,children:f.jsxs("div",{className:ps.wrapperMargin,children:[te.map(Z=>f.jsx(Uk,{typeBlock:i,...Z,blockValue:n,allProperties:Z,userRules:a,setUserRules:c,children:f.jsx(zk,{...Z,isTourOpen:$,setTourStep:g,tourStep:b,settings:Z,blockValue:n,userRules:a,setUserRules:c,theme:y,themeType:w,themeName:T})},Z._id)),f.jsx("div",{style:ce&&C&&!P?{height:((ke=document.getElementById("height"))==null?void 0:ke.clientHeight)||200}:void 0,className:`${ps.emptyBlockStyle} ${ce&&C&&!P?ps.emptyBlock:ps.emptyBlockNone}`})]})})},e_=({size:o,typeBlock:n,name:s,nameAdditionally:i,additionally:a,border:c,userRules:h,setUserRules:g,iconName:b,adapter:$,socket:y,setTourStep:w,tourStep:T,isTourOpen:C,theme:E,themeType:k,themeName:A})=>{const[P,N,B]=U_(n==="actions"?!1:[],`additionallyClickItems_${n}`),[S,H]=ve.useState(!1),[q,se]=ve.useState(!1);ve.useEffect(()=>{if(n==="conditions"&&(P==null?void 0:P.length)!==h.conditions.length-1){const Y=[];h.conditions.forEach((X,ce)=>{ce>0&&Y.push({_id:Date.now(),open:!0})}),N([...P,...Y])}n==="actions"&&!B&&h.actions.else.length&&N(!0)},[]);const[ee,K]=ve.useState(!1);return f.jsxs("div",{className:`${I.Utils.clsx(ps.mainBlockItemRules,o&&ps.addClassOverflow)} ${c&&!o?ps.border:null}`,children:[f.jsxs("span",{id:"width",className:ps.nameBlockItems,children:[f.jsx($u,{iconName:b,className:ps.iconThemCard,adapter:$,socket:y}),s]}),n==="conditions"?f.jsxs("div",{style:{width:"100%"},children:[f.jsxs(D.Select,{variant:"standard",className:ps.selectOnChange,value:h.justCheck||!1,onChange:Y=>{const X=Rh("conditions",h);X.justCheck=Y.target.value==="true",g(X)},children:[f.jsx(D.MenuItem,{value:"false",children:I.I18n.t("on condition change")}),f.jsx(D.MenuItem,{value:"true",children:I.I18n.t("just check")})]}),f.jsx(D.IconButton,{size:"small",title:I.I18n.t("Explanation"),className:ps.selectOnChangeHelp,onClick:()=>H(!0),children:f.jsx(dw,{className:ps.selectOnChangeHelpIcon})})]}):null,f.jsx(r0,{setTourStep:w,tourStep:T,isTourOpen:C,blockValue:n==="actions"?"then":n==="conditions"?0:n,typeBlock:n,setUserRules:g,userRules:h,theme:E,themeName:A,themeType:k,size:o}),a&&[...Array(n==="actions"?1:h.conditions.length-1)].map((Y,X)=>{const ce=(W=X)=>n==="actions"?!!P:!!P.find((te,ke)=>ke===W&&te.open);return f.jsxs(ve.Fragment,{children:[f.jsxs("div",{onClick:()=>{if(n==="actions")return N(!P),null;let W=JSON.parse(JSON.stringify(P));if(h.conditions[X+1].length)return W[X].open=!W[X].open,N(W),null;W=W.filter((te,ke)=>ke!==X),N(W),K(X),setTimeout(()=>{K(!1),g({...h,conditions:[...h.conditions.filter((te,ke)=>ke!==X+1)]})},250)},className:ps.blockCardAdd,children:[ce()?"-":"+",f.jsx("div",{className:ps.cardAdd,children:i})]},X),f.jsx(r0,{blockValue:n==="actions"?"else":n==="conditions"?X+1:n,typeBlock:n,setUserRules:g,userRules:h,boolean:ce(),animation:ee===X,size:o,theme:E,themeName:A,themeType:k})]},`${X}_block_${n}`)}),a&&n==="conditions"&&f.jsxs("div",{onClick:()=>{N([...P,{_id:Date.now(),open:!0}]),g({...h,conditions:[...h.conditions,[]]}),K(h.conditions.length-1),setTimeout(()=>K(!1),1e3)},className:ps.blockCardAdd,children:["+",f.jsx("div",{className:ps.cardAdd,children:i})]}),f.jsx(wL,{open:S,onClose:()=>H(!1)}),f.jsx(CL,{open:q,onClose:()=>se(!1)})]})},SL="_menuRules_1qqcb_1",TL="_switchesRenderWrapper_1qqcb_13",kL="_menuOff_1qqcb_22",EL="_menuTitle_1qqcb_28",IL="_marginAuto_1qqcb_42",xL="_inputWidth_1qqcb_47",DL="_menuWrapper_1qqcb_52",AL="_hamburgerWrapper_1qqcb_57",OL="_hamburgerOff_1qqcb_74",RL="_nothingFound_1qqcb_82",ML="_resetSearch_1qqcb_89",NL="_controlPanel_1qqcb_101",LL="_controlPanelAppBar_1qqcb_112",BL="_addClassMenu_1qqcb_126",PL="_addClassBackground_1qqcb_132",jL="_addClassPosition_1qqcb_136",ur={menuRules:SL,switchesRenderWrapper:TL,menuOff:kL,menuTitle:EL,marginAuto:IL,inputWidth:xL,menuWrapper:DL,hamburgerWrapper:AL,hamburgerOff:OL,nothingFound:RL,resetSearch:ML,controlPanel:NL,controlPanelAppBar:LL,addClassMenu:BL,addClassBackground:PL,addClassPosition:jL},FL=o=>{const{allProperties:n,allProperties:{acceptedBy:s,id:i},setUserRules:a,userRules:c,setTourStep:h,tourStep:g,isTourOpen:b,onTouchMove:$,isActive:y}=o;return f.jsx(Uk,{allProperties:n,id:n.id,isActive:y,setUserRules:a,userRules:c,children:f.jsx(Mk,{onDoubleClick:()=>{b&&g===Ss.addScheduleByDoubleClick&&i==="TriggerScheduleBlock"&&h(Ss.openTagsMenu),b&&g===Ss.addActionPrintText&&i==="ActionPrintText"&&h(Ss.showJavascript);const w=Date.now();let T;switch(s){case"actions":T="then";break;case"conditions":T=c[s].length-1;break}const C=Rh(s,c,T),E={id:i,_id:w,acceptedBy:s};T!==void 0?s==="actions"?C.actions[T].push({...E}):s==="conditions"&&C.conditions[T].push({...E}):C.triggers.push({...E}),a(C)},...o,...n,onTouchMove:$})})},zL="_hamburgerMenu_hqnsm_8",UL="_animate_hqnsm_21",i0={hamburgerMenu:zL,animate:UL};function WL({bool:o}){return f.jsx("div",{className:`${i0.hamburgerMenu} ${o?i0.animate:""}`})}const HL=({addClass:o,setAllBlocks:n,allBlocks:s,userRules:i,onChangeBlocks:a,setTourStep:c,tourStep:h,isTourOpen:g})=>{const{blocks:b,socket:$}=ve.useContext(Gf),[y,w]=U_(!1,"hamburgerOnOff"),[T,C]=U_({text:"",type:"triggers",index:0},"filterControlPanel"),E=(P=T.text,N=T.type)=>{if(!b)return;let B=[...b];B=B.filter(S=>{if(!P)return!0;const{name:H}=S.getStaticData();return H&&I.I18n.t(H).toLowerCase().includes(P.toLowerCase())}),B=B.filter(S=>N===S.getStaticData().acceptedBy),n(B)},k=(P,N)=>{g&&N===0&&h===Ss.selectTriggers&&c(Ss.addScheduleByDoubleClick),g&&N===2&&h===Ss.selectActions&&c(Ss.addActionPrintText),C({...T,index:N,type:["triggers","conditions","actions"][N]}),E(T.text,["triggers","conditions","actions"][N])},A=P=>({id:`scrollable-force-tab-${P}`,"aria-controls":`scrollable-force-tabpanel-${P}`});return ve.useEffect(()=>{E()},[b]),f.jsx(D.ClickAwayListener,{mouseEvent:!1,touchEvent:"onTouchStart",onClickAway:()=>w(!0),children:f.jsxs("div",{className:I.Utils.clsx(ur.menuWrapper,o[1035]&&ur.addClassMenu),children:[f.jsx("div",{className:`${ur.hamburgerWrapper} ${y?ur.hamburgerOff:null}`,onClick:()=>w(!y),children:f.jsx(WL,{bool:!y})}),f.jsxs("div",{className:`${I.Utils.clsx(ur.menuRules,o[1035]&&ur.addClassBackground,o[835]&&ur.addClassPosition)} ${y?ur.menuOff:null}`,children:[f.jsx("div",{className:ur.controlPanel,children:f.jsx(D.AppBar,{className:ur.controlPanelAppBar,position:"static",children:f.jsxs(D.Tabs,{value:T.index,onChange:k,children:[f.jsx(D.Tab,{className:"blocks-triggers",title:I.I18n.t("Triggers"),icon:f.jsx($u,{iconName:"FlashOn"}),...A(0)}),f.jsx(D.Tab,{title:I.I18n.t("Conditions"),className:"blocks-conditions",icon:f.jsx($u,{iconName:"Help"}),...A(1)}),f.jsx(D.Tab,{title:I.I18n.t("Actions"),className:"blocks-actions",icon:f.jsx($u,{iconName:"PlayForWork"}),...A(2)})]})})}),f.jsx("div",{className:ur.switchesRenderWrapper,children:f.jsxs("span",{children:[s.map(P=>{const{name:N,id:B,icon:S,adapter:H}=P.getStaticData();return f.jsx(ve.Fragment,{children:f.jsx(FL,{adapter:H,allProperties:P.getStaticData(),icon:S,id:B,isActive:!1,isTourOpen:g,name:N,onTouchMove:()=>w(!0),setTourStep:c,setUserRules:a,socket:$,tourStep:h,userRules:i})},B)}),!s.length&&f.jsxs("div",{className:ur.nothingFound,children:[I.I18n.t("Nothing found"),"...",f.jsx("div",{className:ur.resetSearch,onClick:()=>{C({...T,text:""}),E("")},children:I.I18n.t("reset search")})]})]})}),f.jsx("div",{className:I.Utils.clsx(ur.menuTitle,ur.marginAuto)}),f.jsx(Yl,{className:ur.inputWidth,fullWidth:!0,customValue:!0,value:T.text,size:"small",autoComplete:"off",label:I.I18n.t("search"),variant:"outlined",onChange:P=>{C({...T,text:P}),E(P)}})]})]})})};let t_=[];const VL=({code:o,onChange:n,themeName:s,themeType:i,theme:a,setTourStep:c,tourStep:h,isTourOpen:g,command:b,scriptId:$,changed:y,running:w})=>{var W;const{blocks:T,socket:C,setOnUpdate:E,setOnDebugMessage:k,setEnableSimulation:A}=ve.useContext(Gf),[P,N]=ve.useState([]),[B,S]=ve.useState(QS(o)),[H,q]=ve.useState(""),[se,ee]=ve.useState(!1);ve.useEffect(()=>{let te,ke;const Z=(at,he)=>{at===`${te}.alive`&&ke!==(he==null?void 0:he.val)&&(ke=!!(he!=null&&he.val),ke&&te&&(C==null||C.sendTo(te.replace(/^system\.adapter\./,""),"rulesOn",$)))},ze=(at,he)=>{var Ae,de;C&&te!==((Ae=he==null?void 0:he.common)==null?void 0:Ae.engine)&&(te&&(C.unsubscribeState(`${te}.alive`,Z),ke&&C.sendTo(te.replace(/^system\.adapter\./,""),"rulesOn",$)),te=(de=he==null?void 0:he.common)==null?void 0:de.engine,te&&te&&C.subscribeState(`${te}.alive`,Z))},Ce=(at,he)=>{if(he)try{const Ae=JSON.parse(he.val),de=Date.now();if(Ae.ruleId===$&&de-Ae.ts<1e3){const Se=[...t_,{blockId:Ae.blockId,data:Ae.data,ts:Ae.ts}];Se.length>200&&Se.splice(0,200-Se.length);for(let xe=Se.length-1;xe>=0;xe--)if(Se[xe].ts<de-5e3){Se.splice(0,xe);break}console.log(`Debug1: ${JSON.stringify(t_)}`),console.log(`Debug2: ${JSON.stringify(Se)}`),t_=Se,k(Se)}}catch{console.error(`Cannot parse: ${he.val}`)}};return C==null||C.getObject($).then(at=>{var he;te=(he=at==null?void 0:at.common)==null?void 0:he.engine,C.subscribeObject($,ze),te&&(C.subscribeState(`${te}.alive`,Z),C.subscribeState(`${te.replace(/^system\.adapter\./,"")}.debug.rules`,Ce))}),function(){C==null||C.unsubscribeState($,Z),te&&(C==null||C.unsubscribeObject(`${te}.alive`,ze),ke&&(C==null||C.sendTo(te.replace(/^system\.adapter\./,""),"rulesOff",$)),C==null||C.unsubscribeState(`${te.replace(/^system\.adapter\./,"")}.debug.rules`,Ce))}},[]),ve.useEffect(()=>{A(!y&&w)},[y,w,A]),ve.useEffect(()=>{b&&(q(b),se||ee(!0))},[b]),ve.useEffect(()=>{const te=QS(o);JSON.stringify(te)!==JSON.stringify(B)&&(S(te),E(!0))},[o]),ve.useEffect(()=>{document.getElementsByTagName("HTML")[0].className=s||"blue"},[s]);const K=ve.useCallback(te=>{S(te),T&&n(VN(te,T))},[T,n]),Y=ve.useRef(null),[X,ce]=ve.useState({835:!1,1035:!1});return ve.useEffect(()=>{Y.current&&(Y.current.clientWidth<=1035&&ce({835:!1,1035:!0}),Y.current.clientWidth<=835&&ce({1035:!0,835:!0}),Y.current.clientWidth>1035&&ce({835:!1,1035:!1}))},[((W=Y.current)==null?void 0:W.clientWidth)||0]),!T||!C?null:f.jsxs("div",{className:Vy.wrapperRules,ref:Y,children:[f.jsx(eL,{allBlocks:P,socket:C}),se?H==="export"?f.jsx(Ek,{scriptId:$,themeType:i,onClose:()=>ee(!1),text:JSON.stringify(B,null,2)}):f.jsx(Kv,{themeType:i,onClose:te=>{ee(!1),te&&K(JSON.parse(te))}}):null,f.jsxs("div",{className:I.Utils.clsx(Vy.rootWrapper,X[835]&&Vy.addClass),children:[f.jsx(HL,{setAllBlocks:N,allBlocks:P,userRules:B,onChangeBlocks:K,setTourStep:c,tourStep:h,addClass:X,isTourOpen:g}),f.jsx(e_,{socket:C,setUserRules:K,userRules:B,isTourOpen:g,setTourStep:c,tourStep:h,name:`${I.I18n.t("when")}...`,typeBlock:"triggers",iconName:"FlashOn",size:X[835],themeType:i,themeName:s,theme:a}),f.jsx(e_,{socket:C,setUserRules:K,isTourOpen:g,setTourStep:c,tourStep:h,userRules:B,name:`...${I.I18n.t("and")}...`,typeBlock:"conditions",iconName:"Help",nameAdditionally:I.I18n.t("or"),additionally:!0,border:!0,size:X[835],themeType:i,themeName:s,theme:a}),f.jsx(e_,{socket:C,setUserRules:K,isTourOpen:g,setTourStep:c,tourStep:h,userRules:B,name:`...${I.I18n.t("then")}`,typeBlock:"actions",iconName:"PlayForWork",nameAdditionally:I.I18n.t("else"),additionally:!0,size:X[835],themeType:i,themeName:s,theme:a})]})]},"rulesEditor")},GL={editorDiv:{height:"100%",width:"100%",overflow:"hidden",position:"relative"}};let KL=class extends We.Component{constructor(n){super(n),this.state={lines:(this.props.script||"").split(/\r\n|\n/)}}render(){return f.jsx("div",{style:GL.editorDiv,children:f.jsx(Gv,{triggerPrettier:1,name:this.props.scriptName,adapterName:this.props.adapterName,readOnly:!0,code:this.props.script||"",isDark:this.props.themeType==="dark",socket:this.props.socket,runningInstances:this.props.runningInstances,language:"javascript",breakpoints:this.props.breakpoints,location:this.props.paused?this.props.location:null,onToggleBreakpoint:n=>this.props.onToggleBreakpoint(n)},"scriptEditor2")},"scriptEditorDiv2")}};const o0=34,ao={logBox:{width:"100%",height:"100%",position:"relative",overflow:"hidden"},logBoxInner:o=>({display:"inline-block",color:o.palette.mode==="dark"?"white":"black",width:`calc(100% - ${o0}px)`,height:"100%",overflow:"auto",position:"relative",verticalAlign:"top"}),info:o=>({background:o.palette.mode==="dark"?"darkgrey":"lightgrey",color:(o.palette.mode==="dark","black")}),error:o=>({background:"#FF0000",color:o.palette.mode==="dark"?"black":"white"}),warn:o=>({background:"#FF8000",color:o.palette.mode==="dark"?"black":"white"}),debug:o=>({background:"gray",opacity:.8,color:o.palette.mode==="dark"?"black":"white"}),silly:o=>({background:"gray",opacity:.6,color:o.palette.mode==="dark"?"black":"white"}),table:{fontFamily:"monospace",width:"100%"},toolbox:{width:o0,height:"100%",boxShadow:"2px 0px 4px -1px rgba(0, 0, 0, 0.2), 4px 0px 5px 0px rgba(0, 0, 0, 0.14), 1px 0px 10px 0px rgba(0, 0, 0, 0.12)",display:"inline-block",verticalAlign:"top",overflow:"hidden"},trTime:{width:90},trSeverity:{width:40,fontWeight:"bold"},iconButtons:{width:32,height:32,padding:4}};function JL(o){let n,s=o.getHours();return s<10&&(s=`0${s.toString()}`),n=`${s}:`,s=o.getMinutes(),s<10&&(s=`0${s.toString()}`),n+=`${s}:`,s=o.getSeconds(),s<10&&(s=`0${s.toString()}`),n+=`${s}.`,s=o.getMilliseconds(),s<10?s=`00${s.toString()}`:s<100&&(s=`0${s.toString()}`),n+=s,n}let qL=class Wk extends We.Component{messagesEnd;constructor(n){super(n),this.state={goBottom:!0},this.messagesEnd=We.createRef()}static generateLine(n){return f.jsxs(D.Box,{component:"tr",sx:ao[n.severity],children:[f.jsx("td",{style:ao.trTime,children:JL(new Date(n.ts))}),f.jsx("td",{style:ao.trSeverity,children:n.severity}),f.jsx("td",{children:n.text})]},`tr_${n.ts}_${n.text.substring(n.text.length-10,n.text.length)}`)}renderLogList(n){return n!=null&&n.length?f.jsxs(D.Box,{sx:ao.logBoxInner,children:[f.jsx("table",{style:ao.table,children:f.jsx("tbody",{children:n.map(s=>Wk.generateLine(s))})},"logTable"),f.jsx("div",{ref:this.messagesEnd,style:{float:"left",clear:"both"}},"logScrollPoint")]},"logList"):f.jsx(D.Box,{sx:ao.logBoxInner,style:{paddingLeft:10},children:I.I18n.t("Log outputs")},"logList")}onCopy(){I.Utils.copyToClipboard(this.props.console.join(`
`))}scrollToBottom(){var n,s;(s=(n=this.messagesEnd)==null?void 0:n.current)==null||s.scrollIntoView({behavior:"smooth"})}componentDidUpdate(){this.state.goBottom&&this.scrollToBottom()}render(){const n=this.props.console;return f.jsxs("div",{style:ao.logBox,children:[f.jsxs("div",{style:ao.toolbox,children:[f.jsx(D.IconButton,{style:ao.iconButtons,onClick:()=>this.setState({goBottom:!this.state.goBottom}),color:this.state.goBottom?"secondary":void 0,size:"medium",children:f.jsx(F0,{})}),n!=null&&n.length?f.jsx(D.IconButton,{style:ao.iconButtons,onClick:()=>this.props.onClearAllLogs(),size:"medium",children:f.jsx(z0,{})}):null,n!=null&&n.length?f.jsx(D.IconButton,{style:ao.iconButtons,onClick:()=>this.onCopy(),size:"medium",children:f.jsx(nw,{})}):null]},"toolbox"),this.renderLogList(n)]})}};var Lw={exports:{}},YL=Lw.exports;(function(o,n){(function(s,i){o.exports=i(ve)})(YL,function(s){return function(i){var a={};function c(h){if(a[h])return a[h].exports;var g=a[h]={i:h,l:!1,exports:{}};return i[h].call(g.exports,g,g.exports,c),g.l=!0,g.exports}return c.m=i,c.c=a,c.d=function(h,g,b){c.o(h,g)||Object.defineProperty(h,g,{enumerable:!0,get:b})},c.r=function(h){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(h,"__esModule",{value:!0})},c.t=function(h,g){if(1&g&&(h=c(h)),8&g||4&g&&typeof h=="object"&&h&&h.__esModule)return h;var b=Object.create(null);if(c.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:h}),2&g&&typeof h!="string")for(var $ in h)c.d(b,$,function(y){return h[y]}.bind(null,$));return b},c.n=function(h){var g=h&&h.__esModule?function(){return h.default}:function(){return h};return c.d(g,"a",g),g},c.o=function(h,g){return Object.prototype.hasOwnProperty.call(h,g)},c.p="",c(c.s=48)}([function(i,a){i.exports=s},function(i,a){var c=i.exports={version:"2.6.12"};typeof __e=="number"&&(__e=c)},function(i,a,c){var h=c(26)("wks"),g=c(17),b=c(3).Symbol,$=typeof b=="function";(i.exports=function(y){return h[y]||(h[y]=$&&b[y]||($?b:g)("Symbol."+y))}).store=h},function(i,a){var c=i.exports=typeof window<"u"&&window.Math==Math?window:typeof self<"u"&&self.Math==Math?self:Function("return this")();typeof __g=="number"&&(__g=c)},function(i,a,c){i.exports=!c(8)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(i,a){var c={}.hasOwnProperty;i.exports=function(h,g){return c.call(h,g)}},function(i,a,c){var h=c(7),g=c(16);i.exports=c(4)?function(b,$,y){return h.f(b,$,g(1,y))}:function(b,$,y){return b[$]=y,b}},function(i,a,c){var h=c(10),g=c(35),b=c(23),$=Object.defineProperty;a.f=c(4)?Object.defineProperty:function(y,w,T){if(h(y),w=b(w,!0),h(T),g)try{return $(y,w,T)}catch{}if("get"in T||"set"in T)throw TypeError("Accessors not supported!");return"value"in T&&(y[w]=T.value),y}},function(i,a){i.exports=function(c){try{return!!c()}catch{return!0}}},function(i,a,c){var h=c(40),g=c(22);i.exports=function(b){return h(g(b))}},function(i,a,c){var h=c(11);i.exports=function(g){if(!h(g))throw TypeError(g+" is not an object!");return g}},function(i,a){i.exports=function(c){return typeof c=="object"?c!==null:typeof c=="function"}},function(i,a){i.exports={}},function(i,a,c){var h=c(39),g=c(27);i.exports=Object.keys||function(b){return h(b,g)}},function(i,a){i.exports=!0},function(i,a,c){var h=c(3),g=c(1),b=c(53),$=c(6),y=c(5),w=function(T,C,E){var k,A,P,N=T&w.F,B=T&w.G,S=T&w.S,H=T&w.P,q=T&w.B,se=T&w.W,ee=B?g:g[C]||(g[C]={}),K=ee.prototype,Y=B?h:S?h[C]:(h[C]||{}).prototype;for(k in B&&(E=C),E)(A=!N&&Y&&Y[k]!==void 0)&&y(ee,k)||(P=A?Y[k]:E[k],ee[k]=B&&typeof Y[k]!="function"?E[k]:q&&A?b(P,h):se&&Y[k]==P?function(X){var ce=function(W,te,ke){if(this instanceof X){switch(arguments.length){case 0:return new X;case 1:return new X(W);case 2:return new X(W,te)}return new X(W,te,ke)}return X.apply(this,arguments)};return ce.prototype=X.prototype,ce}(P):H&&typeof P=="function"?b(Function.call,P):P,H&&((ee.virtual||(ee.virtual={}))[k]=P,T&w.R&&K&&!K[k]&&$(K,k,P)))};w.F=1,w.G=2,w.S=4,w.P=8,w.B=16,w.W=32,w.U=64,w.R=128,i.exports=w},function(i,a){i.exports=function(c,h){return{enumerable:!(1&c),configurable:!(2&c),writable:!(4&c),value:h}}},function(i,a){var c=0,h=Math.random();i.exports=function(g){return"Symbol(".concat(g===void 0?"":g,")_",(++c+h).toString(36))}},function(i,a,c){var h=c(22);i.exports=function(g){return Object(h(g))}},function(i,a){a.f={}.propertyIsEnumerable},function(i,a,c){var h=c(52)(!0);c(34)(String,"String",function(g){this._t=String(g),this._i=0},function(){var g,b=this._t,$=this._i;return $>=b.length?{value:void 0,done:!0}:(g=h(b,$),this._i+=g.length,{value:g,done:!1})})},function(i,a){var c=Math.ceil,h=Math.floor;i.exports=function(g){return isNaN(g=+g)?0:(g>0?h:c)(g)}},function(i,a){i.exports=function(c){if(c==null)throw TypeError("Can't call method on  "+c);return c}},function(i,a,c){var h=c(11);i.exports=function(g,b){if(!h(g))return g;var $,y;if(b&&typeof($=g.toString)=="function"&&!h(y=$.call(g))||typeof($=g.valueOf)=="function"&&!h(y=$.call(g))||!b&&typeof($=g.toString)=="function"&&!h(y=$.call(g)))return y;throw TypeError("Can't convert object to primitive value")}},function(i,a){var c={}.toString;i.exports=function(h){return c.call(h).slice(8,-1)}},function(i,a,c){var h=c(26)("keys"),g=c(17);i.exports=function(b){return h[b]||(h[b]=g(b))}},function(i,a,c){var h=c(1),g=c(3),b=g["__core-js_shared__"]||(g["__core-js_shared__"]={});(i.exports=function($,y){return b[$]||(b[$]=y!==void 0?y:{})})("versions",[]).push({version:h.version,mode:c(14)?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},function(i,a){i.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(i,a,c){var h=c(7).f,g=c(5),b=c(2)("toStringTag");i.exports=function($,y,w){$&&!g($=w?$:$.prototype,b)&&h($,b,{configurable:!0,value:y})}},function(i,a,c){c(62);for(var h=c(3),g=c(6),b=c(12),$=c(2)("toStringTag"),y="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),w=0;w<y.length;w++){var T=y[w],C=h[T],E=C&&C.prototype;E&&!E[$]&&g(E,$,T),b[T]=b.Array}},function(i,a,c){a.f=c(2)},function(i,a,c){var h=c(3),g=c(1),b=c(14),$=c(30),y=c(7).f;i.exports=function(w){var T=g.Symbol||(g.Symbol=b?{}:h.Symbol||{});w.charAt(0)=="_"||w in T||y(T,w,{value:$.f(w)})}},function(i,a){a.f=Object.getOwnPropertySymbols},function(i,a){i.exports=function(c,h,g){return Math.min(Math.max(c,h),g)}},function(i,a,c){var h=c(14),g=c(15),b=c(37),$=c(6),y=c(12),w=c(55),T=c(28),C=c(61),E=c(2)("iterator"),k=!([].keys&&"next"in[].keys()),A=function(){return this};i.exports=function(P,N,B,S,H,q,se){w(B,N,S);var ee,K,Y,X=function(he){if(!k&&he in ke)return ke[he];switch(he){case"keys":case"values":return function(){return new B(this,he)}}return function(){return new B(this,he)}},ce=N+" Iterator",W=H=="values",te=!1,ke=P.prototype,Z=ke[E]||ke["@@iterator"]||H&&ke[H],ze=Z||X(H),Ce=H?W?X("entries"):ze:void 0,at=N=="Array"&&ke.entries||Z;if(at&&(Y=C(at.call(new P)))!==Object.prototype&&Y.next&&(T(Y,ce,!0),h||typeof Y[E]=="function"||$(Y,E,A)),W&&Z&&Z.name!=="values"&&(te=!0,ze=function(){return Z.call(this)}),h&&!se||!k&&!te&&ke[E]||$(ke,E,ze),y[N]=ze,y[ce]=A,H)if(ee={values:W?ze:X("values"),keys:q?ze:X("keys"),entries:Ce},se)for(K in ee)K in ke||b(ke,K,ee[K]);else g(g.P+g.F*(k||te),N,ee);return ee}},function(i,a,c){i.exports=!c(4)&&!c(8)(function(){return Object.defineProperty(c(36)("div"),"a",{get:function(){return 7}}).a!=7})},function(i,a,c){var h=c(11),g=c(3).document,b=h(g)&&h(g.createElement);i.exports=function($){return b?g.createElement($):{}}},function(i,a,c){i.exports=c(6)},function(i,a,c){var h=c(10),g=c(56),b=c(27),$=c(25)("IE_PROTO"),y=function(){},w=function(){var T,C=c(36)("iframe"),E=b.length;for(C.style.display="none",c(60).appendChild(C),C.src="javascript:",(T=C.contentWindow.document).open(),T.write("<script>document.F=Object<\/script>"),T.close(),w=T.F;E--;)delete w.prototype[b[E]];return w()};i.exports=Object.create||function(T,C){var E;return T!==null?(y.prototype=h(T),E=new y,y.prototype=null,E[$]=T):E=w(),C===void 0?E:g(E,C)}},function(i,a,c){var h=c(5),g=c(9),b=c(57)(!1),$=c(25)("IE_PROTO");i.exports=function(y,w){var T,C=g(y),E=0,k=[];for(T in C)T!=$&&h(C,T)&&k.push(T);for(;w.length>E;)h(C,T=w[E++])&&(~b(k,T)||k.push(T));return k}},function(i,a,c){var h=c(24);i.exports=Object("z").propertyIsEnumerable(0)?Object:function(g){return h(g)=="String"?g.split(""):Object(g)}},function(i,a,c){var h=c(39),g=c(27).concat("length","prototype");a.f=Object.getOwnPropertyNames||function(b){return h(b,g)}},function(i,a,c){var h=c(24),g=c(2)("toStringTag"),b=h(function(){return arguments}())=="Arguments";i.exports=function($){var y,w,T;return $===void 0?"Undefined":$===null?"Null":typeof(w=function(C,E){try{return C[E]}catch{}}(y=Object($),g))=="string"?w:b?h(y):(T=h(y))=="Object"&&typeof y.callee=="function"?"Arguments":T}},function(i,a){var c;c=function(){return this}();try{c=c||new Function("return this")()}catch{typeof window=="object"&&(c=window)}i.exports=c},function(i,a){var c=/-?\d+(\.\d+)?%?/g;i.exports=function(h){return h.match(c)}},function(i,a,c){Object.defineProperty(a,"__esModule",{value:!0}),a.getBase16Theme=a.createStyling=a.invertTheme=void 0;var h=A(c(49)),g=A(c(76)),b=A(c(81)),$=A(c(89)),y=A(c(93)),w=function(K){if(K&&K.__esModule)return K;var Y={};if(K!=null)for(var X in K)Object.prototype.hasOwnProperty.call(K,X)&&(Y[X]=K[X]);return Y.default=K,Y}(c(94)),T=A(c(132)),C=A(c(133)),E=A(c(138)),k=c(139);function A(K){return K&&K.__esModule?K:{default:K}}var P=w.default,N=(0,$.default)(P),B=(0,E.default)(C.default,k.rgb2yuv,function(K){var Y,X=(0,b.default)(K,3),ce=X[0],W=X[1],te=X[2];return[(Y=ce,Y<.25?1:Y<.5?.9-Y:1.1-Y),W,te]},k.yuv2rgb,T.default),S=function(K){return function(Y){return{className:[Y.className,K.className].filter(Boolean).join(" "),style:(0,g.default)({},Y.style||{},K.style||{})}}},H=function(K,Y){var X=(0,$.default)(Y);for(var ce in K)X.indexOf(ce)===-1&&X.push(ce);return X.reduce(function(W,te){return W[te]=function(ke,Z){if(ke===void 0)return Z;if(Z===void 0)return ke;var ze=ke===void 0?"undefined":(0,h.default)(ke),Ce=Z===void 0?"undefined":(0,h.default)(Z);switch(ze){case"string":switch(Ce){case"string":return[Z,ke].filter(Boolean).join(" ");case"object":return S({className:ke,style:Z});case"function":return function(at){for(var he=arguments.length,Ae=Array(he>1?he-1:0),de=1;de<he;de++)Ae[de-1]=arguments[de];return S({className:ke})(Z.apply(void 0,[at].concat(Ae)))}}case"object":switch(Ce){case"string":return S({className:Z,style:ke});case"object":return(0,g.default)({},Z,ke);case"function":return function(at){for(var he=arguments.length,Ae=Array(he>1?he-1:0),de=1;de<he;de++)Ae[de-1]=arguments[de];return S({style:ke})(Z.apply(void 0,[at].concat(Ae)))}}case"function":switch(Ce){case"string":return function(at){for(var he=arguments.length,Ae=Array(he>1?he-1:0),de=1;de<he;de++)Ae[de-1]=arguments[de];return ke.apply(void 0,[S(at)({className:Z})].concat(Ae))};case"object":return function(at){for(var he=arguments.length,Ae=Array(he>1?he-1:0),de=1;de<he;de++)Ae[de-1]=arguments[de];return ke.apply(void 0,[S(at)({style:Z})].concat(Ae))};case"function":return function(at){for(var he=arguments.length,Ae=Array(he>1?he-1:0),de=1;de<he;de++)Ae[de-1]=arguments[de];return ke.apply(void 0,[Z.apply(void 0,[at].concat(Ae))].concat(Ae))}}}}(K[te],Y[te]),W},{})},q=function(K,Y){for(var X=arguments.length,ce=Array(X>2?X-2:0),W=2;W<X;W++)ce[W-2]=arguments[W];if(Y===null)return K;Array.isArray(Y)||(Y=[Y]);var te=Y.map(function(Z){return K[Z]}).filter(Boolean),ke=te.reduce(function(Z,ze){return typeof ze=="string"?Z.className=[Z.className,ze].filter(Boolean).join(" "):(ze===void 0?"undefined":(0,h.default)(ze))==="object"?Z.style=(0,g.default)({},Z.style,ze):typeof ze=="function"&&(Z=(0,g.default)({},Z,ze.apply(void 0,[Z].concat(ce)))),Z},{className:"",style:{}});return ke.className||delete ke.className,(0,$.default)(ke.style).length===0&&delete ke.style,ke},se=a.invertTheme=function(K){return(0,$.default)(K).reduce(function(Y,X){return Y[X]=/^base/.test(X)?B(K[X]):X==="scheme"?K[X]+":inverted":K[X],Y},{})},ee=(a.createStyling=(0,y.default)(function(K){for(var Y=arguments.length,X=Array(Y>3?Y-3:0),ce=3;ce<Y;ce++)X[ce-3]=arguments[ce];var W=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},te=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},ke=W.defaultBase16,Z=ke===void 0?P:ke,ze=W.base16Themes,Ce=ze===void 0?null:ze,at=ee(te,Ce);at&&(te=(0,g.default)({},at,te));var he=N.reduce(function(xe,He){return xe[He]=te[He]||Z[He],xe},{}),Ae=(0,$.default)(te).reduce(function(xe,He){return N.indexOf(He)===-1&&(xe[He]=te[He]),xe},{}),de=K(he),Se=H(Ae,de);return(0,y.default)(q,2).apply(void 0,[Se].concat(X))},3),a.getBase16Theme=function(K,Y){if(K&&K.extend&&(K=K.extend),typeof K=="string"){var X=K.split(":"),ce=(0,b.default)(X,2),W=ce[0],te=ce[1];K=(Y||{})[W]||w[W],te==="inverted"&&(K=se(K))}return K&&K.hasOwnProperty("base00")?K:void 0})},function(i,a,c){var h,g=typeof Reflect=="object"?Reflect:null,b=g&&typeof g.apply=="function"?g.apply:function(S,H,q){return Function.prototype.apply.call(S,H,q)};h=g&&typeof g.ownKeys=="function"?g.ownKeys:Object.getOwnPropertySymbols?function(S){return Object.getOwnPropertyNames(S).concat(Object.getOwnPropertySymbols(S))}:function(S){return Object.getOwnPropertyNames(S)};var $=Number.isNaN||function(S){return S!=S};function y(){y.init.call(this)}i.exports=y,i.exports.once=function(S,H){return new Promise(function(q,se){function ee(){K!==void 0&&S.removeListener("error",K),q([].slice.call(arguments))}var K;H!=="error"&&(K=function(Y){S.removeListener(H,ee),se(Y)},S.once("error",K)),S.once(H,ee)})},y.EventEmitter=y,y.prototype._events=void 0,y.prototype._eventsCount=0,y.prototype._maxListeners=void 0;var w=10;function T(S){if(typeof S!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof S)}function C(S){return S._maxListeners===void 0?y.defaultMaxListeners:S._maxListeners}function E(S,H,q,se){var ee,K,Y,X;if(T(q),(K=S._events)===void 0?(K=S._events=Object.create(null),S._eventsCount=0):(K.newListener!==void 0&&(S.emit("newListener",H,q.listener?q.listener:q),K=S._events),Y=K[H]),Y===void 0)Y=K[H]=q,++S._eventsCount;else if(typeof Y=="function"?Y=K[H]=se?[q,Y]:[Y,q]:se?Y.unshift(q):Y.push(q),(ee=C(S))>0&&Y.length>ee&&!Y.warned){Y.warned=!0;var ce=new Error("Possible EventEmitter memory leak detected. "+Y.length+" "+String(H)+" listeners added. Use emitter.setMaxListeners() to increase limit");ce.name="MaxListenersExceededWarning",ce.emitter=S,ce.type=H,ce.count=Y.length,X=ce,console&&console.warn&&console.warn(X)}return S}function k(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function A(S,H,q){var se={fired:!1,wrapFn:void 0,target:S,type:H,listener:q},ee=k.bind(se);return ee.listener=q,se.wrapFn=ee,ee}function P(S,H,q){var se=S._events;if(se===void 0)return[];var ee=se[H];return ee===void 0?[]:typeof ee=="function"?q?[ee.listener||ee]:[ee]:q?function(K){for(var Y=new Array(K.length),X=0;X<Y.length;++X)Y[X]=K[X].listener||K[X];return Y}(ee):B(ee,ee.length)}function N(S){var H=this._events;if(H!==void 0){var q=H[S];if(typeof q=="function")return 1;if(q!==void 0)return q.length}return 0}function B(S,H){for(var q=new Array(H),se=0;se<H;++se)q[se]=S[se];return q}Object.defineProperty(y,"defaultMaxListeners",{enumerable:!0,get:function(){return w},set:function(S){if(typeof S!="number"||S<0||$(S))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+S+".");w=S}}),y.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},y.prototype.setMaxListeners=function(S){if(typeof S!="number"||S<0||$(S))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+S+".");return this._maxListeners=S,this},y.prototype.getMaxListeners=function(){return C(this)},y.prototype.emit=function(S){for(var H=[],q=1;q<arguments.length;q++)H.push(arguments[q]);var se=S==="error",ee=this._events;if(ee!==void 0)se=se&&ee.error===void 0;else if(!se)return!1;if(se){var K;if(H.length>0&&(K=H[0]),K instanceof Error)throw K;var Y=new Error("Unhandled error."+(K?" ("+K.message+")":""));throw Y.context=K,Y}var X=ee[S];if(X===void 0)return!1;if(typeof X=="function")b(X,this,H);else{var ce=X.length,W=B(X,ce);for(q=0;q<ce;++q)b(W[q],this,H)}return!0},y.prototype.addListener=function(S,H){return E(this,S,H,!1)},y.prototype.on=y.prototype.addListener,y.prototype.prependListener=function(S,H){return E(this,S,H,!0)},y.prototype.once=function(S,H){return T(H),this.on(S,A(this,S,H)),this},y.prototype.prependOnceListener=function(S,H){return T(H),this.prependListener(S,A(this,S,H)),this},y.prototype.removeListener=function(S,H){var q,se,ee,K,Y;if(T(H),(se=this._events)===void 0)return this;if((q=se[S])===void 0)return this;if(q===H||q.listener===H)--this._eventsCount==0?this._events=Object.create(null):(delete se[S],se.removeListener&&this.emit("removeListener",S,q.listener||H));else if(typeof q!="function"){for(ee=-1,K=q.length-1;K>=0;K--)if(q[K]===H||q[K].listener===H){Y=q[K].listener,ee=K;break}if(ee<0)return this;ee===0?q.shift():function(X,ce){for(;ce+1<X.length;ce++)X[ce]=X[ce+1];X.pop()}(q,ee),q.length===1&&(se[S]=q[0]),se.removeListener!==void 0&&this.emit("removeListener",S,Y||H)}return this},y.prototype.off=y.prototype.removeListener,y.prototype.removeAllListeners=function(S){var H,q,se;if((q=this._events)===void 0)return this;if(q.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):q[S]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete q[S]),this;if(arguments.length===0){var ee,K=Object.keys(q);for(se=0;se<K.length;++se)(ee=K[se])!=="removeListener"&&this.removeAllListeners(ee);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(H=q[S])=="function")this.removeListener(S,H);else if(H!==void 0)for(se=H.length-1;se>=0;se--)this.removeListener(S,H[se]);return this},y.prototype.listeners=function(S){return P(this,S,!0)},y.prototype.rawListeners=function(S){return P(this,S,!1)},y.listenerCount=function(S,H){return typeof S.listenerCount=="function"?S.listenerCount(H):N.call(S,H)},y.prototype.listenerCount=N,y.prototype.eventNames=function(){return this._eventsCount>0?h(this._events):[]}},function(i,a,c){i.exports.Dispatcher=c(140)},function(i,a,c){i.exports=c(142)},function(i,a,c){a.__esModule=!0;var h=$(c(50)),g=$(c(65)),b=typeof g.default=="function"&&typeof h.default=="symbol"?function(y){return typeof y}:function(y){return y&&typeof g.default=="function"&&y.constructor===g.default&&y!==g.default.prototype?"symbol":typeof y};function $(y){return y&&y.__esModule?y:{default:y}}a.default=typeof g.default=="function"&&b(h.default)==="symbol"?function(y){return y===void 0?"undefined":b(y)}:function(y){return y&&typeof g.default=="function"&&y.constructor===g.default&&y!==g.default.prototype?"symbol":y===void 0?"undefined":b(y)}},function(i,a,c){i.exports={default:c(51),__esModule:!0}},function(i,a,c){c(20),c(29),i.exports=c(30).f("iterator")},function(i,a,c){var h=c(21),g=c(22);i.exports=function(b){return function($,y){var w,T,C=String(g($)),E=h(y),k=C.length;return E<0||E>=k?b?"":void 0:(w=C.charCodeAt(E))<55296||w>56319||E+1===k||(T=C.charCodeAt(E+1))<56320||T>57343?b?C.charAt(E):w:b?C.slice(E,E+2):T-56320+(w-55296<<10)+65536}}},function(i,a,c){var h=c(54);i.exports=function(g,b,$){if(h(g),b===void 0)return g;switch($){case 1:return function(y){return g.call(b,y)};case 2:return function(y,w){return g.call(b,y,w)};case 3:return function(y,w,T){return g.call(b,y,w,T)}}return function(){return g.apply(b,arguments)}}},function(i,a){i.exports=function(c){if(typeof c!="function")throw TypeError(c+" is not a function!");return c}},function(i,a,c){var h=c(38),g=c(16),b=c(28),$={};c(6)($,c(2)("iterator"),function(){return this}),i.exports=function(y,w,T){y.prototype=h($,{next:g(1,T)}),b(y,w+" Iterator")}},function(i,a,c){var h=c(7),g=c(10),b=c(13);i.exports=c(4)?Object.defineProperties:function($,y){g($);for(var w,T=b(y),C=T.length,E=0;C>E;)h.f($,w=T[E++],y[w]);return $}},function(i,a,c){var h=c(9),g=c(58),b=c(59);i.exports=function($){return function(y,w,T){var C,E=h(y),k=g(E.length),A=b(T,k);if($&&w!=w){for(;k>A;)if((C=E[A++])!=C)return!0}else for(;k>A;A++)if(($||A in E)&&E[A]===w)return $||A||0;return!$&&-1}}},function(i,a,c){var h=c(21),g=Math.min;i.exports=function(b){return b>0?g(h(b),9007199254740991):0}},function(i,a,c){var h=c(21),g=Math.max,b=Math.min;i.exports=function($,y){return($=h($))<0?g($+y,0):b($,y)}},function(i,a,c){var h=c(3).document;i.exports=h&&h.documentElement},function(i,a,c){var h=c(5),g=c(18),b=c(25)("IE_PROTO"),$=Object.prototype;i.exports=Object.getPrototypeOf||function(y){return y=g(y),h(y,b)?y[b]:typeof y.constructor=="function"&&y instanceof y.constructor?y.constructor.prototype:y instanceof Object?$:null}},function(i,a,c){var h=c(63),g=c(64),b=c(12),$=c(9);i.exports=c(34)(Array,"Array",function(y,w){this._t=$(y),this._i=0,this._k=w},function(){var y=this._t,w=this._k,T=this._i++;return!y||T>=y.length?(this._t=void 0,g(1)):g(0,w=="keys"?T:w=="values"?y[T]:[T,y[T]])},"values"),b.Arguments=b.Array,h("keys"),h("values"),h("entries")},function(i,a){i.exports=function(){}},function(i,a){i.exports=function(c,h){return{value:h,done:!!c}}},function(i,a,c){i.exports={default:c(66),__esModule:!0}},function(i,a,c){c(67),c(73),c(74),c(75),i.exports=c(1).Symbol},function(i,a,c){var h=c(3),g=c(5),b=c(4),$=c(15),y=c(37),w=c(68).KEY,T=c(8),C=c(26),E=c(28),k=c(17),A=c(2),P=c(30),N=c(31),B=c(69),S=c(70),H=c(10),q=c(11),se=c(18),ee=c(9),K=c(23),Y=c(16),X=c(38),ce=c(71),W=c(72),te=c(32),ke=c(7),Z=c(13),ze=W.f,Ce=ke.f,at=ce.f,he=h.Symbol,Ae=h.JSON,de=Ae&&Ae.stringify,Se=A("_hidden"),xe=A("toPrimitive"),He={}.propertyIsEnumerable,ne=C("symbol-registry"),Ke=C("symbols"),Te=C("op-symbols"),Je=Object.prototype,rt=typeof he=="function"&&!!te.f,ht=h.QObject,nt=!ht||!ht.prototype||!ht.prototype.findChild,Wt=b&&T(function(){return X(Ce({},"a",{get:function(){return Ce(this,"a",{value:7}).a}})).a!=7})?function(ue,we,Ve){var re=ze(Je,we);re&&delete Je[we],Ce(ue,we,Ve),re&&ue!==Je&&Ce(Je,we,re)}:Ce,St=function(ue){var we=Ke[ue]=X(he.prototype);return we._k=ue,we},lt=rt&&typeof he.iterator=="symbol"?function(ue){return typeof ue=="symbol"}:function(ue){return ue instanceof he},ft=function(ue,we,Ve){return ue===Je&&ft(Te,we,Ve),H(ue),we=K(we,!0),H(Ve),g(Ke,we)?(Ve.enumerable?(g(ue,Se)&&ue[Se][we]&&(ue[Se][we]=!1),Ve=X(Ve,{enumerable:Y(0,!1)})):(g(ue,Se)||Ce(ue,Se,Y(1,{})),ue[Se][we]=!0),Wt(ue,we,Ve)):Ce(ue,we,Ve)},st=function(ue,we){H(ue);for(var Ve,re=B(we=ee(we)),Fe=0,It=re.length;It>Fe;)ft(ue,Ve=re[Fe++],we[Ve]);return ue},At=function(ue){var we=He.call(this,ue=K(ue,!0));return!(this===Je&&g(Ke,ue)&&!g(Te,ue))&&(!(we||!g(this,ue)||!g(Ke,ue)||g(this,Se)&&this[Se][ue])||we)},mn=function(ue,we){if(ue=ee(ue),we=K(we,!0),ue!==Je||!g(Ke,we)||g(Te,we)){var Ve=ze(ue,we);return!Ve||!g(Ke,we)||g(ue,Se)&&ue[Se][we]||(Ve.enumerable=!0),Ve}},Ue=function(ue){for(var we,Ve=at(ee(ue)),re=[],Fe=0;Ve.length>Fe;)g(Ke,we=Ve[Fe++])||we==Se||we==w||re.push(we);return re},Nt=function(ue){for(var we,Ve=ue===Je,re=at(Ve?Te:ee(ue)),Fe=[],It=0;re.length>It;)!g(Ke,we=re[It++])||Ve&&!g(Je,we)||Fe.push(Ke[we]);return Fe};rt||(y((he=function(){if(this instanceof he)throw TypeError("Symbol is not a constructor!");var ue=k(arguments.length>0?arguments[0]:void 0),we=function(Ve){this===Je&&we.call(Te,Ve),g(this,Se)&&g(this[Se],ue)&&(this[Se][ue]=!1),Wt(this,ue,Y(1,Ve))};return b&&nt&&Wt(Je,ue,{configurable:!0,set:we}),St(ue)}).prototype,"toString",function(){return this._k}),W.f=mn,ke.f=ft,c(41).f=ce.f=Ue,c(19).f=At,te.f=Nt,b&&!c(14)&&y(Je,"propertyIsEnumerable",At,!0),P.f=function(ue){return St(A(ue))}),$($.G+$.W+$.F*!rt,{Symbol:he});for(var wt="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),qt=0;wt.length>qt;)A(wt[qt++]);for(var ct=Z(A.store),me=0;ct.length>me;)N(ct[me++]);$($.S+$.F*!rt,"Symbol",{for:function(ue){return g(ne,ue+="")?ne[ue]:ne[ue]=he(ue)},keyFor:function(ue){if(!lt(ue))throw TypeError(ue+" is not a symbol!");for(var we in ne)if(ne[we]===ue)return we},useSetter:function(){nt=!0},useSimple:function(){nt=!1}}),$($.S+$.F*!rt,"Object",{create:function(ue,we){return we===void 0?X(ue):st(X(ue),we)},defineProperty:ft,defineProperties:st,getOwnPropertyDescriptor:mn,getOwnPropertyNames:Ue,getOwnPropertySymbols:Nt});var ge=T(function(){te.f(1)});$($.S+$.F*ge,"Object",{getOwnPropertySymbols:function(ue){return te.f(se(ue))}}),Ae&&$($.S+$.F*(!rt||T(function(){var ue=he();return de([ue])!="[null]"||de({a:ue})!="{}"||de(Object(ue))!="{}"})),"JSON",{stringify:function(ue){for(var we,Ve,re=[ue],Fe=1;arguments.length>Fe;)re.push(arguments[Fe++]);if(Ve=we=re[1],(q(we)||ue!==void 0)&&!lt(ue))return S(we)||(we=function(It,pt){if(typeof Ve=="function"&&(pt=Ve.call(this,It,pt)),!lt(pt))return pt}),re[1]=we,de.apply(Ae,re)}}),he.prototype[xe]||c(6)(he.prototype,xe,he.prototype.valueOf),E(he,"Symbol"),E(Math,"Math",!0),E(h.JSON,"JSON",!0)},function(i,a,c){var h=c(17)("meta"),g=c(11),b=c(5),$=c(7).f,y=0,w=Object.isExtensible||function(){return!0},T=!c(8)(function(){return w(Object.preventExtensions({}))}),C=function(k){$(k,h,{value:{i:"O"+ ++y,w:{}}})},E=i.exports={KEY:h,NEED:!1,fastKey:function(k,A){if(!g(k))return typeof k=="symbol"?k:(typeof k=="string"?"S":"P")+k;if(!b(k,h)){if(!w(k))return"F";if(!A)return"E";C(k)}return k[h].i},getWeak:function(k,A){if(!b(k,h)){if(!w(k))return!0;if(!A)return!1;C(k)}return k[h].w},onFreeze:function(k){return T&&E.NEED&&w(k)&&!b(k,h)&&C(k),k}}},function(i,a,c){var h=c(13),g=c(32),b=c(19);i.exports=function($){var y=h($),w=g.f;if(w)for(var T,C=w($),E=b.f,k=0;C.length>k;)E.call($,T=C[k++])&&y.push(T);return y}},function(i,a,c){var h=c(24);i.exports=Array.isArray||function(g){return h(g)=="Array"}},function(i,a,c){var h=c(9),g=c(41).f,b={}.toString,$=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];i.exports.f=function(y){return $&&b.call(y)=="[object Window]"?function(w){try{return g(w)}catch{return $.slice()}}(y):g(h(y))}},function(i,a,c){var h=c(19),g=c(16),b=c(9),$=c(23),y=c(5),w=c(35),T=Object.getOwnPropertyDescriptor;a.f=c(4)?T:function(C,E){if(C=b(C),E=$(E,!0),w)try{return T(C,E)}catch{}if(y(C,E))return g(!h.f.call(C,E),C[E])}},function(i,a){},function(i,a,c){c(31)("asyncIterator")},function(i,a,c){c(31)("observable")},function(i,a,c){a.__esModule=!0;var h,g=c(77),b=(h=g)&&h.__esModule?h:{default:h};a.default=b.default||function($){for(var y=1;y<arguments.length;y++){var w=arguments[y];for(var T in w)Object.prototype.hasOwnProperty.call(w,T)&&($[T]=w[T])}return $}},function(i,a,c){i.exports={default:c(78),__esModule:!0}},function(i,a,c){c(79),i.exports=c(1).Object.assign},function(i,a,c){var h=c(15);h(h.S+h.F,"Object",{assign:c(80)})},function(i,a,c){var h=c(4),g=c(13),b=c(32),$=c(19),y=c(18),w=c(40),T=Object.assign;i.exports=!T||c(8)(function(){var C={},E={},k=Symbol(),A="abcdefghijklmnopqrst";return C[k]=7,A.split("").forEach(function(P){E[P]=P}),T({},C)[k]!=7||Object.keys(T({},E)).join("")!=A})?function(C,E){for(var k=y(C),A=arguments.length,P=1,N=b.f,B=$.f;A>P;)for(var S,H=w(arguments[P++]),q=N?g(H).concat(N(H)):g(H),se=q.length,ee=0;se>ee;)S=q[ee++],h&&!B.call(H,S)||(k[S]=H[S]);return k}:T},function(i,a,c){a.__esModule=!0;var h=b(c(82)),g=b(c(85));function b($){return $&&$.__esModule?$:{default:$}}a.default=function($,y){if(Array.isArray($))return $;if((0,h.default)(Object($)))return function(w,T){var C=[],E=!0,k=!1,A=void 0;try{for(var P,N=(0,g.default)(w);!(E=(P=N.next()).done)&&(C.push(P.value),!T||C.length!==T);E=!0);}catch(B){k=!0,A=B}finally{try{!E&&N.return&&N.return()}finally{if(k)throw A}}return C}($,y);throw new TypeError("Invalid attempt to destructure non-iterable instance")}},function(i,a,c){i.exports={default:c(83),__esModule:!0}},function(i,a,c){c(29),c(20),i.exports=c(84)},function(i,a,c){var h=c(42),g=c(2)("iterator"),b=c(12);i.exports=c(1).isIterable=function($){var y=Object($);return y[g]!==void 0||"@@iterator"in y||b.hasOwnProperty(h(y))}},function(i,a,c){i.exports={default:c(86),__esModule:!0}},function(i,a,c){c(29),c(20),i.exports=c(87)},function(i,a,c){var h=c(10),g=c(88);i.exports=c(1).getIterator=function(b){var $=g(b);if(typeof $!="function")throw TypeError(b+" is not iterable!");return h($.call(b))}},function(i,a,c){var h=c(42),g=c(2)("iterator"),b=c(12);i.exports=c(1).getIteratorMethod=function($){if($!=null)return $[g]||$["@@iterator"]||b[h($)]}},function(i,a,c){i.exports={default:c(90),__esModule:!0}},function(i,a,c){c(91),i.exports=c(1).Object.keys},function(i,a,c){var h=c(18),g=c(13);c(92)("keys",function(){return function(b){return g(h(b))}})},function(i,a,c){var h=c(15),g=c(1),b=c(8);i.exports=function($,y){var w=(g.Object||{})[$]||Object[$],T={};T[$]=y(w),h(h.S+h.F*b(function(){w(1)}),"Object",T)}},function(i,a,c){(function(h){var g=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],b=/^\s+|\s+$/g,$=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,y=/\{\n\/\* \[wrapped with (.+)\] \*/,w=/,? & /,T=/^[-+]0x[0-9a-f]+$/i,C=/^0b[01]+$/i,E=/^\[object .+?Constructor\]$/,k=/^0o[0-7]+$/i,A=/^(?:0|[1-9]\d*)$/,P=parseInt,N=typeof h=="object"&&h&&h.Object===Object&&h,B=typeof self=="object"&&self&&self.Object===Object&&self,S=N||B||Function("return this")();function H(me,ge,ue){switch(ue.length){case 0:return me.call(ge);case 1:return me.call(ge,ue[0]);case 2:return me.call(ge,ue[0],ue[1]);case 3:return me.call(ge,ue[0],ue[1],ue[2])}return me.apply(ge,ue)}function q(me,ge){return!!(me&&me.length)&&function(ue,we,Ve){if(we!=we)return function(It,pt,En,mt){for(var Cn=It.length,$n=En+-1;++$n<Cn;)if(pt(It[$n],$n,It))return $n;return-1}(ue,se,Ve);for(var re=Ve-1,Fe=ue.length;++re<Fe;)if(ue[re]===we)return re;return-1}(me,ge,0)>-1}function se(me){return me!=me}function ee(me,ge){for(var ue=me.length,we=0;ue--;)me[ue]===ge&&we++;return we}function K(me,ge){for(var ue=-1,we=me.length,Ve=0,re=[];++ue<we;){var Fe=me[ue];Fe!==ge&&Fe!=="__lodash_placeholder__"||(me[ue]="__lodash_placeholder__",re[Ve++]=ue)}return re}var Y,X,ce,W=Function.prototype,te=Object.prototype,ke=S["__core-js_shared__"],Z=(Y=/[^.]+$/.exec(ke&&ke.keys&&ke.keys.IE_PROTO||""))?"Symbol(src)_1."+Y:"",ze=W.toString,Ce=te.hasOwnProperty,at=te.toString,he=RegExp("^"+ze.call(Ce).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ae=Object.create,de=Math.max,Se=Math.min,xe=(X=St(Object,"defineProperty"),(ce=St.name)&&ce.length>2?X:void 0);function He(me){return wt(me)?Ae(me):{}}function ne(me){return!(!wt(me)||function(ge){return!!Z&&Z in ge}(me))&&(function(ge){var ue=wt(ge)?at.call(ge):"";return ue=="[object Function]"||ue=="[object GeneratorFunction]"}(me)||function(ge){var ue=!1;if(ge!=null&&typeof ge.toString!="function")try{ue=!!(ge+"")}catch{}return ue}(me)?he:E).test(function(ge){if(ge!=null){try{return ze.call(ge)}catch{}try{return ge+""}catch{}}return""}(me))}function Ke(me,ge,ue,we){for(var Ve=-1,re=me.length,Fe=ue.length,It=-1,pt=ge.length,En=de(re-Fe,0),mt=Array(pt+En),Cn=!we;++It<pt;)mt[It]=ge[It];for(;++Ve<Fe;)(Cn||Ve<re)&&(mt[ue[Ve]]=me[Ve]);for(;En--;)mt[It++]=me[Ve++];return mt}function Te(me,ge,ue,we){for(var Ve=-1,re=me.length,Fe=-1,It=ue.length,pt=-1,En=ge.length,mt=de(re-It,0),Cn=Array(mt+En),$n=!we;++Ve<mt;)Cn[Ve]=me[Ve];for(var zn=Ve;++pt<En;)Cn[zn+pt]=ge[pt];for(;++Fe<It;)($n||Ve<re)&&(Cn[zn+ue[Fe]]=me[Ve++]);return Cn}function Je(me){return function(){var ge=arguments;switch(ge.length){case 0:return new me;case 1:return new me(ge[0]);case 2:return new me(ge[0],ge[1]);case 3:return new me(ge[0],ge[1],ge[2]);case 4:return new me(ge[0],ge[1],ge[2],ge[3]);case 5:return new me(ge[0],ge[1],ge[2],ge[3],ge[4]);case 6:return new me(ge[0],ge[1],ge[2],ge[3],ge[4],ge[5]);case 7:return new me(ge[0],ge[1],ge[2],ge[3],ge[4],ge[5],ge[6])}var ue=He(me.prototype),we=me.apply(ue,ge);return wt(we)?we:ue}}function rt(me,ge,ue,we,Ve,re,Fe,It,pt,En){var mt=128&ge,Cn=1&ge,$n=2&ge,zn=24&ge,Jn=512&ge,Gs=$n?void 0:Je(me);return function ns(){for(var Rn=arguments.length,Kt=Array(Rn),Pn=Rn;Pn--;)Kt[Pn]=arguments[Pn];if(zn)var cs=Wt(ns),Ks=ee(Kt,cs);if(we&&(Kt=Ke(Kt,we,Ve,zn)),re&&(Kt=Te(Kt,re,Fe,zn)),Rn-=Ks,zn&&Rn<En){var jn=K(Kt,cs);return ht(me,ge,rt,ns.placeholder,ue,Kt,jn,It,pt,En-Rn)}var Un=Cn?ue:this,Rs=$n?Un[me]:me;return Rn=Kt.length,It?Kt=At(Kt,It):Jn&&Rn>1&&Kt.reverse(),mt&&pt<Rn&&(Kt.length=pt),this&&this!==S&&this instanceof ns&&(Rs=Gs||Je(Rs)),Rs.apply(Un,Kt)}}function ht(me,ge,ue,we,Ve,re,Fe,It,pt,En){var mt=8&ge;ge|=mt?32:64,4&(ge&=~(mt?64:32))||(ge&=-4);var Cn=ue(me,ge,Ve,mt?re:void 0,mt?Fe:void 0,mt?void 0:re,mt?void 0:Fe,It,pt,En);return Cn.placeholder=we,mn(Cn,me,ge)}function nt(me,ge,ue,we,Ve,re,Fe,It){var pt=2&ge;if(!pt&&typeof me!="function")throw new TypeError("Expected a function");var En=we?we.length:0;if(En||(ge&=-97,we=Ve=void 0),Fe=Fe===void 0?Fe:de(ct(Fe),0),It=It===void 0?It:ct(It),En-=Ve?Ve.length:0,64&ge){var mt=we,Cn=Ve;we=Ve=void 0}var $n=[me,ge,ue,we,Ve,mt,Cn,re,Fe,It];if(me=$n[0],ge=$n[1],ue=$n[2],we=$n[3],Ve=$n[4],!(It=$n[9]=$n[9]==null?pt?0:me.length:de($n[9]-En,0))&&24&ge&&(ge&=-25),ge&&ge!=1)zn=ge==8||ge==16?function(Jn,Gs,ns){var Rn=Je(Jn);return function Kt(){for(var Pn=arguments.length,cs=Array(Pn),Ks=Pn,jn=Wt(Kt);Ks--;)cs[Ks]=arguments[Ks];var Un=Pn<3&&cs[0]!==jn&&cs[Pn-1]!==jn?[]:K(cs,jn);if((Pn-=Un.length)<ns)return ht(Jn,Gs,rt,Kt.placeholder,void 0,cs,Un,void 0,void 0,ns-Pn);var Rs=this&&this!==S&&this instanceof Kt?Rn:Jn;return H(Rs,this,cs)}}(me,ge,It):ge!=32&&ge!=33||Ve.length?rt.apply(void 0,$n):function(Jn,Gs,ns,Rn){var Kt=1&Gs,Pn=Je(Jn);return function cs(){for(var Ks=-1,jn=arguments.length,Un=-1,Rs=Rn.length,ii=Array(Rs+jn),Ir=this&&this!==S&&this instanceof cs?Pn:Jn;++Un<Rs;)ii[Un]=Rn[Un];for(;jn--;)ii[Un++]=arguments[++Ks];return H(Ir,Kt?ns:this,ii)}}(me,ge,ue,we);else var zn=function(Jn,Gs,ns){var Rn=1&Gs,Kt=Je(Jn);return function Pn(){var cs=this&&this!==S&&this instanceof Pn?Kt:Jn;return cs.apply(Rn?ns:this,arguments)}}(me,ge,ue);return mn(zn,me,ge)}function Wt(me){return me.placeholder}function St(me,ge){var ue=function(we,Ve){return we==null?void 0:we[Ve]}(me,ge);return ne(ue)?ue:void 0}function lt(me){var ge=me.match(y);return ge?ge[1].split(w):[]}function ft(me,ge){var ue=ge.length,we=ue-1;return ge[we]=(ue>1?"& ":"")+ge[we],ge=ge.join(ue>2?", ":" "),me.replace($,`{
/* [wrapped with `+ge+`] */
`)}function st(me,ge){return!!(ge=ge??9007199254740991)&&(typeof me=="number"||A.test(me))&&me>-1&&me%1==0&&me<ge}function At(me,ge){for(var ue=me.length,we=Se(ge.length,ue),Ve=function(Fe,It){var pt=-1,En=Fe.length;for(It||(It=Array(En));++pt<En;)It[pt]=Fe[pt];return It}(me);we--;){var re=ge[we];me[we]=st(re,ue)?Ve[re]:void 0}return me}var mn=xe?function(me,ge,ue){var we,Ve=ge+"";return xe(me,"toString",{configurable:!0,enumerable:!1,value:(we=ft(Ve,Ue(lt(Ve),ue)),function(){return we})})}:function(me){return me};function Ue(me,ge){return function(ue,we){for(var Ve=-1,re=ue?ue.length:0;++Ve<re&&we(ue[Ve],Ve,ue)!==!1;);}(g,function(ue){var we="_."+ue[0];ge&ue[1]&&!q(me,we)&&me.push(we)}),me.sort()}function Nt(me,ge,ue){var we=nt(me,8,void 0,void 0,void 0,void 0,void 0,ge=ue?void 0:ge);return we.placeholder=Nt.placeholder,we}function wt(me){var ge=typeof me;return!!me&&(ge=="object"||ge=="function")}function qt(me){return me?(me=function(ge){if(typeof ge=="number")return ge;if(function(Ve){return typeof Ve=="symbol"||function(re){return!!re&&typeof re=="object"}(Ve)&&at.call(Ve)=="[object Symbol]"}(ge))return NaN;if(wt(ge)){var ue=typeof ge.valueOf=="function"?ge.valueOf():ge;ge=wt(ue)?ue+"":ue}if(typeof ge!="string")return ge===0?ge:+ge;ge=ge.replace(b,"");var we=C.test(ge);return we||k.test(ge)?P(ge.slice(2),we?2:8):T.test(ge)?NaN:+ge}(me))===1/0||me===-1/0?17976931348623157e292*(me<0?-1:1):me==me?me:0:me===0?me:0}function ct(me){var ge=qt(me),ue=ge%1;return ge==ge?ue?ge-ue:ge:0}Nt.placeholder={},i.exports=Nt}).call(this,c(43))},function(i,a,c){function h(Te){return Te&&Te.__esModule?Te.default:Te}a.__esModule=!0;var g=c(95);a.threezerotwofour=h(g);var b=c(96);a.apathy=h(b);var $=c(97);a.ashes=h($);var y=c(98);a.atelierDune=h(y);var w=c(99);a.atelierForest=h(w);var T=c(100);a.atelierHeath=h(T);var C=c(101);a.atelierLakeside=h(C);var E=c(102);a.atelierSeaside=h(E);var k=c(103);a.bespin=h(k);var A=c(104);a.brewer=h(A);var P=c(105);a.bright=h(P);var N=c(106);a.chalk=h(N);var B=c(107);a.codeschool=h(B);var S=c(108);a.colors=h(S);var H=c(109);a.default=h(H);var q=c(110);a.eighties=h(q);var se=c(111);a.embers=h(se);var ee=c(112);a.flat=h(ee);var K=c(113);a.google=h(K);var Y=c(114);a.grayscale=h(Y);var X=c(115);a.greenscreen=h(X);var ce=c(116);a.harmonic=h(ce);var W=c(117);a.hopscotch=h(W);var te=c(118);a.isotope=h(te);var ke=c(119);a.marrakesh=h(ke);var Z=c(120);a.mocha=h(Z);var ze=c(121);a.monokai=h(ze);var Ce=c(122);a.ocean=h(Ce);var at=c(123);a.paraiso=h(at);var he=c(124);a.pop=h(he);var Ae=c(125);a.railscasts=h(Ae);var de=c(126);a.shapeshifter=h(de);var Se=c(127);a.solarized=h(Se);var xe=c(128);a.summerfruit=h(xe);var He=c(129);a.tomorrow=h(He);var ne=c(130);a.tube=h(ne);var Ke=c(131);a.twilight=h(Ke)},function(i,a,c){a.__esModule=!0,a.default={scheme:"threezerotwofour",author:"jan t. sott (http://github.com/idleberg)",base00:"#090300",base01:"#3a3432",base02:"#4a4543",base03:"#5c5855",base04:"#807d7c",base05:"#a5a2a2",base06:"#d6d5d4",base07:"#f7f7f7",base08:"#db2d20",base09:"#e8bbd0",base0A:"#fded02",base0B:"#01a252",base0C:"#b5e4f4",base0D:"#01a0e4",base0E:"#a16a94",base0F:"#cdab53"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"apathy",author:"jannik siebert (https://github.com/janniks)",base00:"#031A16",base01:"#0B342D",base02:"#184E45",base03:"#2B685E",base04:"#5F9C92",base05:"#81B5AC",base06:"#A7CEC8",base07:"#D2E7E4",base08:"#3E9688",base09:"#3E7996",base0A:"#3E4C96",base0B:"#883E96",base0C:"#963E4C",base0D:"#96883E",base0E:"#4C963E",base0F:"#3E965B"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"ashes",author:"jannik siebert (https://github.com/janniks)",base00:"#1C2023",base01:"#393F45",base02:"#565E65",base03:"#747C84",base04:"#ADB3BA",base05:"#C7CCD1",base06:"#DFE2E5",base07:"#F3F4F5",base08:"#C7AE95",base09:"#C7C795",base0A:"#AEC795",base0B:"#95C7AE",base0C:"#95AEC7",base0D:"#AE95C7",base0E:"#C795AE",base0F:"#C79595"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"atelier dune",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/dune)",base00:"#20201d",base01:"#292824",base02:"#6e6b5e",base03:"#7d7a68",base04:"#999580",base05:"#a6a28c",base06:"#e8e4cf",base07:"#fefbec",base08:"#d73737",base09:"#b65611",base0A:"#cfb017",base0B:"#60ac39",base0C:"#1fad83",base0D:"#6684e1",base0E:"#b854d4",base0F:"#d43552"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"atelier forest",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/forest)",base00:"#1b1918",base01:"#2c2421",base02:"#68615e",base03:"#766e6b",base04:"#9c9491",base05:"#a8a19f",base06:"#e6e2e0",base07:"#f1efee",base08:"#f22c40",base09:"#df5320",base0A:"#d5911a",base0B:"#5ab738",base0C:"#00ad9c",base0D:"#407ee7",base0E:"#6666ea",base0F:"#c33ff3"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"atelier heath",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/heath)",base00:"#1b181b",base01:"#292329",base02:"#695d69",base03:"#776977",base04:"#9e8f9e",base05:"#ab9bab",base06:"#d8cad8",base07:"#f7f3f7",base08:"#ca402b",base09:"#a65926",base0A:"#bb8a35",base0B:"#379a37",base0C:"#159393",base0D:"#516aec",base0E:"#7b59c0",base0F:"#cc33cc"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"atelier lakeside",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/lakeside/)",base00:"#161b1d",base01:"#1f292e",base02:"#516d7b",base03:"#5a7b8c",base04:"#7195a8",base05:"#7ea2b4",base06:"#c1e4f6",base07:"#ebf8ff",base08:"#d22d72",base09:"#935c25",base0A:"#8a8a0f",base0B:"#568c3b",base0C:"#2d8f6f",base0D:"#257fad",base0E:"#5d5db1",base0F:"#b72dd2"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"atelier seaside",author:"bram de haan (http://atelierbram.github.io/syntax-highlighting/atelier-schemes/seaside/)",base00:"#131513",base01:"#242924",base02:"#5e6e5e",base03:"#687d68",base04:"#809980",base05:"#8ca68c",base06:"#cfe8cf",base07:"#f0fff0",base08:"#e6193c",base09:"#87711d",base0A:"#c3c322",base0B:"#29a329",base0C:"#1999b3",base0D:"#3d62f5",base0E:"#ad2bee",base0F:"#e619c3"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"bespin",author:"jan t. sott",base00:"#28211c",base01:"#36312e",base02:"#5e5d5c",base03:"#666666",base04:"#797977",base05:"#8a8986",base06:"#9d9b97",base07:"#baae9e",base08:"#cf6a4c",base09:"#cf7d34",base0A:"#f9ee98",base0B:"#54be0d",base0C:"#afc4db",base0D:"#5ea6ea",base0E:"#9b859d",base0F:"#937121"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"brewer",author:"timothe poisot (http://github.com/tpoisot)",base00:"#0c0d0e",base01:"#2e2f30",base02:"#515253",base03:"#737475",base04:"#959697",base05:"#b7b8b9",base06:"#dadbdc",base07:"#fcfdfe",base08:"#e31a1c",base09:"#e6550d",base0A:"#dca060",base0B:"#31a354",base0C:"#80b1d3",base0D:"#3182bd",base0E:"#756bb1",base0F:"#b15928"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"bright",author:"chris kempson (http://chriskempson.com)",base00:"#000000",base01:"#303030",base02:"#505050",base03:"#b0b0b0",base04:"#d0d0d0",base05:"#e0e0e0",base06:"#f5f5f5",base07:"#ffffff",base08:"#fb0120",base09:"#fc6d24",base0A:"#fda331",base0B:"#a1c659",base0C:"#76c7b7",base0D:"#6fb3d2",base0E:"#d381c3",base0F:"#be643c"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"chalk",author:"chris kempson (http://chriskempson.com)",base00:"#151515",base01:"#202020",base02:"#303030",base03:"#505050",base04:"#b0b0b0",base05:"#d0d0d0",base06:"#e0e0e0",base07:"#f5f5f5",base08:"#fb9fb1",base09:"#eda987",base0A:"#ddb26f",base0B:"#acc267",base0C:"#12cfc0",base0D:"#6fc2ef",base0E:"#e1a3ee",base0F:"#deaf8f"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"codeschool",author:"brettof86",base00:"#232c31",base01:"#1c3657",base02:"#2a343a",base03:"#3f4944",base04:"#84898c",base05:"#9ea7a6",base06:"#a7cfa3",base07:"#b5d8f6",base08:"#2a5491",base09:"#43820d",base0A:"#a03b1e",base0B:"#237986",base0C:"#b02f30",base0D:"#484d79",base0E:"#c59820",base0F:"#c98344"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"colors",author:"mrmrs (http://clrs.cc)",base00:"#111111",base01:"#333333",base02:"#555555",base03:"#777777",base04:"#999999",base05:"#bbbbbb",base06:"#dddddd",base07:"#ffffff",base08:"#ff4136",base09:"#ff851b",base0A:"#ffdc00",base0B:"#2ecc40",base0C:"#7fdbff",base0D:"#0074d9",base0E:"#b10dc9",base0F:"#85144b"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"default",author:"chris kempson (http://chriskempson.com)",base00:"#181818",base01:"#282828",base02:"#383838",base03:"#585858",base04:"#b8b8b8",base05:"#d8d8d8",base06:"#e8e8e8",base07:"#f8f8f8",base08:"#ab4642",base09:"#dc9656",base0A:"#f7ca88",base0B:"#a1b56c",base0C:"#86c1b9",base0D:"#7cafc2",base0E:"#ba8baf",base0F:"#a16946"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"eighties",author:"chris kempson (http://chriskempson.com)",base00:"#2d2d2d",base01:"#393939",base02:"#515151",base03:"#747369",base04:"#a09f93",base05:"#d3d0c8",base06:"#e8e6df",base07:"#f2f0ec",base08:"#f2777a",base09:"#f99157",base0A:"#ffcc66",base0B:"#99cc99",base0C:"#66cccc",base0D:"#6699cc",base0E:"#cc99cc",base0F:"#d27b53"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"embers",author:"jannik siebert (https://github.com/janniks)",base00:"#16130F",base01:"#2C2620",base02:"#433B32",base03:"#5A5047",base04:"#8A8075",base05:"#A39A90",base06:"#BEB6AE",base07:"#DBD6D1",base08:"#826D57",base09:"#828257",base0A:"#6D8257",base0B:"#57826D",base0C:"#576D82",base0D:"#6D5782",base0E:"#82576D",base0F:"#825757"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"flat",author:"chris kempson (http://chriskempson.com)",base00:"#2C3E50",base01:"#34495E",base02:"#7F8C8D",base03:"#95A5A6",base04:"#BDC3C7",base05:"#e0e0e0",base06:"#f5f5f5",base07:"#ECF0F1",base08:"#E74C3C",base09:"#E67E22",base0A:"#F1C40F",base0B:"#2ECC71",base0C:"#1ABC9C",base0D:"#3498DB",base0E:"#9B59B6",base0F:"#be643c"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"google",author:"seth wright (http://sethawright.com)",base00:"#1d1f21",base01:"#282a2e",base02:"#373b41",base03:"#969896",base04:"#b4b7b4",base05:"#c5c8c6",base06:"#e0e0e0",base07:"#ffffff",base08:"#CC342B",base09:"#F96A38",base0A:"#FBA922",base0B:"#198844",base0C:"#3971ED",base0D:"#3971ED",base0E:"#A36AC7",base0F:"#3971ED"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"grayscale",author:"alexandre gavioli (https://github.com/alexx2/)",base00:"#101010",base01:"#252525",base02:"#464646",base03:"#525252",base04:"#ababab",base05:"#b9b9b9",base06:"#e3e3e3",base07:"#f7f7f7",base08:"#7c7c7c",base09:"#999999",base0A:"#a0a0a0",base0B:"#8e8e8e",base0C:"#868686",base0D:"#686868",base0E:"#747474",base0F:"#5e5e5e"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"green screen",author:"chris kempson (http://chriskempson.com)",base00:"#001100",base01:"#003300",base02:"#005500",base03:"#007700",base04:"#009900",base05:"#00bb00",base06:"#00dd00",base07:"#00ff00",base08:"#007700",base09:"#009900",base0A:"#007700",base0B:"#00bb00",base0C:"#005500",base0D:"#009900",base0E:"#00bb00",base0F:"#005500"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"harmonic16",author:"jannik siebert (https://github.com/janniks)",base00:"#0b1c2c",base01:"#223b54",base02:"#405c79",base03:"#627e99",base04:"#aabcce",base05:"#cbd6e2",base06:"#e5ebf1",base07:"#f7f9fb",base08:"#bf8b56",base09:"#bfbf56",base0A:"#8bbf56",base0B:"#56bf8b",base0C:"#568bbf",base0D:"#8b56bf",base0E:"#bf568b",base0F:"#bf5656"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"hopscotch",author:"jan t. sott",base00:"#322931",base01:"#433b42",base02:"#5c545b",base03:"#797379",base04:"#989498",base05:"#b9b5b8",base06:"#d5d3d5",base07:"#ffffff",base08:"#dd464c",base09:"#fd8b19",base0A:"#fdcc59",base0B:"#8fc13e",base0C:"#149b93",base0D:"#1290bf",base0E:"#c85e7c",base0F:"#b33508"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"isotope",author:"jan t. sott",base00:"#000000",base01:"#404040",base02:"#606060",base03:"#808080",base04:"#c0c0c0",base05:"#d0d0d0",base06:"#e0e0e0",base07:"#ffffff",base08:"#ff0000",base09:"#ff9900",base0A:"#ff0099",base0B:"#33ff00",base0C:"#00ffff",base0D:"#0066ff",base0E:"#cc00ff",base0F:"#3300ff"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"marrakesh",author:"alexandre gavioli (http://github.com/alexx2/)",base00:"#201602",base01:"#302e00",base02:"#5f5b17",base03:"#6c6823",base04:"#86813b",base05:"#948e48",base06:"#ccc37a",base07:"#faf0a5",base08:"#c35359",base09:"#b36144",base0A:"#a88339",base0B:"#18974e",base0C:"#75a738",base0D:"#477ca1",base0E:"#8868b3",base0F:"#b3588e"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"mocha",author:"chris kempson (http://chriskempson.com)",base00:"#3B3228",base01:"#534636",base02:"#645240",base03:"#7e705a",base04:"#b8afad",base05:"#d0c8c6",base06:"#e9e1dd",base07:"#f5eeeb",base08:"#cb6077",base09:"#d28b71",base0A:"#f4bc87",base0B:"#beb55b",base0C:"#7bbda4",base0D:"#8ab3b5",base0E:"#a89bb9",base0F:"#bb9584"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"monokai",author:"wimer hazenberg (http://www.monokai.nl)",base00:"#272822",base01:"#383830",base02:"#49483e",base03:"#75715e",base04:"#a59f85",base05:"#f8f8f2",base06:"#f5f4f1",base07:"#f9f8f5",base08:"#f92672",base09:"#fd971f",base0A:"#f4bf75",base0B:"#a6e22e",base0C:"#a1efe4",base0D:"#66d9ef",base0E:"#ae81ff",base0F:"#cc6633"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"ocean",author:"chris kempson (http://chriskempson.com)",base00:"#2b303b",base01:"#343d46",base02:"#4f5b66",base03:"#65737e",base04:"#a7adba",base05:"#c0c5ce",base06:"#dfe1e8",base07:"#eff1f5",base08:"#bf616a",base09:"#d08770",base0A:"#ebcb8b",base0B:"#a3be8c",base0C:"#96b5b4",base0D:"#8fa1b3",base0E:"#b48ead",base0F:"#ab7967"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"paraiso",author:"jan t. sott",base00:"#2f1e2e",base01:"#41323f",base02:"#4f424c",base03:"#776e71",base04:"#8d8687",base05:"#a39e9b",base06:"#b9b6b0",base07:"#e7e9db",base08:"#ef6155",base09:"#f99b15",base0A:"#fec418",base0B:"#48b685",base0C:"#5bc4bf",base0D:"#06b6ef",base0E:"#815ba4",base0F:"#e96ba8"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"pop",author:"chris kempson (http://chriskempson.com)",base00:"#000000",base01:"#202020",base02:"#303030",base03:"#505050",base04:"#b0b0b0",base05:"#d0d0d0",base06:"#e0e0e0",base07:"#ffffff",base08:"#eb008a",base09:"#f29333",base0A:"#f8ca12",base0B:"#37b349",base0C:"#00aabb",base0D:"#0e5a94",base0E:"#b31e8d",base0F:"#7a2d00"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"railscasts",author:"ryan bates (http://railscasts.com)",base00:"#2b2b2b",base01:"#272935",base02:"#3a4055",base03:"#5a647e",base04:"#d4cfc9",base05:"#e6e1dc",base06:"#f4f1ed",base07:"#f9f7f3",base08:"#da4939",base09:"#cc7833",base0A:"#ffc66d",base0B:"#a5c261",base0C:"#519f50",base0D:"#6d9cbe",base0E:"#b6b3eb",base0F:"#bc9458"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"shapeshifter",author:"tyler benziger (http://tybenz.com)",base00:"#000000",base01:"#040404",base02:"#102015",base03:"#343434",base04:"#555555",base05:"#ababab",base06:"#e0e0e0",base07:"#f9f9f9",base08:"#e92f2f",base09:"#e09448",base0A:"#dddd13",base0B:"#0ed839",base0C:"#23edda",base0D:"#3b48e3",base0E:"#f996e2",base0F:"#69542d"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"solarized",author:"ethan schoonover (http://ethanschoonover.com/solarized)",base00:"#002b36",base01:"#073642",base02:"#586e75",base03:"#657b83",base04:"#839496",base05:"#93a1a1",base06:"#eee8d5",base07:"#fdf6e3",base08:"#dc322f",base09:"#cb4b16",base0A:"#b58900",base0B:"#859900",base0C:"#2aa198",base0D:"#268bd2",base0E:"#6c71c4",base0F:"#d33682"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"summerfruit",author:"christopher corley (http://cscorley.github.io/)",base00:"#151515",base01:"#202020",base02:"#303030",base03:"#505050",base04:"#B0B0B0",base05:"#D0D0D0",base06:"#E0E0E0",base07:"#FFFFFF",base08:"#FF0086",base09:"#FD8900",base0A:"#ABA800",base0B:"#00C918",base0C:"#1faaaa",base0D:"#3777E6",base0E:"#AD00A1",base0F:"#cc6633"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"tomorrow",author:"chris kempson (http://chriskempson.com)",base00:"#1d1f21",base01:"#282a2e",base02:"#373b41",base03:"#969896",base04:"#b4b7b4",base05:"#c5c8c6",base06:"#e0e0e0",base07:"#ffffff",base08:"#cc6666",base09:"#de935f",base0A:"#f0c674",base0B:"#b5bd68",base0C:"#8abeb7",base0D:"#81a2be",base0E:"#b294bb",base0F:"#a3685a"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"london tube",author:"jan t. sott",base00:"#231f20",base01:"#1c3f95",base02:"#5a5758",base03:"#737171",base04:"#959ca1",base05:"#d9d8d8",base06:"#e7e7e8",base07:"#ffffff",base08:"#ee2e24",base09:"#f386a1",base0A:"#ffd204",base0B:"#00853e",base0C:"#85cebc",base0D:"#009ddc",base0E:"#98005d",base0F:"#b06110"},i.exports=a.default},function(i,a,c){a.__esModule=!0,a.default={scheme:"twilight",author:"david hart (http://hart-dev.com)",base00:"#1e1e1e",base01:"#323537",base02:"#464b50",base03:"#5f5a60",base04:"#838184",base05:"#a7a7a7",base06:"#c3c3c3",base07:"#ffffff",base08:"#cf6a4c",base09:"#cda869",base0A:"#f9ee98",base0B:"#8f9d6a",base0C:"#afc4db",base0D:"#7587a6",base0E:"#9b859d",base0F:"#9b703f"},i.exports=a.default},function(i,a,c){var h=c(33);function g(b){var $=Math.round(h(b,0,255)).toString(16);return $.length==1?"0"+$:$}i.exports=function(b){var $=b.length===4?g(255*b[3]):"";return"#"+g(b[0])+g(b[1])+g(b[2])+$}},function(i,a,c){var h=c(134),g=c(135),b=c(136),$=c(137),y={"#":g,hsl:function(T){var C=h(T),E=$(C);return C.length===4&&E.push(C[3]),E},rgb:b};function w(T){for(var C in y)if(T.indexOf(C)===0)return y[C](T)}w.rgb=b,w.hsl=h,w.hex=g,i.exports=w},function(i,a,c){var h=c(44),g=c(33);function b($,y){switch($=parseFloat($),y){case 0:return g($,0,360);case 1:case 2:return g($,0,100);case 3:return g($,0,1)}}i.exports=function($){return h($).map(b)}},function(i,a){i.exports=function(c){c.length!==4&&c.length!==5||(c=function(b){for(var $="#",y=1;y<b.length;y++){var w=b.charAt(y);$+=w+w}return $}(c));var h=[parseInt(c.substring(1,3),16),parseInt(c.substring(3,5),16),parseInt(c.substring(5,7),16)];if(c.length===9){var g=parseFloat((parseInt(c.substring(7,9),16)/255).toFixed(2));h.push(g)}return h}},function(i,a,c){var h=c(44),g=c(33);function b($,y){return y<3?$.indexOf("%")!=-1?Math.round(255*g(parseInt($,10),0,100)/100):g(parseInt($,10),0,255):g(parseFloat($),0,1)}i.exports=function($){return h($).map(b)}},function(i,a){i.exports=function(c){var h,g,b,$,y,w=c[0]/360,T=c[1]/100,C=c[2]/100;if(T==0)return[y=255*C,y,y];h=2*C-(g=C<.5?C*(1+T):C+T-C*T),$=[0,0,0];for(var E=0;E<3;E++)(b=w+1/3*-(E-1))<0&&b++,b>1&&b--,y=6*b<1?h+6*(g-h)*b:2*b<1?g:3*b<2?h+(g-h)*(2/3-b)*6:h,$[E]=255*y;return $}},function(i,a,c){(function(h){var g=typeof h=="object"&&h&&h.Object===Object&&h,b=typeof self=="object"&&self&&self.Object===Object&&self,$=g||b||Function("return this")();function y(K,Y,X){switch(X.length){case 0:return K.call(Y);case 1:return K.call(Y,X[0]);case 2:return K.call(Y,X[0],X[1]);case 3:return K.call(Y,X[0],X[1],X[2])}return K.apply(Y,X)}function w(K,Y){for(var X=-1,ce=Y.length,W=K.length;++X<ce;)K[W+X]=Y[X];return K}var T=Object.prototype,C=T.hasOwnProperty,E=T.toString,k=$.Symbol,A=T.propertyIsEnumerable,P=k?k.isConcatSpreadable:void 0,N=Math.max;function B(K){return S(K)||function(Y){return function(X){return function(ce){return!!ce&&typeof ce=="object"}(X)&&function(ce){return ce!=null&&function(W){return typeof W=="number"&&W>-1&&W%1==0&&W<=9007199254740991}(ce.length)&&!function(W){var te=function(ke){var Z=typeof ke;return!!ke&&(Z=="object"||Z=="function")}(W)?E.call(W):"";return te=="[object Function]"||te=="[object GeneratorFunction]"}(ce)}(X)}(Y)&&C.call(Y,"callee")&&(!A.call(Y,"callee")||E.call(Y)=="[object Arguments]")}(K)||!!(P&&K&&K[P])}var S=Array.isArray,H,q,se,ee=(q=function(K){var Y=(K=function(W,te,ke,Z,ze){var Ce=-1,at=W.length;for(ke||(ke=B),ze||(ze=[]);++Ce<at;){var he=W[Ce];ke(he)?w(ze,he):ze[ze.length]=he}return ze}(K)).length,X=Y;for(H;X--;)if(typeof K[X]!="function")throw new TypeError("Expected a function");return function(){for(var ce=0,W=Y?K[ce].apply(this,arguments):arguments[0];++ce<Y;)W=K[ce].call(this,W);return W}},se=N(se===void 0?q.length-1:se,0),function(){for(var K=arguments,Y=-1,X=N(K.length-se,0),ce=Array(X);++Y<X;)ce[Y]=K[se+Y];Y=-1;for(var W=Array(se+1);++Y<se;)W[Y]=K[Y];return W[se]=ce,y(q,this,W)});i.exports=ee}).call(this,c(43))},function(i,a,c){Object.defineProperty(a,"__esModule",{value:!0}),a.yuv2rgb=function(h){var g,b,$,y=h[0],w=h[1],T=h[2];return g=1*y+0*w+1.13983*T,b=1*y+-.39465*w+-.5806*T,$=1*y+2.02311*w+0*T,g=Math.min(Math.max(0,g),1),b=Math.min(Math.max(0,b),1),$=Math.min(Math.max(0,$),1),[255*g,255*b,255*$]},a.rgb2yuv=function(h){var g=h[0]/255,b=h[1]/255,$=h[2]/255;return[.299*g+.587*b+.114*$,-.14713*g+-.28886*b+.436*$,.615*g+-.51499*b+-.10001*$]}},function(i,a,c){function h($,y,w){return y in $?Object.defineProperty($,y,{value:w,enumerable:!0,configurable:!0,writable:!0}):$[y]=w,$}var g=c(141),b=function(){function $(){h(this,"_callbacks",void 0),h(this,"_isDispatching",void 0),h(this,"_isHandled",void 0),h(this,"_isPending",void 0),h(this,"_lastID",void 0),h(this,"_pendingPayload",void 0),this._callbacks={},this._isDispatching=!1,this._isHandled={},this._isPending={},this._lastID=1}var y=$.prototype;return y.register=function(w){var T="ID_"+this._lastID++;return this._callbacks[T]=w,T},y.unregister=function(w){this._callbacks[w]||g(!1),delete this._callbacks[w]},y.waitFor=function(w){this._isDispatching||g(!1);for(var T=0;T<w.length;T++){var C=w[T];this._isPending[C]?this._isHandled[C]||g(!1):(this._callbacks[C]||g(!1),this._invokeCallback(C))}},y.dispatch=function(w){this._isDispatching&&g(!1),this._startDispatching(w);try{for(var T in this._callbacks)this._isPending[T]||this._invokeCallback(T)}finally{this._stopDispatching()}},y.isDispatching=function(){return this._isDispatching},y._invokeCallback=function(w){this._isPending[w]=!0,this._callbacks[w](this._pendingPayload),this._isHandled[w]=!0},y._startDispatching=function(w){for(var T in this._callbacks)this._isPending[T]=!1,this._isHandled[T]=!1;this._pendingPayload=w,this._isDispatching=!0},y._stopDispatching=function(){delete this._pendingPayload,this._isDispatching=!1},$}();i.exports=b},function(i,a,c){i.exports=function(h,g){for(var b=arguments.length,$=new Array(b>2?b-2:0),y=2;y<b;y++)$[y-2]=arguments[y];if(!h){var w;if(g===void 0)w=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var T=0;(w=new Error(g.replace(/%s/g,function(){return String($[T++])}))).name="Invariant Violation"}throw w.framesToPop=1,w}}},function(i,a,c){function h(z,U,R){return U in z?Object.defineProperty(z,U,{value:R,enumerable:!0,configurable:!0,writable:!0}):z[U]=R,z}function g(z,U){var R=Object.keys(z);if(Object.getOwnPropertySymbols){var j=Object.getOwnPropertySymbols(z);U&&(j=j.filter(function(F){return Object.getOwnPropertyDescriptor(z,F).enumerable})),R.push.apply(R,j)}return R}function b(z){for(var U=1;U<arguments.length;U++){var R=arguments[U]!=null?arguments[U]:{};U%2?g(Object(R),!0).forEach(function(j){h(z,j,R[j])}):Object.getOwnPropertyDescriptors?Object.defineProperties(z,Object.getOwnPropertyDescriptors(R)):g(Object(R)).forEach(function(j){Object.defineProperty(z,j,Object.getOwnPropertyDescriptor(R,j))})}return z}function $(z,U){if(!(z instanceof U))throw new TypeError("Cannot call a class as a function")}function y(z,U){for(var R=0;R<U.length;R++){var j=U[R];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(z,j.key,j)}}function w(z,U,R){return U&&y(z.prototype,U),R&&y(z,R),z}function T(z,U){return(T=Object.setPrototypeOf||function(R,j){return R.__proto__=j,R})(z,U)}function C(z,U){if(typeof U!="function"&&U!==null)throw new TypeError("Super expression must either be null or a function");z.prototype=Object.create(U&&U.prototype,{constructor:{value:z,writable:!0,configurable:!0}}),U&&T(z,U)}function E(z){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(U){return U.__proto__||Object.getPrototypeOf(U)})(z)}function k(z){return(k=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(U){return typeof U}:function(U){return U&&typeof Symbol=="function"&&U.constructor===Symbol&&U!==Symbol.prototype?"symbol":typeof U})(z)}function A(z){if(z===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return z}function P(z,U){return!U||k(U)!=="object"&&typeof U!="function"?A(z):U}function N(z){var U=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var R,j=E(z);if(U){var F=E(this).constructor;R=Reflect.construct(j,arguments,F)}else R=j.apply(this,arguments);return P(this,R)}}c.r(a);var B=c(0),S=c.n(B);function H(){var z=this.constructor.getDerivedStateFromProps(this.props,this.state);z!=null&&this.setState(z)}function q(z){this.setState(function(U){var R=this.constructor.getDerivedStateFromProps(z,U);return R??null}.bind(this))}function se(z,U){try{var R=this.props,j=this.state;this.props=z,this.state=U,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(R,j)}finally{this.props=R,this.state=j}}function ee(z){var U=z.prototype;if(!U||!U.isReactComponent)throw new Error("Can only polyfill class components");if(typeof z.getDerivedStateFromProps!="function"&&typeof U.getSnapshotBeforeUpdate!="function")return z;var R=null,j=null,F=null;if(typeof U.componentWillMount=="function"?R="componentWillMount":typeof U.UNSAFE_componentWillMount=="function"&&(R="UNSAFE_componentWillMount"),typeof U.componentWillReceiveProps=="function"?j="componentWillReceiveProps":typeof U.UNSAFE_componentWillReceiveProps=="function"&&(j="UNSAFE_componentWillReceiveProps"),typeof U.componentWillUpdate=="function"?F="componentWillUpdate":typeof U.UNSAFE_componentWillUpdate=="function"&&(F="UNSAFE_componentWillUpdate"),R!==null||j!==null||F!==null){var pe=z.displayName||z.name,Ee=typeof z.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+pe+" uses "+Ee+" but also contains the following legacy lifecycles:"+(R!==null?`
  `+R:"")+(j!==null?`
  `+j:"")+(F!==null?`
  `+F:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof z.getDerivedStateFromProps=="function"&&(U.componentWillMount=H,U.componentWillReceiveProps=q),typeof U.getSnapshotBeforeUpdate=="function"){if(typeof U.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");U.componentWillUpdate=se;var _e=U.componentDidUpdate;U.componentDidUpdate=function(ae,je,it){var Ft=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:it;_e.call(this,ae,je,Ft)}}return z}function K(z,U){if(z==null)return{};var R,j,F=function(Ee,_e){if(Ee==null)return{};var ae,je,it={},Ft=Object.keys(Ee);for(je=0;je<Ft.length;je++)ae=Ft[je],_e.indexOf(ae)>=0||(it[ae]=Ee[ae]);return it}(z,U);if(Object.getOwnPropertySymbols){var pe=Object.getOwnPropertySymbols(z);for(j=0;j<pe.length;j++)R=pe[j],U.indexOf(R)>=0||Object.prototype.propertyIsEnumerable.call(z,R)&&(F[R]=z[R])}return F}function Y(z){var U=function(R){return{}.toString.call(R).match(/\s([a-zA-Z]+)/)[1].toLowerCase()}(z);return U==="number"&&(U=isNaN(z)?"nan":(0|z)!=z?"float":"integer"),U}H.__suppressDeprecationWarning=!0,q.__suppressDeprecationWarning=!0,se.__suppressDeprecationWarning=!0;var X={scheme:"rjv-default",author:"mac gainor",base00:"rgba(0, 0, 0, 0)",base01:"rgb(245, 245, 245)",base02:"rgb(235, 235, 235)",base03:"#93a1a1",base04:"rgba(0, 0, 0, 0.3)",base05:"#586e75",base06:"#073642",base07:"#002b36",base08:"#d33682",base09:"#cb4b16",base0A:"#dc322f",base0B:"#859900",base0C:"#6c71c4",base0D:"#586e75",base0E:"#2aa198",base0F:"#268bd2"},ce={scheme:"rjv-grey",author:"mac gainor",base00:"rgba(1, 1, 1, 0)",base01:"rgba(1, 1, 1, 0.1)",base02:"rgba(0, 0, 0, 0.2)",base03:"rgba(1, 1, 1, 0.3)",base04:"rgba(0, 0, 0, 0.4)",base05:"rgba(1, 1, 1, 0.5)",base06:"rgba(1, 1, 1, 0.6)",base07:"rgba(1, 1, 1, 0.7)",base08:"rgba(1, 1, 1, 0.8)",base09:"rgba(1, 1, 1, 0.8)",base0A:"rgba(1, 1, 1, 0.8)",base0B:"rgba(1, 1, 1, 0.8)",base0C:"rgba(1, 1, 1, 0.8)",base0D:"rgba(1, 1, 1, 0.8)",base0E:"rgba(1, 1, 1, 0.8)",base0F:"rgba(1, 1, 1, 0.8)"},W={globalFontFamily:"monospace",globalCursor:"default",braceFontWeight:"bold",braceCursor:"pointer",ellipsisFontSize:"18px",ellipsisLineHeight:"10px",ellipsisCursor:"pointer",keyMargin:"0px 5px",keyLetterSpacing:"0.5px",keyFontStyle:"none",keyVerticalAlign:"top",keyOpacity:"0.85",keyOpacityHover:"1",keyValPaddingTop:"3px",keyValPaddingBottom:"3px",keyValPaddingRight:"5px",keyValBorderLeft:"1px solid",keyValBorderHover:"2px solid",pushedContentMarginLeft:"6px",variableValuePaddingRight:"6px",nullFontSize:"11px",nullFontWeight:"bold",nullPadding:"1px 2px",nullBorderRadius:"3px",nanFontSize:"11px",nanFontWeight:"bold",nanPadding:"1px 2px",nanBorderRadius:"3px",undefinedFontSize:"11px",undefinedPadding:"1px 2px",undefinedBorderRadius:"3px",dataTypeFontSize:"11px",dataTypeMarginRight:"4px",datatypeOpacity:"0.8",objectSizeBorderRadius:"3px",objectSizeFontStyle:"italic",objectSizeMargin:"0px 6px 0px 0px",clipboardCursor:"pointer",clipboardCheckMarginLeft:"-12px",metaDataPadding:"0px 0px 0px 10px",arrayGroupMetaPadding:"0px 0px 0px 4px",iconContainerWidth:"17px",tooltipPadding:"4px",editInputMinWidth:"130px",editInputBorderRadius:"2px",editInputPadding:"5px",editInputMarginRight:"4px",editInputFontFamily:"monospace",iconCursor:"pointer",iconFontSize:"15px",iconPaddingRight:"1px",dateValueMarginLeft:"2px",iconMarginRight:"3px",detectedRowPaddingTop:"3px",addKeyCoverBackground:"rgba(255, 255, 255, 0.3)",addKeyCoverPosition:"absolute",addKeyCoverPositionPx:"0px",addKeyModalWidth:"200px",addKeyModalMargin:"auto",addKeyModalPadding:"10px",addKeyModalRadius:"3px"},te=c(45),ke=function(z){var U=function(R){return{backgroundColor:R.base00,ellipsisColor:R.base09,braceColor:R.base07,expandedIcon:R.base0D,collapsedIcon:R.base0E,keyColor:R.base07,arrayKeyColor:R.base0C,objectSize:R.base04,copyToClipboard:R.base0F,copyToClipboardCheck:R.base0D,objectBorder:R.base02,dataTypes:{boolean:R.base0E,date:R.base0D,float:R.base0B,function:R.base0D,integer:R.base0F,string:R.base09,nan:R.base08,null:R.base0A,undefined:R.base05,regexp:R.base0A,background:R.base02},editVariable:{editIcon:R.base0E,cancelIcon:R.base09,removeIcon:R.base09,addIcon:R.base0E,checkIcon:R.base0E,background:R.base01,color:R.base0A,border:R.base07},addKeyModal:{background:R.base05,border:R.base04,color:R.base0A,labelColor:R.base01},validationFailure:{background:R.base09,iconColor:R.base01,fontColor:R.base01}}}(z);return{"app-container":{fontFamily:W.globalFontFamily,cursor:W.globalCursor,backgroundColor:U.backgroundColor,position:"relative"},ellipsis:{display:"inline-block",color:U.ellipsisColor,fontSize:W.ellipsisFontSize,lineHeight:W.ellipsisLineHeight,cursor:W.ellipsisCursor},"brace-row":{display:"inline-block",cursor:"pointer"},brace:{display:"inline-block",cursor:W.braceCursor,fontWeight:W.braceFontWeight,color:U.braceColor},"expanded-icon":{color:U.expandedIcon},"collapsed-icon":{color:U.collapsedIcon},colon:{display:"inline-block",margin:W.keyMargin,color:U.keyColor,verticalAlign:"top"},objectKeyVal:function(R,j){return{style:b({paddingTop:W.keyValPaddingTop,paddingRight:W.keyValPaddingRight,paddingBottom:W.keyValPaddingBottom,borderLeft:W.keyValBorderLeft+" "+U.objectBorder,":hover":{paddingLeft:j.paddingLeft-1+"px",borderLeft:W.keyValBorderHover+" "+U.objectBorder}},j)}},"object-key-val-no-border":{padding:W.keyValPadding},"pushed-content":{marginLeft:W.pushedContentMarginLeft},variableValue:function(R,j){return{style:b({display:"inline-block",paddingRight:W.variableValuePaddingRight,position:"relative"},j)}},"object-name":{display:"inline-block",color:U.keyColor,letterSpacing:W.keyLetterSpacing,fontStyle:W.keyFontStyle,verticalAlign:W.keyVerticalAlign,opacity:W.keyOpacity,":hover":{opacity:W.keyOpacityHover}},"array-key":{display:"inline-block",color:U.arrayKeyColor,letterSpacing:W.keyLetterSpacing,fontStyle:W.keyFontStyle,verticalAlign:W.keyVerticalAlign,opacity:W.keyOpacity,":hover":{opacity:W.keyOpacityHover}},"object-size":{color:U.objectSize,borderRadius:W.objectSizeBorderRadius,fontStyle:W.objectSizeFontStyle,margin:W.objectSizeMargin,cursor:"default"},"data-type-label":{fontSize:W.dataTypeFontSize,marginRight:W.dataTypeMarginRight,opacity:W.datatypeOpacity},boolean:{display:"inline-block",color:U.dataTypes.boolean},date:{display:"inline-block",color:U.dataTypes.date},"date-value":{marginLeft:W.dateValueMarginLeft},float:{display:"inline-block",color:U.dataTypes.float},function:{display:"inline-block",color:U.dataTypes.function,cursor:"pointer",whiteSpace:"pre-line"},"function-value":{fontStyle:"italic"},integer:{display:"inline-block",color:U.dataTypes.integer},string:{display:"inline-block",color:U.dataTypes.string},nan:{display:"inline-block",color:U.dataTypes.nan,fontSize:W.nanFontSize,fontWeight:W.nanFontWeight,backgroundColor:U.dataTypes.background,padding:W.nanPadding,borderRadius:W.nanBorderRadius},null:{display:"inline-block",color:U.dataTypes.null,fontSize:W.nullFontSize,fontWeight:W.nullFontWeight,backgroundColor:U.dataTypes.background,padding:W.nullPadding,borderRadius:W.nullBorderRadius},undefined:{display:"inline-block",color:U.dataTypes.undefined,fontSize:W.undefinedFontSize,padding:W.undefinedPadding,borderRadius:W.undefinedBorderRadius,backgroundColor:U.dataTypes.background},regexp:{display:"inline-block",color:U.dataTypes.regexp},"copy-to-clipboard":{cursor:W.clipboardCursor},"copy-icon":{color:U.copyToClipboard,fontSize:W.iconFontSize,marginRight:W.iconMarginRight,verticalAlign:"top"},"copy-icon-copied":{color:U.copyToClipboardCheck,marginLeft:W.clipboardCheckMarginLeft},"array-group-meta-data":{display:"inline-block",padding:W.arrayGroupMetaPadding},"object-meta-data":{display:"inline-block",padding:W.metaDataPadding},"icon-container":{display:"inline-block",width:W.iconContainerWidth},tooltip:{padding:W.tooltipPadding},removeVarIcon:{verticalAlign:"top",display:"inline-block",color:U.editVariable.removeIcon,cursor:W.iconCursor,fontSize:W.iconFontSize,marginRight:W.iconMarginRight},addVarIcon:{verticalAlign:"top",display:"inline-block",color:U.editVariable.addIcon,cursor:W.iconCursor,fontSize:W.iconFontSize,marginRight:W.iconMarginRight},editVarIcon:{verticalAlign:"top",display:"inline-block",color:U.editVariable.editIcon,cursor:W.iconCursor,fontSize:W.iconFontSize,marginRight:W.iconMarginRight},"edit-icon-container":{display:"inline-block",verticalAlign:"top"},"check-icon":{display:"inline-block",cursor:W.iconCursor,color:U.editVariable.checkIcon,fontSize:W.iconFontSize,paddingRight:W.iconPaddingRight},"cancel-icon":{display:"inline-block",cursor:W.iconCursor,color:U.editVariable.cancelIcon,fontSize:W.iconFontSize,paddingRight:W.iconPaddingRight},"edit-input":{display:"inline-block",minWidth:W.editInputMinWidth,borderRadius:W.editInputBorderRadius,backgroundColor:U.editVariable.background,color:U.editVariable.color,padding:W.editInputPadding,marginRight:W.editInputMarginRight,fontFamily:W.editInputFontFamily},"detected-row":{paddingTop:W.detectedRowPaddingTop},"key-modal-request":{position:W.addKeyCoverPosition,top:W.addKeyCoverPositionPx,left:W.addKeyCoverPositionPx,right:W.addKeyCoverPositionPx,bottom:W.addKeyCoverPositionPx,backgroundColor:W.addKeyCoverBackground},"key-modal":{width:W.addKeyModalWidth,backgroundColor:U.addKeyModal.background,marginLeft:W.addKeyModalMargin,marginRight:W.addKeyModalMargin,padding:W.addKeyModalPadding,borderRadius:W.addKeyModalRadius,marginTop:"15px",position:"relative"},"key-modal-label":{color:U.addKeyModal.labelColor,marginLeft:"2px",marginBottom:"5px",fontSize:"11px"},"key-modal-input-container":{overflow:"hidden"},"key-modal-input":{width:"100%",padding:"3px 6px",fontFamily:"monospace",color:U.addKeyModal.color,border:"none",boxSizing:"border-box",borderRadius:"2px"},"key-modal-cancel":{backgroundColor:U.editVariable.removeIcon,position:"absolute",top:"0px",right:"0px",borderRadius:"0px 3px 0px 3px",cursor:"pointer"},"key-modal-cancel-icon":{color:U.addKeyModal.labelColor,fontSize:W.iconFontSize,transform:"rotate(45deg)"},"key-modal-submit":{color:U.editVariable.addIcon,fontSize:W.iconFontSize,position:"absolute",right:"2px",top:"3px",cursor:"pointer"},"function-ellipsis":{display:"inline-block",color:U.ellipsisColor,fontSize:W.ellipsisFontSize,lineHeight:W.ellipsisLineHeight,cursor:W.ellipsisCursor},"validation-failure":{float:"right",padding:"3px 6px",borderRadius:"2px",cursor:"pointer",color:U.validationFailure.fontColor,backgroundColor:U.validationFailure.background},"validation-failure-label":{marginRight:"6px"},"validation-failure-clear":{position:"relative",verticalAlign:"top",cursor:"pointer",color:U.validationFailure.iconColor,fontSize:W.iconFontSize,transform:"rotate(45deg)"}}};function Z(z,U,R){return z||console.error("theme has not been set"),function(j){var F=X;return j!==!1&&j!=="none"||(F=ce),Object(te.createStyling)(ke,{defaultBase16:F})(j)}(z)(U,R)}var ze=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){var j=this.props,F=(j.rjvId,j.type_name),pe=j.displayDataTypes,Ee=j.theme;return pe?S.a.createElement("span",Object.assign({className:"data-type-label"},Z(Ee,"data-type-label")),F):null}}]),R}(S.a.PureComponent),Ce=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){var j=this.props;return S.a.createElement("div",Z(j.theme,"boolean"),S.a.createElement(ze,Object.assign({type_name:"bool"},j)),j.value?"true":"false")}}]),R}(S.a.PureComponent),at=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){var j=this.props;return S.a.createElement("div",Z(j.theme,"date"),S.a.createElement(ze,Object.assign({type_name:"date"},j)),S.a.createElement("span",Object.assign({className:"date-value"},Z(j.theme,"date-value")),j.value.toLocaleTimeString("en-us",{weekday:"short",year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})))}}]),R}(S.a.PureComponent),he=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){var j=this.props;return S.a.createElement("div",Z(j.theme,"float"),S.a.createElement(ze,Object.assign({type_name:"float"},j)),this.props.value)}}]),R}(S.a.PureComponent);function Ae(z,U){(U==null||U>z.length)&&(U=z.length);for(var R=0,j=new Array(U);R<U;R++)j[R]=z[R];return j}function de(z,U){if(z){if(typeof z=="string")return Ae(z,U);var R=Object.prototype.toString.call(z).slice(8,-1);return R==="Object"&&z.constructor&&(R=z.constructor.name),R==="Map"||R==="Set"?Array.from(z):R==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(R)?Ae(z,U):void 0}}function Se(z,U){var R;if(typeof Symbol>"u"||z[Symbol.iterator]==null){if(Array.isArray(z)||(R=de(z))||U){R&&(z=R);var j=0,F=function(){};return{s:F,n:function(){return j>=z.length?{done:!0}:{done:!1,value:z[j++]}},e:function(ae){throw ae},f:F}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var pe,Ee=!0,_e=!1;return{s:function(){R=z[Symbol.iterator]()},n:function(){var ae=R.next();return Ee=ae.done,ae},e:function(ae){_e=!0,pe=ae},f:function(){try{Ee||R.return==null||R.return()}finally{if(_e)throw pe}}}}function xe(z){return function(U){if(Array.isArray(U))return Ae(U)}(z)||function(U){if(typeof Symbol<"u"&&Symbol.iterator in Object(U))return Array.from(U)}(z)||de(z)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}var He=c(46),ne=new(c(47)).Dispatcher,Ke=new(function(z){C(R,z);var U=N(R);function R(){var j;$(this,R);for(var F=arguments.length,pe=new Array(F),Ee=0;Ee<F;Ee++)pe[Ee]=arguments[Ee];return(j=U.call.apply(U,[this].concat(pe))).objects={},j.set=function(_e,ae,je,it){j.objects[_e]===void 0&&(j.objects[_e]={}),j.objects[_e][ae]===void 0&&(j.objects[_e][ae]={}),j.objects[_e][ae][je]=it},j.get=function(_e,ae,je,it){return j.objects[_e]===void 0||j.objects[_e][ae]===void 0||j.objects[_e][ae][je]==null?it:j.objects[_e][ae][je]},j.handleAction=function(_e){var ae=_e.rjvId,je=_e.data;switch(_e.name){case"RESET":j.emit("reset-"+ae);break;case"VARIABLE_UPDATED":_e.data.updated_src=j.updateSrc(ae,je),j.set(ae,"action","variable-update",b(b({},je),{},{type:"variable-edited"})),j.emit("variable-update-"+ae);break;case"VARIABLE_REMOVED":_e.data.updated_src=j.updateSrc(ae,je),j.set(ae,"action","variable-update",b(b({},je),{},{type:"variable-removed"})),j.emit("variable-update-"+ae);break;case"VARIABLE_ADDED":_e.data.updated_src=j.updateSrc(ae,je),j.set(ae,"action","variable-update",b(b({},je),{},{type:"variable-added"})),j.emit("variable-update-"+ae);break;case"ADD_VARIABLE_KEY_REQUEST":j.set(ae,"action","new-key-request",je),j.emit("add-key-request-"+ae)}},j.updateSrc=function(_e,ae){var je=ae.name,it=ae.namespace,Ft=ae.new_value,Yt=(ae.existing_value,ae.variable_removed);it.shift();var on,Lt=j.get(_e,"global","src"),an=j.deepCopy(Lt,xe(it)),_n=an,Tt=Se(it);try{for(Tt.s();!(on=Tt.n()).done;)_n=_n[on.value]}catch(In){Tt.e(In)}finally{Tt.f()}return Yt?Y(_n)=="array"?_n.splice(je,1):delete _n[je]:je!==null?_n[je]=Ft:an=Ft,j.set(_e,"global","src",an),an},j.deepCopy=function(_e,ae){var je,it=Y(_e),Ft=ae.shift();return it=="array"?je=xe(_e):it=="object"&&(je=b({},_e)),Ft!==void 0&&(je[Ft]=j.deepCopy(_e[Ft],ae)),je},j}return R}(He.EventEmitter));ne.register(Ke.handleAction.bind(Ke));var Te=Ke,Je=function(z){C(R,z);var U=N(R);function R(j){var F;return $(this,R),(F=U.call(this,j)).toggleCollapsed=function(){F.setState({collapsed:!F.state.collapsed},function(){Te.set(F.props.rjvId,F.props.namespace,"collapsed",F.state.collapsed)})},F.getFunctionDisplay=function(pe){var Ee=A(F).props;return pe?S.a.createElement("span",null,F.props.value.toString().slice(9,-1).replace(/\{[\s\S]+/,""),S.a.createElement("span",{className:"function-collapsed",style:{fontWeight:"bold"}},S.a.createElement("span",null,"{"),S.a.createElement("span",Z(Ee.theme,"ellipsis"),"..."),S.a.createElement("span",null,"}"))):F.props.value.toString().slice(9,-1)},F.state={collapsed:Te.get(j.rjvId,j.namespace,"collapsed",!0)},F}return w(R,[{key:"render",value:function(){var j=this.props,F=this.state.collapsed;return S.a.createElement("div",Z(j.theme,"function"),S.a.createElement(ze,Object.assign({type_name:"function"},j)),S.a.createElement("span",Object.assign({},Z(j.theme,"function-value"),{className:"rjv-function-container",onClick:this.toggleCollapsed}),this.getFunctionDisplay(F)))}}]),R}(S.a.PureComponent),rt=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){return S.a.createElement("div",Z(this.props.theme,"nan"),"NaN")}}]),R}(S.a.PureComponent),ht=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){return S.a.createElement("div",Z(this.props.theme,"null"),"NULL")}}]),R}(S.a.PureComponent),nt=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){var j=this.props;return S.a.createElement("div",Z(j.theme,"integer"),S.a.createElement(ze,Object.assign({type_name:"int"},j)),this.props.value)}}]),R}(S.a.PureComponent),Wt=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){var j=this.props;return S.a.createElement("div",Z(j.theme,"regexp"),S.a.createElement(ze,Object.assign({type_name:"regexp"},j)),this.props.value.toString())}}]),R}(S.a.PureComponent),St=function(z){C(R,z);var U=N(R);function R(j){var F;return $(this,R),(F=U.call(this,j)).toggleCollapsed=function(){F.setState({collapsed:!F.state.collapsed},function(){Te.set(F.props.rjvId,F.props.namespace,"collapsed",F.state.collapsed)})},F.state={collapsed:Te.get(j.rjvId,j.namespace,"collapsed",!0)},F}return w(R,[{key:"render",value:function(){this.state.collapsed;var j=this.props,F=j.collapseStringsAfterLength,pe=j.theme,Ee=j.value,_e={style:{cursor:"default"}};return Y(F)==="integer"&&Ee.length>F&&(_e.style.cursor="pointer",this.state.collapsed&&(Ee=S.a.createElement("span",null,Ee.substring(0,F),S.a.createElement("span",Z(pe,"ellipsis")," ...")))),S.a.createElement("div",Z(pe,"string"),S.a.createElement(ze,Object.assign({type_name:"string"},j)),S.a.createElement("span",Object.assign({className:"string-value"},_e,{onClick:this.toggleCollapsed}),'"',Ee,'"'))}}]),R}(S.a.PureComponent),lt=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){return S.a.createElement("div",Z(this.props.theme,"undefined"),"undefined")}}]),R}(S.a.PureComponent);function ft(){return(ft=Object.assign||function(z){for(var U=1;U<arguments.length;U++){var R=arguments[U];for(var j in R)Object.prototype.hasOwnProperty.call(R,j)&&(z[j]=R[j])}return z}).apply(this,arguments)}var st=B.useLayoutEffect,At=function(z){var U=Object(B.useRef)(z);return st(function(){U.current=z}),U},mn=function(z,U){typeof z!="function"?z.current=U:z(U)},Ue=function(z,U){var R=Object(B.useRef)();return Object(B.useCallback)(function(j){z.current=j,R.current&&mn(R.current,null),R.current=U,U&&mn(U,j)},[U])},Nt={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0"},wt=function(z){Object.keys(Nt).forEach(function(U){z.style.setProperty(U,Nt[U],"important")})},qt=null,ct=function(){},me=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width"],ge=!!document.documentElement.currentStyle,ue=function(z,U){var R=z.cacheMeasurements,j=z.maxRows,F=z.minRows,pe=z.onChange,Ee=pe===void 0?ct:pe,_e=z.onHeightChange,ae=_e===void 0?ct:_e,je=function(Tt,In){if(Tt==null)return{};var ss,Js,Xo={},Dr=Object.keys(Tt);for(Js=0;Js<Dr.length;Js++)ss=Dr[Js],In.indexOf(ss)>=0||(Xo[ss]=Tt[ss]);return Xo}(z,["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"]),it,Ft=je.value!==void 0,Yt=Object(B.useRef)(null),on=Ue(Yt,U),Lt=Object(B.useRef)(0),an=Object(B.useRef)(),_n=function(){var Tt=Yt.current,In=R&&an.current?an.current:function(Dr){var ho=window.getComputedStyle(Dr);if(ho===null)return null;var Ts,tn=(Ts=ho,me.reduce(function(Oi,rs){return Oi[rs]=Ts[rs],Oi},{})),qs=tn.boxSizing;return qs===""?null:(ge&&qs==="border-box"&&(tn.width=parseFloat(tn.width)+parseFloat(tn.borderRightWidth)+parseFloat(tn.borderLeftWidth)+parseFloat(tn.paddingRight)+parseFloat(tn.paddingLeft)+"px"),{sizingStyle:tn,paddingSize:parseFloat(tn.paddingBottom)+parseFloat(tn.paddingTop),borderSize:parseFloat(tn.borderBottomWidth)+parseFloat(tn.borderTopWidth)})}(Tt);if(In){an.current=In;var ss=function(Dr,ho,Ts,tn){Ts===void 0&&(Ts=1),tn===void 0&&(tn=1/0),qt||((qt=document.createElement("textarea")).setAttribute("tab-index","-1"),qt.setAttribute("aria-hidden","true"),wt(qt)),qt.parentNode===null&&document.body.appendChild(qt);var qs=Dr.paddingSize,Oi=Dr.borderSize,rs=Dr.sizingStyle,Ms=rs.boxSizing;Object.keys(rs).forEach(function(fo){var oi=fo;qt.style[oi]=rs[oi]}),wt(qt),qt.value=ho;var po=function(fo,oi){var Mi=fo.scrollHeight;return oi.sizingStyle.boxSizing==="border-box"?Mi+oi.borderSize:Mi-oi.paddingSize}(qt,Dr);qt.value="x";var Zo=qt.scrollHeight-qs,Ri=Zo*Ts;Ms==="border-box"&&(Ri=Ri+qs+Oi),po=Math.max(Ri,po);var go=Zo*tn;return Ms==="border-box"&&(go=go+qs+Oi),[po=Math.min(go,po),Zo]}(In,Tt.value||Tt.placeholder||"x",F,j),Js=ss[0],Xo=ss[1];Lt.current!==Js&&(Lt.current=Js,Tt.style.setProperty("height",Js+"px","important"),ae(Js,{rowHeight:Xo}))}};return Object(B.useLayoutEffect)(_n),it=At(_n),Object(B.useLayoutEffect)(function(){var Tt=function(In){it.current(In)};return window.addEventListener("resize",Tt),function(){window.removeEventListener("resize",Tt)}},[]),Object(B.createElement)("textarea",ft({},je,{onChange:function(Tt){Ft||_n(),Ee(Tt)},ref:on}))},we=Object(B.forwardRef)(ue);function Ve(z){z=z.trim();try{if((z=JSON.stringify(JSON.parse(z)))[0]==="[")return re("array",JSON.parse(z));if(z[0]==="{")return re("object",JSON.parse(z));if(z.match(/\-?\d+\.\d+/)&&z.match(/\-?\d+\.\d+/)[0]===z)return re("float",parseFloat(z));if(z.match(/\-?\d+e-\d+/)&&z.match(/\-?\d+e-\d+/)[0]===z)return re("float",Number(z));if(z.match(/\-?\d+/)&&z.match(/\-?\d+/)[0]===z)return re("integer",parseInt(z));if(z.match(/\-?\d+e\+\d+/)&&z.match(/\-?\d+e\+\d+/)[0]===z)return re("integer",Number(z))}catch{}switch(z=z.toLowerCase()){case"undefined":return re("undefined",void 0);case"nan":return re("nan",NaN);case"null":return re("null",null);case"true":return re("boolean",!0);case"false":return re("boolean",!1);default:if(z=Date.parse(z))return re("date",new Date(z))}return re(!1,null)}function re(z,U){return{type:z,value:U}}var Fe=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){var j=this.props,F=j.style,pe=K(j,["style"]);return S.a.createElement("span",pe,S.a.createElement("svg",Object.assign({},Kt(F),{viewBox:"0 0 24 24",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),S.a.createElement("path",{d:"M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M7,13H17V11H7"})))}}]),R}(S.a.PureComponent),It=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){var j=this.props,F=j.style,pe=K(j,["style"]);return S.a.createElement("span",pe,S.a.createElement("svg",Object.assign({},Kt(F),{viewBox:"0 0 24 24",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),S.a.createElement("path",{d:"M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M13,7H11V11H7V13H11V17H13V13H17V11H13V7Z"})))}}]),R}(S.a.PureComponent),pt=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){var j=this.props,F=j.style,pe=K(j,["style"]),Ee=Kt(F).style;return S.a.createElement("span",pe,S.a.createElement("svg",{fill:Ee.color,width:Ee.height,height:Ee.width,style:Ee,viewBox:"0 0 1792 1792"},S.a.createElement("path",{d:"M1344 800v64q0 14-9 23t-23 9h-832q-14 0-23-9t-9-23v-64q0-14 9-23t23-9h832q14 0 23 9t9 23zm128 448v-832q0-66-47-113t-113-47h-832q-66 0-113 47t-47 113v832q0 66 47 113t113 47h832q66 0 113-47t47-113zm128-832v832q0 119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119 84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z"})))}}]),R}(S.a.PureComponent),En=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){var j=this.props,F=j.style,pe=K(j,["style"]),Ee=Kt(F).style;return S.a.createElement("span",pe,S.a.createElement("svg",{fill:Ee.color,width:Ee.height,height:Ee.width,style:Ee,viewBox:"0 0 1792 1792"},S.a.createElement("path",{d:"M1344 800v64q0 14-9 23t-23 9h-352v352q0 14-9 23t-23 9h-64q-14 0-23-9t-9-23v-352h-352q-14 0-23-9t-9-23v-64q0-14 9-23t23-9h352v-352q0-14 9-23t23-9h64q14 0 23 9t9 23v352h352q14 0 23 9t9 23zm128 448v-832q0-66-47-113t-113-47h-832q-66 0-113 47t-47 113v832q0 66 47 113t113 47h832q66 0 113-47t47-113zm128-832v832q0 119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119 84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z"})))}}]),R}(S.a.PureComponent),mt=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){var j=this.props,F=j.style,pe=K(j,["style"]);return S.a.createElement("span",pe,S.a.createElement("svg",{style:b(b({},Kt(F).style),{},{paddingLeft:"2px",verticalAlign:"top"}),viewBox:"0 0 15 15",fill:"currentColor"},S.a.createElement("path",{d:"M0 14l6-6-6-6z"})))}}]),R}(S.a.PureComponent),Cn=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){var j=this.props,F=j.style,pe=K(j,["style"]);return S.a.createElement("span",pe,S.a.createElement("svg",{style:b(b({},Kt(F).style),{},{paddingLeft:"2px",verticalAlign:"top"}),viewBox:"0 0 15 15",fill:"currentColor"},S.a.createElement("path",{d:"M0 5l6 6 6-6z"})))}}]),R}(S.a.PureComponent),$n=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){var j=this.props,F=j.style,pe=K(j,["style"]);return S.a.createElement("span",pe,S.a.createElement("svg",Object.assign({},Kt(F),{viewBox:"0 0 40 40",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),S.a.createElement("g",null,S.a.createElement("path",{d:"m30 35h-25v-22.5h25v7.5h2.5v-12.5c0-1.4-1.1-2.5-2.5-2.5h-7.5c0-2.8-2.2-5-5-5s-5 2.2-5 5h-7.5c-1.4 0-2.5 1.1-2.5 2.5v27.5c0 1.4 1.1 2.5 2.5 2.5h25c1.4 0 2.5-1.1 2.5-2.5v-5h-2.5v5z m-20-27.5h2.5s2.5-1.1 2.5-2.5 1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5 1.3 2.5 2.5 2.5h2.5s2.5 1.1 2.5 2.5h-20c0-1.5 1.1-2.5 2.5-2.5z m-2.5 20h5v-2.5h-5v2.5z m17.5-5v-5l-10 7.5 10 7.5v-5h12.5v-5h-12.5z m-17.5 10h7.5v-2.5h-7.5v2.5z m12.5-17.5h-12.5v2.5h12.5v-2.5z m-7.5 5h-5v2.5h5v-2.5z"}))))}}]),R}(S.a.PureComponent),zn=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){var j=this.props,F=j.style,pe=K(j,["style"]);return S.a.createElement("span",pe,S.a.createElement("svg",Object.assign({},Kt(F),{viewBox:"0 0 40 40",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),S.a.createElement("g",null,S.a.createElement("path",{d:"m28.6 25q0-0.5-0.4-1l-4-4 4-4q0.4-0.5 0.4-1 0-0.6-0.4-1.1l-2-2q-0.4-0.4-1-0.4-0.6 0-1 0.4l-4.1 4.1-4-4.1q-0.4-0.4-1-0.4-0.6 0-1 0.4l-2 2q-0.5 0.5-0.5 1.1 0 0.5 0.5 1l4 4-4 4q-0.5 0.5-0.5 1 0 0.7 0.5 1.1l2 2q0.4 0.4 1 0.4 0.6 0 1-0.4l4-4.1 4.1 4.1q0.4 0.4 1 0.4 0.6 0 1-0.4l2-2q0.4-0.4 0.4-1z m8.7-5q0 4.7-2.3 8.6t-6.3 6.2-8.6 2.3-8.6-2.3-6.2-6.2-2.3-8.6 2.3-8.6 6.2-6.2 8.6-2.3 8.6 2.3 6.3 6.2 2.3 8.6z"}))))}}]),R}(S.a.PureComponent),Jn=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){var j=this.props,F=j.style,pe=K(j,["style"]);return S.a.createElement("span",pe,S.a.createElement("svg",Object.assign({},Kt(F),{viewBox:"0 0 40 40",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),S.a.createElement("g",null,S.a.createElement("path",{d:"m30.1 21.4v-2.8q0-0.6-0.4-1t-1-0.5h-5.7v-5.7q0-0.6-0.4-1t-1-0.4h-2.9q-0.6 0-1 0.4t-0.4 1v5.7h-5.7q-0.6 0-1 0.5t-0.5 1v2.8q0 0.6 0.5 1t1 0.5h5.7v5.7q0 0.5 0.4 1t1 0.4h2.9q0.6 0 1-0.4t0.4-1v-5.7h5.7q0.6 0 1-0.5t0.4-1z m7.2-1.4q0 4.7-2.3 8.6t-6.3 6.2-8.6 2.3-8.6-2.3-6.2-6.2-2.3-8.6 2.3-8.6 6.2-6.2 8.6-2.3 8.6 2.3 6.3 6.2 2.3 8.6z"}))))}}]),R}(S.a.PureComponent),Gs=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){var j=this.props,F=j.style,pe=K(j,["style"]);return S.a.createElement("span",pe,S.a.createElement("svg",Object.assign({},Kt(F),{viewBox:"0 0 40 40",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),S.a.createElement("g",null,S.a.createElement("path",{d:"m31.6 21.6h-10v10h-3.2v-10h-10v-3.2h10v-10h3.2v10h10v3.2z"}))))}}]),R}(S.a.PureComponent),ns=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){var j=this.props,F=j.style,pe=K(j,["style"]);return S.a.createElement("span",pe,S.a.createElement("svg",Object.assign({},Kt(F),{viewBox:"0 0 40 40",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),S.a.createElement("g",null,S.a.createElement("path",{d:"m19.8 26.4l2.6-2.6-3.4-3.4-2.6 2.6v1.3h2.2v2.1h1.2z m9.8-16q-0.3-0.4-0.7 0l-7.8 7.8q-0.4 0.4 0 0.7t0.7 0l7.8-7.8q0.4-0.4 0-0.7z m1.8 13.2v4.3q0 2.6-1.9 4.5t-4.5 1.9h-18.6q-2.6 0-4.5-1.9t-1.9-4.5v-18.6q0-2.7 1.9-4.6t4.5-1.8h18.6q1.4 0 2.6 0.5 0.3 0.2 0.4 0.5 0.1 0.4-0.2 0.7l-1.1 1.1q-0.3 0.3-0.7 0.1-0.5-0.1-1-0.1h-18.6q-1.4 0-2.5 1.1t-1 2.5v18.6q0 1.4 1 2.5t2.5 1h18.6q1.5 0 2.5-1t1.1-2.5v-2.9q0-0.2 0.2-0.4l1.4-1.5q0.3-0.3 0.8-0.1t0.4 0.6z m-2.1-16.5l6.4 6.5-15 15h-6.4v-6.5z m9.9 3l-2.1 2-6.4-6.4 2.1-2q0.6-0.7 1.5-0.7t1.5 0.7l3.4 3.4q0.6 0.6 0.6 1.5t-0.6 1.5z"}))))}}]),R}(S.a.PureComponent),Rn=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){var j=this.props,F=j.style,pe=K(j,["style"]);return S.a.createElement("span",pe,S.a.createElement("svg",Object.assign({},Kt(F),{viewBox:"0 0 40 40",fill:"currentColor",preserveAspectRatio:"xMidYMid meet"}),S.a.createElement("g",null,S.a.createElement("path",{d:"m31.7 16.4q0-0.6-0.4-1l-2.1-2.1q-0.4-0.4-1-0.4t-1 0.4l-9.1 9.1-5-5q-0.5-0.4-1-0.4t-1 0.4l-2.1 2q-0.4 0.4-0.4 1 0 0.6 0.4 1l8.1 8.1q0.4 0.4 1 0.4 0.6 0 1-0.4l12.2-12.1q0.4-0.4 0.4-1z m5.6 3.6q0 4.7-2.3 8.6t-6.3 6.2-8.6 2.3-8.6-2.3-6.2-6.2-2.3-8.6 2.3-8.6 6.2-6.2 8.6-2.3 8.6 2.3 6.3 6.2 2.3 8.6z"}))))}}]),R}(S.a.PureComponent);function Kt(z){return z||(z={}),{style:b(b({verticalAlign:"middle"},z),{},{color:z.color?z.color:"#000000",height:"1em",width:"1em"})}}var Pn=function(z){C(R,z);var U=N(R);function R(j){var F;return $(this,R),(F=U.call(this,j)).copiedTimer=null,F.handleCopy=function(){var pe=document.createElement("textarea"),Ee=F.props,_e=Ee.clickCallback,ae=Ee.src,je=Ee.namespace;pe.innerHTML=JSON.stringify(F.clipboardValue(ae),null,"  "),document.body.appendChild(pe),pe.select(),document.execCommand("copy"),document.body.removeChild(pe),F.copiedTimer=setTimeout(function(){F.setState({copied:!1})},5500),F.setState({copied:!0},function(){typeof _e=="function"&&_e({src:ae,namespace:je,name:je[je.length-1]})})},F.getClippyIcon=function(){var pe=F.props.theme;return F.state.copied?S.a.createElement("span",null,S.a.createElement($n,Object.assign({className:"copy-icon"},Z(pe,"copy-icon"))),S.a.createElement("span",Z(pe,"copy-icon-copied"),"")):S.a.createElement($n,Object.assign({className:"copy-icon"},Z(pe,"copy-icon")))},F.clipboardValue=function(pe){switch(Y(pe)){case"function":case"regexp":return pe.toString();default:return pe}},F.state={copied:!1},F}return w(R,[{key:"componentWillUnmount",value:function(){this.copiedTimer&&(clearTimeout(this.copiedTimer),this.copiedTimer=null)}},{key:"render",value:function(){var j=this.props,F=(j.src,j.theme),pe=j.hidden,Ee=j.rowHovered,_e=Z(F,"copy-to-clipboard").style,ae="inline";return pe&&(ae="none"),S.a.createElement("span",{className:"copy-to-clipboard-container",title:"Copy to clipboard",style:{verticalAlign:"top",display:Ee?"inline-block":"none"}},S.a.createElement("span",{style:b(b({},_e),{},{display:ae}),onClick:this.handleCopy},this.getClippyIcon()))}}]),R}(S.a.PureComponent),cs=function(z){C(R,z);var U=N(R);function R(j){var F;return $(this,R),(F=U.call(this,j)).getEditIcon=function(){var pe=F.props,Ee=pe.variable,_e=pe.theme;return S.a.createElement("div",{className:"click-to-edit",style:{verticalAlign:"top",display:F.state.hovered?"inline-block":"none"}},S.a.createElement(ns,Object.assign({className:"click-to-edit-icon"},Z(_e,"editVarIcon"),{onClick:function(){F.prepopInput(Ee)}})))},F.prepopInput=function(pe){if(F.props.onEdit!==!1){var Ee=function(ae){var je;switch(Y(ae)){case"undefined":je="undefined";break;case"nan":je="NaN";break;case"string":je=ae;break;case"date":case"function":case"regexp":je=ae.toString();break;default:try{je=JSON.stringify(ae,null,"  ")}catch{je=""}}return je}(pe.value),_e=Ve(Ee);F.setState({editMode:!0,editValue:Ee,parsedInput:{type:_e.type,value:_e.value}})}},F.getRemoveIcon=function(){var pe=F.props,Ee=pe.variable,_e=pe.namespace,ae=pe.theme,je=pe.rjvId;return S.a.createElement("div",{className:"click-to-remove",style:{verticalAlign:"top",display:F.state.hovered?"inline-block":"none"}},S.a.createElement(zn,Object.assign({className:"click-to-remove-icon"},Z(ae,"removeVarIcon"),{onClick:function(){ne.dispatch({name:"VARIABLE_REMOVED",rjvId:je,data:{name:Ee.name,namespace:_e,existing_value:Ee.value,variable_removed:!0}})}})))},F.getValue=function(pe,Ee){var _e=!Ee&&pe.type,ae=A(F).props;switch(_e){case!1:return F.getEditInput();case"string":return S.a.createElement(St,Object.assign({value:pe.value},ae));case"integer":return S.a.createElement(nt,Object.assign({value:pe.value},ae));case"float":return S.a.createElement(he,Object.assign({value:pe.value},ae));case"boolean":return S.a.createElement(Ce,Object.assign({value:pe.value},ae));case"function":return S.a.createElement(Je,Object.assign({value:pe.value},ae));case"null":return S.a.createElement(ht,ae);case"nan":return S.a.createElement(rt,ae);case"undefined":return S.a.createElement(lt,ae);case"date":return S.a.createElement(at,Object.assign({value:pe.value},ae));case"regexp":return S.a.createElement(Wt,Object.assign({value:pe.value},ae));default:return S.a.createElement("div",{className:"object-value"},JSON.stringify(pe.value))}},F.getEditInput=function(){var pe=F.props.theme,Ee=F.state.editValue;return S.a.createElement("div",null,S.a.createElement(we,Object.assign({type:"text",inputRef:function(_e){return _e&&_e.focus()},value:Ee,className:"variable-editor",onChange:function(_e){var ae=_e.target.value,je=Ve(ae);F.setState({editValue:ae,parsedInput:{type:je.type,value:je.value}})},onKeyDown:function(_e){switch(_e.key){case"Escape":F.setState({editMode:!1,editValue:""});break;case"Enter":(_e.ctrlKey||_e.metaKey)&&F.submitEdit(!0)}_e.stopPropagation()},placeholder:"update this value",minRows:2},Z(pe,"edit-input"))),S.a.createElement("div",Z(pe,"edit-icon-container"),S.a.createElement(zn,Object.assign({className:"edit-cancel"},Z(pe,"cancel-icon"),{onClick:function(){F.setState({editMode:!1,editValue:""})}})),S.a.createElement(Rn,Object.assign({className:"edit-check string-value"},Z(pe,"check-icon"),{onClick:function(){F.submitEdit()}})),S.a.createElement("div",null,F.showDetected())))},F.submitEdit=function(pe){var Ee=F.props,_e=Ee.variable,ae=Ee.namespace,je=Ee.rjvId,it=F.state,Ft=it.editValue,Yt=it.parsedInput,on=Ft;pe&&Yt.type&&(on=Yt.value),F.setState({editMode:!1}),ne.dispatch({name:"VARIABLE_UPDATED",rjvId:je,data:{name:_e.name,namespace:ae,existing_value:_e.value,new_value:on,variable_removed:!1}})},F.showDetected=function(){var pe=F.props,Ee=pe.theme,_e=(pe.variable,pe.namespace,pe.rjvId,F.state.parsedInput),ae=(_e.type,_e.value,F.getDetectedInput());if(ae)return S.a.createElement("div",null,S.a.createElement("div",Z(Ee,"detected-row"),ae,S.a.createElement(Rn,{className:"edit-check detected",style:b({verticalAlign:"top",paddingLeft:"3px"},Z(Ee,"check-icon").style),onClick:function(){F.submitEdit(!0)}})))},F.getDetectedInput=function(){var pe=F.state.parsedInput,Ee=pe.type,_e=pe.value,ae=A(F).props,je=ae.theme;if(Ee!==!1)switch(Ee.toLowerCase()){case"object":return S.a.createElement("span",null,S.a.createElement("span",{style:b(b({},Z(je,"brace").style),{},{cursor:"default"})},"{"),S.a.createElement("span",{style:b(b({},Z(je,"ellipsis").style),{},{cursor:"default"})},"..."),S.a.createElement("span",{style:b(b({},Z(je,"brace").style),{},{cursor:"default"})},"}"));case"array":return S.a.createElement("span",null,S.a.createElement("span",{style:b(b({},Z(je,"brace").style),{},{cursor:"default"})},"["),S.a.createElement("span",{style:b(b({},Z(je,"ellipsis").style),{},{cursor:"default"})},"..."),S.a.createElement("span",{style:b(b({},Z(je,"brace").style),{},{cursor:"default"})},"]"));case"string":return S.a.createElement(St,Object.assign({value:_e},ae));case"integer":return S.a.createElement(nt,Object.assign({value:_e},ae));case"float":return S.a.createElement(he,Object.assign({value:_e},ae));case"boolean":return S.a.createElement(Ce,Object.assign({value:_e},ae));case"function":return S.a.createElement(Je,Object.assign({value:_e},ae));case"null":return S.a.createElement(ht,ae);case"nan":return S.a.createElement(rt,ae);case"undefined":return S.a.createElement(lt,ae);case"date":return S.a.createElement(at,Object.assign({value:new Date(_e)},ae))}},F.state={editMode:!1,editValue:"",hovered:!1,renameKey:!1,parsedInput:{type:!1,value:null}},F}return w(R,[{key:"render",value:function(){var j=this,F=this.props,pe=F.variable,Ee=F.singleIndent,_e=F.type,ae=F.theme,je=F.namespace,it=F.indentWidth,Ft=F.enableClipboard,Yt=F.onEdit,on=F.onDelete,Lt=F.onSelect,an=F.displayArrayKey,_n=F.quotesOnKeys,Tt=this.state.editMode;return S.a.createElement("div",Object.assign({},Z(ae,"objectKeyVal",{paddingLeft:it*Ee}),{onMouseEnter:function(){return j.setState(b(b({},j.state),{},{hovered:!0}))},onMouseLeave:function(){return j.setState(b(b({},j.state),{},{hovered:!1}))},className:"variable-row",key:pe.name}),_e=="array"?an?S.a.createElement("span",Object.assign({},Z(ae,"array-key"),{key:pe.name+"_"+je}),pe.name,S.a.createElement("div",Z(ae,"colon"),":")):null:S.a.createElement("span",null,S.a.createElement("span",Object.assign({},Z(ae,"object-name"),{className:"object-key",key:pe.name+"_"+je}),!!_n&&S.a.createElement("span",{style:{verticalAlign:"top"}},'"'),S.a.createElement("span",{style:{display:"inline-block"}},pe.name),!!_n&&S.a.createElement("span",{style:{verticalAlign:"top"}},'"')),S.a.createElement("span",Z(ae,"colon"),":")),S.a.createElement("div",Object.assign({className:"variable-value",onClick:Lt===!1&&Yt===!1?null:function(In){var ss=xe(je);(In.ctrlKey||In.metaKey)&&Yt!==!1?j.prepopInput(pe):Lt!==!1&&(ss.shift(),Lt(b(b({},pe),{},{namespace:ss})))}},Z(ae,"variableValue",{cursor:Lt===!1?"default":"pointer"})),this.getValue(pe,Tt)),Ft?S.a.createElement(Pn,{rowHovered:this.state.hovered,hidden:Tt,src:pe.value,clickCallback:Ft,theme:ae,namespace:[].concat(xe(je),[pe.name])}):null,Yt!==!1&&Tt==0?this.getEditIcon():null,on!==!1&&Tt==0?this.getRemoveIcon():null)}}]),R}(S.a.PureComponent),Ks=function(z){C(R,z);var U=N(R);function R(){var j;$(this,R);for(var F=arguments.length,pe=new Array(F),Ee=0;Ee<F;Ee++)pe[Ee]=arguments[Ee];return(j=U.call.apply(U,[this].concat(pe))).getObjectSize=function(){var _e=j.props,ae=_e.size,je=_e.theme;if(_e.displayObjectSize)return S.a.createElement("span",Object.assign({className:"object-size"},Z(je,"object-size")),ae," item",ae===1?"":"s")},j.getAddAttribute=function(_e){var ae=j.props,je=ae.theme,it=ae.namespace,Ft=ae.name,Yt=ae.src,on=ae.rjvId,Lt=ae.depth;return S.a.createElement("span",{className:"click-to-add",style:{verticalAlign:"top",display:_e?"inline-block":"none"}},S.a.createElement(Jn,Object.assign({className:"click-to-add-icon"},Z(je,"addVarIcon"),{onClick:function(){var an={name:Lt>0?Ft:null,namespace:it.splice(0,it.length-1),existing_value:Yt,variable_removed:!1,key_name:null};Y(Yt)==="object"?ne.dispatch({name:"ADD_VARIABLE_KEY_REQUEST",rjvId:on,data:an}):ne.dispatch({name:"VARIABLE_ADDED",rjvId:on,data:b(b({},an),{},{new_value:[].concat(xe(Yt),[null])})})}})))},j.getRemoveObject=function(_e){var ae=j.props,je=ae.theme,it=(ae.hover,ae.namespace),Ft=ae.name,Yt=ae.src,on=ae.rjvId;if(it.length!==1)return S.a.createElement("span",{className:"click-to-remove",style:{display:_e?"inline-block":"none"}},S.a.createElement(zn,Object.assign({className:"click-to-remove-icon"},Z(je,"removeVarIcon"),{onClick:function(){ne.dispatch({name:"VARIABLE_REMOVED",rjvId:on,data:{name:Ft,namespace:it.splice(0,it.length-1),existing_value:Yt,variable_removed:!0}})}})))},j.render=function(){var _e=j.props,ae=_e.theme,je=_e.onDelete,it=_e.onAdd,Ft=_e.enableClipboard,Yt=_e.src,on=_e.namespace,Lt=_e.rowHovered;return S.a.createElement("div",Object.assign({},Z(ae,"object-meta-data"),{className:"object-meta-data",onClick:function(an){an.stopPropagation()}}),j.getObjectSize(),Ft?S.a.createElement(Pn,{rowHovered:Lt,clickCallback:Ft,src:Yt,theme:ae,namespace:on}):null,it!==!1?j.getAddAttribute(Lt):null,je!==!1?j.getRemoveObject(Lt):null)},j}return R}(S.a.PureComponent);function jn(z){var U=z.parent_type,R=z.namespace,j=z.quotesOnKeys,F=z.theme,pe=z.jsvRoot,Ee=z.name,_e=z.displayArrayKey,ae=z.name?z.name:"";return!pe||Ee!==!1&&Ee!==null?U=="array"?_e?S.a.createElement("span",Object.assign({},Z(F,"array-key"),{key:R}),S.a.createElement("span",{className:"array-key"},ae),S.a.createElement("span",Z(F,"colon"),":")):S.a.createElement("span",null):S.a.createElement("span",Object.assign({},Z(F,"object-name"),{key:R}),S.a.createElement("span",{className:"object-key"},j&&S.a.createElement("span",{style:{verticalAlign:"top"}},'"'),S.a.createElement("span",null,ae),j&&S.a.createElement("span",{style:{verticalAlign:"top"}},'"')),S.a.createElement("span",Z(F,"colon"),":")):S.a.createElement("span",null)}function Un(z){var U=z.theme;switch(z.iconStyle){case"triangle":return S.a.createElement(Cn,Object.assign({},Z(U,"expanded-icon"),{className:"expanded-icon"}));case"square":return S.a.createElement(pt,Object.assign({},Z(U,"expanded-icon"),{className:"expanded-icon"}));default:return S.a.createElement(Fe,Object.assign({},Z(U,"expanded-icon"),{className:"expanded-icon"}))}}function Rs(z){var U=z.theme;switch(z.iconStyle){case"triangle":return S.a.createElement(mt,Object.assign({},Z(U,"collapsed-icon"),{className:"collapsed-icon"}));case"square":return S.a.createElement(En,Object.assign({},Z(U,"collapsed-icon"),{className:"collapsed-icon"}));default:return S.a.createElement(It,Object.assign({},Z(U,"collapsed-icon"),{className:"collapsed-icon"}))}}var ii=function(z){C(R,z);var U=N(R);function R(j){var F;return $(this,R),(F=U.call(this,j)).toggleCollapsed=function(pe){var Ee=[];for(var _e in F.state.expanded)Ee.push(F.state.expanded[_e]);Ee[pe]=!Ee[pe],F.setState({expanded:Ee})},F.state={expanded:[]},F}return w(R,[{key:"getExpandedIcon",value:function(j){var F=this.props,pe=F.theme,Ee=F.iconStyle;return this.state.expanded[j]?S.a.createElement(Un,{theme:pe,iconStyle:Ee}):S.a.createElement(Rs,{theme:pe,iconStyle:Ee})}},{key:"render",value:function(){var j=this,F=this.props,pe=F.src,Ee=F.groupArraysAfterLength,_e=(F.depth,F.name),ae=F.theme,je=F.jsvRoot,it=F.namespace,Ft=(F.parent_type,K(F,["src","groupArraysAfterLength","depth","name","theme","jsvRoot","namespace","parent_type"])),Yt=0,on=5*this.props.indentWidth;je||(Yt=5*this.props.indentWidth);var Lt=Ee,an=Math.ceil(pe.length/Lt);return S.a.createElement("div",Object.assign({className:"object-key-val"},Z(ae,je?"jsv-root":"objectKeyVal",{paddingLeft:Yt})),S.a.createElement(jn,this.props),S.a.createElement("span",null,S.a.createElement(Ks,Object.assign({size:pe.length},this.props))),xe(Array(an)).map(function(_n,Tt){return S.a.createElement("div",Object.assign({key:Tt,className:"object-key-val array-group"},Z(ae,"objectKeyVal",{marginLeft:6,paddingLeft:on})),S.a.createElement("span",Z(ae,"brace-row"),S.a.createElement("div",Object.assign({className:"icon-container"},Z(ae,"icon-container"),{onClick:function(In){j.toggleCollapsed(Tt)}}),j.getExpandedIcon(Tt)),j.state.expanded[Tt]?S.a.createElement(xr,Object.assign({key:_e+Tt,depth:0,name:!1,collapsed:!1,groupArraysAfterLength:Lt,index_offset:Tt*Lt,src:pe.slice(Tt*Lt,Tt*Lt+Lt),namespace:it,type:"array",parent_type:"array_group",theme:ae},Ft)):S.a.createElement("span",Object.assign({},Z(ae,"brace"),{onClick:function(In){j.toggleCollapsed(Tt)},className:"array-group-brace"}),"[",S.a.createElement("div",Object.assign({},Z(ae,"array-group-meta-data"),{className:"array-group-meta-data"}),S.a.createElement("span",Object.assign({className:"object-size"},Z(ae,"object-size")),Tt*Lt," - ",Tt*Lt+Lt>pe.length?pe.length:Tt*Lt+Lt)),"]")))}))}}]),R}(S.a.PureComponent),Ir=function(z){C(R,z);var U=N(R);function R(j){var F;$(this,R),(F=U.call(this,j)).toggleCollapsed=function(){F.setState({expanded:!F.state.expanded},function(){Te.set(F.props.rjvId,F.props.namespace,"expanded",F.state.expanded)})},F.getObjectContent=function(Ee,_e,ae){return S.a.createElement("div",{className:"pushed-content object-container"},S.a.createElement("div",Object.assign({className:"object-content"},Z(F.props.theme,"pushed-content")),F.renderObjectContents(_e,ae)))},F.getEllipsis=function(){return F.state.size===0?null:S.a.createElement("div",Object.assign({},Z(F.props.theme,"ellipsis"),{className:"node-ellipsis",onClick:F.toggleCollapsed}),"...")},F.getObjectMetaData=function(Ee){var _e=F.props,ae=(_e.rjvId,_e.theme,F.state),je=ae.size,it=ae.hovered;return S.a.createElement(Ks,Object.assign({rowHovered:it,size:je},F.props))},F.renderObjectContents=function(Ee,_e){var ae,je=F.props,it=je.depth,Ft=je.parent_type,Yt=je.index_offset,on=je.groupArraysAfterLength,Lt=je.namespace,an=F.state.object_type,_n=[],Tt=Object.keys(Ee||{});return F.props.sortKeys&&an!=="array"&&(Tt=Tt.sort()),Tt.forEach(function(In){if(ae=new ec(In,Ee[In]),Ft==="array_group"&&Yt&&(ae.name=parseInt(ae.name)+Yt),Ee.hasOwnProperty(In))if(ae.type==="object")_n.push(S.a.createElement(xr,Object.assign({key:ae.name,depth:it+1,name:ae.name,src:ae.value,namespace:Lt.concat(ae.name),parent_type:an},_e)));else if(ae.type==="array"){var ss=xr;on&&ae.value.length>on&&(ss=ii),_n.push(S.a.createElement(ss,Object.assign({key:ae.name,depth:it+1,name:ae.name,src:ae.value,namespace:Lt.concat(ae.name),type:"array",parent_type:an},_e)))}else _n.push(S.a.createElement(cs,Object.assign({key:ae.name+"_"+Lt,variable:ae,singleIndent:5,namespace:Lt,type:F.props.type},_e)))}),_n};var pe=R.getState(j);return F.state=b(b({},pe),{},{prevProps:{}}),F}return w(R,[{key:"getBraceStart",value:function(j,F){var pe=this,Ee=this.props,_e=Ee.src,ae=Ee.theme,je=Ee.iconStyle;if(Ee.parent_type==="array_group")return S.a.createElement("span",null,S.a.createElement("span",Z(ae,"brace"),j==="array"?"[":"{"),F?this.getObjectMetaData(_e):null);var it=F?Un:Rs;return S.a.createElement("span",null,S.a.createElement("span",Object.assign({onClick:function(Ft){pe.toggleCollapsed()}},Z(ae,"brace-row")),S.a.createElement("div",Object.assign({className:"icon-container"},Z(ae,"icon-container")),S.a.createElement(it,{theme:ae,iconStyle:je})),S.a.createElement(jn,this.props),S.a.createElement("span",Z(ae,"brace"),j==="array"?"[":"{")),F?this.getObjectMetaData(_e):null)}},{key:"render",value:function(){var j=this,F=this.props,pe=F.depth,Ee=F.src,_e=(F.namespace,F.name,F.type,F.parent_type),ae=F.theme,je=F.jsvRoot,it=F.iconStyle,Ft=K(F,["depth","src","namespace","name","type","parent_type","theme","jsvRoot","iconStyle"]),Yt=this.state,on=Yt.object_type,Lt=Yt.expanded,an={};return je||_e==="array_group"?_e==="array_group"&&(an.borderLeft=0,an.display="inline"):an.paddingLeft=5*this.props.indentWidth,S.a.createElement("div",Object.assign({className:"object-key-val",onMouseEnter:function(){return j.setState(b(b({},j.state),{},{hovered:!0}))},onMouseLeave:function(){return j.setState(b(b({},j.state),{},{hovered:!1}))}},Z(ae,je?"jsv-root":"objectKeyVal",an)),this.getBraceStart(on,Lt),Lt?this.getObjectContent(pe,Ee,b({theme:ae,iconStyle:it},Ft)):this.getEllipsis(),S.a.createElement("span",{className:"brace-row"},S.a.createElement("span",{style:b(b({},Z(ae,"brace").style),{},{paddingLeft:Lt?"3px":"0px"})},on==="array"?"]":"}"),Lt?null:this.getObjectMetaData(Ee)))}}],[{key:"getDerivedStateFromProps",value:function(j,F){var pe=F.prevProps;return j.src!==pe.src||j.collapsed!==pe.collapsed||j.name!==pe.name||j.namespace!==pe.namespace||j.rjvId!==pe.rjvId?b(b({},R.getState(j)),{},{prevProps:j}):null}}]),R}(S.a.PureComponent);Ir.getState=function(z){var U=Object.keys(z.src).length,R=(z.collapsed===!1||z.collapsed!==!0&&z.collapsed>z.depth)&&(!z.shouldCollapse||z.shouldCollapse({name:z.name,src:z.src,type:Y(z.src),namespace:z.namespace})===!1)&&U!==0;return{expanded:Te.get(z.rjvId,z.namespace,"expanded",R),object_type:z.type==="array"?"array":"object",parent_type:z.type==="array"?"array":"object",size:U,hovered:!1}};var ec=function z(U,R){$(this,z),this.name=U,this.value=R,this.type=Y(R)};ee(Ir);var xr=Ir,Ka=function(z){C(R,z);var U=N(R);function R(){var j;$(this,R);for(var F=arguments.length,pe=new Array(F),Ee=0;Ee<F;Ee++)pe[Ee]=arguments[Ee];return(j=U.call.apply(U,[this].concat(pe))).render=function(){var _e=A(j).props,ae=[_e.name],je=xr;return Array.isArray(_e.src)&&_e.groupArraysAfterLength&&_e.src.length>_e.groupArraysAfterLength&&(je=ii),S.a.createElement("div",{className:"pretty-json-container object-container"},S.a.createElement("div",{className:"object-content"},S.a.createElement(je,Object.assign({namespace:ae,depth:0,jsvRoot:!0},_e))))},j}return R}(S.a.PureComponent),tc=function(z){C(R,z);var U=N(R);function R(j){var F;return $(this,R),(F=U.call(this,j)).closeModal=function(){ne.dispatch({rjvId:F.props.rjvId,name:"RESET"})},F.submit=function(){F.props.submit(F.state.input)},F.state={input:j.input?j.input:""},F}return w(R,[{key:"render",value:function(){var j=this,F=this.props,pe=F.theme,Ee=F.rjvId,_e=F.isValid,ae=this.state.input,je=_e(ae);return S.a.createElement("div",Object.assign({className:"key-modal-request"},Z(pe,"key-modal-request"),{onClick:this.closeModal}),S.a.createElement("div",Object.assign({},Z(pe,"key-modal"),{onClick:function(it){it.stopPropagation()}}),S.a.createElement("div",Z(pe,"key-modal-label"),"Key Name:"),S.a.createElement("div",{style:{position:"relative"}},S.a.createElement("input",Object.assign({},Z(pe,"key-modal-input"),{className:"key-modal-input",ref:function(it){return it&&it.focus()},spellCheck:!1,value:ae,placeholder:"...",onChange:function(it){j.setState({input:it.target.value})},onKeyPress:function(it){je&&it.key==="Enter"?j.submit():it.key==="Escape"&&j.closeModal()}})),je?S.a.createElement(Rn,Object.assign({},Z(pe,"key-modal-submit"),{className:"key-modal-submit",onClick:function(it){return j.submit()}})):null),S.a.createElement("span",Z(pe,"key-modal-cancel"),S.a.createElement(Gs,Object.assign({},Z(pe,"key-modal-cancel-icon"),{className:"key-modal-cancel",onClick:function(){ne.dispatch({rjvId:Ee,name:"RESET"})}})))))}}]),R}(S.a.PureComponent),nc=function(z){C(R,z);var U=N(R);function R(){var j;$(this,R);for(var F=arguments.length,pe=new Array(F),Ee=0;Ee<F;Ee++)pe[Ee]=arguments[Ee];return(j=U.call.apply(U,[this].concat(pe))).isValid=function(_e){var ae=j.props.rjvId,je=Te.get(ae,"action","new-key-request");return _e!=""&&Object.keys(je.existing_value).indexOf(_e)===-1},j.submit=function(_e){var ae=j.props.rjvId,je=Te.get(ae,"action","new-key-request");je.new_value=b({},je.existing_value),je.new_value[_e]=j.props.defaultValue,ne.dispatch({name:"VARIABLE_ADDED",rjvId:ae,data:je})},j}return w(R,[{key:"render",value:function(){var j=this.props,F=j.active,pe=j.theme,Ee=j.rjvId;return F?S.a.createElement(tc,{rjvId:Ee,theme:pe,isValid:this.isValid,submit:this.submit}):null}}]),R}(S.a.PureComponent),Tu=function(z){C(R,z);var U=N(R);function R(){return $(this,R),U.apply(this,arguments)}return w(R,[{key:"render",value:function(){var j=this.props,F=j.message,pe=j.active,Ee=j.theme,_e=j.rjvId;return pe?S.a.createElement("div",Object.assign({className:"validation-failure"},Z(Ee,"validation-failure"),{onClick:function(){ne.dispatch({rjvId:_e,name:"RESET"})}}),S.a.createElement("span",Z(Ee,"validation-failure-label"),F),S.a.createElement(Gs,Z(Ee,"validation-failure-clear"))):null}}]),R}(S.a.PureComponent),Yo=function(z){C(R,z);var U=N(R);function R(j){var F;return $(this,R),(F=U.call(this,j)).rjvId=Date.now().toString(),F.getListeners=function(){return{reset:F.resetState,"variable-update":F.updateSrc,"add-key-request":F.addKeyRequest}},F.updateSrc=function(){var pe,Ee=Te.get(F.rjvId,"action","variable-update"),_e=Ee.name,ae=Ee.namespace,je=Ee.new_value,it=Ee.existing_value,Ft=(Ee.variable_removed,Ee.updated_src),Yt=Ee.type,on=F.props,Lt=on.onEdit,an=on.onDelete,_n=on.onAdd,Tt={existing_src:F.state.src,new_value:je,updated_src:Ft,name:_e,namespace:ae,existing_value:it};switch(Yt){case"variable-added":pe=_n(Tt);break;case"variable-edited":pe=Lt(Tt);break;case"variable-removed":pe=an(Tt)}pe!==!1?(Te.set(F.rjvId,"global","src",Ft),F.setState({src:Ft})):F.setState({validationFailure:!0})},F.addKeyRequest=function(){F.setState({addKeyRequest:!0})},F.resetState=function(){F.setState({validationFailure:!1,addKeyRequest:!1})},F.state={addKeyRequest:!1,editKeyRequest:!1,validationFailure:!1,src:R.defaultProps.src,name:R.defaultProps.name,theme:R.defaultProps.theme,validationMessage:R.defaultProps.validationMessage,prevSrc:R.defaultProps.src,prevName:R.defaultProps.name,prevTheme:R.defaultProps.theme},F}return w(R,[{key:"componentDidMount",value:function(){Te.set(this.rjvId,"global","src",this.state.src);var j=this.getListeners();for(var F in j)Te.on(F+"-"+this.rjvId,j[F]);this.setState({addKeyRequest:!1,editKeyRequest:!1})}},{key:"componentDidUpdate",value:function(j,F){F.addKeyRequest!==!1&&this.setState({addKeyRequest:!1}),F.editKeyRequest!==!1&&this.setState({editKeyRequest:!1}),j.src!==this.state.src&&Te.set(this.rjvId,"global","src",this.state.src)}},{key:"componentWillUnmount",value:function(){var j=this.getListeners();for(var F in j)Te.removeListener(F+"-"+this.rjvId,j[F])}},{key:"render",value:function(){var j=this.state,F=j.validationFailure,pe=j.validationMessage,Ee=j.addKeyRequest,_e=j.theme,ae=j.src,je=j.name,it=this.props,Ft=it.style,Yt=it.defaultValue;return S.a.createElement("div",{className:"react-json-view",style:b(b({},Z(_e,"app-container").style),Ft)},S.a.createElement(Tu,{message:pe,active:F,theme:_e,rjvId:this.rjvId}),S.a.createElement(Ka,Object.assign({},this.props,{src:ae,name:je,theme:_e,type:Y(ae),rjvId:this.rjvId})),S.a.createElement(nc,{active:Ee,theme:_e,rjvId:this.rjvId,defaultValue:Yt}))}}],[{key:"getDerivedStateFromProps",value:function(j,F){if(j.src!==F.prevSrc||j.name!==F.prevName||j.theme!==F.prevTheme){var pe={src:j.src,name:j.name,theme:j.theme,validationMessage:j.validationMessage,prevSrc:j.src,prevName:j.name,prevTheme:j.theme};return R.validateState(pe)}return null}}]),R}(S.a.PureComponent);Yo.defaultProps={src:{},name:"root",theme:"rjv-default",collapsed:!1,collapseStringsAfterLength:!1,shouldCollapse:!1,sortKeys:!1,quotesOnKeys:!0,groupArraysAfterLength:100,indentWidth:4,enableClipboard:!0,displayObjectSize:!0,displayDataTypes:!0,onEdit:!1,onDelete:!1,onAdd:!1,onSelect:!1,iconStyle:"triangle",style:{},validationMessage:"Validation Error",defaultValue:null,displayArrayKey:!0},Yo.validateState=function(z){var U={};return Y(z.theme)!=="object"||function(R){var j=["base00","base01","base02","base03","base04","base05","base06","base07","base08","base09","base0A","base0B","base0C","base0D","base0E","base0F"];if(Y(R)==="object"){for(var F=0;F<j.length;F++)if(!(j[F]in R))return!1;return!0}return!1}(z.theme)||(console.error("react-json-view error:","theme prop must be a theme name or valid base-16 theme object.",'defaulting to "rjv-default" theme'),U.theme="rjv-default"),Y(z.src)!=="object"&&Y(z.src)!=="array"&&(console.error("react-json-view error:","src property must be a valid json object"),U.name="ERROR",U.src={message:"src property must be a valid json object"}),b(b({},z),U)},ee(Yo),a.default=Yo}])})})(Lw);var XL=Lw.exports;const ZL=Ga(XL),bn={frameRoot:{paddingTop:0,paddingBottom:0},frameTextRoot:{m:0},frameTextPrimary:o=>({color:o.palette.mode==="dark"?"#CCC":"#333"}),frameTextSecondary:{fontStyle:"italic",fontSize:12,opacity:.6,pl:1},listRoot:{padding:0,fontSize:"small"},scopeType:{verticalAlign:"top",textTransform:"uppercase",width:50},scopeType_local:{color:"#53a944"},scopeType_closure:{color:"#365b80"},scopeType_user:{color:"#a48a15"},scopeName:{color:"#bc5b5b",width:"calc(100% - 82px)",whiteSpace:"nowrap",textOverflow:"ellipsis"},scopeButton:{width:32},scopeValueEditable:{cursor:"pointer"},selectedFrame:{backgroundColor:"#777",color:"white"},splitter:{width:"100%",height:"calc(100% - 36px)",overflow:"hidden",fontSize:12},toolbarScopes:o=>({width:24,display:"inline-block",height:"100%",background:o.palette.mode==="dark"?"#222":"#EEE",verticalAlign:"top"}),scopesAfterToolbar:{width:"calc(100% - 24px)",display:"inline-block",height:"100%",verticalAlign:"top"},scopeNameName:{fontWeight:"bold",display:"inline-block",verticalAlign:"top"},scopeNameEqual:o=>({display:"inline-block",color:o.palette.mode==="dark"?"#EEE":"#222",verticalAlign:"top"}),scopeNameValue:{verticalAlign:"top",display:"inline-block",color:"#3b709f",whiteSpace:"nowrap"},scopeButtonDel:{padding:0,float:"right"},valueNull:{color:"#a44a24"},valueUndefined:{color:"#a44a24"},valueString:{color:"#1e8816"},valueNumber:{color:"#163c88"},valueBoolean:{color:"#a44a24"},valueObject:{color:"#721b70"},valueNone:{color:"#8a8a8a"},valueFunc:{color:"#ac4343"},error:o=>({color:o.palette.mode==="dark"?"#FF8080":"#FF0000",fontStyle:"italic"})};function QL(o){var s,i;const n={};return o.className==="ReferenceError"?o.description:((i=(s=o.preview)==null?void 0:s.properties)==null||i.forEach(a=>{(a==null?void 0:a.type)==="object"?a.subtype==="null"?n[a.name]=null:n[a.name]=`{ ${a.value==="Object"?"...":a.value} }`:a.type==="boolean"?n[a.name||a.description]=a.value==="true":a.type==="number"?n[a.name||a.description]=parseFloat(a.value):a.type==="function"?n[a.name||a.description]="function(){}":a.type==="undefined"?n[a.name||a.description]=void 0:n[a.name||a.description]=a.value}),n)}let eB=class extends We.Component{editRef;scopeValue=null;constructor(n){super(n);const s=window.localStorage.getItem("JS.framesSizes");let i=[30,70];if(s)try{i=JSON.parse(s)}catch{}this.state={editValue:null,callFrames:this.props.callFrames,framesSizes:i},this.editRef=We.createRef()}onExpressionNameUpdate(){this.state.editValue&&this.props.onExpressionNameUpdate(this.state.editValue.index,this.scopeValue,()=>{this.setState({editValue:null}),this.scopeValue=null})}renderExpression(n,s){const i=this.state.editValue&&this.state.editValue.type==="expression"&&this.state.editValue.index===s?f.jsx(D.Input,{inputRef:this.editRef,fullWidth:!0,margin:"dense",onBlur:()=>this.state.editValue&&this.setState({editValue:null}),defaultValue:n.name,onKeyUp:a=>{a.key==="Enter"?this.onExpressionNameUpdate():a.key==="Escape"&&this.setState({editValue:null})},onChange:a=>this.scopeValue=a.target.value,endAdornment:f.jsx(D.InputAdornment,{position:"end",children:f.jsx(D.IconButton,{onClick:()=>this.onExpressionNameUpdate(),size:"medium",children:f.jsx(b_,{})})})}):[f.jsx("div",{style:bn.scopeNameName,title:I.I18n.t("Double click to edit expression"),children:n.name},"name"),f.jsxs(D.Box,{sx:bn.scopeNameEqual,children:[" ","="," "]},"="),f.jsx("div",{style:bn.scopeNameValue,children:this.formatValue(n.value)},"val")];return f.jsxs("tr",{children:[f.jsx("td",{style:{...bn.scopeType,...bn.scopeType_user},children:"user"}),f.jsx("td",{style:bn.scopeName,onDoubleClick:()=>{this.scopeValue=n.name||"",this.setState({editValue:{type:"expression",valueType:"string",index:s,name:n.name,value:n.name||""}})},children:i}),f.jsx(D.IconButton,{style:bn.scopeButtonDel,size:"small",disabled:!!this.state.editValue,onClick:()=>this.props.onExpressionDelete(s),children:f.jsx(A$,{})})]},`user_${s}${n.name}`)}renderExpressions(){return this.props.expressions.map((n,s)=>this.renderExpression(n,s))}renderOneFrameTitle(n,s){if(this.props.mainScriptId===this.props.currentScriptId&&n.location.scriptId!==this.props.mainScriptId)return null;const i=(n.url.split("/").pop()||"").replace(/^script\.js\./,"");return f.jsx(D.ListItemButton,{onClick:()=>this.props.onChangeCurrentFrame(s),dense:!0,selected:this.props.currentFrame===s,style:bn.frameRoot,children:f.jsx(D.ListItemText,{sx:{...bn.frameTextRoot,"& .MuiListItemText-primary":bn.frameTextPrimary,"& .MuiListItemText-secondary":bn.frameTextSecondary},title:n.url,primary:n.functionName||"anonymous",secondary:`${i} (${n.location.lineNumber}:${n.location.columnNumber})`})},n.callFrameId)}formatValue(n,s){if(!n)return s?"none":f.jsx("span",{style:bn.valueNone,children:"none"});if(n.type==="undefined")return s?"undefined":f.jsx("span",{style:bn.valueUndefined,children:"undefined"});if(n.type==="null")return s?"null":f.jsx("span",{style:bn.valueNull,children:"null"});if(n.type==="function"){const i=n.description?n.description.length>100?`${n.description.substring(0,100)}...`:n.description:"function";return s?i:f.jsx("span",{style:bn.valueFunc,title:n.description,children:i})}if(n.type==="object"){const i=QL(n);return s?JSON.stringify(i):typeof i=="string"?f.jsx(D.Box,{component:"span",sx:bn.error,children:i}):f.jsx(ZL,{name:!1,enableClipboard:!1,style:{backgroundColor:"inherit",marginTop:3},src:i,collapsed:!0,theme:this.props.themeType==="dark"?"brewer":"rjv-default",displayDataTypes:!1})}if(n.value===void 0)return s?"undefined":f.jsx("span",{style:bn.valueUndefined,children:"undefined"});if(n.value===null)return s?"null":f.jsx("span",{style:bn.valueNull,children:"null"});if(n.type==="string"){if(s)return n.value;const i=`"${n.value?n.value.length>100?`${n.value.substring(0,100)}...`:n.value:""}"`;return f.jsx("span",{style:bn.valueString,title:i,children:i})}return n.type==="boolean"?s?n.value.toString():f.jsx("span",{style:bn.valueBoolean,children:n.value.toString()}):n.value.toString()}onWriteScopeValue(){var n,s;this.scopeValue==="true"?this.scopeValue=!0:this.scopeValue==="false"?this.scopeValue=!1:this.scopeValue==="null"?this.scopeValue=null:this.scopeValue==="undefined"?this.scopeValue=void 0:parseFloat(this.scopeValue).toString()===this.scopeValue&&(this.scopeValue=parseFloat(this.scopeValue)),this.props.onWriteScopeValue({variableName:((n=this.state.editValue)==null?void 0:n.name)||"",scopeNumber:0,newValue:{value:this.scopeValue,valueType:typeof this.scopeValue},callFrameId:(s=this.props.callFrames)==null?void 0:s[this.props.currentFrame].callFrameId}),this.setState({editValue:null}),this.scopeValue=null}componentDidUpdate(){var n;(n=this.editRef.current)==null||n.focus()}renderScope(n,s,i){var h,g,b,$;const a=!this.props.currentFrame&&s.value&&(s.value.type==="undefined"||s.value.type==="string"||s.value.type==="number"||s.value.type==="boolean"||((h=s.value)==null?void 0:h.value)===null||((g=s.value)==null?void 0:g.value)===void 0&&s.value.type!=="object"),c=((b=this.state.editValue)==null?void 0:b.type)===i&&(($=this.state.editValue)==null?void 0:$.name)===s.name?[f.jsx("div",{style:bn.scopeNameName,children:s.name},"name"),f.jsxs(D.Box,{sx:bn.scopeNameEqual,children:[" ","="," "]},"="),f.jsx(D.Input,{inputRef:this.editRef,margin:"dense",onBlur:()=>this.state.editValue&&this.setState({editValue:null}),defaultValue:this.formatValue(s.value,!0),onKeyUp:y=>{y.key==="Enter"?this.onWriteScopeValue():y.key==="Escape"&&this.setState({editValue:null})},onChange:y=>this.scopeValue=y.target.value,endAdornment:f.jsx(D.InputAdornment,{position:"end",children:f.jsx(D.IconButton,{onClick:()=>this.onWriteScopeValue(),size:"medium",children:f.jsx(b_,{})})})},"input")]:[f.jsx("div",{style:bn.scopeNameName,title:I.I18n.t("Double click to write value"),children:s.name},"name"),f.jsxs(D.Box,{sx:bn.scopeNameEqual,children:[" ","="," "]},"="),f.jsxs("div",{style:bn.scopeNameValue,children:[this.formatValue(s.value)," (",s.value.type,")"]},"val")];return f.jsxs("tr",{children:[f.jsx("td",{style:{...bn.scopeType,...bn[`scopeType_${i}`]},children:i}),f.jsx("td",{style:{...bn.scopeName,...!this.props.currentFrame&&a?bn.scopeValueEditable:void 0},onDoubleClick:()=>{a&&(this.scopeValue=s.value.value,this.setState({editValue:{scopeId:n,type:i,index:0,valueType:s.value.type,name:s.name,value:s.value.value}}))},children:c})]},`${i}_${n}_${s.name}`)}renderScopes(n){var a,c,h,g,b,$;if(!n)return null;const s=this.renderExpressions();let i=(h=(c=(a=this.props.scopes)==null?void 0:a.local)==null?void 0:c.properties)==null?void 0:h.result.map(y=>this.props.scopes&&this.renderScope("",y,"local"));return i==null||i.forEach(y=>y&&s.push(y)),i=($=(b=(g=this.props.scopes)==null?void 0:g.closure)==null?void 0:b.properties)==null?void 0:$.result.map(y=>this.props.scopes&&this.renderScope("",y,"closure")),i==null||i.forEach(y=>y&&s.push(y)),f.jsx("table",{style:{width:"100%",fontSize:"small"},children:f.jsx("tbody",{children:s})})}render(){var n,s;return f.jsxs(J$,{direction:Bn.Horizontal,initialSizes:this.state.framesSizes,minWidths:[100,200],onResizeFinished:(i,a)=>{this.setState({framesSizes:a}),window.localStorage.setItem("JS.framesSizes",JSON.stringify(a))},gutterClassName:this.props.themeType==="dark"?"Dark visGutter":"Light visGutter",children:[f.jsx("div",{style:{width:"100%",height:"100%",overflow:"auto"},children:f.jsx(D.List,{style:bn.listRoot,children:((n=this.props.callFrames)==null?void 0:n.map((i,a)=>this.renderOneFrameTitle(i,a)))||null})}),f.jsxs("div",{style:{width:"100%",height:"100%",overflow:"auto"},children:[f.jsx(D.Box,{sx:bn.toolbarScopes,children:f.jsx(D.IconButton,{size:"small",onClick:()=>this.props.onExpressionAdd((i,a)=>{this.scopeValue=a.name||"",this.setState({editValue:{type:"expression",valueType:"string",index:i,name:a.name,value:a.name||""}})}),children:f.jsx(Ev,{})})}),f.jsx("div",{style:bn.scopesAfterToolbar,children:((s=this.props.callFrames)==null?void 0:s.length)&&this.renderScopes(this.props.callFrames[this.props.currentFrame])})]})]})}};const _s={root:o=>({width:"100%",height:`calc(100% - ${parseInt(o.toolbar.height,10)+38+5}px)`,overflow:"hidden",position:"relative"}),toolbar:{minHeight:38,boxShadow:"0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12)"},buttonRun:{color:"green"},buttonPause:{color:"orange"},buttonRestart:{color:"darkgreen"},buttonNext:{color:"blue"},buttonStep:{color:"blue"},buttonOut:{color:"blue"},buttonException:{},tabFile:o=>({textTransform:"inherit",color:o.palette.mode==="dark"?"#DDD":"inherit"}),tabText:{maxWidth:130,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",display:"inline-block",verticalAlign:"middle"},closeButton:{position:"absolute",top:8,right:0,zIndex:10,padding:8,cursor:"pointer"},tabsRoot:o=>({minHeight:24,background:o.palette.mode==="dark"?"#333":"#e6e6e6",color:o.palette.mode==="dark"?"white":"inherit"}),tabRoot:{minHeight:24},bpListItem:{borderTop:"1px dashed #bfbfbf44"},monospace:{fontFamily:"Courier New, monospace",whiteSpace:"pre",fontSize:12},arrow:{color:"#fffa4f"}};class $v extends We.Component{console=null;scripts={};mainScriptId=null;constructor(n){super(n);const s=window.localStorage.getItem(`javascript.tools.bp.${this.props.src}`);let i;try{i=s?JSON.parse(s):[]}catch{i=[]}const a=window.localStorage.getItem(`javascript.tools.exps.${this.props.src}`);let c;try{c=(a?JSON.parse(a):[]).map($=>({name:$,value:{type:"undefined",description:"",value:"undefined",name:"name"}}))}catch{c=[]}const h=window.localStorage.getItem("JS.toolSizes");let g=[80,20];if(h)try{g=JSON.parse(h)}catch{}this.state={starting:!0,selected:null,tabs:{},script:"",breakpoints:i,expressions:c,running:!1,error:"",started:!1,paused:!0,location:null,toolsTab:window.localStorage.getItem("javascript.tools.tab")||"console",stopOnException:window.localStorage.getItem("javascript.tools.stopOnException")==="true",console:[],finished:!1,currentFrame:0,scopes:{},queryBreakpoints:null,logErrors:0,logWarnings:0,logs:0,toolSizes:g,instance:void 0,context:null}}async componentDidMount(){var s,i;let n;if(this.props.debugInstance)n=this.props.debugInstance.instance;else{const a=await this.props.socket.getObject(this.props.src);n=((i=(s=a==null?void 0:a.common)==null?void 0:s.engine)==null?void 0:i.replace("system.adapter.",""))||""}this.setState({instance:n},()=>{this.state.instance?(this.props.socket.setState(`${this.state.instance}.debug.from`,{val:'{"cmd": "subscribed"}',ack:!0}),setTimeout(()=>this.props.socket.subscribeState(`${this.state.instance}.debug.from`,this.fromInstance),200)):this.setState({error:"Unknown instance"})})}componentWillUnmount(){this.state.instance&&(this.props.socket.unsubscribeState(`${this.state.instance}.debug.from`,this.fromInstance),this.props.socket.sendTo(this.state.instance,"debugStop"))}sendToInstance(n){this.props.socket.setState(`${this.state.instance}.debug.to`,{val:JSON.stringify(n),ack:!1})}reinitBreakpoints(n){if(this.state.breakpoints.length){const i=JSON.parse(JSON.stringify(this.state.breakpoints)).map(a=>a.location);this.setState({breakpoints:[]},()=>{this.sendToInstance({breakpoints:i,cmd:"sb"}),this.state.stopOnException&&this.sendToInstance({cmd:"stopOnException",state:!0}),n&&n()})}else this.state.stopOnException&&this.sendToInstance({cmd:"stopOnException",state:!0}),n&&n()}static getLocation(n){return n.callFrames?n.callFrames[0].location:null}readCurrentScope(){var s;const n=((s=this.state.context)==null?void 0:s.callFrames)&&this.state.context.callFrames[this.state.currentFrame];if(n){const i=n.scopeChain.filter(a=>a.type!=="global");i.length?this.sendToInstance({cmd:"scope",scopes:i}):(this.state.scopes.global||this.state.scopes.local||this.state.scopes.closure)&&this.setState({scopes:{}})}}readExpressions(n){var s;this.state.expressions.length&&((s=this.state.context)!=null&&s.callFrames)&&this.state.context.callFrames[this.state.currentFrame]&&(n!==void 0?this.sendToInstance({cmd:"expressions",expressions:[this.state.expressions[n]],callFrameId:this.state.context.callFrames[this.state.currentFrame].callFrameId}):this.sendToInstance({cmd:"expressions",expressions:this.state.expressions,callFrameId:this.state.context.callFrames[this.state.currentFrame].callFrameId}))}fromInstance=(n,s)=>{var i,a,c,h,g,b,$,y,w,T;if(s!=null&&s.val&&this.state.instance!==void 0)try{const C=JSON.parse(s.val);if(C.cmd==="subscribed")this.props.socket.sendTo(this.state.instance,"debug",this.props.debugInstance||{scriptName:this.props.src});else if(C.cmd==="readyToDebug"){this.mainScriptId=C.scriptId,this.scripts[C.scriptId]=C.script,C.script.startsWith(`(async () => {debugger;
`)?this.scripts[C.scriptId]=`(async () => {
${C.script.substring(24)}`:C.script.startsWith("debugger;")&&(this.scripts[C.scriptId]=C.script.substring(9));const E=JSON.parse(JSON.stringify(this.state.tabs));E[C.scriptId]=this.props.debugInstance?C.url:this.props.src.replace("script.js.","");const k=`${Date.now()}.${Math.random()*1e4}`;(a=(i=C.context)==null?void 0:i.callFrames)==null||a.forEach((A,P)=>A.id=k+P),this.setState({starting:!1,finished:!1,selected:this.mainScriptId,script:this.scripts[C.scriptId],tabs:E,currentFrame:0,started:!0,paused:!0,location:$v.getLocation(C.context),context:C.context},()=>this.reinitBreakpoints(()=>{this.readCurrentScope(),this.readExpressions()}))}else if(C.cmd==="paused"){const E=`${Date.now()}.${Math.random()*1e4}`;(h=(c=C.context)==null?void 0:c.callFrames)==null||h.forEach((B,S)=>B.id=E+S);const k=$v.getLocation(C.context),A=JSON.parse(JSON.stringify(this.state.tabs)),P=C.context.callFrames[0].url.split("iobroker.javascript");k&&(A[k.scriptId]=(P[1]||P[0]).replace("script.js.",""));const N={tabs:A,paused:!0,location:k,currentFrame:0,context:C.context};N.script=!(k!=null&&k.scriptId)||this.scripts[k.scriptId]===void 0?I.I18n.t("loading..."):this.scripts[k.scriptId],N.selected=k==null?void 0:k.scriptId,this.setState(N,()=>{this.readCurrentScope(),this.readExpressions(),k!=null&&k.scriptId&&(this.scripts[k.scriptId]||this.sendToInstance({cmd:"source",scriptId:k.scriptId}))})}else if(C.cmd==="script")this.scripts[C.scriptId]=C.text,this.state.selected===C.scriptId&&this.setState({script:this.scripts[C.scriptId]});else if(C.cmd==="resumed")this.setState({paused:!1});else if(C.cmd==="log")if(this.state.toolsTab==="console"){this.console=null;const E=[...this.state.console];E.push({text:C.text,severity:C.severity,ts:C.ts}),this.setState({console:E})}else C.severity==="error"?this.setState({logErrors:this.state.logErrors+1}):C.severity==="warn"?this.setState({logWarnings:this.state.logWarnings+1}):this.setState({logs:this.state.logs+1}),this.console=this.console||[...this.state.console],this.console.push({text:C.text,severity:C.severity,ts:C.ts});else if(C.cmd==="error")this.setState({error:C.error});else if(C.cmd==="finished"||C.cmd==="debugStopped")this.setState({finished:!0,starting:!1,started:!0});else if(C.cmd==="sb"){const E=JSON.parse(JSON.stringify(this.state.breakpoints));let k=!1;C.breakpoints.filter(A=>A).forEach(A=>{E.find(N=>N.location.scriptId===A.location.scriptId&&N.location.lineNumber===A.location.lineNumber)||(k=!0,E.push(A))}),k&&window.localStorage.setItem(`javascript.tools.bp.${this.props.src}`,JSON.stringify(E)),k&&this.setState({breakpoints:E})}else if(C.cmd==="cb"){const E=JSON.parse(JSON.stringify(this.state.breakpoints));let k=!1;C.breakpoints.filter(A=>A!=null).forEach(A=>{const P=E.find(N=>N.id===A);if(P){const N=E.indexOf(P);E.splice(N,1),k=!0}}),k&&window.localStorage.setItem(`javascript.tools.bp.${this.props.src}`,JSON.stringify(E)),k&&this.setState({breakpoints:E})}else if(C.cmd==="scope"){const E=C.scopes.find(A=>A.type==="local")||void 0,k=C.scopes.find(A=>A.type==="closure")||void 0;console.log(JSON.stringify(k)),this.setState({scopes:{local:E,closure:k}})}else if(C.cmd==="setValue"){const E=JSON.parse(JSON.stringify(this.state.scopes));let k;C.scopeNumber===0?k=(b=(g=E==null?void 0:E.local)==null?void 0:g.properties)==null?void 0:b.result.find(A=>A.name===C.variableName):k=(y=($=E==null?void 0:E.closure)==null?void 0:$.properties)==null?void 0:y.result.find(A=>A.name===C.variableName),k&&(k.value.value=C.newValue.value,this.setState({scopes:E}))}else if(C.cmd==="expressions"){const E=JSON.parse(JSON.stringify(this.state.expressions));let k=!1;C.expressions.forEach(A=>{const P=E.find(N=>N.name===A.name);P&&(k=!0,P.value=A.result)}),k&&this.setState({expressions:E}),console.log(`expressions: ${JSON.stringify(C)}`)}else C.cmd==="getPossibleBreakpoints"?((w=C.breakpoints)==null?void 0:w.length)===1?this.sendToInstance({breakpoints:C.breakpoints,cmd:"sb"}):(T=C.breakpoints)!=null&&T.length?this.setState({queryBreakpoints:C.breakpoints}):window.alert("cannot set"):console.error(`Unknown command: ${JSON.stringify(C)}`)}catch{}};getTextAtLocation(n){let s=this.state.script.split(/\r\n|\n/)[n.lineNumber],i;return n.columnNumber!==void 0&&n.columnNumber>=10?(s=s.substring(n.columnNumber-10,n.columnNumber+20),i=`${"".padStart(10," ")}`):n.columnNumber!==void 0&&(s=s.substring(0,30-n.columnNumber),i=`${"".padStart(n.columnNumber," ")}`),[f.jsx("div",{style:_s.monospace,children:s},"line"),f.jsx("div",{style:{..._s.monospace,..._s.arrow},children:i},"arrow")]}renderQueryBreakpoints(){return this.state.queryBreakpoints?f.jsxs(D.Dialog,{onClose:()=>this.setState({queryBreakpoints:null}),"aria-labelledby":"bp-dialog-title",open:!0,children:[f.jsx(D.DialogTitle,{id:"bp-dialog-title",children:I.I18n.t("Select breakpoint")}),f.jsx(D.List,{children:this.state.queryBreakpoints.map((n,s)=>f.jsx(D.ListItemButton,{style:_s.bpListItem,dense:!0,onClick:()=>{this.sendToInstance({breakpoints:[n],cmd:"sb"}),this.setState({queryBreakpoints:null})},children:f.jsx(D.ListItemText,{primary:this.getTextAtLocation(n)})},s))})]}):null}renderError(){return this.state.error?f.jsx(Hf,{onClose:()=>this.setState({error:""}),text:this.state.error},"dialogError"):null}closeTab(n,s){s==null||s.stopPropagation();const i=JSON.parse(JSON.stringify(this.state.tabs));delete i[n];const a={tabs:i,script:this.mainScriptId?this.scripts[this.mainScriptId]:"...",selected:this.mainScriptId};this.state.location&&this.state.location.scriptId!==this.mainScriptId&&(a.location=null),this.setState(a)}renderTabs(){const n=!this.state.tabs||!this.state.started;return f.jsx(D.Tabs,{component:"div",indicatorColor:"primary",style:{position:"relative",width:"calc(100% - 300px)",display:"inline-block"},value:this.state.selected,onChange:(s,i)=>{this.scripts[i]?this.setState({selected:i,script:this.scripts[i]}):this.setState({selected:i,script:"loading..."},()=>this.sendToInstance({cmd:"source",scriptId:i}))},scrollButtons:"auto",children:Object.keys(this.state.tabs||[]).map(s=>{let i=s;const a=this.state.tabs[s]||"";this.state.tabs[s]&&(i=this.state.tabs[s].split("/").pop()||"");const c=[f.jsx("div",{style:_s.tabText,children:i},"text"),s!==this.mainScriptId?f.jsx("span",{style:_s.closeButton,children:f.jsx(Xl,{onClick:h=>this.closeTab(s,h),fontSize:"small"},"close")},"icon"):null];return f.jsx(D.Tab,{disabled:n,sx:_s.tabFile,label:c,title:a,value:s},s)})})}onResume(){this.sendToInstance({cmd:"cont"})}onPause(){this.sendToInstance({cmd:"pause"})}onNext(){this.sendToInstance({cmd:"next"})}onStepIn(){this.sendToInstance({cmd:"step"})}onStepOut(){this.sendToInstance({cmd:"out"})}onRestart(){this.setState({started:!1,starting:!0},()=>this.state.instance!==void 0&&this.props.socket.sendTo(this.state.instance,"debug",this.props.debugInstance||{scriptName:this.props.src}))}onToggleException(){const n=!this.state.stopOnException;window.localStorage.setItem("javascript.tools.stopOnException",n?"true":"false"),this.setState({stopOnException:n},()=>this.sendToInstance({cmd:"stopOnException",state:n}))}renderToolbar(){const n=!this.state.started;return f.jsxs(D.Toolbar,{variant:"dense",style:_s.toolbar,children:[f.jsx(D.IconButton,{style:_s.buttonRestart,disabled:n,onClick:()=>this.onRestart(),title:I.I18n.t("Restart"),size:"medium",children:f.jsx(H0,{})}),!this.state.finished&&this.state.paused?f.jsx(D.IconButton,{style:_s.buttonRun,disabled:n,onClick:()=>this.onResume(),title:I.I18n.t("Resume execution"),size:"medium",children:f.jsx(V$,{})}):!this.state.finished&&f.jsx(D.IconButton,{disabled:n,style:_s.buttonPause,onClick:()=>this.onPause(),title:I.I18n.t("Pause execution"),size:"medium",children:f.jsx(vf,{})}),!this.state.finished&&f.jsx(D.IconButton,{style:_s.buttonNext,disabled:n||!this.state.paused,onClick:()=>this.onNext(),title:I.I18n.t("Go to next line"),size:"medium",children:f.jsx(YI,{})}),!this.state.finished&&f.jsx(D.IconButton,{style:_s.buttonStep,disabled:n||!this.state.paused,onClick:()=>this.onStepIn(),title:I.I18n.t("Step into function"),size:"medium",children:f.jsx(XI,{})}),!this.state.finished&&f.jsx(D.IconButton,{style:_s.buttonOut,disabled:n||!this.state.paused,onClick:()=>this.onStepOut(),title:I.I18n.t("Step out from function"),size:"medium",children:f.jsx(ZI,{})}),!this.state.finished&&f.jsx(D.IconButton,{style:_s.buttonException,color:this.state.stopOnException?"primary":"default",disabled:n||!this.state.paused,onClick:()=>this.onToggleException(),title:I.I18n.t("Stop on exception"),size:"medium",children:f.jsx(QI,{})}),this.renderTabs()]},"toolbar1")}getPossibleBreakpoints(n){const s={...n,columnNumber:1e3};this.sendToInstance({cmd:"getPossibleBreakpoints",start:n,end:s})}toggleBreakpoint(n){const s=this.state.breakpoints.find(i=>i.location.scriptId===this.state.selected&&i.location.lineNumber===n);if(s){const i=JSON.parse(JSON.stringify(this.state.breakpoints));this.setState({breakpoints:i},()=>this.sendToInstance({breakpoints:[s.id],cmd:"cb"}))}else this.getPossibleBreakpoints({scriptId:this.state.selected,lineNumber:n,columnNumber:0})}renderCode(){if(this.state.script&&this.state.started){const n=this.state.breakpoints.filter(s=>s.location.scriptId===this.state.selected);return f.jsx(KL,{runningInstances:this.props.runningInstances,socket:this.props.socket,adapterName:this.props.adapterName,scriptName:this.state.selected?this.state.tabs[this.state.selected]:"",sourceId:this.state.selected,script:this.state.script,paused:this.state.paused,breakpoints:n,location:this.state.location,themeType:this.props.themeType,themeName:this.props.themeName,onToggleBreakpoint:s=>this.toggleBreakpoint(s)})}return null}renderFrames(){var n;return this.state.paused?f.jsx(eB,{currentScriptId:this.state.selected,scopes:this.state.scopes,expressions:this.state.expressions,themeType:this.props.themeType,callFrames:(n=this.state.context)==null?void 0:n.callFrames,currentFrame:this.state.currentFrame,onChangeCurrentFrame:s=>{this.setState({currentFrame:s,scopes:{}},()=>{this.readCurrentScope(),this.readExpressions()})},onWriteScopeValue:s=>{this.sendToInstance({cmd:"setValue",variableName:s.variableName,scopeNumber:s.scopeNumber,newValue:s.newValue,callFrameId:s.callFrameId})},onExpressionDelete:s=>{const i=JSON.parse(JSON.stringify(this.state.expressions));i.splice(s,1),this.setState({expressions:i}),window.localStorage.setItem(`javascript.tools.exps.${this.props.src}`,JSON.stringify(i.map(a=>a.name)))},onExpressionAdd:s=>{const i=JSON.parse(JSON.stringify(this.state.expressions));i.push({name:"",value:{value:""}}),this.setState({expressions:i},()=>s&&s(i.length-1,this.state.expressions[i.length-1]))},onExpressionNameUpdate:(s,i,a)=>{const c=JSON.parse(JSON.stringify(this.state.expressions));if(!i)c.splice(s,1);else{if(c.find(h=>h.name===i))return a&&a();c[s].name=i}this.setState({expressions:c},()=>{i&&this.readExpressions(s),a&&a()}),window.localStorage.setItem(`javascript.tools.exps.${this.props.src}`,JSON.stringify(c.map(h=>h.name)))}}):null}renderConsole(){return f.jsx(qL,{console:this.state.console,onClearAllLogs:()=>this.setState({console:[],logErrors:0,logWarnings:0,logs:0})})}renderTools(){const n=!this.state.tabs||!this.state.started;let s;return this.state.logErrors?s=f.jsx(D.Badge,{badgeContent:this.state.logErrors,color:"error",children:f.jsx("span",{children:I.I18n.t("Console")})}):this.state.logWarnings?s=f.jsx(D.Badge,{badgeContent:this.state.logWarnings,color:"secondary",children:f.jsx("span",{children:I.I18n.t("Console")})}):this.state.logs?s=f.jsx(D.Badge,{badgeContent:this.state.logs,color:"default",children:f.jsx("span",{children:I.I18n.t("Console")})}):s=I.I18n.t("Console"),f.jsxs("div",{style:{width:"100%",height:"100%",overflow:"hidden"},children:[f.jsxs(D.Tabs,{sx:_s.tabsRoot,component:"div",indicatorColor:"primary",style:{position:"relative",width:"100%"},value:this.state.toolsTab,onChange:(i,a)=>{const c={toolsTab:a};this.console&&a==="console"&&(c.console=this.console,this.console=null,c.logs=0,c.logWarnings=0,c.logErrors=0),window.localStorage.setItem("javascript.tools.tab",a),this.setState(c)},scrollButtons:"auto",children:[f.jsx(D.Tab,{style:_s.tabRoot,disabled:n,label:I.I18n.t("Stack"),value:"stack"}),f.jsx(D.Tab,{style:_s.tabRoot,disabled:n,label:s,value:"console"})]}),f.jsxs("div",{style:{width:"100%",height:"calc(100% - 36px)",overflow:"hidden"},children:[this.state.toolsTab==="stack"&&!n?this.renderFrames():null,this.state.toolsTab==="console"&&!n?this.renderConsole():null]})]})}render(){return f.jsxs(D.Box,{sx:_s.root,children:[this.state.starting?f.jsx(D.LinearProgress,{}):null,this.renderToolbar(),f.jsxs(J$,{direction:Bn.Vertical,initialSizes:this.state.toolSizes,minHeights:[100,100],onResizeFinished:(n,s)=>{this.setState({toolSizes:s}),window.localStorage.setItem("JS.toolSizes",JSON.stringify(s))},gutterClassName:this.props.themeType==="dark"?"Dark visGutter":"Light visGutter",children:[f.jsxs("div",{style:{width:"100%",height:"100%",overflow:"hidden"},children:[this.renderCode(),this.renderQueryBreakpoints()]}),f.jsx("div",{style:{width:"100%",height:"100%",overflow:"hidden"},children:this.renderTools()})]}),this.renderError()]},"debugger")}}function Mt(o,n,s,i,a){if(typeof n=="function"?o!==n||!0:!n.has(o))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n.set(o,s),s}function $e(o,n,s,i){if(s==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof n=="function"?o!==n||!i:!n.has(o))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?i:s==="a"?i.call(o):i?i.value:n.get(o)}let Hk=function(){const{crypto:o}=globalThis;if(o!=null&&o.randomUUID)return Hk=o.randomUUID.bind(o),o.randomUUID();const n=new Uint8Array(1),s=o?()=>o.getRandomValues(n)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,i=>(+i^s()&15>>+i/4).toString(16))};function H_(o){return typeof o=="object"&&o!==null&&("name"in o&&o.name==="AbortError"||"message"in o&&String(o.message).includes("FetchRequestCanceledException"))}const V_=o=>{if(o instanceof Error)return o;if(typeof o=="object"&&o!==null){try{if(Object.prototype.toString.call(o)==="[object Error]"){const n=new Error(o.message,o.cause?{cause:o.cause}:{});return o.stack&&(n.stack=o.stack),o.cause&&!n.cause&&(n.cause=o.cause),o.name&&(n.name=o.name),n}}catch{}try{return new Error(JSON.stringify(o))}catch{}}return new Error(o)};class Dt extends Error{}class Vs extends Dt{constructor(n,s,i,a){super(`${Vs.makeMessage(n,s,i)}`),this.status=n,this.headers=a,this.requestID=a==null?void 0:a.get("x-request-id"),this.error=s;const c=s;this.code=c==null?void 0:c.code,this.param=c==null?void 0:c.param,this.type=c==null?void 0:c.type}static makeMessage(n,s,i){const a=s!=null&&s.message?typeof s.message=="string"?s.message:JSON.stringify(s.message):s?JSON.stringify(s):i;return n&&a?`${n} ${a}`:n?`${n} status code (no body)`:a||"(no status code or body)"}static generate(n,s,i,a){if(!n||!a)return new Jv({message:i,cause:V_(s)});const c=s==null?void 0:s.error;return n===400?new Vk(n,c,i,a):n===401?new Gk(n,c,i,a):n===403?new Kk(n,c,i,a):n===404?new Jk(n,c,i,a):n===409?new qk(n,c,i,a):n===422?new Yk(n,c,i,a):n===429?new Xk(n,c,i,a):n>=500?new Zk(n,c,i,a):new Vs(n,c,i,a)}}class xi extends Vs{constructor({message:n}={}){super(void 0,void 0,n||"Request was aborted.",void 0)}}class Jv extends Vs{constructor({message:n,cause:s}){super(void 0,void 0,n||"Connection error.",void 0),s&&(this.cause=s)}}class Bw extends Jv{constructor({message:n}={}){super({message:n??"Request timed out."})}}class Vk extends Vs{}class Gk extends Vs{}class Kk extends Vs{}class Jk extends Vs{}class qk extends Vs{}class Yk extends Vs{}class Xk extends Vs{}class Zk extends Vs{}class Qk extends Dt{constructor(){super("Could not parse response content as the length limit was reached")}}class eE extends Dt{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}const tB=/^[a-z][a-z0-9+.-]*:/i,nB=o=>tB.test(o);function sB(o){return typeof o!="object"?{}:o??{}}function rB(o){if(!o)return!0;for(const n in o)return!1;return!0}function iB(o,n){return Object.prototype.hasOwnProperty.call(o,n)}function n_(o){return o!=null&&typeof o=="object"&&!Array.isArray(o)}const oB=(o,n)=>{if(typeof n!="number"||!Number.isInteger(n))throw new Dt(`${o} must be an integer`);if(n<0)throw new Dt(`${o} must be a positive integer`);return n},aB=o=>{try{return JSON.parse(o)}catch{return}},Kf=o=>new Promise(n=>setTimeout(n,o)),vv={off:0,error:200,warn:300,info:400,debug:500},a0=(o,n,s)=>{if(o){if(iB(vv,o))return o;dr(s).warn(`${n} was set to ${JSON.stringify(o)}, expected one of ${JSON.stringify(Object.keys(vv))}`)}};function df(){}function w$(o,n,s){return!n||vv[o]>vv[s]?df:n[o].bind(n)}const lB={error:df,warn:df,info:df,debug:df};let l0=new WeakMap;function dr(o){const n=o.logger,s=o.logLevel??"off";if(!n)return lB;const i=l0.get(n);if(i&&i[0]===s)return i[1];const a={error:w$("error",n,s),warn:w$("warn",n,s),info:w$("info",n,s),debug:w$("debug",n,s)};return l0.set(n,[s,a]),a}const hu=o=>(o.options&&(o.options={...o.options},delete o.options.headers),o.headers&&(o.headers=Object.fromEntries((o.headers instanceof Headers?[...o.headers]:Object.entries(o.headers)).map(([n,s])=>[n,n.toLowerCase()==="authorization"||n.toLowerCase()==="cookie"||n.toLowerCase()==="set-cookie"?"***":s]))),"retryOfRequestLogID"in o&&(o.retryOfRequestLogID&&(o.retryOf=o.retryOfRequestLogID),delete o.retryOfRequestLogID),o),_h="5.3.0",cB=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u";function uB(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const dB=()=>{var s;const o=uB();if(o==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":_h,"X-Stainless-OS":u0(Deno.build.os),"X-Stainless-Arch":c0(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((s=Deno.version)==null?void 0:s.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":_h,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(o==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":_h,"X-Stainless-OS":u0(globalThis.process.platform??"unknown"),"X-Stainless-Arch":c0(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const n=hB();return n?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":_h,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${n.browser}`,"X-Stainless-Runtime-Version":n.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":_h,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function hB(){if(typeof navigator>"u"||!navigator)return null;const o=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:n,pattern:s}of o){const i=s.exec(navigator.userAgent);if(i){const a=i[1]||0,c=i[2]||0,h=i[3]||0;return{browser:n,version:`${a}.${c}.${h}`}}}return null}const c0=o=>o==="x32"?"x32":o==="x86_64"||o==="x64"?"x64":o==="arm"?"arm":o==="aarch64"||o==="arm64"?"arm64":o?`other:${o}`:"unknown",u0=o=>(o=o.toLowerCase(),o.includes("ios")?"iOS":o==="android"?"Android":o==="darwin"?"MacOS":o==="win32"?"Windows":o==="freebsd"?"FreeBSD":o==="openbsd"?"OpenBSD":o==="linux"?"Linux":o?`Other:${o}`:"Unknown");let d0;const pB=()=>d0??(d0=dB());function gB(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function tE(...o){const n=globalThis.ReadableStream;if(typeof n>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new n(...o)}function nE(o){let n=Symbol.asyncIterator in o?o[Symbol.asyncIterator]():o[Symbol.iterator]();return tE({start(){},async pull(s){const{done:i,value:a}=await n.next();i?s.close():s.enqueue(a)},async cancel(){var s;await((s=n.return)==null?void 0:s.call(n))}})}function sE(o){if(o[Symbol.asyncIterator])return o;const n=o.getReader();return{async next(){try{const s=await n.read();return s!=null&&s.done&&n.releaseLock(),s}catch(s){throw n.releaseLock(),s}},async return(){const s=n.cancel();return n.releaseLock(),await s,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function fB(o){var i,a;if(o===null||typeof o!="object")return;if(o[Symbol.asyncIterator]){await((a=(i=o[Symbol.asyncIterator]()).return)==null?void 0:a.call(i));return}const n=o.getReader(),s=n.cancel();n.releaseLock(),await s}const mB=({headers:o,body:n})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(n)}),G_="RFC3986",K_={RFC1738:o=>String(o).replace(/%20/g,"+"),RFC3986:o=>String(o)},bB="RFC1738",$B=Array.isArray,Uo=(()=>{const o=[];for(let n=0;n<256;++n)o.push("%"+((n<16?"0":"")+n.toString(16)).toUpperCase());return o})(),s_=1024,vB=(o,n,s,i,a)=>{if(o.length===0)return o;let c=o;if(typeof o=="symbol"?c=Symbol.prototype.toString.call(o):typeof o!="string"&&(c=String(o)),s==="iso-8859-1")return escape(c).replace(/%u[0-9a-f]{4}/gi,function(g){return"%26%23"+parseInt(g.slice(2),16)+"%3B"});let h="";for(let g=0;g<c.length;g+=s_){const b=c.length>=s_?c.slice(g,g+s_):c,$=[];for(let y=0;y<b.length;++y){let w=b.charCodeAt(y);if(w===45||w===46||w===95||w===126||w>=48&&w<=57||w>=65&&w<=90||w>=97&&w<=122||a===bB&&(w===40||w===41)){$[$.length]=b.charAt(y);continue}if(w<128){$[$.length]=Uo[w];continue}if(w<2048){$[$.length]=Uo[192|w>>6]+Uo[128|w&63];continue}if(w<55296||w>=57344){$[$.length]=Uo[224|w>>12]+Uo[128|w>>6&63]+Uo[128|w&63];continue}y+=1,w=65536+((w&1023)<<10|b.charCodeAt(y)&1023),$[$.length]=Uo[240|w>>18]+Uo[128|w>>12&63]+Uo[128|w>>6&63]+Uo[128|w&63]}h+=$.join("")}return h};function yB(o){return!o||typeof o!="object"?!1:!!(o.constructor&&o.constructor.isBuffer&&o.constructor.isBuffer(o))}function h0(o,n){if($B(o)){const s=[];for(let i=0;i<o.length;i+=1)s.push(n(o[i]));return s}return n(o)}const _B=Object.prototype.hasOwnProperty,rE={brackets(o){return String(o)+"[]"},comma:"comma",indices(o,n){return String(o)+"["+n+"]"},repeat(o){return String(o)}},Wo=Array.isArray,wB=Array.prototype.push,iE=function(o,n){wB.apply(o,Wo(n)?n:[n])},CB=Date.prototype.toISOString,Cs={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:vB,encodeValuesOnly:!1,format:G_,formatter:K_[G_],indices:!1,serializeDate(o){return CB.call(o)},skipNulls:!1,strictNullHandling:!1};function SB(o){return typeof o=="string"||typeof o=="number"||typeof o=="boolean"||typeof o=="symbol"||typeof o=="bigint"}const r_={};function oE(o,n,s,i,a,c,h,g,b,$,y,w,T,C,E,k,A,P){let N=o,B=P,S=0,H=!1;for(;(B=B.get(r_))!==void 0&&!H;){const Y=B.get(o);if(S+=1,typeof Y<"u"){if(Y===S)throw new RangeError("Cyclic object value");H=!0}typeof B.get(r_)>"u"&&(S=0)}if(typeof $=="function"?N=$(n,N):N instanceof Date?N=T==null?void 0:T(N):s==="comma"&&Wo(N)&&(N=h0(N,function(Y){return Y instanceof Date?T==null?void 0:T(Y):Y})),N===null){if(c)return b&&!k?b(n,Cs.encoder,A,"key",C):n;N=""}if(SB(N)||yB(N)){if(b){const Y=k?n:b(n,Cs.encoder,A,"key",C);return[(E==null?void 0:E(Y))+"="+(E==null?void 0:E(b(N,Cs.encoder,A,"value",C)))]}return[(E==null?void 0:E(n))+"="+(E==null?void 0:E(String(N)))]}const q=[];if(typeof N>"u")return q;let se;if(s==="comma"&&Wo(N))k&&b&&(N=h0(N,b)),se=[{value:N.length>0?N.join(",")||null:void 0}];else if(Wo($))se=$;else{const Y=Object.keys(N);se=y?Y.sort(y):Y}const ee=g?String(n).replace(/\./g,"%2E"):String(n),K=i&&Wo(N)&&N.length===1?ee+"[]":ee;if(a&&Wo(N)&&N.length===0)return K+"[]";for(let Y=0;Y<se.length;++Y){const X=se[Y],ce=typeof X=="object"&&typeof X.value<"u"?X.value:N[X];if(h&&ce===null)continue;const W=w&&g?X.replace(/\./g,"%2E"):X,te=Wo(N)?typeof s=="function"?s(K,W):K:K+(w?"."+W:"["+W+"]");P.set(o,S);const ke=new WeakMap;ke.set(r_,P),iE(q,oE(ce,te,s,i,a,c,h,g,s==="comma"&&k&&Wo(N)?null:b,$,y,w,T,C,E,k,A,ke))}return q}function TB(o=Cs){if(typeof o.allowEmptyArrays<"u"&&typeof o.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof o.encodeDotInKeys<"u"&&typeof o.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(o.encoder!==null&&typeof o.encoder<"u"&&typeof o.encoder!="function")throw new TypeError("Encoder has to be a function.");const n=o.charset||Cs.charset;if(typeof o.charset<"u"&&o.charset!=="utf-8"&&o.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let s=G_;if(typeof o.format<"u"){if(!_B.call(K_,o.format))throw new TypeError("Unknown format option provided.");s=o.format}const i=K_[s];let a=Cs.filter;(typeof o.filter=="function"||Wo(o.filter))&&(a=o.filter);let c;if(o.arrayFormat&&o.arrayFormat in rE?c=o.arrayFormat:"indices"in o?c=o.indices?"indices":"repeat":c=Cs.arrayFormat,"commaRoundTrip"in o&&typeof o.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const h=typeof o.allowDots>"u"?o.encodeDotInKeys?!0:Cs.allowDots:!!o.allowDots;return{addQueryPrefix:typeof o.addQueryPrefix=="boolean"?o.addQueryPrefix:Cs.addQueryPrefix,allowDots:h,allowEmptyArrays:typeof o.allowEmptyArrays=="boolean"?!!o.allowEmptyArrays:Cs.allowEmptyArrays,arrayFormat:c,charset:n,charsetSentinel:typeof o.charsetSentinel=="boolean"?o.charsetSentinel:Cs.charsetSentinel,commaRoundTrip:!!o.commaRoundTrip,delimiter:typeof o.delimiter>"u"?Cs.delimiter:o.delimiter,encode:typeof o.encode=="boolean"?o.encode:Cs.encode,encodeDotInKeys:typeof o.encodeDotInKeys=="boolean"?o.encodeDotInKeys:Cs.encodeDotInKeys,encoder:typeof o.encoder=="function"?o.encoder:Cs.encoder,encodeValuesOnly:typeof o.encodeValuesOnly=="boolean"?o.encodeValuesOnly:Cs.encodeValuesOnly,filter:a,format:s,formatter:i,serializeDate:typeof o.serializeDate=="function"?o.serializeDate:Cs.serializeDate,skipNulls:typeof o.skipNulls=="boolean"?o.skipNulls:Cs.skipNulls,sort:typeof o.sort=="function"?o.sort:null,strictNullHandling:typeof o.strictNullHandling=="boolean"?o.strictNullHandling:Cs.strictNullHandling}}function kB(o,n={}){let s=o;const i=TB(n);let a,c;typeof i.filter=="function"?(c=i.filter,s=c("",s)):Wo(i.filter)&&(c=i.filter,a=c);const h=[];if(typeof s!="object"||s===null)return"";const g=rE[i.arrayFormat],b=g==="comma"&&i.commaRoundTrip;a||(a=Object.keys(s)),i.sort&&a.sort(i.sort);const $=new WeakMap;for(let T=0;T<a.length;++T){const C=a[T];i.skipNulls&&s[C]===null||iE(h,oE(s[C],C,g,b,i.allowEmptyArrays,i.strictNullHandling,i.skipNulls,i.encodeDotInKeys,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset,$))}const y=h.join(i.delimiter);let w=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?w+="utf8=%26%2310003%3B&":w+="utf8=%E2%9C%93&"),y.length>0?w+y:""}function EB(o){let n=0;for(const a of o)n+=a.length;const s=new Uint8Array(n);let i=0;for(const a of o)s.set(a,i),i+=a.length;return s}let p0;function Pw(o){let n;return(p0??(n=new globalThis.TextEncoder,p0=n.encode.bind(n)))(o)}let g0;function f0(o){let n;return(g0??(n=new globalThis.TextDecoder,g0=n.decode.bind(n)))(o)}var ni,si;class qv{constructor(){ni.set(this,void 0),si.set(this,void 0),Mt(this,ni,new Uint8Array),Mt(this,si,null)}decode(n){if(n==null)return[];const s=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?Pw(n):n;Mt(this,ni,EB([$e(this,ni,"f"),s]));const i=[];let a;for(;(a=IB($e(this,ni,"f"),$e(this,si,"f")))!=null;){if(a.carriage&&$e(this,si,"f")==null){Mt(this,si,a.index);continue}if($e(this,si,"f")!=null&&(a.index!==$e(this,si,"f")+1||a.carriage)){i.push(f0($e(this,ni,"f").subarray(0,$e(this,si,"f")-1))),Mt(this,ni,$e(this,ni,"f").subarray($e(this,si,"f"))),Mt(this,si,null);continue}const c=$e(this,si,"f")!==null?a.preceding-1:a.preceding,h=f0($e(this,ni,"f").subarray(0,c));i.push(h),Mt(this,ni,$e(this,ni,"f").subarray(a.index)),Mt(this,si,null)}return i}flush(){return $e(this,ni,"f").length?this.decode(`
`):[]}}ni=new WeakMap,si=new WeakMap;qv.NEWLINE_CHARS=new Set([`
`,"\r"]);qv.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function IB(o,n){for(let a=n??0;a<o.length;a++){if(o[a]===10)return{preceding:a,index:a+1,carriage:!1};if(o[a]===13)return{preceding:a,index:a+1,carriage:!0}}return null}function xB(o){for(let i=0;i<o.length-1;i++){if(o[i]===10&&o[i+1]===10||o[i]===13&&o[i+1]===13)return i+2;if(o[i]===13&&o[i+1]===10&&i+3<o.length&&o[i+2]===13&&o[i+3]===10)return i+4}return-1}class Ko{constructor(n,s){this.iterator=n,this.controller=s}static fromSSEResponse(n,s){let i=!1;async function*a(){if(i)throw new Dt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let c=!1;try{for await(const h of DB(n,s))if(!c){if(h.data.startsWith("[DONE]")){c=!0;continue}if(h.event===null||h.event.startsWith("response.")||h.event.startsWith("transcript.")){let g;try{g=JSON.parse(h.data)}catch(b){throw console.error("Could not parse message into JSON:",h.data),console.error("From chunk:",h.raw),b}if(g&&g.error)throw new Vs(void 0,g.error,void 0,n.headers);yield g}else{let g;try{g=JSON.parse(h.data)}catch(b){throw console.error("Could not parse message into JSON:",h.data),console.error("From chunk:",h.raw),b}if(h.event=="error")throw new Vs(void 0,g.error,g.message,void 0);yield{event:h.event,data:g}}}c=!0}catch(h){if(H_(h))return;throw h}finally{c||s.abort()}}return new Ko(a,s)}static fromReadableStream(n,s){let i=!1;async function*a(){const h=new qv,g=sE(n);for await(const b of g)for(const $ of h.decode(b))yield $;for(const b of h.flush())yield b}async function*c(){if(i)throw new Dt("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let h=!1;try{for await(const g of a())h||g&&(yield JSON.parse(g));h=!0}catch(g){if(H_(g))return;throw g}finally{h||s.abort()}}return new Ko(c,s)}[Symbol.asyncIterator](){return this.iterator()}tee(){const n=[],s=[],i=this.iterator(),a=c=>({next:()=>{if(c.length===0){const h=i.next();n.push(h),s.push(h)}return c.shift()}});return[new Ko(()=>a(n),this.controller),new Ko(()=>a(s),this.controller)]}toReadableStream(){const n=this;let s;return tE({async start(){s=n[Symbol.asyncIterator]()},async pull(i){try{const{value:a,done:c}=await s.next();if(c)return i.close();const h=Pw(JSON.stringify(a)+`
`);i.enqueue(h)}catch(a){i.error(a)}},async cancel(){var i;await((i=s.return)==null?void 0:i.call(s))}})}}async function*DB(o,n){if(!o.body)throw n.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new Dt("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new Dt("Attempted to iterate over a response with no body");const s=new OB,i=new qv,a=sE(o.body);for await(const c of AB(a))for(const h of i.decode(c)){const g=s.decode(h);g&&(yield g)}for(const c of i.flush()){const h=s.decode(c);h&&(yield h)}}async function*AB(o){let n=new Uint8Array;for await(const s of o){if(s==null)continue;const i=s instanceof ArrayBuffer?new Uint8Array(s):typeof s=="string"?Pw(s):s;let a=new Uint8Array(n.length+i.length);a.set(n),a.set(i,n.length),n=a;let c;for(;(c=xB(n))!==-1;)yield n.slice(0,c),n=n.slice(c)}n.length>0&&(yield n)}class OB{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(n){if(n.endsWith("\r")&&(n=n.substring(0,n.length-1)),!n){if(!this.event&&!this.data.length)return null;const c={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],c}if(this.chunks.push(n),n.startsWith(":"))return null;let[s,i,a]=RB(n,":");return a.startsWith(" ")&&(a=a.substring(1)),s==="event"?this.event=a:s==="data"&&this.data.push(a),null}}function RB(o,n){const s=o.indexOf(n);return s!==-1?[o.substring(0,s),n,o.substring(s+n.length)]:[o,"",""]}async function aE(o,n){const{response:s,requestLogID:i,retryOfRequestLogID:a,startTime:c}=n,h=await(async()=>{var w;if(n.options.stream)return dr(o).debug("response",s.status,s.url,s.headers,s.body),n.options.__streamClass?n.options.__streamClass.fromSSEResponse(s,n.controller):Ko.fromSSEResponse(s,n.controller);if(s.status===204)return null;if(n.options.__binaryResponse)return s;const g=s.headers.get("content-type"),b=(w=g==null?void 0:g.split(";")[0])==null?void 0:w.trim();if((b==null?void 0:b.includes("application/json"))||(b==null?void 0:b.endsWith("+json"))){const T=await s.json();return lE(T,s)}return await s.text()})();return dr(o).debug(`[${i}] response parsed`,hu({retryOfRequestLogID:a,url:s.url,status:s.status,body:h,durationMs:Date.now()-c})),h}function lE(o,n){return!o||typeof o!="object"||Array.isArray(o)?o:Object.defineProperty(o,"_request_id",{value:n.headers.get("x-request-id"),enumerable:!1})}var hf;class Yv extends Promise{constructor(n,s,i=aE){super(a=>{a(null)}),this.responsePromise=s,this.parseResponse=i,hf.set(this,void 0),Mt(this,hf,n)}_thenUnwrap(n){return new Yv($e(this,hf,"f"),this.responsePromise,async(s,i)=>lE(n(await this.parseResponse(s,i),i),i.response))}asResponse(){return this.responsePromise.then(n=>n.response)}async withResponse(){const[n,s]=await Promise.all([this.parse(),this.asResponse()]);return{data:n,response:s,request_id:s.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(n=>this.parseResponse($e(this,hf,"f"),n))),this.parsedPromise}then(n,s){return this.parse().then(n,s)}catch(n){return this.parse().catch(n)}finally(n){return this.parse().finally(n)}}hf=new WeakMap;var C$;class cE{constructor(n,s,i,a){C$.set(this,void 0),Mt(this,C$,n),this.options=a,this.response=s,this.body=i}hasNextPage(){return this.getPaginatedItems().length?this.nextPageRequestOptions()!=null:!1}async getNextPage(){const n=this.nextPageRequestOptions();if(!n)throw new Dt("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await $e(this,C$,"f").requestAPIList(this.constructor,n)}async*iterPages(){let n=this;for(yield n;n.hasNextPage();)n=await n.getNextPage(),yield n}async*[(C$=new WeakMap,Symbol.asyncIterator)](){for await(const n of this.iterPages())for(const s of n.getPaginatedItems())yield s}}class MB extends Yv{constructor(n,s,i){super(n,s,async(a,c)=>new i(a,c.response,await aE(a,c),c.options))}async*[Symbol.asyncIterator](){const n=await this;for await(const s of n)yield s}}class Xv extends cE{constructor(n,s,i,a){super(n,s,i,a),this.data=i.data||[],this.object=i.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class gs extends cE{constructor(n,s,i,a){super(n,s,i,a),this.data=i.data||[],this.has_more=i.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageRequestOptions(){var i;const n=this.getPaginatedItems(),s=(i=n[n.length-1])==null?void 0:i.id;return s?{...this.options,query:{...sB(this.options.query),after:s}}:null}}const uE=()=>{var o;if(typeof File>"u"){const{process:n}=globalThis,s=typeof((o=n==null?void 0:n.versions)==null?void 0:o.node)=="string"&&parseInt(n.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(s?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Tf(o,n,s){return uE(),new File(o,n??"unknown_file",s)}function B$(o){return(typeof o=="object"&&o!==null&&("name"in o&&o.name&&String(o.name)||"url"in o&&o.url&&String(o.url)||"filename"in o&&o.filename&&String(o.filename)||"path"in o&&o.path&&String(o.path))||"").split(/[\\/]/).pop()||void 0}const dE=o=>o!=null&&typeof o=="object"&&typeof o[Symbol.asyncIterator]=="function",wu=async(o,n)=>({...o,body:await LB(o.body,n)}),m0=new WeakMap;function NB(o){const n=typeof o=="function"?o:o.fetch,s=m0.get(n);if(s)return s;const i=(async()=>{try{const a="Response"in n?n.Response:(await n("data:,")).constructor,c=new FormData;return c.toString()!==await new a(c).text()}catch{return!0}})();return m0.set(n,i),i}const LB=async(o,n)=>{if(!await NB(n))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const s=new FormData;return await Promise.all(Object.entries(o||{}).map(([i,a])=>J_(s,i,a))),s},BB=o=>o instanceof Blob&&"name"in o,J_=async(o,n,s)=>{if(s!==void 0){if(s==null)throw new TypeError(`Received null for "${n}"; to pass null in FormData, you must use the string 'null'`);if(typeof s=="string"||typeof s=="number"||typeof s=="boolean")o.append(n,String(s));else if(s instanceof Response)o.append(n,Tf([await s.blob()],B$(s)));else if(dE(s))o.append(n,Tf([await new Response(nE(s)).blob()],B$(s)));else if(BB(s))o.append(n,s,B$(s));else if(Array.isArray(s))await Promise.all(s.map(i=>J_(o,n+"[]",i)));else if(typeof s=="object")await Promise.all(Object.entries(s).map(([i,a])=>J_(o,`${n}[${i}]`,a)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${s} instead`)}},hE=o=>o!=null&&typeof o=="object"&&typeof o.size=="number"&&typeof o.type=="string"&&typeof o.text=="function"&&typeof o.slice=="function"&&typeof o.arrayBuffer=="function",PB=o=>o!=null&&typeof o=="object"&&typeof o.name=="string"&&typeof o.lastModified=="number"&&hE(o),jB=o=>o!=null&&typeof o=="object"&&typeof o.url=="string"&&typeof o.blob=="function";async function FB(o,n,s){if(uE(),o=await o,PB(o))return o instanceof File?o:Tf([await o.arrayBuffer()],o.name);if(jB(o)){const a=await o.blob();return n||(n=new URL(o.url).pathname.split(/[\\/]/).pop()),Tf(await q_(a),n,s)}const i=await q_(o);if(n||(n=B$(o)),!(s!=null&&s.type)){const a=i.find(c=>typeof c=="object"&&"type"in c&&c.type);typeof a=="string"&&(s={...s,type:a})}return Tf(i,n,s)}async function q_(o){var s;let n=[];if(typeof o=="string"||ArrayBuffer.isView(o)||o instanceof ArrayBuffer)n.push(o);else if(hE(o))n.push(o instanceof Blob?o:await o.arrayBuffer());else if(dE(o))for await(const i of o)n.push(...await q_(i));else{const i=(s=o==null?void 0:o.constructor)==null?void 0:s.name;throw new Error(`Unexpected data type: ${typeof o}${i?`; constructor: ${i}`:""}${zB(o)}`)}return n}function zB(o){return typeof o!="object"||o===null?"":`; props: [${Object.getOwnPropertyNames(o).map(s=>`"${s}"`).join(", ")}]`}class Pt{constructor(n){this._client=n}}function pE(o){return o.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const UB=(o=pE)=>function(s,...i){if(s.length===1)return s[0];let a=!1;const c=s.reduce((y,w,T)=>(/[?#]/.test(w)&&(a=!0),y+w+(T===i.length?"":(a?encodeURIComponent:o)(String(i[T])))),""),h=c.split(/[?#]/,1)[0],g=[],b=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;let $;for(;($=b.exec(h))!==null;)g.push({start:$.index,length:$[0].length});if(g.length>0){let y=0;const w=g.reduce((T,C)=>{const E=" ".repeat(C.start-y),k="^".repeat(C.length);return y=C.start+C.length,T+E+k},"");throw new Dt(`Path parameters result in path with invalid segments:
${c}
${w}`)}return c},Xe=UB(pE);let gE=class extends Pt{list(n,s={},i){return this._client.getAPIList(Xe`/chat/completions/${n}/messages`,gs,{query:s,...i})}};function WB(o){return typeof o.parse=="function"}const yv=o=>(o==null?void 0:o.role)==="assistant",fE=o=>(o==null?void 0:o.role)==="tool";var Y_,P$,j$,pf,gf,F$,ff,Wa,mf,_v,wv,wh,mE;class jw{constructor(){Y_.add(this),this.controller=new AbortController,P$.set(this,void 0),j$.set(this,()=>{}),pf.set(this,()=>{}),gf.set(this,void 0),F$.set(this,()=>{}),ff.set(this,()=>{}),Wa.set(this,{}),mf.set(this,!1),_v.set(this,!1),wv.set(this,!1),wh.set(this,!1),Mt(this,P$,new Promise((n,s)=>{Mt(this,j$,n,"f"),Mt(this,pf,s,"f")})),Mt(this,gf,new Promise((n,s)=>{Mt(this,F$,n,"f"),Mt(this,ff,s,"f")})),$e(this,P$,"f").catch(()=>{}),$e(this,gf,"f").catch(()=>{})}_run(n){setTimeout(()=>{n().then(()=>{this._emitFinal(),this._emit("end")},$e(this,Y_,"m",mE).bind(this))},0)}_connected(){this.ended||($e(this,j$,"f").call(this),this._emit("connect"))}get ended(){return $e(this,mf,"f")}get errored(){return $e(this,_v,"f")}get aborted(){return $e(this,wv,"f")}abort(){this.controller.abort()}on(n,s){return($e(this,Wa,"f")[n]||($e(this,Wa,"f")[n]=[])).push({listener:s}),this}off(n,s){const i=$e(this,Wa,"f")[n];if(!i)return this;const a=i.findIndex(c=>c.listener===s);return a>=0&&i.splice(a,1),this}once(n,s){return($e(this,Wa,"f")[n]||($e(this,Wa,"f")[n]=[])).push({listener:s,once:!0}),this}emitted(n){return new Promise((s,i)=>{Mt(this,wh,!0),n!=="error"&&this.once("error",i),this.once(n,s)})}async done(){Mt(this,wh,!0),await $e(this,gf,"f")}_emit(n,...s){if($e(this,mf,"f"))return;n==="end"&&(Mt(this,mf,!0),$e(this,F$,"f").call(this));const i=$e(this,Wa,"f")[n];if(i&&($e(this,Wa,"f")[n]=i.filter(a=>!a.once),i.forEach(({listener:a})=>a(...s))),n==="abort"){const a=s[0];!$e(this,wh,"f")&&!(i!=null&&i.length)&&Promise.reject(a),$e(this,pf,"f").call(this,a),$e(this,ff,"f").call(this,a),this._emit("end");return}if(n==="error"){const a=s[0];!$e(this,wh,"f")&&!(i!=null&&i.length)&&Promise.reject(a),$e(this,pf,"f").call(this,a),$e(this,ff,"f").call(this,a),this._emit("end")}}_emitFinal(){}}P$=new WeakMap,j$=new WeakMap,pf=new WeakMap,gf=new WeakMap,F$=new WeakMap,ff=new WeakMap,Wa=new WeakMap,mf=new WeakMap,_v=new WeakMap,wv=new WeakMap,wh=new WeakMap,Y_=new WeakSet,mE=function(n){if(Mt(this,_v,!0),n instanceof Error&&n.name==="AbortError"&&(n=new xi),n instanceof xi)return Mt(this,wv,!0),this._emit("abort",n);if(n instanceof Dt)return this._emit("error",n);if(n instanceof Error){const s=new Dt(n.message);return s.cause=n,this._emit("error",s)}return this._emit("error",new Dt(String(n)))};function Fw(o){return(o==null?void 0:o.$brand)==="auto-parseable-response-format"}function Jf(o){return(o==null?void 0:o.$brand)==="auto-parseable-tool"}function HB(o,n){return!n||!bE(n)?{...o,choices:o.choices.map(s=>({...s,message:{...s.message,parsed:null,...s.message.tool_calls?{tool_calls:s.message.tool_calls}:void 0}}))}:zw(o,n)}function zw(o,n){const s=o.choices.map(i=>{var a;if(i.finish_reason==="length")throw new Qk;if(i.finish_reason==="content_filter")throw new eE;return{...i,message:{...i.message,...i.message.tool_calls?{tool_calls:((a=i.message.tool_calls)==null?void 0:a.map(c=>GB(n,c)))??void 0}:void 0,parsed:i.message.content&&!i.message.refusal?VB(n,i.message.content):null}}});return{...o,choices:s}}function VB(o,n){var s,i;return((s=o.response_format)==null?void 0:s.type)!=="json_schema"?null:((i=o.response_format)==null?void 0:i.type)==="json_schema"?"$parseRaw"in o.response_format?o.response_format.$parseRaw(n):JSON.parse(n):null}function GB(o,n){var i;const s=(i=o.tools)==null?void 0:i.find(a=>{var c;return((c=a.function)==null?void 0:c.name)===n.function.name});return{...n,function:{...n.function,parsed_arguments:Jf(s)?s.$parseRaw(n.function.arguments):s!=null&&s.function.strict?JSON.parse(n.function.arguments):null}}}function KB(o,n){var i;if(!o)return!1;const s=(i=o.tools)==null?void 0:i.find(a=>{var c;return((c=a.function)==null?void 0:c.name)===n.function.name});return Jf(s)||(s==null?void 0:s.function.strict)||!1}function bE(o){var n;return Fw(o.response_format)?!0:((n=o.tools)==null?void 0:n.some(s=>Jf(s)||s.type==="function"&&s.function.strict===!0))??!1}function JB(o){for(const n of o??[]){if(n.type!=="function")throw new Dt(`Currently only \`function\` tool types support auto-parsing; Received \`${n.type}\``);if(n.function.strict!==!0)throw new Dt(`The \`${n.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var Tr,X_,Cv,Z_,Q_,ew,$E,vE;const qB=10;class yE extends jw{constructor(){super(...arguments),Tr.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(n){var i;this._chatCompletions.push(n),this._emit("chatCompletion",n);const s=(i=n.choices[0])==null?void 0:i.message;return s&&this._addMessage(s),n}_addMessage(n,s=!0){if("content"in n||(n.content=null),this.messages.push(n),s){if(this._emit("message",n),fE(n)&&n.content)this._emit("functionToolCallResult",n.content);else if(yv(n)&&n.tool_calls)for(const i of n.tool_calls)i.type==="function"&&this._emit("functionToolCall",i.function)}}async finalChatCompletion(){await this.done();const n=this._chatCompletions[this._chatCompletions.length-1];if(!n)throw new Dt("stream ended without producing a ChatCompletion");return n}async finalContent(){return await this.done(),$e(this,Tr,"m",X_).call(this)}async finalMessage(){return await this.done(),$e(this,Tr,"m",Cv).call(this)}async finalFunctionToolCall(){return await this.done(),$e(this,Tr,"m",Z_).call(this)}async finalFunctionToolCallResult(){return await this.done(),$e(this,Tr,"m",Q_).call(this)}async totalUsage(){return await this.done(),$e(this,Tr,"m",ew).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const n=this._chatCompletions[this._chatCompletions.length-1];n&&this._emit("finalChatCompletion",n);const s=$e(this,Tr,"m",Cv).call(this);s&&this._emit("finalMessage",s);const i=$e(this,Tr,"m",X_).call(this);i&&this._emit("finalContent",i);const a=$e(this,Tr,"m",Z_).call(this);a&&this._emit("finalFunctionToolCall",a);const c=$e(this,Tr,"m",Q_).call(this);c!=null&&this._emit("finalFunctionToolCallResult",c),this._chatCompletions.some(h=>h.usage)&&this._emit("totalUsage",$e(this,Tr,"m",ew).call(this))}async _createChatCompletion(n,s,i){const a=i==null?void 0:i.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),$e(this,Tr,"m",$E).call(this,s);const c=await n.chat.completions.create({...s,stream:!1},{...i,signal:this.controller.signal});return this._connected(),this._addChatCompletion(zw(c,s))}async _runChatCompletion(n,s,i){for(const a of s.messages)this._addMessage(a,!1);return await this._createChatCompletion(n,s,i)}async _runTools(n,s,i){var C,E,k;const a="tool",{tool_choice:c="auto",stream:h,...g}=s,b=typeof c!="string"&&((C=c==null?void 0:c.function)==null?void 0:C.name),{maxChatCompletions:$=qB}=i||{},y=s.tools.map(A=>{if(Jf(A)){if(!A.$callback)throw new Dt("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:A.$callback,name:A.function.name,description:A.function.description||"",parameters:A.function.parameters,parse:A.$parseRaw,strict:!0}}}return A}),w={};for(const A of y)A.type==="function"&&(w[A.function.name||A.function.function.name]=A.function);const T="tools"in s?y.map(A=>A.type==="function"?{type:"function",function:{name:A.function.name||A.function.function.name,parameters:A.function.parameters,description:A.function.description,strict:A.function.strict}}:A):void 0;for(const A of s.messages)this._addMessage(A,!1);for(let A=0;A<$;++A){const N=(E=(await this._createChatCompletion(n,{...g,tool_choice:c,tools:T,messages:[...this.messages]},i)).choices[0])==null?void 0:E.message;if(!N)throw new Dt("missing message in ChatCompletion response");if(!((k=N.tool_calls)!=null&&k.length))return;for(const B of N.tool_calls){if(B.type!=="function")continue;const S=B.id,{name:H,arguments:q}=B.function,se=w[H];if(se){if(b&&b!==H){const X=`Invalid tool_call: ${JSON.stringify(H)}. ${JSON.stringify(b)} requested. Please try again`;this._addMessage({role:a,tool_call_id:S,content:X});continue}}else{const X=`Invalid tool_call: ${JSON.stringify(H)}. Available options are: ${Object.keys(w).map(ce=>JSON.stringify(ce)).join(", ")}. Please try again`;this._addMessage({role:a,tool_call_id:S,content:X});continue}let ee;try{ee=WB(se)?await se.parse(q):q}catch(X){const ce=X instanceof Error?X.message:String(X);this._addMessage({role:a,tool_call_id:S,content:ce});continue}const K=await se.function(ee,this),Y=$e(this,Tr,"m",vE).call(this,K);if(this._addMessage({role:a,tool_call_id:S,content:Y}),b)return}}}}Tr=new WeakSet,X_=function(){return $e(this,Tr,"m",Cv).call(this).content??null},Cv=function(){let n=this.messages.length;for(;n-- >0;){const s=this.messages[n];if(yv(s))return{...s,content:s.content??null,refusal:s.refusal??null}}throw new Dt("stream ended without producing a ChatCompletionMessage with role=assistant")},Z_=function(){var n,s;for(let i=this.messages.length-1;i>=0;i--){const a=this.messages[i];if(yv(a)&&((n=a==null?void 0:a.tool_calls)!=null&&n.length))return(s=a.tool_calls.at(-1))==null?void 0:s.function}},Q_=function(){for(let n=this.messages.length-1;n>=0;n--){const s=this.messages[n];if(fE(s)&&s.content!=null&&typeof s.content=="string"&&this.messages.some(i=>{var a;return i.role==="assistant"&&((a=i.tool_calls)==null?void 0:a.some(c=>c.type==="function"&&c.id===s.tool_call_id))}))return s.content}},ew=function(){const n={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:s}of this._chatCompletions)s&&(n.completion_tokens+=s.completion_tokens,n.prompt_tokens+=s.prompt_tokens,n.total_tokens+=s.total_tokens);return n},$E=function(n){if(n.n!=null&&n.n>1)throw new Dt("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},vE=function(n){return typeof n=="string"?n:n===void 0?"undefined":JSON.stringify(n)};class Uw extends yE{static runTools(n,s,i){const a=new Uw,c={...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(n,s,c)),a}_addMessage(n,s=!0){super._addMessage(n,s),yv(n)&&n.content&&this._emit("content",n.content)}}const _E=1,wE=2,CE=4,SE=8,TE=16,kE=32,EE=64,IE=128,xE=256,DE=IE|xE,AE=TE|kE|DE|EE,OE=_E|wE|AE,RE=CE|SE,YB=OE|RE,Os={STR:_E,NUM:wE,ARR:CE,OBJ:SE,NULL:TE,BOOL:kE,NAN:EE,INFINITY:IE,MINUS_INFINITY:xE,INF:DE,SPECIAL:AE,ATOM:OE,COLLECTION:RE,ALL:YB};class XB extends Error{}class ZB extends Error{}function QB(o,n=Os.ALL){if(typeof o!="string")throw new TypeError(`expecting str, got ${typeof o}`);if(!o.trim())throw new Error(`${o} is empty`);return eP(o.trim(),n)}const eP=(o,n)=>{const s=o.length;let i=0;const a=T=>{throw new XB(`${T} at position ${i}`)},c=T=>{throw new ZB(`${T} at position ${i}`)},h=()=>(w(),i>=s&&a("Unexpected end of input"),o[i]==='"'?g():o[i]==="{"?b():o[i]==="["?$():o.substring(i,i+4)==="null"||Os.NULL&n&&s-i<4&&"null".startsWith(o.substring(i))?(i+=4,null):o.substring(i,i+4)==="true"||Os.BOOL&n&&s-i<4&&"true".startsWith(o.substring(i))?(i+=4,!0):o.substring(i,i+5)==="false"||Os.BOOL&n&&s-i<5&&"false".startsWith(o.substring(i))?(i+=5,!1):o.substring(i,i+8)==="Infinity"||Os.INFINITY&n&&s-i<8&&"Infinity".startsWith(o.substring(i))?(i+=8,1/0):o.substring(i,i+9)==="-Infinity"||Os.MINUS_INFINITY&n&&1<s-i&&s-i<9&&"-Infinity".startsWith(o.substring(i))?(i+=9,-1/0):o.substring(i,i+3)==="NaN"||Os.NAN&n&&s-i<3&&"NaN".startsWith(o.substring(i))?(i+=3,NaN):y()),g=()=>{const T=i;let C=!1;for(i++;i<s&&(o[i]!=='"'||C&&o[i-1]==="\\");)C=o[i]==="\\"?!C:!1,i++;if(o.charAt(i)=='"')try{return JSON.parse(o.substring(T,++i-Number(C)))}catch(E){c(String(E))}else if(Os.STR&n)try{return JSON.parse(o.substring(T,i-Number(C))+'"')}catch{return JSON.parse(o.substring(T,o.lastIndexOf("\\"))+'"')}a("Unterminated string literal")},b=()=>{i++,w();const T={};try{for(;o[i]!=="}";){if(w(),i>=s&&Os.OBJ&n)return T;const C=g();w(),i++;try{const E=h();Object.defineProperty(T,C,{value:E,writable:!0,enumerable:!0,configurable:!0})}catch(E){if(Os.OBJ&n)return T;throw E}w(),o[i]===","&&i++}}catch{if(Os.OBJ&n)return T;a("Expected '}' at end of object")}return i++,T},$=()=>{i++;const T=[];try{for(;o[i]!=="]";)T.push(h()),w(),o[i]===","&&i++}catch{if(Os.ARR&n)return T;a("Expected ']' at end of array")}return i++,T},y=()=>{if(i===0){o==="-"&&Os.NUM&n&&a("Not sure what '-' is");try{return JSON.parse(o)}catch(C){if(Os.NUM&n)try{return o[o.length-1]==="."?JSON.parse(o.substring(0,o.lastIndexOf("."))):JSON.parse(o.substring(0,o.lastIndexOf("e")))}catch{}c(String(C))}}const T=i;for(o[i]==="-"&&i++;o[i]&&!",]}".includes(o[i]);)i++;i==s&&!(Os.NUM&n)&&a("Unterminated number literal");try{return JSON.parse(o.substring(T,i))}catch{o.substring(T,i)==="-"&&Os.NUM&n&&a("Not sure what '-' is");try{return JSON.parse(o.substring(T,o.lastIndexOf("e")))}catch(E){c(String(E))}}},w=()=>{for(;i<s&&` 
\r	`.includes(o[i]);)i++};return h()},b0=o=>QB(o,Os.ALL^Os.NUM);var ws,Ua,$h,Kl,i_,S$,o_,a_,l_,T$,c_,$0;class Mf extends yE{constructor(n){super(),ws.add(this),Ua.set(this,void 0),$h.set(this,void 0),Kl.set(this,void 0),Mt(this,Ua,n),Mt(this,$h,[])}get currentChatCompletionSnapshot(){return $e(this,Kl,"f")}static fromReadableStream(n){const s=new Mf(null);return s._run(()=>s._fromReadableStream(n)),s}static createChatCompletion(n,s,i){const a=new Mf(s);return a._run(()=>a._runChatCompletion(n,{...s,stream:!0},{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createChatCompletion(n,s,i){var h;super._createChatCompletion;const a=i==null?void 0:i.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),$e(this,ws,"m",i_).call(this);const c=await n.chat.completions.create({...s,stream:!0},{...i,signal:this.controller.signal});this._connected();for await(const g of c)$e(this,ws,"m",o_).call(this,g);if((h=c.controller.signal)!=null&&h.aborted)throw new xi;return this._addChatCompletion($e(this,ws,"m",T$).call(this))}async _fromReadableStream(n,s){var h;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),$e(this,ws,"m",i_).call(this),this._connected();const a=Ko.fromReadableStream(n,this.controller);let c;for await(const g of a)c&&c!==g.id&&this._addChatCompletion($e(this,ws,"m",T$).call(this)),$e(this,ws,"m",o_).call(this,g),c=g.id;if((h=a.controller.signal)!=null&&h.aborted)throw new xi;return this._addChatCompletion($e(this,ws,"m",T$).call(this))}[(Ua=new WeakMap,$h=new WeakMap,Kl=new WeakMap,ws=new WeakSet,i_=function(){this.ended||Mt(this,Kl,void 0)},S$=function(s){let i=$e(this,$h,"f")[s.index];return i||(i={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},$e(this,$h,"f")[s.index]=i,i)},o_=function(s){var a,c,h,g,b,$,y,w,T,C,E,k,A,P,N;if(this.ended)return;const i=$e(this,ws,"m",$0).call(this,s);this._emit("chunk",s,i);for(const B of s.choices){const S=i.choices[B.index];B.delta.content!=null&&((a=S.message)==null?void 0:a.role)==="assistant"&&((c=S.message)!=null&&c.content)&&(this._emit("content",B.delta.content,S.message.content),this._emit("content.delta",{delta:B.delta.content,snapshot:S.message.content,parsed:S.message.parsed})),B.delta.refusal!=null&&((h=S.message)==null?void 0:h.role)==="assistant"&&((g=S.message)!=null&&g.refusal)&&this._emit("refusal.delta",{delta:B.delta.refusal,snapshot:S.message.refusal}),((b=B.logprobs)==null?void 0:b.content)!=null&&(($=S.message)==null?void 0:$.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(y=B.logprobs)==null?void 0:y.content,snapshot:((w=S.logprobs)==null?void 0:w.content)??[]}),((T=B.logprobs)==null?void 0:T.refusal)!=null&&((C=S.message)==null?void 0:C.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(E=B.logprobs)==null?void 0:E.refusal,snapshot:((k=S.logprobs)==null?void 0:k.refusal)??[]});const H=$e(this,ws,"m",S$).call(this,S);S.finish_reason&&($e(this,ws,"m",l_).call(this,S),H.current_tool_call_index!=null&&$e(this,ws,"m",a_).call(this,S,H.current_tool_call_index));for(const q of B.delta.tool_calls??[])H.current_tool_call_index!==q.index&&($e(this,ws,"m",l_).call(this,S),H.current_tool_call_index!=null&&$e(this,ws,"m",a_).call(this,S,H.current_tool_call_index)),H.current_tool_call_index=q.index;for(const q of B.delta.tool_calls??[]){const se=(A=S.message.tool_calls)==null?void 0:A[q.index];se!=null&&se.type&&((se==null?void 0:se.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(P=se.function)==null?void 0:P.name,index:q.index,arguments:se.function.arguments,parsed_arguments:se.function.parsed_arguments,arguments_delta:((N=q.function)==null?void 0:N.arguments)??""}):(se==null||se.type,void 0))}}},a_=function(s,i){var h,g,b;if($e(this,ws,"m",S$).call(this,s).done_tool_calls.has(i))return;const c=(h=s.message.tool_calls)==null?void 0:h[i];if(!c)throw new Error("no tool call snapshot");if(!c.type)throw new Error("tool call snapshot missing `type`");if(c.type==="function"){const $=(b=(g=$e(this,Ua,"f"))==null?void 0:g.tools)==null?void 0:b.find(y=>y.type==="function"&&y.function.name===c.function.name);this._emit("tool_calls.function.arguments.done",{name:c.function.name,index:i,arguments:c.function.arguments,parsed_arguments:Jf($)?$.$parseRaw(c.function.arguments):$!=null&&$.function.strict?JSON.parse(c.function.arguments):null})}else c.type},l_=function(s){var a,c;const i=$e(this,ws,"m",S$).call(this,s);if(s.message.content&&!i.content_done){i.content_done=!0;const h=$e(this,ws,"m",c_).call(this);this._emit("content.done",{content:s.message.content,parsed:h?h.$parseRaw(s.message.content):null})}s.message.refusal&&!i.refusal_done&&(i.refusal_done=!0,this._emit("refusal.done",{refusal:s.message.refusal})),(a=s.logprobs)!=null&&a.content&&!i.logprobs_content_done&&(i.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:s.logprobs.content})),(c=s.logprobs)!=null&&c.refusal&&!i.logprobs_refusal_done&&(i.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:s.logprobs.refusal}))},T$=function(){if(this.ended)throw new Dt("stream has ended, this shouldn't happen");const s=$e(this,Kl,"f");if(!s)throw new Dt("request ended without sending any chunks");return Mt(this,Kl,void 0),Mt(this,$h,[]),tP(s,$e(this,Ua,"f"))},c_=function(){var i;const s=(i=$e(this,Ua,"f"))==null?void 0:i.response_format;return Fw(s)?s:null},$0=function(s){var i,a,c,h;let g=$e(this,Kl,"f");const{choices:b,...$}=s;g?Object.assign(g,$):g=Mt(this,Kl,{...$,choices:[]});for(const{delta:y,finish_reason:w,index:T,logprobs:C=null,...E}of s.choices){let k=g.choices[T];if(k||(k=g.choices[T]={finish_reason:w,index:T,message:{},logprobs:C,...E}),C)if(!k.logprobs)k.logprobs=Object.assign({},C);else{const{content:q,refusal:se,...ee}=C;Object.assign(k.logprobs,ee),q&&((i=k.logprobs).content??(i.content=[]),k.logprobs.content.push(...q)),se&&((a=k.logprobs).refusal??(a.refusal=[]),k.logprobs.refusal.push(...se))}if(w&&(k.finish_reason=w,$e(this,Ua,"f")&&bE($e(this,Ua,"f")))){if(w==="length")throw new Qk;if(w==="content_filter")throw new eE}if(Object.assign(k,E),!y)continue;const{content:A,refusal:P,function_call:N,role:B,tool_calls:S,...H}=y;if(Object.assign(k.message,H),P&&(k.message.refusal=(k.message.refusal||"")+P),B&&(k.message.role=B),N&&(k.message.function_call?(N.name&&(k.message.function_call.name=N.name),N.arguments&&((c=k.message.function_call).arguments??(c.arguments=""),k.message.function_call.arguments+=N.arguments)):k.message.function_call=N),A&&(k.message.content=(k.message.content||"")+A,!k.message.refusal&&$e(this,ws,"m",c_).call(this)&&(k.message.parsed=b0(k.message.content))),S){k.message.tool_calls||(k.message.tool_calls=[]);for(const{index:q,id:se,type:ee,function:K,...Y}of S){const X=(h=k.message.tool_calls)[q]??(h[q]={});Object.assign(X,Y),se&&(X.id=se),ee&&(X.type=ee),K&&(X.function??(X.function={name:K.name??"",arguments:""})),K!=null&&K.name&&(X.function.name=K.name),K!=null&&K.arguments&&(X.function.arguments+=K.arguments,KB($e(this,Ua,"f"),X)&&(X.function.parsed_arguments=b0(X.function.arguments)))}}}return g},Symbol.asyncIterator)](){const n=[],s=[];let i=!1;return this.on("chunk",a=>{const c=s.shift();c?c.resolve(a):n.push(a)}),this.on("end",()=>{i=!0;for(const a of s)a.resolve(void 0);s.length=0}),this.on("abort",a=>{i=!0;for(const c of s)c.reject(a);s.length=0}),this.on("error",a=>{i=!0;for(const c of s)c.reject(a);s.length=0}),{next:async()=>n.length?{value:n.shift(),done:!1}:i?{value:void 0,done:!0}:new Promise((c,h)=>s.push({resolve:c,reject:h})).then(c=>c?{value:c,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Ko(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function tP(o,n){const{id:s,choices:i,created:a,model:c,system_fingerprint:h,...g}=o,b={...g,id:s,choices:i.map(({message:$,finish_reason:y,index:w,logprobs:T,...C})=>{if(!y)throw new Dt(`missing finish_reason for choice ${w}`);const{content:E=null,function_call:k,tool_calls:A,...P}=$,N=$.role;if(!N)throw new Dt(`missing role for choice ${w}`);if(k){const{arguments:B,name:S}=k;if(B==null)throw new Dt(`missing function_call.arguments for choice ${w}`);if(!S)throw new Dt(`missing function_call.name for choice ${w}`);return{...C,message:{content:E,function_call:{arguments:B,name:S},role:N,refusal:$.refusal??null},finish_reason:y,index:w,logprobs:T}}return A?{...C,index:w,finish_reason:y,logprobs:T,message:{...P,role:N,content:E,refusal:$.refusal??null,tool_calls:A.map((B,S)=>{const{function:H,type:q,id:se,...ee}=B,{arguments:K,name:Y,...X}=H||{};if(se==null)throw new Dt(`missing choices[${w}].tool_calls[${S}].id
${k$(o)}`);if(q==null)throw new Dt(`missing choices[${w}].tool_calls[${S}].type
${k$(o)}`);if(Y==null)throw new Dt(`missing choices[${w}].tool_calls[${S}].function.name
${k$(o)}`);if(K==null)throw new Dt(`missing choices[${w}].tool_calls[${S}].function.arguments
${k$(o)}`);return{...ee,id:se,type:q,function:{...X,name:Y,arguments:K}}})}}:{...C,message:{...P,content:E,role:N,refusal:$.refusal??null},finish_reason:y,index:w,logprobs:T}}),created:a,model:c,object:"chat.completion",...h?{system_fingerprint:h}:{}};return HB(b,n)}function k$(o){return JSON.stringify(o)}class Sv extends Mf{static fromReadableStream(n){const s=new Sv(null);return s._run(()=>s._fromReadableStream(n)),s}static runTools(n,s,i){const a=new Sv(s),c={...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"runTools"}};return a._run(()=>a._runTools(n,s,c)),a}}let Ww=class extends Pt{constructor(){super(...arguments),this.messages=new gE(this._client)}create(n,s){return this._client.post("/chat/completions",{body:n,...s,stream:n.stream??!1})}retrieve(n,s){return this._client.get(Xe`/chat/completions/${n}`,s)}update(n,s,i){return this._client.post(Xe`/chat/completions/${n}`,{body:s,...i})}list(n={},s){return this._client.getAPIList("/chat/completions",gs,{query:n,...s})}delete(n,s){return this._client.delete(Xe`/chat/completions/${n}`,s)}parse(n,s){return JB(n.tools),this._client.chat.completions.create(n,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(i=>zw(i,n))}runTools(n,s){return n.stream?Sv.runTools(this._client,n,s):Uw.runTools(this._client,n,s)}stream(n,s){return Mf.createChatCompletion(this._client,n,s)}};Ww.Messages=gE;class Hw extends Pt{constructor(){super(...arguments),this.completions=new Ww(this._client)}}Hw.Completions=Ww;const ME=Symbol("brand.privateNullableHeaders"),v0=Array.isArray;function*nP(o){if(!o)return;if(ME in o){const{values:i,nulls:a}=o;yield*i.entries();for(const c of a)yield[c,null];return}let n=!1,s;o instanceof Headers?s=o.entries():v0(o)?s=o:(n=!0,s=Object.entries(o??{}));for(let i of s){const a=i[0];if(typeof a!="string")throw new TypeError("expected header name to be a string");const c=v0(i[1])?i[1]:[i[1]];let h=!1;for(const g of c)g!==void 0&&(n&&!h&&(h=!0,yield[a,null]),yield[a,g])}}const _t=o=>{const n=new Headers,s=new Set;for(const i of o){const a=new Set;for(const[c,h]of nP(i)){const g=c.toLowerCase();a.has(g)||(n.delete(c),a.add(g)),h===null?(n.delete(c),s.add(g)):(n.append(c,h),s.delete(g))}}return{[ME]:!0,values:n,nulls:s}};class NE extends Pt{create(n,s){return this._client.post("/audio/speech",{body:n,...s,headers:_t([{Accept:"application/octet-stream"},s==null?void 0:s.headers]),__binaryResponse:!0})}}class LE extends Pt{create(n,s){return this._client.post("/audio/transcriptions",wu({body:n,...s,stream:n.stream??!1,__metadata:{model:n.model}},this._client))}}class BE extends Pt{create(n,s){return this._client.post("/audio/translations",wu({body:n,...s,__metadata:{model:n.model}},this._client))}}class qf extends Pt{constructor(){super(...arguments),this.transcriptions=new LE(this._client),this.translations=new BE(this._client),this.speech=new NE(this._client)}}qf.Transcriptions=LE;qf.Translations=BE;qf.Speech=NE;class PE extends Pt{create(n,s){return this._client.post("/batches",{body:n,...s})}retrieve(n,s){return this._client.get(Xe`/batches/${n}`,s)}list(n={},s){return this._client.getAPIList("/batches",gs,{query:n,...s})}cancel(n,s){return this._client.post(Xe`/batches/${n}/cancel`,s)}}class jE extends Pt{create(n,s){return this._client.post("/assistants",{body:n,...s,headers:_t([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}retrieve(n,s){return this._client.get(Xe`/assistants/${n}`,{...s,headers:_t([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}update(n,s,i){return this._client.post(Xe`/assistants/${n}`,{body:s,...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}list(n={},s){return this._client.getAPIList("/assistants",gs,{query:n,...s,headers:_t([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}delete(n,s){return this._client.delete(Xe`/assistants/${n}`,{...s,headers:_t([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}class FE extends Pt{create(n,s){return this._client.post("/realtime/sessions",{body:n,...s,headers:_t([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}class zE extends Pt{create(n,s){return this._client.post("/realtime/transcription_sessions",{body:n,...s,headers:_t([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}}class Zv extends Pt{constructor(){super(...arguments),this.sessions=new FE(this._client),this.transcriptionSessions=new zE(this._client)}}Zv.Sessions=FE;Zv.TranscriptionSessions=zE;class UE extends Pt{create(n,s,i){return this._client.post(Xe`/threads/${n}/messages`,{body:s,...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}retrieve(n,s,i){const{thread_id:a}=s;return this._client.get(Xe`/threads/${a}/messages/${n}`,{...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}update(n,s,i){const{thread_id:a,...c}=s;return this._client.post(Xe`/threads/${a}/messages/${n}`,{body:c,...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}list(n,s={},i){return this._client.getAPIList(Xe`/threads/${n}/messages`,gs,{query:s,...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}delete(n,s,i){const{thread_id:a}=s;return this._client.delete(Xe`/threads/${a}/messages/${n}`,{...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}}class WE extends Pt{retrieve(n,s,i){const{thread_id:a,run_id:c,...h}=s;return this._client.get(Xe`/threads/${a}/runs/${c}/steps/${n}`,{query:h,...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}list(n,s,i){const{thread_id:a,...c}=s;return this._client.getAPIList(Xe`/threads/${a}/runs/${n}/steps`,gs,{query:c,...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}}const sP=o=>{if(typeof Buffer<"u"){const n=Buffer.from(o,"base64");return Array.from(new Float32Array(n.buffer,n.byteOffset,n.length/Float32Array.BYTES_PER_ELEMENT))}else{const n=atob(o),s=n.length,i=new Uint8Array(s);for(let a=0;a<s;a++)i[a]=n.charCodeAt(a);return Array.from(new Float32Array(i.buffer))}};var u_={};const af=o=>{var n,s,i,a;if(typeof globalThis.process<"u")return((n=u_==null?void 0:u_[o])==null?void 0:n.trim())??void 0;if(typeof globalThis.Deno<"u")return(a=(i=(s=globalThis.Deno.env)==null?void 0:s.get)==null?void 0:i.call(s,o))==null?void 0:a.trim()};var Hs,fu,tw,Ho,z$,lo,mu,Th,gu,Tv,ri,U$,W$,kf,bf,$f,y0,_0,w0,C0,S0,T0,k0;class Ef extends jw{constructor(){super(...arguments),Hs.add(this),tw.set(this,[]),Ho.set(this,{}),z$.set(this,{}),lo.set(this,void 0),mu.set(this,void 0),Th.set(this,void 0),gu.set(this,void 0),Tv.set(this,void 0),ri.set(this,void 0),U$.set(this,void 0),W$.set(this,void 0),kf.set(this,void 0)}[(tw=new WeakMap,Ho=new WeakMap,z$=new WeakMap,lo=new WeakMap,mu=new WeakMap,Th=new WeakMap,gu=new WeakMap,Tv=new WeakMap,ri=new WeakMap,U$=new WeakMap,W$=new WeakMap,kf=new WeakMap,Hs=new WeakSet,Symbol.asyncIterator)](){const n=[],s=[];let i=!1;return this.on("event",a=>{const c=s.shift();c?c.resolve(a):n.push(a)}),this.on("end",()=>{i=!0;for(const a of s)a.resolve(void 0);s.length=0}),this.on("abort",a=>{i=!0;for(const c of s)c.reject(a);s.length=0}),this.on("error",a=>{i=!0;for(const c of s)c.reject(a);s.length=0}),{next:async()=>n.length?{value:n.shift(),done:!1}:i?{value:void 0,done:!0}:new Promise((c,h)=>s.push({resolve:c,reject:h})).then(c=>c?{value:c,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(n){const s=new fu;return s._run(()=>s._fromReadableStream(n)),s}async _fromReadableStream(n,s){var c;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort())),this._connected();const a=Ko.fromReadableStream(n,this.controller);for await(const h of a)$e(this,Hs,"m",bf).call(this,h);if((c=a.controller.signal)!=null&&c.aborted)throw new xi;return this._addRun($e(this,Hs,"m",$f).call(this))}toReadableStream(){return new Ko(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(n,s,i,a){const c=new fu;return c._run(()=>c._runToolAssistantStream(n,s,i,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),c}async _createToolAssistantStream(n,s,i,a){var b;const c=a==null?void 0:a.signal;c&&(c.aborted&&this.controller.abort(),c.addEventListener("abort",()=>this.controller.abort()));const h={...i,stream:!0},g=await n.submitToolOutputs(s,h,{...a,signal:this.controller.signal});this._connected();for await(const $ of g)$e(this,Hs,"m",bf).call(this,$);if((b=g.controller.signal)!=null&&b.aborted)throw new xi;return this._addRun($e(this,Hs,"m",$f).call(this))}static createThreadAssistantStream(n,s,i){const a=new fu;return a._run(()=>a._threadAssistantStream(n,s,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),a}static createAssistantStream(n,s,i,a){const c=new fu;return c._run(()=>c._runAssistantStream(n,s,i,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),c}currentEvent(){return $e(this,U$,"f")}currentRun(){return $e(this,W$,"f")}currentMessageSnapshot(){return $e(this,lo,"f")}currentRunStepSnapshot(){return $e(this,kf,"f")}async finalRunSteps(){return await this.done(),Object.values($e(this,Ho,"f"))}async finalMessages(){return await this.done(),Object.values($e(this,z$,"f"))}async finalRun(){if(await this.done(),!$e(this,mu,"f"))throw Error("Final run was not received.");return $e(this,mu,"f")}async _createThreadAssistantStream(n,s,i){var g;const a=i==null?void 0:i.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const c={...s,stream:!0},h=await n.createAndRun(c,{...i,signal:this.controller.signal});this._connected();for await(const b of h)$e(this,Hs,"m",bf).call(this,b);if((g=h.controller.signal)!=null&&g.aborted)throw new xi;return this._addRun($e(this,Hs,"m",$f).call(this))}async _createAssistantStream(n,s,i,a){var b;const c=a==null?void 0:a.signal;c&&(c.aborted&&this.controller.abort(),c.addEventListener("abort",()=>this.controller.abort()));const h={...i,stream:!0},g=await n.create(s,h,{...a,signal:this.controller.signal});this._connected();for await(const $ of g)$e(this,Hs,"m",bf).call(this,$);if((b=g.controller.signal)!=null&&b.aborted)throw new xi;return this._addRun($e(this,Hs,"m",$f).call(this))}static accumulateDelta(n,s){for(const[i,a]of Object.entries(s)){if(!n.hasOwnProperty(i)){n[i]=a;continue}let c=n[i];if(c==null){n[i]=a;continue}if(i==="index"||i==="type"){n[i]=a;continue}if(typeof c=="string"&&typeof a=="string")c+=a;else if(typeof c=="number"&&typeof a=="number")c+=a;else if(n_(c)&&n_(a))c=this.accumulateDelta(c,a);else if(Array.isArray(c)&&Array.isArray(a)){if(c.every(h=>typeof h=="string"||typeof h=="number")){c.push(...a);continue}for(const h of a){if(!n_(h))throw new Error(`Expected array delta entry to be an object but got: ${h}`);const g=h.index;if(g==null)throw console.error(h),new Error("Expected array delta entry to have an `index` property");if(typeof g!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${g}`);const b=c[g];b==null?c.push(h):c[g]=this.accumulateDelta(b,h)}continue}else throw Error(`Unhandled record type: ${i}, deltaValue: ${a}, accValue: ${c}`);n[i]=c}return n}_addRun(n){return n}async _threadAssistantStream(n,s,i){return await this._createThreadAssistantStream(s,n,i)}async _runAssistantStream(n,s,i,a){return await this._createAssistantStream(s,n,i,a)}async _runToolAssistantStream(n,s,i,a){return await this._createToolAssistantStream(s,n,i,a)}}fu=Ef,bf=function(n){if(!this.ended)switch(Mt(this,U$,n),$e(this,Hs,"m",w0).call(this,n),n.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":$e(this,Hs,"m",k0).call(this,n);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":$e(this,Hs,"m",_0).call(this,n);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":$e(this,Hs,"m",y0).call(this,n);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},$f=function(){if(this.ended)throw new Dt("stream has ended, this shouldn't happen");if(!$e(this,mu,"f"))throw Error("Final run has not been received");return $e(this,mu,"f")},y0=function(n){const[s,i]=$e(this,Hs,"m",S0).call(this,n,$e(this,lo,"f"));Mt(this,lo,s),$e(this,z$,"f")[s.id]=s;for(const a of i){const c=s.content[a.index];(c==null?void 0:c.type)=="text"&&this._emit("textCreated",c.text)}switch(n.event){case"thread.message.created":this._emit("messageCreated",n.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",n.data.delta,s),n.data.delta.content)for(const a of n.data.delta.content){if(a.type=="text"&&a.text){let c=a.text,h=s.content[a.index];if(h&&h.type=="text")this._emit("textDelta",c,h.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(a.index!=$e(this,Th,"f")){if($e(this,gu,"f"))switch($e(this,gu,"f").type){case"text":this._emit("textDone",$e(this,gu,"f").text,$e(this,lo,"f"));break;case"image_file":this._emit("imageFileDone",$e(this,gu,"f").image_file,$e(this,lo,"f"));break}Mt(this,Th,a.index)}Mt(this,gu,s.content[a.index])}break;case"thread.message.completed":case"thread.message.incomplete":if($e(this,Th,"f")!==void 0){const a=n.data.content[$e(this,Th,"f")];if(a)switch(a.type){case"image_file":this._emit("imageFileDone",a.image_file,$e(this,lo,"f"));break;case"text":this._emit("textDone",a.text,$e(this,lo,"f"));break}}$e(this,lo,"f")&&this._emit("messageDone",n.data),Mt(this,lo,void 0)}},_0=function(n){const s=$e(this,Hs,"m",C0).call(this,n);switch(Mt(this,kf,s),n.event){case"thread.run.step.created":this._emit("runStepCreated",n.data);break;case"thread.run.step.delta":const i=n.data.delta;if(i.step_details&&i.step_details.type=="tool_calls"&&i.step_details.tool_calls&&s.step_details.type=="tool_calls")for(const c of i.step_details.tool_calls)c.index==$e(this,Tv,"f")?this._emit("toolCallDelta",c,s.step_details.tool_calls[c.index]):($e(this,ri,"f")&&this._emit("toolCallDone",$e(this,ri,"f")),Mt(this,Tv,c.index),Mt(this,ri,s.step_details.tool_calls[c.index]),$e(this,ri,"f")&&this._emit("toolCallCreated",$e(this,ri,"f")));this._emit("runStepDelta",n.data.delta,s);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Mt(this,kf,void 0),n.data.step_details.type=="tool_calls"&&$e(this,ri,"f")&&(this._emit("toolCallDone",$e(this,ri,"f")),Mt(this,ri,void 0)),this._emit("runStepDone",n.data,s);break}},w0=function(n){$e(this,tw,"f").push(n),this._emit("event",n)},C0=function(n){switch(n.event){case"thread.run.step.created":return $e(this,Ho,"f")[n.data.id]=n.data,n.data;case"thread.run.step.delta":let s=$e(this,Ho,"f")[n.data.id];if(!s)throw Error("Received a RunStepDelta before creation of a snapshot");let i=n.data;if(i.delta){const a=fu.accumulateDelta(s,i.delta);$e(this,Ho,"f")[n.data.id]=a}return $e(this,Ho,"f")[n.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":$e(this,Ho,"f")[n.data.id]=n.data;break}if($e(this,Ho,"f")[n.data.id])return $e(this,Ho,"f")[n.data.id];throw new Error("No snapshot available")},S0=function(n,s){let i=[];switch(n.event){case"thread.message.created":return[n.data,i];case"thread.message.delta":if(!s)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let a=n.data;if(a.delta.content)for(const c of a.delta.content)if(c.index in s.content){let h=s.content[c.index];s.content[c.index]=$e(this,Hs,"m",T0).call(this,c,h)}else s.content[c.index]=c,i.push(c);return[s,i];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(s)return[s,i];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},T0=function(n,s){return fu.accumulateDelta(s,n)},k0=function(n){switch(Mt(this,W$,n.data),n.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":Mt(this,mu,n.data),$e(this,ri,"f")&&(this._emit("toolCallDone",$e(this,ri,"f")),Mt(this,ri,void 0));break}};let Vw=class extends Pt{constructor(){super(...arguments),this.steps=new WE(this._client)}create(n,s,i){const{include:a,...c}=s;return this._client.post(Xe`/threads/${n}/runs`,{query:{include:a},body:c,...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers]),stream:s.stream??!1})}retrieve(n,s,i){const{thread_id:a}=s;return this._client.get(Xe`/threads/${a}/runs/${n}`,{...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}update(n,s,i){const{thread_id:a,...c}=s;return this._client.post(Xe`/threads/${a}/runs/${n}`,{body:c,...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}list(n,s={},i){return this._client.getAPIList(Xe`/threads/${n}/runs`,gs,{query:s,...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}cancel(n,s,i){const{thread_id:a}=s;return this._client.post(Xe`/threads/${a}/runs/${n}/cancel`,{...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}async createAndPoll(n,s,i){const a=await this.create(n,s,i);return await this.poll(a.id,{thread_id:n},i)}createAndStream(n,s,i){return Ef.createAssistantStream(n,this._client.beta.threads.runs,s,i)}async poll(n,s,i){var c;const a=_t([i==null?void 0:i.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((c=i==null?void 0:i.pollIntervalMs)==null?void 0:c.toString())??void 0}]);for(;;){const{data:h,response:g}=await this.retrieve(n,s,{...i,headers:{...i==null?void 0:i.headers,...a}}).withResponse();switch(h.status){case"queued":case"in_progress":case"cancelling":let b=5e3;if(i!=null&&i.pollIntervalMs)b=i.pollIntervalMs;else{const $=g.headers.get("openai-poll-after-ms");if($){const y=parseInt($);isNaN(y)||(b=y)}}await Kf(b);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return h}}}stream(n,s,i){return Ef.createAssistantStream(n,this._client.beta.threads.runs,s,i)}submitToolOutputs(n,s,i){const{thread_id:a,...c}=s;return this._client.post(Xe`/threads/${a}/runs/${n}/submit_tool_outputs`,{body:c,...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers]),stream:s.stream??!1})}async submitToolOutputsAndPoll(n,s,i){const a=await this.submitToolOutputs(n,s,i);return await this.poll(a.id,s,i)}submitToolOutputsStream(n,s,i){return Ef.createToolAssistantStream(n,this._client.beta.threads.runs,s,i)}};Vw.Steps=WE;class Qv extends Pt{constructor(){super(...arguments),this.runs=new Vw(this._client),this.messages=new UE(this._client)}create(n={},s){return this._client.post("/threads",{body:n,...s,headers:_t([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}retrieve(n,s){return this._client.get(Xe`/threads/${n}`,{...s,headers:_t([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}update(n,s,i){return this._client.post(Xe`/threads/${n}`,{body:s,...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}delete(n,s){return this._client.delete(Xe`/threads/${n}`,{...s,headers:_t([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}createAndRun(n,s){return this._client.post("/threads/runs",{body:n,...s,headers:_t([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers]),stream:n.stream??!1})}async createAndRunPoll(n,s){const i=await this.createAndRun(n,s);return await this.runs.poll(i.id,{thread_id:i.thread_id},s)}createAndRunStream(n,s){return Ef.createThreadAssistantStream(n,this._client.beta.threads,s)}}Qv.Runs=Vw;Qv.Messages=UE;class Yf extends Pt{constructor(){super(...arguments),this.realtime=new Zv(this._client),this.assistants=new jE(this._client),this.threads=new Qv(this._client)}}Yf.Realtime=Zv;Yf.Assistants=jE;Yf.Threads=Qv;class HE extends Pt{create(n,s){return this._client.post("/completions",{body:n,...s,stream:n.stream??!1})}}class VE extends Pt{retrieve(n,s,i){const{container_id:a}=s;return this._client.get(Xe`/containers/${a}/files/${n}/content`,{...i,headers:_t([{Accept:"application/binary"},i==null?void 0:i.headers]),__binaryResponse:!0})}}let Gw=class extends Pt{constructor(){super(...arguments),this.content=new VE(this._client)}create(n,s,i){return this._client.post(Xe`/containers/${n}/files`,wu({body:s,...i},this._client))}retrieve(n,s,i){const{container_id:a}=s;return this._client.get(Xe`/containers/${a}/files/${n}`,i)}list(n,s={},i){return this._client.getAPIList(Xe`/containers/${n}/files`,gs,{query:s,...i})}delete(n,s,i){const{container_id:a}=s;return this._client.delete(Xe`/containers/${a}/files/${n}`,{...i,headers:_t([{Accept:"*/*"},i==null?void 0:i.headers])})}};Gw.Content=VE;class Kw extends Pt{constructor(){super(...arguments),this.files=new Gw(this._client)}create(n,s){return this._client.post("/containers",{body:n,...s})}retrieve(n,s){return this._client.get(Xe`/containers/${n}`,s)}list(n={},s){return this._client.getAPIList("/containers",gs,{query:n,...s})}delete(n,s){return this._client.delete(Xe`/containers/${n}`,{...s,headers:_t([{Accept:"*/*"},s==null?void 0:s.headers])})}}Kw.Files=Gw;class GE extends Pt{create(n,s){const i=!!n.encoding_format;let a=i?n.encoding_format:"base64";i&&dr(this._client).debug("embeddings/user defined encoding_format:",n.encoding_format);const c=this._client.post("/embeddings",{body:{...n,encoding_format:a},...s});return i?c:(dr(this._client).debug("embeddings/decoding base64 embeddings from base64"),c._thenUnwrap(h=>(h&&h.data&&h.data.forEach(g=>{const b=g.embedding;g.embedding=sP(b)}),h)))}}class KE extends Pt{retrieve(n,s,i){const{eval_id:a,run_id:c}=s;return this._client.get(Xe`/evals/${a}/runs/${c}/output_items/${n}`,i)}list(n,s,i){const{eval_id:a,...c}=s;return this._client.getAPIList(Xe`/evals/${a}/runs/${n}/output_items`,gs,{query:c,...i})}}class Jw extends Pt{constructor(){super(...arguments),this.outputItems=new KE(this._client)}create(n,s,i){return this._client.post(Xe`/evals/${n}/runs`,{body:s,...i})}retrieve(n,s,i){const{eval_id:a}=s;return this._client.get(Xe`/evals/${a}/runs/${n}`,i)}list(n,s={},i){return this._client.getAPIList(Xe`/evals/${n}/runs`,gs,{query:s,...i})}delete(n,s,i){const{eval_id:a}=s;return this._client.delete(Xe`/evals/${a}/runs/${n}`,i)}cancel(n,s,i){const{eval_id:a}=s;return this._client.post(Xe`/evals/${a}/runs/${n}`,i)}}Jw.OutputItems=KE;class qw extends Pt{constructor(){super(...arguments),this.runs=new Jw(this._client)}create(n,s){return this._client.post("/evals",{body:n,...s})}retrieve(n,s){return this._client.get(Xe`/evals/${n}`,s)}update(n,s,i){return this._client.post(Xe`/evals/${n}`,{body:s,...i})}list(n={},s){return this._client.getAPIList("/evals",gs,{query:n,...s})}delete(n,s){return this._client.delete(Xe`/evals/${n}`,s)}}qw.Runs=Jw;let JE=class extends Pt{create(n,s){return this._client.post("/files",wu({body:n,...s},this._client))}retrieve(n,s){return this._client.get(Xe`/files/${n}`,s)}list(n={},s){return this._client.getAPIList("/files",gs,{query:n,...s})}delete(n,s){return this._client.delete(Xe`/files/${n}`,s)}content(n,s){return this._client.get(Xe`/files/${n}/content`,{...s,headers:_t([{Accept:"application/binary"},s==null?void 0:s.headers]),__binaryResponse:!0})}async waitForProcessing(n,{pollInterval:s=5e3,maxWait:i=30*60*1e3}={}){const a=new Set(["processed","error","deleted"]),c=Date.now();let h=await this.retrieve(n);for(;!h.status||!a.has(h.status);)if(await Kf(s),h=await this.retrieve(n),Date.now()-c>i)throw new Bw({message:`Giving up on waiting for file ${n} to finish processing after ${i} milliseconds.`});return h}};class qE extends Pt{}let YE=class extends Pt{run(n,s){return this._client.post("/fine_tuning/alpha/graders/run",{body:n,...s})}validate(n,s){return this._client.post("/fine_tuning/alpha/graders/validate",{body:n,...s})}};class Yw extends Pt{constructor(){super(...arguments),this.graders=new YE(this._client)}}Yw.Graders=YE;class XE extends Pt{create(n,s,i){return this._client.getAPIList(Xe`/fine_tuning/checkpoints/${n}/permissions`,Xv,{body:s,method:"post",...i})}retrieve(n,s={},i){return this._client.get(Xe`/fine_tuning/checkpoints/${n}/permissions`,{query:s,...i})}delete(n,s,i){const{fine_tuned_model_checkpoint:a}=s;return this._client.delete(Xe`/fine_tuning/checkpoints/${a}/permissions/${n}`,i)}}let Xw=class extends Pt{constructor(){super(...arguments),this.permissions=new XE(this._client)}};Xw.Permissions=XE;class ZE extends Pt{list(n,s={},i){return this._client.getAPIList(Xe`/fine_tuning/jobs/${n}/checkpoints`,gs,{query:s,...i})}}class Zw extends Pt{constructor(){super(...arguments),this.checkpoints=new ZE(this._client)}create(n,s){return this._client.post("/fine_tuning/jobs",{body:n,...s})}retrieve(n,s){return this._client.get(Xe`/fine_tuning/jobs/${n}`,s)}list(n={},s){return this._client.getAPIList("/fine_tuning/jobs",gs,{query:n,...s})}cancel(n,s){return this._client.post(Xe`/fine_tuning/jobs/${n}/cancel`,s)}listEvents(n,s={},i){return this._client.getAPIList(Xe`/fine_tuning/jobs/${n}/events`,gs,{query:s,...i})}pause(n,s){return this._client.post(Xe`/fine_tuning/jobs/${n}/pause`,s)}resume(n,s){return this._client.post(Xe`/fine_tuning/jobs/${n}/resume`,s)}}Zw.Checkpoints=ZE;class Mh extends Pt{constructor(){super(...arguments),this.methods=new qE(this._client),this.jobs=new Zw(this._client),this.checkpoints=new Xw(this._client),this.alpha=new Yw(this._client)}}Mh.Methods=qE;Mh.Jobs=Zw;Mh.Checkpoints=Xw;Mh.Alpha=Yw;class QE extends Pt{}class Qw extends Pt{constructor(){super(...arguments),this.graderModels=new QE(this._client)}}Qw.GraderModels=QE;class eI extends Pt{createVariation(n,s){return this._client.post("/images/variations",wu({body:n,...s},this._client))}edit(n,s){return this._client.post("/images/edits",wu({body:n,...s},this._client))}generate(n,s){return this._client.post("/images/generations",{body:n,...s})}}class tI extends Pt{retrieve(n,s){return this._client.get(Xe`/models/${n}`,s)}list(n){return this._client.getAPIList("/models",Xv,n)}delete(n,s){return this._client.delete(Xe`/models/${n}`,s)}}class nI extends Pt{create(n,s){return this._client.post("/moderations",{body:n,...s})}}function rP(o,n){return!n||!oP(n)?{...o,output_parsed:null,output:o.output.map(s=>s.type==="function_call"?{...s,parsed_arguments:null}:s.type==="message"?{...s,content:s.content.map(i=>({...i,parsed:null}))}:s)}:sI(o,n)}function sI(o,n){const s=o.output.map(a=>{if(a.type==="function_call")return{...a,parsed_arguments:cP(n,a)};if(a.type==="message"){const c=a.content.map(h=>h.type==="output_text"?{...h,parsed:iP(n,h.text)}:h);return{...a,content:c}}return a}),i=Object.assign({},o,{output:s});return Object.getOwnPropertyDescriptor(o,"output_text")||rI(i),Object.defineProperty(i,"output_parsed",{enumerable:!0,get(){for(const a of i.output)if(a.type==="message"){for(const c of a.content)if(c.type==="output_text"&&c.parsed!==null)return c.parsed}return null}}),i}function iP(o,n){var s,i,a,c;return((i=(s=o.text)==null?void 0:s.format)==null?void 0:i.type)!=="json_schema"?null:"$parseRaw"in((a=o.text)==null?void 0:a.format)?((c=o.text)==null?void 0:c.format).$parseRaw(n):JSON.parse(n)}function oP(o){var n;return!!Fw((n=o.text)==null?void 0:n.format)}function aP(o){return(o==null?void 0:o.$brand)==="auto-parseable-tool"}function lP(o,n){return o.find(s=>s.type==="function"&&s.name===n)}function cP(o,n){const s=lP(o.tools??[],n.name);return{...n,...n,parsed_arguments:aP(s)?s.$parseRaw(n.arguments):s!=null&&s.strict?JSON.parse(n.arguments):null}}function rI(o){const n=[];for(const s of o.output)if(s.type==="message")for(const i of s.content)i.type==="output_text"&&n.push(i.text);o.output_text=n.join("")}var vh,E$,Jl,I$,E0,I0,x0,D0;class eC extends jw{constructor(n){super(),vh.add(this),E$.set(this,void 0),Jl.set(this,void 0),I$.set(this,void 0),Mt(this,E$,n)}static createResponse(n,s,i){const a=new eC(s);return a._run(()=>a._createOrRetrieveResponse(n,s,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createOrRetrieveResponse(n,s,i){var g;const a=i==null?void 0:i.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort())),$e(this,vh,"m",E0).call(this);let c,h=null;"response_id"in s?(c=await n.responses.retrieve(s.response_id,{stream:!0},{...i,signal:this.controller.signal,stream:!0}),h=s.starting_after??null):c=await n.responses.create({...s,stream:!0},{...i,signal:this.controller.signal}),this._connected();for await(const b of c)$e(this,vh,"m",I0).call(this,b,h);if((g=c.controller.signal)!=null&&g.aborted)throw new xi;return $e(this,vh,"m",x0).call(this)}[(E$=new WeakMap,Jl=new WeakMap,I$=new WeakMap,vh=new WeakSet,E0=function(){this.ended||Mt(this,Jl,void 0)},I0=function(s,i){if(this.ended)return;const a=(h,g)=>{(i==null||g.sequence_number>i)&&this._emit(h,g)},c=$e(this,vh,"m",D0).call(this,s);switch(a("event",s),s.type){case"response.output_text.delta":{const h=c.output[s.output_index];if(!h)throw new Dt(`missing output at index ${s.output_index}`);if(h.type==="message"){const g=h.content[s.content_index];if(!g)throw new Dt(`missing content at index ${s.content_index}`);if(g.type!=="output_text")throw new Dt(`expected content to be 'output_text', got ${g.type}`);a("response.output_text.delta",{...s,snapshot:g.text})}break}case"response.function_call_arguments.delta":{const h=c.output[s.output_index];if(!h)throw new Dt(`missing output at index ${s.output_index}`);h.type==="function_call"&&a("response.function_call_arguments.delta",{...s,snapshot:h.arguments});break}default:a(s.type,s);break}},x0=function(){if(this.ended)throw new Dt("stream has ended, this shouldn't happen");const s=$e(this,Jl,"f");if(!s)throw new Dt("request ended without sending any events");Mt(this,Jl,void 0);const i=uP(s,$e(this,E$,"f"));return Mt(this,I$,i),i},D0=function(s){let i=$e(this,Jl,"f");if(!i){if(s.type!=="response.created")throw new Dt(`When snapshot hasn't been set yet, expected 'response.created' event, got ${s.type}`);return i=Mt(this,Jl,s.response),i}switch(s.type){case"response.output_item.added":{i.output.push(s.item);break}case"response.content_part.added":{const a=i.output[s.output_index];if(!a)throw new Dt(`missing output at index ${s.output_index}`);a.type==="message"&&a.content.push(s.part);break}case"response.output_text.delta":{const a=i.output[s.output_index];if(!a)throw new Dt(`missing output at index ${s.output_index}`);if(a.type==="message"){const c=a.content[s.content_index];if(!c)throw new Dt(`missing content at index ${s.content_index}`);if(c.type!=="output_text")throw new Dt(`expected content to be 'output_text', got ${c.type}`);c.text+=s.delta}break}case"response.function_call_arguments.delta":{const a=i.output[s.output_index];if(!a)throw new Dt(`missing output at index ${s.output_index}`);a.type==="function_call"&&(a.arguments+=s.delta);break}case"response.completed":{Mt(this,Jl,s.response);break}}return i},Symbol.asyncIterator)](){const n=[],s=[];let i=!1;return this.on("event",a=>{const c=s.shift();c?c.resolve(a):n.push(a)}),this.on("end",()=>{i=!0;for(const a of s)a.resolve(void 0);s.length=0}),this.on("abort",a=>{i=!0;for(const c of s)c.reject(a);s.length=0}),this.on("error",a=>{i=!0;for(const c of s)c.reject(a);s.length=0}),{next:async()=>n.length?{value:n.shift(),done:!1}:i?{value:void 0,done:!0}:new Promise((c,h)=>s.push({resolve:c,reject:h})).then(c=>c?{value:c,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const n=$e(this,I$,"f");if(!n)throw new Dt("stream ended without producing a ChatCompletion");return n}}function uP(o,n){return rP(o,n)}class iI extends Pt{list(n,s={},i){return this._client.getAPIList(Xe`/responses/${n}/input_items`,gs,{query:s,...i})}}class tC extends Pt{constructor(){super(...arguments),this.inputItems=new iI(this._client)}create(n,s){return this._client.post("/responses",{body:n,...s,stream:n.stream??!1})._thenUnwrap(i=>("object"in i&&i.object==="response"&&rI(i),i))}retrieve(n,s={},i){return this._client.get(Xe`/responses/${n}`,{query:s,...i,stream:(s==null?void 0:s.stream)??!1})}delete(n,s){return this._client.delete(Xe`/responses/${n}`,{...s,headers:_t([{Accept:"*/*"},s==null?void 0:s.headers])})}parse(n,s){return this._client.responses.create(n,s)._thenUnwrap(i=>sI(i,n))}stream(n,s){return eC.createResponse(this._client,n,s)}cancel(n,s){return this._client.post(Xe`/responses/${n}/cancel`,s)}}tC.InputItems=iI;class oI extends Pt{create(n,s,i){return this._client.post(Xe`/uploads/${n}/parts`,wu({body:s,...i},this._client))}}class nC extends Pt{constructor(){super(...arguments),this.parts=new oI(this._client)}create(n,s){return this._client.post("/uploads",{body:n,...s})}cancel(n,s){return this._client.post(Xe`/uploads/${n}/cancel`,s)}complete(n,s,i){return this._client.post(Xe`/uploads/${n}/complete`,{body:s,...i})}}nC.Parts=oI;const dP=async o=>{const n=await Promise.allSettled(o),s=n.filter(a=>a.status==="rejected");if(s.length){for(const a of s)console.error(a.reason);throw new Error(`${s.length} promise(s) failed - see the above errors`)}const i=[];for(const a of n)a.status==="fulfilled"&&i.push(a.value);return i};class aI extends Pt{create(n,s,i){return this._client.post(Xe`/vector_stores/${n}/file_batches`,{body:s,...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}retrieve(n,s,i){const{vector_store_id:a}=s;return this._client.get(Xe`/vector_stores/${a}/file_batches/${n}`,{...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}cancel(n,s,i){const{vector_store_id:a}=s;return this._client.post(Xe`/vector_stores/${a}/file_batches/${n}/cancel`,{...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}async createAndPoll(n,s,i){const a=await this.create(n,s);return await this.poll(n,a.id,i)}listFiles(n,s,i){const{vector_store_id:a,...c}=s;return this._client.getAPIList(Xe`/vector_stores/${a}/file_batches/${n}/files`,gs,{query:c,...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}async poll(n,s,i){var c;const a=_t([i==null?void 0:i.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((c=i==null?void 0:i.pollIntervalMs)==null?void 0:c.toString())??void 0}]);for(;;){const{data:h,response:g}=await this.retrieve(s,{vector_store_id:n},{...i,headers:a}).withResponse();switch(h.status){case"in_progress":let b=5e3;if(i!=null&&i.pollIntervalMs)b=i.pollIntervalMs;else{const $=g.headers.get("openai-poll-after-ms");if($){const y=parseInt($);isNaN(y)||(b=y)}}await Kf(b);break;case"failed":case"cancelled":case"completed":return h}}}async uploadAndPoll(n,{files:s,fileIds:i=[]},a){if(s==null||s.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const c=(a==null?void 0:a.maxConcurrency)??5,h=Math.min(c,s.length),g=this._client,b=s.values(),$=[...i];async function y(T){for(let C of T){const E=await g.files.create({file:C,purpose:"assistants"},a);$.push(E.id)}}const w=Array(h).fill(b).map(y);return await dP(w),await this.createAndPoll(n,{file_ids:$})}}class lI extends Pt{create(n,s,i){return this._client.post(Xe`/vector_stores/${n}/files`,{body:s,...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}retrieve(n,s,i){const{vector_store_id:a}=s;return this._client.get(Xe`/vector_stores/${a}/files/${n}`,{...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}update(n,s,i){const{vector_store_id:a,...c}=s;return this._client.post(Xe`/vector_stores/${a}/files/${n}`,{body:c,...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}list(n,s={},i){return this._client.getAPIList(Xe`/vector_stores/${n}/files`,gs,{query:s,...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}delete(n,s,i){const{vector_store_id:a}=s;return this._client.delete(Xe`/vector_stores/${a}/files/${n}`,{...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}async createAndPoll(n,s,i){const a=await this.create(n,s,i);return await this.poll(n,a.id,i)}async poll(n,s,i){var c;const a=_t([i==null?void 0:i.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":((c=i==null?void 0:i.pollIntervalMs)==null?void 0:c.toString())??void 0}]);for(;;){const h=await this.retrieve(s,{vector_store_id:n},{...i,headers:a}).withResponse(),g=h.data;switch(g.status){case"in_progress":let b=5e3;if(i!=null&&i.pollIntervalMs)b=i.pollIntervalMs;else{const $=h.response.headers.get("openai-poll-after-ms");if($){const y=parseInt($);isNaN(y)||(b=y)}}await Kf(b);break;case"failed":case"completed":return g}}}async upload(n,s,i){const a=await this._client.files.create({file:s,purpose:"assistants"},i);return this.create(n,{file_id:a.id},i)}async uploadAndPoll(n,s,i){const a=await this.upload(n,s,i);return await this.poll(n,a.id,i)}content(n,s,i){const{vector_store_id:a}=s;return this._client.getAPIList(Xe`/vector_stores/${a}/files/${n}/content`,Xv,{...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}}class ey extends Pt{constructor(){super(...arguments),this.files=new lI(this._client),this.fileBatches=new aI(this._client)}create(n,s){return this._client.post("/vector_stores",{body:n,...s,headers:_t([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}retrieve(n,s){return this._client.get(Xe`/vector_stores/${n}`,{...s,headers:_t([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}update(n,s,i){return this._client.post(Xe`/vector_stores/${n}`,{body:s,...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}list(n={},s){return this._client.getAPIList("/vector_stores",gs,{query:n,...s,headers:_t([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}delete(n,s){return this._client.delete(Xe`/vector_stores/${n}`,{...s,headers:_t([{"OpenAI-Beta":"assistants=v2"},s==null?void 0:s.headers])})}search(n,s,i){return this._client.getAPIList(Xe`/vector_stores/${n}/search`,Xv,{body:s,method:"post",...i,headers:_t([{"OpenAI-Beta":"assistants=v2"},i==null?void 0:i.headers])})}}ey.Files=lI;ey.FileBatches=aI;var sC,H$;class hn{constructor({baseURL:n=af("OPENAI_BASE_URL"),apiKey:s=af("OPENAI_API_KEY"),organization:i=af("OPENAI_ORG_ID")??null,project:a=af("OPENAI_PROJECT_ID")??null,...c}={}){if(H$.set(this,void 0),this.completions=new HE(this),this.chat=new Hw(this),this.embeddings=new GE(this),this.files=new JE(this),this.images=new eI(this),this.audio=new qf(this),this.moderations=new nI(this),this.models=new tI(this),this.fineTuning=new Mh(this),this.graders=new Qw(this),this.vectorStores=new ey(this),this.beta=new Yf(this),this.batches=new PE(this),this.uploads=new nC(this),this.responses=new tC(this),this.evals=new qw(this),this.containers=new Kw(this),s===void 0)throw new Dt("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const h={apiKey:s,organization:i,project:a,...c,baseURL:n||"https://api.openai.com/v1"};if(!h.dangerouslyAllowBrowser&&cB())throw new Dt(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);this.baseURL=h.baseURL,this.timeout=h.timeout??sC.DEFAULT_TIMEOUT,this.logger=h.logger??console;const g="warn";this.logLevel=g,this.logLevel=a0(h.logLevel,"ClientOptions.logLevel",this)??a0(af("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??g,this.fetchOptions=h.fetchOptions,this.maxRetries=h.maxRetries??2,this.fetch=h.fetch??gB(),Mt(this,H$,mB),this._options=h,this.apiKey=s,this.organization=i,this.project=a}withOptions(n){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,...n})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:n,nulls:s}){}authHeaders(n){return _t([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(n){return kB(n,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${_h}`}defaultIdempotencyKey(){return`stainless-node-retry-${Hk()}`}makeStatusError(n,s,i,a){return Vs.generate(n,s,i,a)}buildURL(n,s){const i=nB(n)?new URL(n):new URL(this.baseURL+(this.baseURL.endsWith("/")&&n.startsWith("/")?n.slice(1):n)),a=this.defaultQuery();return rB(a)||(s={...a,...s}),typeof s=="object"&&s&&!Array.isArray(s)&&(i.search=this.stringifyQuery(s)),i.toString()}async prepareOptions(n){}async prepareRequest(n,{url:s,options:i}){}get(n,s){return this.methodRequest("get",n,s)}post(n,s){return this.methodRequest("post",n,s)}patch(n,s){return this.methodRequest("patch",n,s)}put(n,s){return this.methodRequest("put",n,s)}delete(n,s){return this.methodRequest("delete",n,s)}methodRequest(n,s,i){return this.request(Promise.resolve(i).then(a=>({method:n,path:s,...a})))}request(n,s=null){return new Yv(this,this.makeRequest(n,s,void 0))}async makeRequest(n,s,i){var P,N;const a=await n,c=a.maxRetries??this.maxRetries;s==null&&(s=c),await this.prepareOptions(a);const{req:h,url:g,timeout:b}=this.buildRequest(a,{retryCount:c-s});await this.prepareRequest(h,{url:g,options:a});const $="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),y=i===void 0?"":`, retryOf: ${i}`,w=Date.now();if(dr(this).debug(`[${$}] sending request`,hu({retryOfRequestLogID:i,method:a.method,url:g,options:a,headers:h.headers})),(P=a.signal)!=null&&P.aborted)throw new xi;const T=new AbortController,C=await this.fetchWithTimeout(g,h,b,T).catch(V_),E=Date.now();if(C instanceof Error){const B=`retrying, ${s} attempts remaining`;if((N=a.signal)!=null&&N.aborted)throw new xi;const S=H_(C)||/timed? ?out/i.test(String(C)+("cause"in C?String(C.cause):""));if(s)return dr(this).info(`[${$}] connection ${S?"timed out":"failed"} - ${B}`),dr(this).debug(`[${$}] connection ${S?"timed out":"failed"} (${B})`,hu({retryOfRequestLogID:i,url:g,durationMs:E-w,message:C.message})),this.retryRequest(a,s,i??$);throw dr(this).info(`[${$}] connection ${S?"timed out":"failed"} - error; no more retries left`),dr(this).debug(`[${$}] connection ${S?"timed out":"failed"} (error; no more retries left)`,hu({retryOfRequestLogID:i,url:g,durationMs:E-w,message:C.message})),S?new Bw:new Jv({cause:C})}const k=[...C.headers.entries()].filter(([B])=>B==="x-request-id").map(([B,S])=>", "+B+": "+JSON.stringify(S)).join(""),A=`[${$}${y}${k}] ${h.method} ${g} ${C.ok?"succeeded":"failed"} with status ${C.status} in ${E-w}ms`;if(!C.ok){const B=this.shouldRetry(C);if(s&&B){const K=`retrying, ${s} attempts remaining`;return await fB(C.body),dr(this).info(`${A} - ${K}`),dr(this).debug(`[${$}] response error (${K})`,hu({retryOfRequestLogID:i,url:C.url,status:C.status,headers:C.headers,durationMs:E-w})),this.retryRequest(a,s,i??$,C.headers)}const S=B?"error; no more retries left":"error; not retryable";dr(this).info(`${A} - ${S}`);const H=await C.text().catch(K=>V_(K).message),q=aB(H),se=q?void 0:H;throw dr(this).debug(`[${$}] response error (${S})`,hu({retryOfRequestLogID:i,url:C.url,status:C.status,headers:C.headers,message:se,durationMs:Date.now()-w})),this.makeStatusError(C.status,q,se,C.headers)}return dr(this).info(A),dr(this).debug(`[${$}] response start`,hu({retryOfRequestLogID:i,url:C.url,status:C.status,headers:C.headers,durationMs:E-w})),{response:C,options:a,controller:T,requestLogID:$,retryOfRequestLogID:i,startTime:w}}getAPIList(n,s,i){return this.requestAPIList(s,{method:"get",path:n,...i})}requestAPIList(n,s){const i=this.makeRequest(s,null,void 0);return new MB(this,i,n)}async fetchWithTimeout(n,s,i,a){const{signal:c,method:h,...g}=s||{};c&&c.addEventListener("abort",()=>a.abort());const b=setTimeout(()=>a.abort(),i),$=globalThis.ReadableStream&&g.body instanceof globalThis.ReadableStream||typeof g.body=="object"&&g.body!==null&&Symbol.asyncIterator in g.body,y={signal:a.signal,...$?{duplex:"half"}:{},method:"GET",...g};h&&(y.method=h.toUpperCase());try{return await this.fetch.call(void 0,n,y)}finally{clearTimeout(b)}}shouldRetry(n){const s=n.headers.get("x-should-retry");return s==="true"?!0:s==="false"?!1:n.status===408||n.status===409||n.status===429||n.status>=500}async retryRequest(n,s,i,a){let c;const h=a==null?void 0:a.get("retry-after-ms");if(h){const b=parseFloat(h);Number.isNaN(b)||(c=b)}const g=a==null?void 0:a.get("retry-after");if(g&&!c){const b=parseFloat(g);Number.isNaN(b)?c=Date.parse(g)-Date.now():c=b*1e3}if(!(c&&0<=c&&c<60*1e3)){const b=n.maxRetries??this.maxRetries;c=this.calculateDefaultRetryTimeoutMillis(s,b)}return await Kf(c),this.makeRequest(n,s-1,i)}calculateDefaultRetryTimeoutMillis(n,s){const c=s-n,h=Math.min(.5*Math.pow(2,c),8),g=1-Math.random()*.25;return h*g*1e3}buildRequest(n,{retryCount:s=0}={}){const i={...n},{method:a,path:c,query:h}=i,g=this.buildURL(c,h);"timeout"in i&&oB("timeout",i.timeout),i.timeout=i.timeout??this.timeout;const{bodyHeaders:b,body:$}=this.buildBody({options:i}),y=this.buildHeaders({options:n,method:a,bodyHeaders:b,retryCount:s});return{req:{method:a,headers:y,...i.signal&&{signal:i.signal},...globalThis.ReadableStream&&$ instanceof globalThis.ReadableStream&&{duplex:"half"},...$&&{body:$},...this.fetchOptions??{},...i.fetchOptions??{}},url:g,timeout:i.timeout}}buildHeaders({options:n,method:s,bodyHeaders:i,retryCount:a}){let c={};this.idempotencyHeader&&s!=="get"&&(n.idempotencyKey||(n.idempotencyKey=this.defaultIdempotencyKey()),c[this.idempotencyHeader]=n.idempotencyKey);const h=_t([c,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(a),...n.timeout?{"X-Stainless-Timeout":String(Math.trunc(n.timeout/1e3))}:{},...pB(),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},this.authHeaders(n),this._options.defaultHeaders,i,n.headers]);return this.validateHeaders(h),h.values}buildBody({options:{body:n,headers:s}}){if(!n)return{bodyHeaders:void 0,body:void 0};const i=_t([s]);return ArrayBuffer.isView(n)||n instanceof ArrayBuffer||n instanceof DataView||typeof n=="string"&&i.values.has("content-type")||n instanceof Blob||n instanceof FormData||n instanceof URLSearchParams||globalThis.ReadableStream&&n instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:n}:typeof n=="object"&&(Symbol.asyncIterator in n||Symbol.iterator in n&&"next"in n&&typeof n.next=="function")?{bodyHeaders:void 0,body:nE(n)}:$e(this,H$,"f").call(this,{body:n,headers:i})}}sC=hn,H$=new WeakMap;hn.OpenAI=sC;hn.DEFAULT_TIMEOUT=6e5;hn.OpenAIError=Dt;hn.APIError=Vs;hn.APIConnectionError=Jv;hn.APIConnectionTimeoutError=Bw;hn.APIUserAbortError=xi;hn.NotFoundError=Jk;hn.ConflictError=qk;hn.RateLimitError=Xk;hn.BadRequestError=Vk;hn.AuthenticationError=Gk;hn.InternalServerError=Zk;hn.PermissionDeniedError=Kk;hn.UnprocessableEntityError=Yk;hn.toFile=FB;hn.Completions=HE;hn.Chat=Hw;hn.Embeddings=GE;hn.Files=JE;hn.Images=eI;hn.Audio=qf;hn.Moderations=nI;hn.Models=tI;hn.FineTuning=Mh;hn.Graders=Qw;hn.VectorStores=ey;hn.Beta=Yf;hn.Batches=PE;hn.Uploads=nC;hn.Responses=tC;hn.Evals=qw;hn.Containers=Kw;const hP=px(()=>import("./docs-BrInh2Pn.js"),[],import.meta.url);let x$=null;async function pP(o){if(x$)return x$;const n=await o.getObjectViewSystem("state","",""),s=await o.getObjectViewSystem("channel","",""),i=await o.getObjectViewSystem("device","",""),a=await o.getObjectViewSystem("folder","",""),c=await o.getObjectViewSystem("enum","","");return x$=Object.assign(n,s,i,a,c),x$}function yh(o,n){return o&&typeof o=="object"?o[n]||o.en:o||""}async function gP(o){var E,k,A,P;const n=I.I18n.getLanguage(),s=await pP(o),i=Object.keys(s).sort(),a=new ex,c=[],h=["UNREACH_STICKY"],g=[tx.Types.info],b=[],$=[],y=[],w=[];i.forEach(N=>{var B,S,H;((B=s[N])==null?void 0:B.type)==="enum"?b.push(N):(H=(S=s[N])==null?void 0:S.common)!=null&&H.smartName&&w.push(N)}),b.forEach(N=>{N.startsWith("enum.rooms.")?$.push(N):N.startsWith("enum.functions.")&&y.push(N);const B=s[N].common.members;B!=null&&B.length&&B.forEach(S=>{s[S]&&(w.includes(S)||w.push(S))})});const T={id:"",objects:s,_keysOptional:i,_usedIdsOptional:c,ignoreIndicators:h,excludedTypes:g},C=[];w.forEach(N=>{T.id=N;const B=a.detect(T);B&&B.forEach(S=>{var W;const H=(W=S.states.find(te=>te.id))==null?void 0:W.id;if(!H||C.find(te=>te.id===H))return;const q=s[H],se={id:H,name:yh(q.common.name,n),type:q.type,deviceType:S.type,states:S.states.filter(te=>te.id).map(te=>({id:te.id,name:te.name,role:te.defaultRole,type:s[te.id].common.type,unit:s[te.id].common.unit,read:s[te.id].common.read===void 0?!0:s[te.id].common.read,write:s[te.id].common.write===void 0?!0:s[te.id].common.write}))},ee=H.split(".");let K,Y;(q.type==="channel"||q.type==="state")&&(ee.pop(),K=ee.join("."),s[K]&&(s[K].type==="channel"||s[K].type==="folder")?(ee.pop(),Y=ee.join("."),(!s[Y]||s[Y].type!=="device"&&s[K].type!=="folder")&&(Y=void 0)):K=void 0);const X=$.find(te=>{var ke,Z,ze;return(ke=s[te].common.members)!=null&&ke.includes(H)||K&&((Z=s[te].common.members)!=null&&Z.includes(K))?!0:Y&&((ze=s[te].common.members)==null?void 0:ze.includes(Y))});X&&(se.room=yh(s[X].common.name,n));const ce=y.find(te=>{var ke,Z,ze;return(ke=s[te].common.members)!=null&&ke.includes(H)||K&&((Z=s[te].common.members)!=null&&Z.includes(K))?!0:Y&&((ze=s[te].common.members)==null?void 0:ze.includes(Y))});ce&&(se.function=yh(s[ce].common.name,n)),C.push(se)})});for(let N=0;N<C.length;N++){const B=C[N];if(B.type==="state"||B.type==="channel"){const S=B.id.split(".");S.pop();const H=s[S.join(".")];if(H&&(H.type==="channel"||H.type==="device"||H.type==="folder")){B.name=yh(((E=H.common)==null?void 0:E.name)||B.name,n),S.pop();const q=s[S.join(".")];(q==null?void 0:q.type)==="device"&&((k=q.common)!=null&&k.icon)&&(B.name=yh(((A=q.common)==null?void 0:A.name)||B.name,n))}else B.name=yh(((P=H==null?void 0:H.common)==null?void 0:P.name)||B.name,n)}}return C}const fP=async()=>(await hP).default,mP={ru:"Russian",en:"English",de:"German",es:"Spanish",fr:"French",it:"Italian",pl:"Polish",nl:"Dutch",pt:"Portuguese",uk:"Ukrainian","zh-cn":"Chinese"};function bP(){return f.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 2406 2406",children:[f.jsx("path",{d:"M1 578.4C1 259.5 259.5 1 578.4 1h1249.1c319 0 577.5 258.5 577.5 577.4V2406H578.4C259.5 2406 1 2147.5 1 1828.6V578.4z",fill:"#74aa9c"}),f.jsx("path",{d:"M1107.3 299.1c-198 0-373.9 127.3-435.2 315.3C544.8 640.6 434.9 720.2 370.5 833c-99.3 171.4-76.6 386.9 56.4 533.8-41.1 123.1-27 257.7 38.6 369.2 98.7 172 297.3 260.2 491.6 219.2 86.1 97 209.8 152.3 339.6 151.8 198 0 373.9-127.3 435.3-315.3 127.5-26.3 237.2-105.9 301-218.5 99.9-171.4 77.2-386.9-55.8-533.9v-.6c41.1-123.1 27-257.8-38.6-369.8-98.7-171.4-297.3-259.6-491-218.6-86.6-96.8-210.5-151.8-340.3-151.2zm0 117.5-.6.6c79.7 0 156.3 27.5 217.6 78.4-2.5 1.2-7.4 4.3-11 6.1L952.8 709.3c-18.4 10.4-29.4 30-29.4 51.4V1248l-155.1-89.4V755.8c-.1-187.1 151.6-338.9 339-339.2zm434.2 141.9c121.6-.2 234 64.5 294.7 169.8 39.2 68.6 53.9 148.8 40.4 226.5-2.5-1.8-7.3-4.3-10.4-6.1l-360.4-208.2c-18.4-10.4-41-10.4-59.4 0L1024 984.2V805.4L1372.7 604c51.3-29.7 109.5-45.4 168.8-45.5zM650 743.5v427.9c0 21.4 11 40.4 29.4 51.4l421.7 243-155.7 90L597.2 1355c-162-93.8-217.4-300.9-123.8-462.8C513.1 823.6 575.5 771 650 743.5zm807.9 106 348.8 200.8c162.5 93.7 217.6 300.6 123.8 462.8l.6.6c-39.8 68.6-102.4 121.2-176.5 148.2v-428c0-21.4-11-41-29.4-51.4l-422.3-243.7 155-89.3zM1201.7 997l177.8 102.8v205.1l-177.8 102.8-177.8-102.8v-205.1L1201.7 997zm279.5 161.6 155.1 89.4v402.2c0 187.3-152 339.2-339 339.2v-.6c-79.1 0-156.3-27.6-217-78.4 2.5-1.2 8-4.3 11-6.1l360.4-207.5c18.4-10.4 30-30 29.4-51.4l.1-486.8zM1380 1421.9v178.8l-348.8 200.8c-162.5 93.1-369.6 38-463.4-123.7h.6c-39.8-68-54-148.8-40.5-226.5 2.5 1.8 7.4 4.3 10.4 6.1l360.4 208.2c18.4 10.4 41 10.4 59.4 0l421.9-243.7z",fill:"white"})]})}const A0={toolbarButtons:{padding:4,marginLeft:4},fullHeightDialog:{height:"calc(100% - 100px)"}},$P=o=>{const[n,s]=ve.useState(window.localStorage.getItem("openai-question")||""),[i,a]=ve.useState(""),[c,h]=ve.useState(!1),[g,b]=ve.useState(!1),[$,y]=ve.useState(!1),[w,T]=ve.useState(window.localStorage.getItem("openai-model")||"gpt-4o"),[C,E]=ve.useState(!1),k=ve.useRef(null),A=ve.useRef(null),P=ve.useRef(null),N=ve.useCallback(async()=>{var q;let B;k.current?B=k.current:(B=await gP(o.socket),k.current=B,console.log(`devices: ${JSON.stringify(B,null,2)}`));let S;if(A.current)S=A.current;else{const se=Object.keys(o.runningInstances);for(let ee=0;ee<se.length;ee++){const K=await o.socket.getObject(se[ee]);if(S=((K==null?void 0:K.native.gptKey)||"").trim(),S)break}A.current=S||null}let H;if(P.current?H=P.current:(H=await fP(),P.current=H),!S){E(!0);return}b(!0),y(!1);try{const K=(await new hn({apiKey:S,dangerouslyAllowBrowser:!0}).chat.completions.create({model:w,messages:[{role:"system",content:`You are programmer. Here is a documentation:

${H}`},{role:"system",content:`Here is list of devices:

${JSON.stringify(B,null,2)}`},{role:"user",content:`Write JavaScript code that does:

${n}
Return only code.
Write comments in ${mP[I.I18n.getLanguage()]||"English"}.
You can call async function directly in the code without encapsulate them in async function as this code will be already executed in async function.
Do not import any libraries as all functions are already imported.`}]})).choices[0].message,Y=(q=K.content)==null?void 0:q.match(/```(javascript|js|typescript)\n?(.*)```(.*)/ms);let X;if(!Y)X=K.content,X!=null&&X.startsWith("`")&&(X=X.substring(1)),X!=null&&X.endsWith("`")&&(X=X.substring(0,X.length-1));else if(X=Y[2],Y[3]){const ce=Y[3].split(`
`).map(W=>W.trim());for(;ce[0]==="";)ce.shift();X=`${ce.map(W=>`// ${W}`).join(`
`)}
${X}`}console.log(K),a(X||"")}catch(se){console.log(JSON.stringify(se)),se.error&&y(se.error.message),console.error(`Cannot request: ${se}, ${JSON.stringify(se.error||se,null,2)}`)}b(!1)},[n,w,o.runningInstances,o.socket]);return f.jsxs(f.Fragment,{children:[f.jsx(D.IconButton,{"aria-label":"AI",title:I.I18n.t("AI code generator"),style:A0.toolbarButtons,size:"medium",onClick:()=>h(!0),children:f.jsx(bP,{})},"ai"),C&&f.jsxs(D.Dialog,{maxWidth:"lg",open:!0,onClose:()=>E(!1),fullWidth:!0,children:[f.jsx(D.DialogTitle,{children:I.I18n.t("No Chat GPT Key found")}),f.jsxs(D.DialogContent,{style:{display:"flex",flexDirection:"column",gap:8},children:[f.jsx("div",{children:I.I18n.t("You have to enter OpenAI API key in the configuration of javascript adapter.")}),f.jsx(D.Button,{variant:"contained",onClick:()=>{const B=Object.keys(o.runningInstances);window.open(`../../#tab-instances/config/${B[0]||"system.adapter.javascript.0"}`,"_blank"),E(!1)},children:I.I18n.t("Open configuration")})]}),f.jsx(D.DialogActions,{children:f.jsx(D.Button,{variant:"contained",startIcon:f.jsx(f_,{}),onClick:()=>E(!1),children:I.I18n.t("Close")})})]}),c&&f.jsxs(D.Dialog,{maxWidth:"lg",sx:{"& .MuiDialog-paper":A0.fullHeightDialog},open:!0,onClose:()=>h(!1),fullWidth:!0,children:[f.jsx(D.DialogTitle,{children:I.I18n.t("AI code generator")}),f.jsxs(D.DialogContent,{style:{display:"flex",flexDirection:"column",gap:8,height:"100%"},children:[f.jsx("div",{children:f.jsx(D.TextField,{variant:"standard",multiline:!0,autoFocus:!0,disabled:g,fullWidth:!0,onKeyUp:B=>{B.key==="Enter"&&B.ctrlKey&&N()},label:I.I18n.t("Enter your question"),helperText:I.I18n.t("Press Ctrl+Enter to get the answer"),value:n,onChange:B=>{window.localStorage.setItem("openai-question",B.target.value),s(B.target.value)}})}),f.jsxs("div",{style:{display:"flex",alignItems:"baseline"},children:[f.jsx(D.Button,{variant:"contained",disabled:g||!n,startIcon:f.jsx(YA,{}),onClick:async()=>N(),children:g?f.jsx(D.CircularProgress,{size:24}):I.I18n.t("Ask")}),f.jsxs(D.FormControl,{style:{width:150,marginLeft:20},variant:"standard",children:[f.jsx(D.InputLabel,{children:I.I18n.t("Model")}),f.jsxs(D.Select,{variant:"standard",value:w,onChange:B=>{window.localStorage.setItem("openai-model",B.target.value),$&&y(!1),T(B.target.value)},children:[f.jsx(D.MenuItem,{value:"gpt-4o",children:"GPT-4o"}),f.jsx(D.MenuItem,{value:"gpt-4-turbo",children:"GPT-4 Turbo"}),f.jsx(D.MenuItem,{value:"gpt-4-32k",children:"GPT-4 32k"}),f.jsx(D.MenuItem,{value:"gpt-4",children:"GPT-4"}),f.jsx(D.MenuItem,{value:"gpt-3.5-turbo-16k",children:"GPT-3.5 Turbo"})]})]})]}),f.jsx("div",{children:I.I18n.t("Result")}),f.jsx("div",{style:{height:"calc(100% - 155px)"},children:$?f.jsx("div",{style:{color:o.themeType==="dark"?"#984242":"#bb0000"},children:$}):f.jsx(Gv,{triggerPrettier:1,adapterName:o.adapterName,runningInstances:o.runningInstances,style:{height:"100%",width:"100%",resize:"none"},name:"ai",socket:o.socket,readOnly:!0,checkJs:!0,code:i,isDark:o.themeType==="dark",language:o.language||"javascript"})})]}),f.jsxs(D.DialogActions,{children:[f.jsx(D.Button,{color:"grey",variant:"outlined",disabled:!i,startIcon:f.jsx(ST,{}),onClick:()=>{I.Utils.copyToClipboard(i),window.alert(I.I18n.t("Copied"))},children:I.I18n.t("Copy to clipboard")}),f.jsx(D.Button,{color:"primary",variant:"contained",disabled:!i||$,startIcon:f.jsx(Va,{}),onClick:()=>{o.onAddCode(i),h(!1)},children:I.I18n.t("Use generated code")}),f.jsx(D.Button,{color:"grey",variant:"contained",startIcon:f.jsx(f_,{}),onClick:()=>h(!1),children:I.I18n.t("Close")})]})]})]})},O0={Blockly:_T,"Javascript/js":q$,Rules:CT,def:q$,"TypeScript/ts":wT},vP=48,R0="#02a102",d_="#70aae9",yP=L0[400],_P=B0[400],Et={toolbar:o=>({minHeight:38,boxShadow:"0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12)",backgroundColor:o.palette.mode==="dark"?"#1e1e1e":"#E2E2E2"}),toolbarButtons:{padding:4,marginLeft:4},toolbarButtonsDisabled:{filter:"grayscale(100%)",opacity:.5},editorDiv:o=>({height:`calc(100% - ${(parseInt(o.toolbar.height,10)||48)+38+10}px)`,width:"100%",overflow:"hidden",position:"relative"}),textButton:{marginRight:10,minHeight:24,padding:"6px 16px"},saveButton:{background:"#ff9900"},tabIcon:{width:24,height:24,verticalAlign:"middle",marginBottom:2,marginRight:2,borderRadius:3},hintIcon:{padding:"0 8px 0 8px"},hintButton:{marginTop:8,marginLeft:20},tabMenuButton:{position:"absolute",top:0,right:0},tabChanged:o=>({color:o.palette.secondary.main}),tabText:{maxWidth:130,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",display:"inline-block",verticalAlign:"middle"},tabChangedIcon:{color:"#FF0000",fontSize:16,marginLeft:5},closeButton:{marginLeft:5},notRunning:{color:"#ffbc00",marginRight:8,marginLeft:8},tabButton:{minHeight:48},tabButtonWrapper:{display:"inline-block"},menuIcon:{width:18,height:18,borderRadius:2,marginRight:5}};class kh extends We.Component{getSelect=null;cron={initValue:null,callback:null};scriptDialog={initValue:null,callback:null,args:null,isReturn:!1};objects;scripts;selectId={initValue:null,callback:null};confirmCallback=null;constructor(n){super(n);const s=window.localStorage.getItem("Editor.selected")||"",i=window.localStorage.getItem("Editor.editing")||"[]";let a;try{a=JSON.parse(i)}catch{a=[]}s&&!a.includes(s)&&a.push(s),this.state={askAboutDebug:!1,astroEvents:null,blockly:null,changed:{},cmdToBlockly:"",cmdToRules:"",confirm:"",debugEnabled:!1,editing:a,insert:"",instancesLoaded:!1,isTourOpen:window.localStorage.getItem("tour")!=="true",menuDebugAnchorEl:null,menuOpened:!!this.props.menuOpened,menuTabsOpened:!1,triggerPrettier:1,rules:null,runningInstances:this.props.runningInstances||{},searchText:"",selected:s,showAdapterDebug:!1,showAstro:!1,showCompiledCode:!1,showCron:!1,showDebugMenu:!1,showScript:!1,showSelectId:!1,themeType:this.props.themeType,toast:"",tourStep:Ss.selectTriggers,verboseEnabled:!1,visible:n.visible},this.setChangedInAdmin(),window.systemLang=I.I18n.getLanguage(),window.main={objects:{},getObject:(c,h)=>this.props.socket.getObject(c).then(g=>h&&h(null,g)).catch(g=>h&&h(g)),instances:[],selectIdDialog:(c,h,g)=>{typeof h=="function"&&(g=h,h=null),this.selectId.callback=g,this.selectId.initValue=c,this.selectId.type=h,this.setState({showSelectId:!0})},cronDialog:(c,h)=>{this.cron.callback=h,this.cron.initValue=c,this.setState({showCron:!0})},showScriptDialog:(c,h,g,b)=>{this.scriptDialog.callback=b,this.scriptDialog.initValue=c,this.scriptDialog.args=h,this.scriptDialog.isReturn=g||!1,this.setState({showScript:!0})}},this.objects=n.objects,this.scripts={},!this.state.selected&&this.state.editing.length&&Object.assign(this.state,{selected:this.state.editing[0]}),this.getAllAdapterInstances().then(()=>{this.props.onSelectedChange&&this.state.selected&&setTimeout(()=>this.props.onSelectedChange(this.state.selected,this.state.editing),100)})}getAllAdapterInstances(){return this.props.socket.getAdapterInstances(!0).then(n=>{const s={},i=n.map(a=>(s[a._id]=a,a._id));window.main.objects=s,window.main.instances=i,this.setState({instancesLoaded:!0})})}static onInstanceChanged(n,s){if(n)if(!s&&window.main.instances.includes(n)){delete window.main.objects[n];const i=window.main.instances.indexOf(n);window.main.instances.splice(i,1)}else s&&s.type==="instance"&&(window.main.instances.includes(n)||(window.main.instances.push(n),window.main.instances.sort()),window.main.objects[n]=s)}setChangedInAdmin(){const n=Object.keys(this.state.changed).find(s=>this.state.changed[s]);typeof window.parent<"u"&&window.parent&&(window.parent.configNotSaved=!!n)}componentDidMount(){window.addEventListener("beforeunload",this.onBrowserClose,!1),this.props.socket.subscribeObject("system.adapter.*",kh.onInstanceChanged)}componentWillUnmount(){window.removeEventListener("beforeunload",this.onBrowserClose),this.props.socket.unsubscribeObject("system.adapter.*",kh.onInstanceChanged)}onBrowserClose=n=>{const s=Object.keys(this.scripts).find(i=>JSON.stringify(this.scripts[i])!==JSON.stringify(this.props.objects[i].common));if(s){console.log(`Script ${JSON.stringify(this.scripts[s])}`);const i=I.I18n.t("Configuration not saved.");return n=n||window.event,n&&(n.returnValue=i),i}};removeNonExistingScripts(n,s){n=n||this.props,s=s||{};let i=!1;if(this.state.editing&&this.state.editing.find(c=>n&&!n.objects[c])){const c=JSON.parse(JSON.stringify(this.state.editing));for(let h=c.length-1;h>=0;h--)this.objects[c[h]]||(i=!0,c.splice(h,1));i&&(s.editing=c),this.state.selected&&!this.objects[this.state.selected]&&(i=!0,s.selected=c[0]||"",s.selected&&this.scripts[s.selected]&&(this.state.blockly!==(this.scripts[s.selected].engineType==="Blockly")&&(s.blockly=this.scripts[s.selected].engineType==="Blockly",i=!0),this.state.rules!==(this.scripts[s.selected].engineType==="Rules")&&(s.rules=this.scripts[s.selected].engineType==="Rules",i=!0),this.state.verboseEnabled!==this.scripts[s.selected].verbose&&(s.verboseEnabled=this.scripts[s.selected].verbose,i=!0),this.state.debugEnabled!==this.scripts[s.selected].debug&&(s.debugEnabled=this.scripts[s.selected].debug,i=!0)))}return i}UNSAFE_componentWillReceiveProps(n){var a,c;const s={};let i=!1;if(JSON.stringify(n.runningInstances)!==JSON.stringify(this.state.runningInstances)&&(i=!0,s.runningInstances=n.runningInstances),this.state.menuOpened!==n.menuOpened&&(s.menuOpened=n.menuOpened,i=!0),this.state.themeType!==n.themeType&&(s.themeType=n.themeType,i=!0),this.removeNonExistingScripts(n,s)&&(i=!0),this.state.searchText!==n.searchText&&(s.searchText=n.searchText,i=!0),this.objects!==n.objects){this.objects=n.objects,window.main.objects=n.objects,Object.keys(this.scripts).forEach(g=>{const b=this.scripts[g].source;this.scripts[g]=JSON.parse(JSON.stringify(this.objects[g].common)),this.scripts[g].source=b}),this.state.selected&&this.objects[this.state.selected]&&(this.scripts[this.state.selected]=this.scripts[this.state.selected]||JSON.parse(JSON.stringify(this.objects[this.state.selected].common)),this.state.blockly!==(this.scripts[this.state.selected].engineType==="Blockly")&&(s.blockly=this.scripts[this.state.selected].engineType==="Blockly",i=!0),this.state.rules!==(this.scripts[this.state.selected].engineType==="Rules")&&(s.rules=this.scripts[this.state.selected].engineType==="Rules",i=!0),this.state.verboseEnabled!==this.scripts[this.state.selected].verbose&&(s.verboseEnabled=this.scripts[this.state.selected].verbose,i=!0),this.state.debugEnabled!==this.scripts[this.state.selected].debug&&(s.debugEnabled=this.scripts[this.state.selected].debug,i=!0));const h=JSON.parse(JSON.stringify(this.state.editing));for(let g=h.length-1;g>=0;g--)this.objects[h[g]]||(i=!0,h.splice(g,1),this.state.changed[h[g]]!==void 0&&(s.changed=s.changed||JSON.parse(JSON.stringify(this.state.changed)),s.changed&&delete s.changed[h[g]]));this.state.selected&&!this.objects[this.state.selected]&&(s.selected=h[0]||""),i&&(s.editing=h)}else for(const h in this.scripts)if(Object.prototype.hasOwnProperty.call(this.scripts,h)){if((a=this.objects[h])!=null&&a.common){if(this.objects[h].type==="script"){const g=this.scripts[h].source,b=JSON.parse(JSON.stringify(this.scripts[h]));b.source=this.objects[h].common.source,JSON.stringify(b)!==JSON.stringify(this.objects[h].common)&&(this.scripts[h]=JSON.parse(JSON.stringify(this.objects[h].common)),this.scripts[h].source=g),g!==this.objects[h].common.source?this.state.changed[h]?(c=this.objects[h].from)!=null&&c.startsWith("system.adapter.javascript.")&&(this.objects[h].from="system.adapter.admin.0",this.setState({toast:I.I18n.t("Script %s was modified on disk.",h.split(".").pop())})):this.scripts[h].source=this.objects[h].common.source:this.state.changed[h]&&(s.changed=s.changed||JSON.parse(JSON.stringify(this.state.changed)),s.changed&&(s.changed[h]=!1),i=!0)}}else if(this.scripts[h]&&(delete this.scripts[h],this.state.selected===h)){if(this.state.editing.indexOf(h)!==-1){const g=JSON.parse(JSON.stringify(this.state.editing)),b=g.indexOf(h);b!==-1&&(g.splice(b,1),s.editing=g,i=!0)}s.selected=this.state.editing[0]||"",i=!0}}if(this.state.selected!==n.selected&&n.selected){n.selected&&(this.scripts[n.selected]=this.scripts[n.selected]||JSON.parse(JSON.stringify(this.props.objects[n.selected].common)));const h=this.props.objects[n.selected]&&this.props.objects[n.selected].common,g=h&&JSON.stringify(this.scripts[n.selected])!==JSON.stringify(h),b=JSON.parse(JSON.stringify(this.state.editing));n.selected&&b.indexOf(n.selected)===-1&&(b.push(n.selected),this.props.onSelectedChange(n.selected,b),window.localStorage&&window.localStorage.setItem("Editor.editing",JSON.stringify(b))),i=!0,s.changed=s.changed||JSON.parse(JSON.stringify(this.state.changed)),s.changed&&(s.changed[n.selected]=g),s.editing=b,s.selected=n.selected,s.blockly=this.scripts[n.selected].engineType==="Blockly",s.rules=this.scripts[n.selected].engineType==="Rules",s.verboseEnabled=this.scripts[n.selected].verbose,s.debugEnabled=this.scripts[n.selected].debug,s.showCompiledCode=!1}this.state.visible!==n.visible&&(i=!0,s.visible=n.visible),i&&this.setState(s,()=>this.setChangedInAdmin())}onRestart(){this.props.onRestart&&this.props.onRestart(this.state.selected)}onStartStop(){const n=JSON.parse(JSON.stringify(this.scripts[this.state.selected]));n.enabled=!n.enabled,this.props.onChange&&this.props.onChange(this.state.selected,n)}onSave(){if(this.state.isTourOpen&&this.state.tourStep===Ss.saveTheScript&&(this.setState({isTourOpen:!1}),window.localStorage.setItem("tour","true")),this.state.changed[this.state.selected]){const n=JSON.parse(JSON.stringify(this.state.changed));n[this.state.selected]=!1,this.setState({changed:n},()=>{this.setChangedInAdmin(),this.props.onChange&&this.props.onChange(this.state.selected,this.scripts[this.state.selected])})}}onSaveAll(){const n=JSON.parse(JSON.stringify(this.state.changed));Object.keys(n).forEach(s=>{n[s]&&(n[s]=!1,this.props.onChange&&this.props.onChange(s,this.scripts[s]))}),this.setState({changed:n},()=>this.setChangedInAdmin())}onCancel(){this.scripts[this.state.selected]=JSON.parse(JSON.stringify(this.props.objects[this.state.selected].common));const n=JSON.parse(JSON.stringify(this.state.changed));n[this.state.selected]=!1,this.setState({changed:n},()=>this.setChangedInAdmin())}onRegisterSelect(n){this.getSelect=n}onConvertBlockly2JS(){this.showConfirmDialog(I.I18n.t("It will not be possible to revert this operation."),n=>{if(n){this.scripts[this.state.selected].engineType="Javascript/js";const i=this.scripts[this.state.selected].source.split(`
`);i.pop(),this.scripts[this.state.selected].source=i.join(`
`);const a=this.state.selected,c=JSON.parse(JSON.stringify(this.state.changed));c[this.state.selected]=!0,this.setState({changed:c,blockly:!1,selected:""},()=>{this.setChangedInAdmin(),setTimeout(()=>this.setState({selected:a}),100)})}})}onChange(n){n=n||{},n&&(n.script!==void 0&&(this.scripts[this.state.selected].source=n.script),n.debug!==void 0&&(this.scripts[this.state.selected].debug=n.debug),n.verbose!==void 0&&(this.scripts[this.state.selected].verbose=n.verbose));const s=JSON.stringify(this.scripts[this.state.selected])!==JSON.stringify(this.props.objects[this.state.selected].common);if(s!==(this.state.changed[this.state.selected]||!1)){const i=JSON.parse(JSON.stringify(this.state.changed));i[this.state.selected]=s,this.objects[this.state.selected].from="system.adapter.admin.0",this.setState({changed:i},()=>this.setChangedInAdmin())}}onTabChange(n){if(this.props.debugMode)return;window.localStorage&&window.localStorage.setItem("Editor.selected",n);const s=this.scripts[n]||this.props.objects[n]&&this.props.objects[n].common;this.setState({selected:n,rules:s.engineType==="Rules",blockly:s.engineType==="Blockly",showCompiledCode:!1,verboseEnabled:s.verbose,debugEnabled:s.debug}),this.props.onSelectedChange&&this.props.onSelectedChange(n,this.state.editing)}isScriptChanged(n){return!!(this.scripts[n]&&this.props.objects[n]&&JSON.stringify(this.scripts[n])!==JSON.stringify(this.props.objects[n].common))}onTabClose(n,s){s==null||s.stopPropagation();const i=this.state.editing.indexOf(n);if(this.state.editing.includes(n))if(this.isScriptChanged(n))this.showConfirmDialog(I.I18n.t("Discard changes for %s",this.props.objects[n].common.name),a=>{a&&(delete this.scripts[n],this.onTabClose(n))});else{const a=JSON.parse(JSON.stringify(this.state.editing));a.splice(i,1);const c={editing:a};if(n===this.state.selected?a.length?i===0||a.length===1?c.selected=a[0]:c.selected=a[i-1]:c.selected="":this.state.selected&&!a.length&&(c.selected=""),window.localStorage&&window.localStorage.setItem("Editor.editing",JSON.stringify(a)),c.selected!==void 0){c.changed=c.changed||JSON.parse(JSON.stringify(this.state.changed))||{},c.changed&&(c.changed[c.selected]=this.isScriptChanged(c.selected));const h=c.selected&&(this.scripts[c.selected]||this.props.objects[c.selected]&&this.props.objects[c.selected].common);c.blockly=h?h.engineType==="Blockly":!1,c.rules=h?h.engineType==="Rules":!1,c.verboseEnabled=h?h.verbose:!1,c.debugEnabled=h?h.debug:!1,c.showCompiledCode=!1}this.setState(c,()=>{this.setChangedInAdmin(),c.selected!==void 0?(this.props.onSelectedChange&&this.props.onSelectedChange(c.selected,this.state.editing),window.localStorage&&window.localStorage.setItem("Editor.selected",c.selected)):this.props.onSelectedChange&&this.props.onSelectedChange(this.state.selected,this.state.editing)})}}showConfirmDialog(n,s){this.confirmCallback=s,this.setState({confirm:n})}sendCommandToBlockly(n){this.setState({cmdToBlockly:n},()=>setTimeout(()=>this.setState({cmdToBlockly:""}),200))}sendCommandToRules(n){this.setState({cmdToRules:n},()=>setTimeout(()=>this.setState({cmdToRules:""}),200))}static getText(n){return typeof n=="object"?n[I.I18n.getLanguage()]||n.en:n}getScriptFullName(n){const s=n.split(".");s.shift(),s.shift();const i=[];let a="script.js";for(let c=0;c<s.length;c++)a+=`.${s[c]}`,this.props.objects[a]&&this.props.objects[a].common?i.push(kh.getText(this.props.objects[a].common.name)):i.push(s[c]);return`/ ${i.join(" / ")}`}getTabs(){return this.state.editing.length?[f.jsxs(D.Tabs,{component:"div",value:this.props.debugInstance?this.props.debugInstance.adapter:this.state.selected,onChange:(n,s)=>this.onTabChange(s),indicatorColor:"primary",style:{position:"relative",marginLeft:10,width:this.state.editing.length>1?"calc(100% - 50px)":"100%",display:"inline-block"},textColor:"primary",variant:"scrollable",scrollButtons:"auto",allowScrollButtonsMobile:!0,children:[this.state.editing.map(n=>{if(!this.props.objects[n]){const h=[f.jsx(D.Box,{sx:this.isScriptChanged(n)?Et.tabChanged:void 0,style:Et.tabText,children:n.split(".").pop()},"text"),f.jsx(D.IconButton,{onClick:g=>this.onTabClose(n,g),style:Et.closeButton,size:"small",component:"span",children:f.jsx(Xl,{})},"icon")];return f.jsx(D.Tab,{wrapped:!0,href:`#${n}`,label:h,value:n,sx:{"& .MuiTab-wrapper":Et.tabButtonWrapper}},n)}let s=kh.getText(this.props.objects[n].common.name)||"";const i=this.getScriptFullName(n);s.length>18&&(s=`${s.substring(0,15)}...`);const a=this.scripts[n]&&this.props.objects[n].common&&this.props.objects[n].common.source!==this.scripts[n].source,c=[f.jsx(D.Box,{sx:this.isScriptChanged(n)?Et.tabChanged:void 0,style:Et.tabText,children:s},"text"),a?f.jsx("span",{style:Et.tabChangedIcon,children:""},"changedSign"):null,!this.props.debugInstance&&(!this.props.debugMode||this.state.selected!==n)&&f.jsx(D.IconButton,{onClick:h=>this.onTabClose(n,h),style:Et.closeButton,size:"small",component:"span",children:f.jsx(Xl,{})},"icon")];return f.jsx(D.Tab,{disabled:!!this.props.debugInstance||this.state.selected!==n&&this.props.debugMode,wrapped:!0,iconPosition:"start",icon:f.jsx("img",{alt:"",src:O0[this.props.objects[n].common.engineType]||O0.def,style:Et.tabIcon},"icon"),href:`#${n}`,label:c,style:Et.tabButton,value:n,title:i,sx:{"& .MuiTab-wrapper":Et.tabButtonWrapper}},n)}),this.props.debugInstance?f.jsx(D.Tab,{disabled:!1,wrapped:!0,href:`#${this.props.debugInstance.adapter}`,label:this.props.debugInstance.adapter,style:Et.tabButton,value:this.props.debugInstance.adapter,title:this.props.debugInstance.adapter,sx:{"& .MuiTab-wrapper":Et.tabButtonWrapper}},this.props.debugInstance.adapter):""]},"tabs1"),this.state.editing.length>1?f.jsx(D.IconButton,{href:"#","aria-label":"Close all but current",style:Et.tabMenuButton,title:I.I18n.t("Close all but current"),"aria-haspopup":"false",onClick:n=>{const s=[this.state.selected];Object.keys(this.scripts).forEach(i=>i!==this.state.selected&&JSON.stringify(this.scripts[i])!==JSON.stringify(this.props.objects[i].common)&&s.push(i)),window.localStorage&&window.localStorage.setItem("Editor.editing",JSON.stringify(s)),this.setState({menuTabsOpened:!1,editing:s})},size:"medium",children:f.jsx(nx,{})},"menuButton"):null]:f.jsx(D.Box,{sx:Et.toolbar,children:f.jsxs(D.Button,{color:"grey",disabled:!0,style:Et.hintButton,href:"",children:[f.jsx("span",{children:I.I18n.t("Click on this icon")},"select2"),f.jsx(j0,{style:Et.hintIcon},"select3"),f.jsx("span",{children:I.I18n.t("for edit or create script")},"select4")]},"select1")},"tabs2")}getDebugMenu(){return this.state.showDebugMenu?f.jsxs(D.Menu,{id:"menu-debug",anchorEl:this.state.menuDebugAnchorEl,open:this.state.showDebugMenu,onClose:()=>this.setState({showDebugMenu:!1,menuDebugAnchorEl:null}),slotProps:{root:{style:{maxHeight:vP*7.5}}},children:[f.jsxs(D.MenuItem,{title:I.I18n.t("debug_help"),onClick:n=>{n.stopPropagation(),n.preventDefault(),this.setState({showDebugMenu:!1,menuDebugAnchorEl:null,debugEnabled:!this.state.debugEnabled},()=>this.onChange({debug:this.state.debugEnabled}))},children:[f.jsx(D.Checkbox,{checked:this.state.debugEnabled}),f.jsx(uf,{style:{...Et.menuIcon,color:R0}}),I.I18n.t("debug_label")]},"debugEnabled"),f.jsxs(D.MenuItem,{title:I.I18n.t("verbose_help"),onClick:n=>{n.stopPropagation(),n.preventDefault(),this.setState({showDebugMenu:!1,menuDebugAnchorEl:null,verboseEnabled:!this.state.verboseEnabled},()=>this.onChange({verbose:this.state.verboseEnabled}))},children:[f.jsx(D.Checkbox,{checked:this.state.verboseEnabled}),f.jsx(HC,{style:{...Et.menuIcon,color:d_}}),I.I18n.t("verbose_label")]},"verboseEnabled")]},"menuDebug"):null}getDebugBadge(){return[this.state.debugEnabled&&this.state.verboseEnabled?f.jsx(uf,{style:{...Et.menuIcon,color:d_}},"DebugVerbose"):null,this.state.debugEnabled&&!this.state.verboseEnabled?f.jsx(uf,{style:{...Et.menuIcon,color:R0}},"DebugNoVerbose"):null,!this.state.debugEnabled&&this.state.verboseEnabled?f.jsx(HC,{style:{...Et.menuIcon,color:d_}},"noDebugVerbose"):null]}getAskAboutDebug(){return this.state.askAboutDebug?f.jsx(I.DialogConfirm,{onClose:()=>{this.setState({askAboutDebug:!1},()=>this.props.onDebugModeChange(!0))},ok:I.I18n.t("Yes"),cancel:I.I18n.t("Cancel"),text:I.I18n.t("The script will be stopped and must be activated manually after debugging. Continue?")}):null}getToolbar(){const n=!!(this.state.selected&&this.scripts[this.state.selected]&&this.scripts[this.state.selected].engine&&this.state.runningInstances[this.scripts[this.state.selected].engine]),s=!!(this.state.selected&&this.scripts[this.state.selected]&&this.scripts[this.state.selected].enabled);if(this.state.selected){const i=Object.keys(this.state.changed).filter(c=>this.state.changed[c]).length,a=this.state.changed[this.state.selected];return f.jsxs(D.Toolbar,{variant:"dense",sx:Et.toolbar,children:[!this.props.debugInstance&&this.state.menuOpened&&this.props.onLocate&&f.jsx(D.IconButton,{style:Et.toolbarButtons,title:I.I18n.t("Locate file"),onClick:()=>this.props.onLocate(this.state.selected),size:"medium",children:f.jsx(sx,{})},"locate"),!this.props.debugInstance&&!a&&n?f.jsx(D.IconButton,{disabled:this.props.debugMode,style:Et.toolbarButtons,onClick:()=>this.onRestart(),title:I.I18n.t("Restart"),size:"medium",children:f.jsx(H0,{})},"restart"):null,!this.props.debugInstance&&!a?f.jsx(D.IconButton,{disabled:this.props.debugMode,onClick:()=>this.onStartStop(),title:s?I.I18n.t("Pause script"):I.I18n.t("Run script"),size:"medium",style:{...Et.toolbarButtons,color:s?yP:_P},children:s?f.jsx(vf,{}):f.jsx(V$,{})},"start-stop"):null,!this.props.debugInstance&&!a&&!s?f.jsx("span",{style:Et.notRunning,children:I.I18n.t("Script is not running")}):null,!a&&s&&!n?f.jsx("span",{style:Et.notRunning,children:I.I18n.t("Instance is disabled")}):null,a?f.jsx(D.Button,{color:"grey",variant:"contained",style:{...Et.textButton,...Et.saveButton},className:"button-save",onClick:()=>this.onSave(),endIcon:f.jsx(VC,{}),children:I.I18n.t("Save")},"save"):null,i>1||i===1&&!a?f.jsx(D.Button,{color:"grey",variant:"contained",style:Et.textButton,onClick:()=>this.onSaveAll(),endIcon:f.jsx(VC,{}),children:I.I18n.t("Save all")},"saveall"):null,a?f.jsx(D.Button,{color:"grey",variant:"contained",style:Et.textButton,onClick:()=>this.onCancel(),endIcon:f.jsx(Iv,{}),children:I.I18n.t("Cancel")},"cancel"):null,f.jsx("div",{style:{flex:2}}),!this.props.debugInstance&&!this.state.showCompiledCode&&f.jsx(D.IconButton,{style:Et.toolbarButtons,title:I.I18n.t("Prettify the script"),onClick:()=>this.setState({triggerPrettier:this.state.triggerPrettier+1}),size:"medium",children:f.jsx(rx,{})},"prettier"),this.state.blockly&&!this.state.showCompiledCode?f.jsx(D.IconButton,{"aria-label":"Export Blocks",title:I.I18n.t("Export blocks"),style:Et.toolbarButtons,onClick:()=>this.sendCommandToBlockly("export"),size:"medium",children:f.jsx(G$,{})},"export"):null,this.state.blockly&&!this.state.showCompiledCode&&f.jsx(D.IconButton,{"aria-label":"Import Blocks",title:I.I18n.t("Import blocks"),style:Et.toolbarButtons,onClick:()=>this.sendCommandToBlockly("import"),size:"medium",children:f.jsx(m_,{})},"import"),this.state.blockly&&!this.state.showCompiledCode&&f.jsx(D.IconButton,{"aria-label":"Check code",title:I.I18n.t("Check blocks"),style:Et.toolbarButtons,onClick:()=>this.sendCommandToBlockly("check"),size:"medium",children:f.jsx(ix,{})},"check"),!this.props.debugMode&&!this.state.blockly&&!this.state.rules&&!this.state.showCompiledCode?f.jsx(D.IconButton,{"aria-label":"create CRON",title:I.I18n.t("Create or edit CRON or time wizard"),style:Et.toolbarButtons,onClick:()=>this.setState({showCron:!0}),size:"medium",children:f.jsx(ox,{})},"select-cron"):null,this.scripts[this.state.selected]&&this.scripts[this.state.selected].engineType!=="Blockly"&&this.scripts[this.state.selected].engineType!=="Rules"?f.jsx($P,{adapterName:this.props.adapterName,socket:this.props.socket,runningInstances:this.state.runningInstances,themeType:this.state.themeType,language:this.scripts[this.state.selected].engineType==="TypeScript/ts"?"typescript":"javascript",onAddCode:c=>this.setState({insert:c})}):null,f.jsx(D.IconButton,{"aria-label":"Show astronomical events",title:I.I18n.t("Show astronomical events"),style:Et.toolbarButtons,disabled:!n,onClick:()=>{this.setState({showAstro:!0,astroEvents:null}),this.props.socket.sendTo(this.scripts[this.state.selected].engine.replace("system.adapter.",""),"calcAstroAll",{}).then(c=>this.setState({astroEvents:c}))},size:"medium",children:f.jsx(ax,{})},"show-astro"),!this.props.debugMode&&!this.state.blockly&&!this.state.rules&&!this.state.showCompiledCode&&f.jsx(D.IconButton,{"aria-label":"select ID",title:I.I18n.t("Insert object ID"),style:Et.toolbarButtons,onClick:()=>this.setState({showSelectId:!0}),size:"medium",children:f.jsx(lx,{})},"select-id"),this.state.blockly&&!this.state.rules&&this.state.showCompiledCode&&f.jsx(D.Button,{color:"grey","aria-label":"convert to javascript",title:I.I18n.t("Convert blockly to javascript for ever."),onClick:()=>this.onConvertBlockly2JS(),children:"Blockly=>JS"},"convert2js"),this.state.rules&&!this.state.showCompiledCode&&f.jsx(D.IconButton,{"aria-label":"Export Blocks",title:I.I18n.t("Export blocks"),style:Et.toolbarButtons,onClick:()=>this.sendCommandToRules("export"),size:"medium",children:f.jsx(G$,{})},"export"),this.state.rules&&!this.state.showCompiledCode&&f.jsx(D.IconButton,{"aria-label":"Import Blocks",title:I.I18n.t("Import blocks"),style:Et.toolbarButtons,onClick:()=>this.sendCommandToRules("import"),size:"medium",children:f.jsx(m_,{})},"import"),this.props.expertMode&&!a&&(this.props.debugMode||!this.state.blockly&&!this.state.rules||(this.state.blockly||this.state.rules)&&this.state.showCompiledCode)&&f.jsx(D.IconButton,{style:Et.toolbarButtons,color:this.props.debugMode?"primary":"default",disabled:!this.props.debugMode&&!n,onClick:()=>{!this.props.debugMode&&s?this.setState({askAboutDebug:!0}):this.props.onDebugModeChange(!this.props.debugMode)},size:"medium",children:f.jsx(uf,{style:{fontSize:32}})}),(this.state.blockly||this.state.rules)&&f.jsx(D.Button,{"aria-label":"blockly",title:I.I18n.t("Show javascript code"),className:"button-js-code",color:this.state.showCompiledCode?"secondary":"inherit",disabled:this.props.debugMode,style:{...Et.toolbarButtons,...this.props.debugMode?Et.toolbarButtonsDisabled:void 0,padding:"0 5px"},onClick:()=>{this.props.debugMode||(this.setState({showCompiledCode:!this.state.showCompiledCode}),this.state.isTourOpen&&this.state.tourStep===Ss.showJavascript&&this.setState({tourStep:Ss.switchBackToRules}),this.state.isTourOpen&&this.state.tourStep===Ss.switchBackToRules&&this.setState({tourStep:Ss.saveTheScript}))},children:f.jsx("img",{alt:this.state.blockly?"blockly2js":"rules2js",src:this.state.blockly?hM:pM})},"blockly-code"),f.jsx(D.IconButton,{disabled:this.props.debugMode,"aria-label":"Debug menu",title:I.I18n.t("Debug options"),style:Et.toolbarButtons,onClick:c=>this.setState({showDebugMenu:!0,menuDebugAnchorEl:c.currentTarget}),size:"medium",children:f.jsx(D.Badge,{style:Et.badgeMargin,badgeContent:this.getDebugBadge(),children:f.jsx(cx,{})})},"debug")]},"toolbar1")}return null}getScriptEditor(){return!this.props.debugMode&&this.state.selected&&this.props.objects[this.state.selected]&&this.state.blockly!==null&&(!this.state.blockly||this.state.showCompiledCode)&&(!this.state.rules||this.state.showCompiledCode)?(this.scripts[this.state.selected]=this.scripts[this.state.selected]||JSON.parse(JSON.stringify(this.props.objects[this.state.selected].common)),f.jsx(D.Box,{sx:Et.editorDiv,children:f.jsx(Gv,{name:this.state.selected,adapterName:this.props.adapterName,insert:this.state.insert,onInserted:()=>this.setState({insert:""}),onForceSave:()=>this.onSave(),searchText:this.state.searchText,onRegisterSelect:n=>this.onRegisterSelect(n),readOnly:this.state.showCompiledCode,changed:this.state.changed[this.state.selected],code:this.scripts[this.state.selected].source||"",isDark:this.state.themeType==="dark",socket:this.props.socket,runningInstances:this.state.runningInstances,triggerPrettier:this.state.triggerPrettier,onChange:n=>this.onChange({script:n}),language:this.scripts[this.state.selected].engineType==="TypeScript/ts"?"typescript":"javascript"},"scriptEditor1")},"scriptEditorDiv")):null}getBlocklyEditor(){return!this.props.debugMode&&this.state.instancesLoaded&&this.state.selected&&this.props.objects[this.state.selected]&&this.state.blockly&&!this.state.showCompiledCode&&this.state.visible?(this.scripts[this.state.selected]=this.scripts[this.state.selected]||JSON.parse(JSON.stringify(this.props.objects[this.state.selected].common)),f.jsx(D.Box,{sx:Et.editorDiv,children:f.jsx(dn,{command:this.state.cmdToBlockly,themeType:this.state.themeType,searchText:this.state.searchText,code:this.scripts[this.state.selected].source||"",scriptId:this.state.selected,onChange:n=>this.onChange({script:n})},"BlocklyEditor")},"blocklyEditorDiv")):null}getRulesEditor(){var n,s;if(!this.props.debugMode&&this.state.instancesLoaded&&this.state.selected&&this.props.objects[this.state.selected]&&this.state.rules&&!this.state.showCompiledCode&&this.state.visible){this.scripts[this.state.selected]=this.scripts[this.state.selected]||JSON.parse(JSON.stringify(this.props.objects[this.state.selected].common));const i=!!this.state.selected&&!!((n=this.scripts[this.state.selected])!=null&&n.engine)&&this.state.runningInstances[this.scripts[this.state.selected].engine],a=!!this.state.selected&&((s=this.scripts[this.state.selected])==null?void 0:s.enabled);return f.jsx(D.Box,{sx:Et.editorDiv,children:f.jsx(VL,{scriptId:this.state.selected,setTourStep:this.setTourStep,tourStep:this.state.tourStep,isTourOpen:this.state.isTourOpen,changed:this.state.changed[this.state.selected],running:i&&a,command:this.state.cmdToRules,themeType:this.state.themeType,themeName:this.props.themeName,theme:this.props.theme,searchText:this.state.searchText,resizing:this.props.resizing,code:this.scripts[this.state.selected].source||"",onChange:c=>this.onChange({script:c})},"flowEditor")},"flowEditorDiv")}return null}getConfirmDialog(){return this.state.confirm?f.jsx(I.DialogConfirm,{text:this.state.confirm,onClose:n=>{if(this.confirmCallback){const s=this.confirmCallback;this.confirmCallback=null,s(n)}this.setState({confirm:""})}},"dialogConfirm1"):null}getSelectIdDialog(){var n;if(this.state.showSelectId){const s=["state","channel","device","adapter","instance","enum","host","config","script","user","group"],i=["adapter","instance","enum","host","config","script","user","group"];let a=this.selectId.callback?this.selectId.initValue||"":this.getSelect&&this.getSelect()||"",c=a.indexOf("/*");c!==-1&&(a=a.substring(0,c)),c=a.indexOf("//"),c!==-1&&(a=a.substring(0,c));let h=a.match(/"([^"]+)"/);return h&&(a=h[1]),h=a.match(/'([^']+)'/),h&&(a=h[1]),f.jsx(I.DialogSelectID,{theme:this.props.theme,imagePrefix:"../..",themeName:this.props.themeName,themeType:this.state.themeType,socket:this.props.socket,selected:a,expertMode:this.selectId.type&&this.selectId.type!=="all"&&i.includes(this.selectId.type)?!0:void 0,types:((n=this.selectId)==null?void 0:n.type)==="all"?s:[this.selectId.type||"state"],onClose:()=>{this.setState({showSelectId:!1}),this.selectId.callback&&(this.selectId.callback=null)},onOk:(g,b)=>{this.selectId.initValue=null,this.selectId.callback?(this.selectId.callback(g),this.selectId.callback=null):this.setState({insert:`'${g}'/*${b}*/`})}},"dialogSelectID1")}return null}getCronDialog(){return this.state.showCron?f.jsx(I.DialogCron,{theme:this.props.theme,cron:this.cron.callback?this.cron.initValue||"":this.getSelect?this.getSelect():"* * * * *",onClose:()=>this.setState({showCron:!1}),onOk:n=>{this.cron.initValue=null,this.cron.callback?(this.cron.callback(n),this.cron.callback=null):this.setState({insert:`'${n}'`})}},"dialogCron1"):null}getAstroDialog(){return this.state.showAstro?f.jsxs(D.Dialog,{open:!0,onClose:()=>this.setState({showAstro:!1}),children:[f.jsx(D.DialogTitle,{children:I.I18n.t("Astronomical events today")}),f.jsx(D.DialogContent,{children:this.state.astroEvents?f.jsx(D.TableContainer,{component:D.Paper,children:f.jsxs(D.Table,{size:"small",children:[f.jsx(D.TableHead,{children:f.jsxs(D.TableRow,{children:[f.jsx(D.TableCell,{children:I.I18n.t("Name")}),f.jsx(D.TableCell,{children:I.I18n.t("Server time")}),f.jsx(D.TableCell,{children:I.I18n.t("Description")})]})}),f.jsx(D.TableBody,{children:Object.keys(this.state.astroEvents).map(n=>{var s,i,a,c;return f.jsxs(D.TableRow,{children:[f.jsx(D.TableCell,{component:"th",scope:"row",children:n.startsWith("next")?"":n}),f.jsx(D.Tooltip,{title:`${I.I18n.t("Local time")}: ${(s=this.state.astroEvents)!=null&&s[n].isValidDate?new Date((i=this.state.astroEvents)==null?void 0:i[n].date).toLocaleTimeString():"n/a"}`,children:f.jsx(D.TableCell,{align:"right",children:(a=this.state.astroEvents)!=null&&a[n].isValidDate?(c=this.state.astroEvents)==null?void 0:c[n].serverTime:"n/a"})}),f.jsx(D.TableCell,{children:I.I18n.t(n)})]},n)})})]})}):f.jsx(D.LinearProgress,{})}),f.jsx(D.DialogActions,{children:f.jsx(D.Button,{variant:"contained",onClick:()=>this.setState({showAstro:!1}),color:"primary",startIcon:f.jsx(Xl,{}),children:I.I18n.t("Close")})})]},"dialogAstro"):null}getEditorDialog(){return this.state.showScript?f.jsx(PM,{adapterName:this.props.adapterName,source:this.scriptDialog.initValue||"",args:this.scriptDialog.args?this.scriptDialog.args.join(", "):"",isReturn:this.scriptDialog.isReturn,socket:this.props.socket,runningInstances:this.state.runningInstances,themeType:this.state.themeType,onClose:n=>{this.scriptDialog.initValue=null,this.scriptDialog.callback&&(n!==!1&&this.scriptDialog.callback(n||""),this.scriptDialog.callback=null),this.setState({showScript:!1})}},"scriptEditorDialog"):null}getToast(){return f.jsx(D.Snackbar,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:!!this.state.toast,autoHideDuration:6e3,onClose:()=>this.setState({toast:""}),ContentProps:{"aria-describedby":"message-id"},message:f.jsx("span",{id:"message-id",children:this.state.toast}),action:[f.jsx(D.IconButton,{"aria-label":"close",color:"inherit",style:Et.closeToast,onClick:()=>this.setState({toast:""}),size:"medium",children:f.jsx(Xl,{})},"close")]},"toast")}setTourStep=n=>this.setState({tourStep:n});getTour(){return this.state.instancesLoaded&&this.state.selected&&this.props.isAnyRulesExists===1&&this.props.objects[this.state.selected]&&this.state.rules&&this.state.visible?f.jsx(Rw,{steps:FN,isOpen:this.state.isTourOpen,onRequestClose:()=>{this.setState({isTourOpen:!1}),window.localStorage.setItem("tour","true"),this.props.socket.setState("javascript.0.variables.rulesTour",{val:!0,ack:!0})},goToStep:this.state.tourStep},"tour"):null}getDebug(){return this.props.debugMode?this.state.selected&&this.scripts[this.state.selected]&&this.scripts[this.state.selected].engine&&this.state.runningInstances[this.scripts[this.state.selected].engine]?f.jsx($v,{runningInstances:this.state.runningInstances,adapterName:this.props.adapterName,socket:this.props.socket,themeName:this.props.themeName,themeType:this.props.themeType,src:this.props.debugInstance?this.props.debugInstance.adapter:this.state.selected,debugInstance:this.props.debugInstance},"debugger"):(setTimeout(()=>this.props.onDebugModeChange(!1)),null):null}render(){return this.state.selected&&this.props.objects[this.state.selected]&&this.state.blockly===null&&this.state.rules===null&&(this.scripts[this.state.selected]=this.scripts[this.state.selected]||JSON.parse(JSON.stringify(this.props.objects[this.state.selected].common)),setTimeout(()=>{const n={blockly:this.scripts[this.state.selected].engineType==="Blockly",rules:this.scripts[this.state.selected].engineType==="Rules",showCompiledCode:!1,debugEnabled:this.scripts[this.state.selected].debug,verboseEnabled:this.scripts[this.state.selected].verbose};this.removeNonExistingScripts(null,n),this.setState(n)},100)),[this.getTabs(),this.getToolbar(),this.getScriptEditor(),this.getAskAboutDebug(),this.getBlocklyEditor(),this.getRulesEditor(),this.getDebug(),this.getConfirmDialog(),this.getSelectIdDialog(),this.getCronDialog(),this.getEditorDialog(),this.getAstroDialog(),this.getDebugMenu(),this.getToast(),this.getTour()]}}const Sr={dialog:{height:"95%"},dropzone:{marginTop:20,width:"100%",borderWidth:5,borderStyle:"dashed",borderColor:"#d0cccc",textAlign:"center",boxSizing:"border-box",paddingTop:45,borderRadius:10,height:"calc(100% - 10px)"},dropzoneDiv:{width:"100%",height:"100%"},dropzoneRejected:{borderColor:"#970000"},dropzoneAccepted:{borderColor:"#17cd02"},icon:{height:"30%",width:"30%",color:"#eeeeee",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%,-50%)",zIndex:0},iconError:{color:"#ffc3c6"},iconOk:{color:"#aaeebc"},text:{top:"50%",left:"50%",transform:"translate(-50%,-50%)",color:"#868686",position:"absolute",zIndex:1}};class rC extends We.Component{constructor(n){super(n),this.state={error:"",imageStatus:""}}componentDidMount(){setTimeout(()=>{var n;try{(n=window.document.getElementById("import-text-area"))==null||n.focus()}catch{}},100)}handleCancel(){this.props.onClose()}static readFileDataUrl(n,s){const i=new FileReader;i.onload=()=>{s(null,{data:i.result,name:n.name})},i.onabort=()=>{console.error("file reading was aborted"),s(I.I18n.t("file reading was aborted"))},i.onerror=a=>{console.error("file reading has failed"),s(I.I18n.t("file reading has failed: %s",a))},i.readAsDataURL(n)}handleDropFile(n){if(!(n!=null&&n.length))return;const s=n[n.length-1];s&&rC.readFileDataUrl(s,(i,a)=>{var c;i||!a?this.setState({error:i||"No data"}):this.props.onClose(((c=a.data)==null?void 0:c.toString())||"")})}render(){const n={...Sr.dropzone,...this.state.imageStatus==="accepted"?Sr.dropzoneAccepted:this.state.imageStatus==="rejected"?Sr.dropzoneRejected:void 0};return f.jsxs(D.Dialog,{onClose:()=>!1,maxWidth:"lg",sx:{"& .MuiDialog-paper":Sr.dialog},fullWidth:!0,open:!0,"aria-labelledby":"import-dialog-title",PaperProps:{style:{minHeight:"90%",maxHeight:"90%"}},children:[f.jsx(D.DialogTitle,{id:"import-dialog-title",children:I.I18n.t("Import scripts")}),f.jsxs(D.DialogContent,{children:[f.jsx(U0,{maxSize:5e7,onDrop:(s,i)=>{var a,c,h;s.length?this.handleDropFile(s):window.alert(((h=(c=(a=i==null?void 0:i[0])==null?void 0:a.errors)==null?void 0:c[0])==null?void 0:h.message)||I.I18n.t("ra_Cannot upload"))},multiple:!1,accept:{"application/zip":[],"application/x-zip-compressed":[]},children:({getRootProps:s,getInputProps:i,isDragActive:a,isDragReject:c})=>c?(this.state.imageStatus!=="rejected"&&this.setState({imageStatus:"rejected"}),f.jsxs("div",{style:{...n,...Sr.dropzoneDiv},...s(),children:[f.jsx("input",{...i()}),f.jsx("span",{style:Sr.text,children:I.I18n.t("Some files will be rejected")},"text"),f.jsx(Iv,{style:{...Sr.icon,...Sr.iconError}},"icon")]})):a?(this.state.imageStatus!=="accepted"&&this.setState({imageStatus:"accepted"}),f.jsxs("div",{style:{...n,...Sr.dropzoneDiv},...s(),children:[f.jsx("input",{...i()}),f.jsx("span",{style:Sr.text,children:I.I18n.t("All files will be accepted")},"text"),f.jsx(Ev,{style:{...Sr.icon,...Sr.iconOk}},"icon")]})):(this.state.imageStatus!=="wait"&&this.setState({imageStatus:"wait"}),f.jsxs("div",{style:{...n,...Sr.dropzoneDiv},...s(),children:[f.jsx("input",{...i()}),f.jsx("span",{style:Sr.text,children:I.I18n.t("Drop some files here or click...")},"text"),f.jsx(W0,{style:Sr.icon},"icon")]}))},"image-drop"),this.state.error?f.jsx(Hf,{text:this.state.error,onClose:()=>this.setState({error:""})}):null]}),f.jsx(D.DialogActions,{children:f.jsx(D.Button,{color:"grey",variant:"contained",onClick:()=>this.handleCancel(),startIcon:f.jsx(Jo,{}),children:I.I18n.t("Close")})})]})}}const wP="Acknowledged",CP="Actions",SP="Add",TP="All",kP="Any",EP="Apply",IP="April",xP="Ask",DP="Astronomical",AP="August",OP="Cancel",RP="Close",MP="Condition",NP="Conditions",LP="Console",BP="Copied",PP="December",jP="Default",FP="Delay",zP="Delete",UP="Description",WP="Done",HP="Exec shell",VP="Explanation",GP="Export",KP="Februar",JP="February",qP="Filter",YP="Folder",XP="Fr",ZP="Friday",QP="ID",e2="ID1",t2="ID2",n2="Import",s2="Instance",r2="Instances",i2="Instructions",o2="Januar",a2="January",l2="July",c2="June",u2="Limit",d2="March",h2="May",p2="Menu",g2="Message",f2="Mo",m2="Model",b2="Monday",$2="Month",v2="More",y2="Name",_2="November",w2="OK",C2="October",S2="Ok",T2="Pause",k2="Pushover",E2="Pushsafer",I2="Rename",x2="Repeat",D2="Restart",A2="Result",O2="Sa",R2="Saturday",M2="Save",N2="Schedule",L2="Script",B2="September",P2="Simulate",j2="Stack",F2="Start",z2="State",U2="Su",W2="Sunday",H2="Telegram",V2="Th",G2="Thursday",K2="Time",J2="Triggered",q2="Triggers",Y2="Tu",X2="Tuesday",Z2="URL",Q2="Value",ej="Volume",tj="We",nj="Wednesday",sj="Write",rj="Yes",ij="acknowledgment",oj="all",aj="and",lj="Astro",cj="at",uj="control",dj="copy",hj="CRON",pj="Dawn",gj="This is a special mode in which states and objects will not change. But only information about each planned change will be displayed in the protocol.",fj="Debug",mj="Dusk",bj="easy",$j="every",vj="Function",yj="ID",_j="Name",wj="Role",Cj="Room",Sj="Golden hour",Tj="End of golden hour",kj='The code will be executed only every time when condition is true. E.g. if triggering on the temperature sensor value and the condition is "if temperature is greater than 20C", the "then" actions will be executed every time when sensor sends the temperature and it is over 20C. By 21C, by 22C and so on.',Ej='The code will be executed only if the condition result changes. E.g. if triggering on the temperature sensor value and the condition is "if temperature is greater than 20C", the "then" actions will be executed once when temperature is over 20. Next time the "then" actions will be executed when the temperature fails under 20 and then rises over 20 again.',Ij="hours",xj="includes",Dj="interval",Aj="magic",Oj="milliseconds",Rj="minutes",Mj="ms",Nj="Nadir",Lj="Nautical dawn",Bj="Nautical dusk",Pj="Next Sunrise",jj="Next sunset",Fj="Night",zj="Night end",Uj="normal",Wj="offset",Hj="one",Vj="or",Gj="quiet",Kj="search",Jj="seconds",qj="Solar noon",Yj="sunrise",Xj="Sunrise end",Zj="Sunset",Qj="Sunset start",eF="then",tF="Acknowledge",nF="From",sF="Last changed",rF="Quality",iF="Timestamp",oF="User",aF="Value",lF="two",cF="update",uF="Adds debug output to the log for many system commands",dF="Verbose log outputs",hF="when",pF="Wizard",gF={"%s not found":"%s not found","()":"()","(at %s)":"(at %s)","(optional)":"(optional)","-":"-",".":".","AI code generator":"AI code generator",Ack:wP,Actions:CP,"Actual time of day":"Actual time of day",Add:SP,"Add new script":"Add new script",All:TP,"All files will be accepted":"All files will be accepted",Any:kP,"Any month":"Any month",Apply:EP,April:IP,"Are you sure?":"Are you sure?",Ask:xP,Astronomical:DP,"Astronomical events today":"Astronomical events today",August:AP,"Blockly description":"Creating rules by graphic blocks","Body:":"Body:",Cancel:OP,"Cannot delete non empty item!":"Cannot delete non empty item!","Change layout":"Change layout",'Change theme (actual "%s")':'Change theme (now - "%s")',"Check blocks":"Check blocks","Check is not active, because javascript adapter is disabled":"Check is not active, because Javascript adapter is disabled","Clear search input":"Clear search input","Click on this icon":"Click on this icon",Close:RP,"Close all but current":"Close all but current","Collapse all":"Collapse all","Compares current time with astronomical event":"Compares current time with astronomical event","Compares current time with the user specific time":"Compares current time with the user specific time","Compares the state value with user defined value":"Compares the state value with user defined value",Condition:MP,Conditions:NP,"Configuration not saved.":"Configuration not saved.",Console:LP,"Control or update some state":"Control or update some state","Control or update some state with delay":"Control or update some state with delay","Convert blockly to javascript for ever.":"Permanently convert Blockly to Javascript.",Copied:BP,"Copy script":"Copy script","Copy to clipboard":"Copy to clipboard","Create new":"Create new","Create new folder":"Create new folder","Create new script":"Create new script","Create or edit CRON or time wizard":"Create or edit CRON or time wizard","Dark Theme":"Dark theme","Dark style":"Dark style",Date:"Date","Debug instance":"Debug instance","Debug options":"Debug options",December:PP,Default:jP,"Define cron...":"Define cron...","Define schedule...":"Define schedule...",Delay:FP,Delete:zP,"Delete %s":"Delete %s...","Delete folder":"Delete folder","Delete script":"Delete script",Description:UP,"Deselect all":"Deselect all","Discard changes for %s":"Discard changes for %s",Done:WP,"Double click to write value":"Double click to write value","Download as file":"Download as file","Drop some files here or click...":"Drop some files here or click...","Duplicate name":"Duplicate name","Edit script or just double click":"Edit script or just double click","Empty name is not allowed":"Empty name is not allowed","End search mode":"End search mode","Enter your question":"Enter your request",Error:"Error","Error formatting code":"Error formatting code","Error was found":"Error was found","Every day":"Every day",Exec:HP,"Executes some shell command":"Executes some shell command","Existing scripts will be overwritten.":"Existing scripts will be overwritten.","Expand all":"Expand all","Expert mode":"Expert mode",Explanation:VP,Export:GP,"Export all scripts":"Export all scripts","Export blocks":"Export blocks","Export selected blocks":"Export selected blocks",Februar:KP,February:JP,Filter:qP,Folder:YP,Fr:XP,Friday:ZP,Function:"Function","Function editor":"Function editor","Function: executed":"Function: executed","Go to next line":"Go to next line","HTTP Call":"HTTP Call","Hide logs":"Hide logs",ID:QP,ID1:e2,ID2:t2,Import:n2,"Import blocks":"Import blocks","Import error":"Import error","Import scripts":"Import scripts","Insert object ID":"Insert object ID",Instance:s2,"Instance is disabled":"Instance is disabled","Instance:":"Instance:",Instances:r2,Instructions:i2,"Invalid CRON":"Invalid CRON","It will not be possible to revert this operation.":"It will not be possible to revert this operation.","JS description":"Creating rules by writing Javascript",Januar:o2,January:a2,July:l2,June:c2,"Just check":"Just check","Language:":"Language:","Learn More":"Learn More","Light style":"Light style",Limit:u2,"Local time":"Local time","Locate file":"Locate file","Log outputs":"Log outputs","Log text":"Log text","Log: %s":"Log: %s","Make a HTTP get request":"Make a HTTP get request","Make a pause between actions":"Make a pause between actions",March:d2,"March ":"March ",May:h2,Menu:p2,Message:g2,Mo:f2,Model:m2,Monday:b2,Month:$2,More:v2,Name:y2,"No Chat GPT Key found":"No Chat GPT Key found","No active host found":"No active host found","Nothing found":"Nothing found",November:_2,OK:w2,October:C2,Ok:S2,"On condition change":"On condition result change","On script save or adapter start":"On script save or adapter start","On weekdays":"On weekdays","Open configuration":"Open configuration","Operate two states":"Operate two states","Operations with two states":"Operations with two states","Paste your blocks here":"Paste your blocks here",Pause:T2,"Pause execution":"Pause execution","Pause script":"Pause script","Phone:":"Phone:","Please select object ID...":"Please select object ID...","Press Ctrl+Enter to get the answer":"Press Ctrl+Enter to get the answer","Prettify the script":"Prettify the script","Print some text in log":"Print some text in log","Priority:":"Priority:",Pushover:k2,Pushsafer:E2,"Read only ID selected: %s":"Read only ID selected: %s",Rename:I2,"Reorder scripts in folders":"Reorder scripts in folders",Repeat:x2,Restart:D2,Result:A2,"Resume execution":"Resume execution","Root folder":"Root folder","Rules description":"Create rules with IF, THEN, ELSE blocks","Run script":"Run script",Sa:O2,Saturday:R2,Save:M2,"Save all":"Save all","Say It":"Say It","Say some text via sayit adapter":"Say some text via sayit adapter",Schedule:N2,Script:L2,"Script %s was modified on disk":"Script %s was modified on disk","Script is not running":"Script is not running","Search in scripts":"Search in scripts","Search...":"Search...","Select all":"Select all","Send email":"Send email","Sends an email":"Sends an email","Sends message via Pushsafer":"Sends message via Pushsafer","Sends message via pushover":"Sends message via pushover","Sends message via telegram":"Sends message via telegram","Sends message via whatsapp-cmb":"Sends message via whatsapp-cmb",September:B2,"Server time":"Server time","Set state action":"Set state action","Set with delay":"Set with delay","Shell command":"Shell command","Show astronomical events":"Show astronomical events","Show javascript code":"Show Javascript code","Show logs":"Show logs","Show only paused scripts":"Show only paused scripts","Show only running scripts":"Show only running scripts","Show only scripts with problems":"Show only scripts with problems",Simulate:P2,"Some files will be rejected":"Some files will be rejected","Sound:":"Sound:",Stack:j2,Start:F2,"Start script":"Start script",State:z2,"State condition":"State condition","Step into function":"Step into function","Step out from function":"Step out from function","Stop on exception":"Stop on exception",Su:U2,"Subject:":"Subject:",Sunday:W2,"TS description":"Creating rules by writing Typescript",Telegram:H2,"Text:":"Text:",Th:V2,"The script will be stopped and must be activated manually after debugging. Continue?":"The script will be stopped and must be activated manually after debugging. Continue?","This is advances option. You can write your own code here and it will be executed on trigger":"This is advances option. You can write your own code here and it will be executed on trigger",Thursday:G2,Time:K2,"Time condition":"Time condition","Title:":"Title:","To:":"To:","Trigger with value":"Trigger with value",Triggered:J2,Triggers:q2,"Triggers the on script saving or the javascript instance restart":"Triggers the on script saving or the javascript instance restart","Triggers the rule on update or change of some state":"Triggers the rule on update or change of some state","Triggers the rule periodically or on some specific time":"Triggers the rule periodically or on some specific time",Tu:Y2,Tuesday:X2,URL:Z2,"Unknown error":"Unknown error","Unknown error!":"Unknown error!","Use generated code":"Use generated code","User function":"User function","User:":"User:",Value:Q2,"Vibration:":"Vibration:",Volume:ej,We:tj,Wednesday:nj,"Whatsapp-cmb":"Whatsapp-cmb",Write:sj,"Write your own code":"Write your own code",Yes:rj,"Yet exists!":"Yet exists!","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":"You can use %s in the URL to use current trigger value, %id to use the triggered object ID, %name to show triggered object ID name or %old to use old trigger value","You can use %s in the command to use current trigger value or %id to use the triggered object ID":"You can use %s in the command to use current trigger value, %id to use the triggered object ID, %name to show triggered object ID name or %old to use old trigger value","You can use %s in the text to display current trigger value or %id to display the triggered object ID":"You can use %s in the text to display current trigger value, %id to use the triggered object ID, %name to show triggered object ID name or %old to use old trigger value","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":"You can use %s in the value to use the current trigger value, %id to use the triggered object ID, %name to show triggered object ID name or %old to use old trigger value","You have to enter OpenAI API key in the configuration of javascript adapter.":"You have to enter OpenAI API key in the configuration of javascript adapter.","[equal]":"[equal]","[greater or equal]":"[greater or equal]","[greater]":"[greater]","[hysteresis]":"[hysteresis]","[includes]":"[includes]","[less or equal]":"[less or equal]","[less]":"[less]","[not equal]":"[not equal]",acknowledgment:ij,all:oj,and:aj,astro:lj,at:cj,"clear running":"clear running",control:uj,copy:dj,cron:hj,dawn:pj,debug_help:gj,debug_label:fj,default:"default",dusk:mj,easy:bj,else:"else","equal to":"equal to",every:$j,"every hour at 0 minutes":"every hour at 0 minutes",false:"false","file reading has failed: %s":"file reading has failed: %s","file reading was aborted":"file reading was aborted",filter_func:vj,filter_id:yj,filter_name:_j,filter_role:wj,filter_room:Cj,"for edit or create script":"for edit or create a new script","for professionals":"for professionals","for programmers":"for programmers",goldenHour:Sj,goldenHourEnd:Tj,"greater or equal":"greater or equal","greater or equal to":"greater or equal to","greater than":"greater than",help_just_check:kj,help_on_change:Ej,"high priority":"high priority","high-priority":"high-priority","highest priority":"highest priority",hours:Ij,includes:xj,interval:Dj,"just check":"just check","less or equal":"less or equal","less or equal to":"less or equal to","less than":"less than","lower priority":"lower priority","lowest priority":"lowest priority",magic:Aj,milliseconds:Oj,minutes:Rj,ms:Mj,nadir:Nj,nauticalDawn:Lj,nauticalDusk:Bj,nextSunrise:Pj,nextSunset:jj,night:Fj,nightEnd:zj,"no blocks found":"No blocks found","no group":"NO GROUP",normal:Uj,"normal priority":"normal priority","not equal to":"not equal to","not properly connected":"This block is not properly connected to other blocks.",offset:Wj,"on change":"on change","on condition change":"on condition change","on update":"on update",one:Hj,or:Vj,quiet:Gj,"reset search":"reset search",search:Kj,seconds:Jj,solarNoon:qj,"store in":"store in",sunrise:Yj,sunriseEnd:Xj,sunset:Zj,sunsetStart:Qj,then:eF,"toggle value":"toggle value",tooltip_ack:tF,tooltip_from:nF,tooltip_lc:sF,tooltip_quality:rF,tooltip_ts:iF,tooltip_user:oF,tooltip_value:aF,true:"true",two:lF,undefined:"undefined",update:cF,"use seconds":"use seconds","use trigger value":"use trigger value",verbose_help:uF,verbose_label:dF,when:hF,with:"with","with date":"with date","with offset":"with offset",wizard:pF},fF="Besttigt",mF="Aktionen",bF="Hinzufgen",$F="Alle",vF="Egal",yF="Anwenden",_F="April",wF="Fragen",CF="Astronomisch",SF="August",TF="Abbrechen",kF="Schlieen",EF="Bedingung",IF="Bedingungen",xF="Konsole",DF="Kopiert",AF="Dezember",OF="Standard",RF="Verzgerung",MF="Lschen",NF="Beschreibung",LF="Fertig",BF="Exec shell",PF="Erluterung",jF="Export",FF="Februar",zF="Februar",UF="Filter",WF="Ordner",HF="Fr",VF="Freitag",GF="ID",KF="ID1",JF="ID2",qF="Import",YF="Instanz",XF="Instanzen",ZF="Anleitung",QF="Januar",ez="Januar",tz="Juli",nz="Juni",sz="Grenze",rz="Mrz",iz="Mai",oz="Men",az="Nachricht",lz="Mo",cz="Modell",uz="Montag",dz="Monat",hz="Mehr",pz="Name",gz="November",fz="OK",mz="Oktober",bz="Ok",$z="Pause",vz="Pushover",yz="Pushsafer",_z="Umbenennen",wz="Wiederholen",Cz="Neustart",Sz="Ergebnis",Tz="Sa",kz="Samstag",Ez="Speichern",Iz="Zeitplan",xz="Skript",Dz="September",Az="Simulieren",Oz="Stack",Rz="Start",Mz="Zustand",Nz="So",Lz="Sonntag",Bz="Telegram",Pz="Do",jz="Donnerstag",Fz="Zeit",zz="Ausgelst",Uz="Lst aus",Wz="Di",Hz="Dienstag",Vz="URL",Gz="Wert",Kz="Volumen",Jz="Mi",qz="Mittwoch",Yz="Schreiben",Xz="Ja",Zz="Wissen",Qz="alle",eU="und",tU="Astro",nU="um",sU="Steuerung",rU="Kopie",iU="CRON",oU="Morgendmmerung",aU="Dies ist ein spezieller Modus, in dem sich Zustnde und Objekte nicht ndern. Im Protokoll werden jedoch nur Informationen zu jeder geplanten nderung angezeigt.",lU="Debuggen",cU="Abenddmmerung",uU="einfach",dU="jeder",hU="Funktion",pU="ID",gU="Name",fU="Rolle",mU="Raum",bU="Goldene Abendstunde",$U="Vormittag",vU='Der Code wird jedes Mal ausgefhrt, wenn die Bedingung erfllt ist. z.B. wenn der Temperatur wert sich ndert und die Bedingung "Wenn die Temperatur grer als 20C ist" lautet, werden die "Dann" -Aktionen jedes Mal ausgefhrt, wenn der Sensor die Temperatur sendet und diese ber 20C liegt. Bei 21C, bei 22C und so weiter.',yU='Der Code wird nur ausgefhrt, wenn sich das Ergebnis der Bedingung ndert. z.B. wenn sich der Temperatur wert ndert und die Bedingung "Wenn die Temperatur grer als 20C ist" lautet, werden die "Dann" -Aktionen einmal ausgefhrt, wenn die Temperatur ber 20C liegt. Das nchste Mal werden die "Dann" -Aktionen ausgefhrt, wenn die Temperatur unter 20C gefallen ist und dann wieder ber 20C ansteigt.',_U="Stunden",wU="beinhaltet",CU="Intervall",SU="Magie",TU="Millisekunden",kU="Minuten",EU="ms",IU="Nadir",xU="nautische Morgendmmerung",DU="nautische Abenddmmerung",AU="Nchster Sonnenaufgang",OU="Nchster Sonnenuntergang",RU="Nacht",MU="astronomische Morgendmmerung",NU="Normal",LU="Versatz",BU="einer",PU="oder",jU="ruhig",FU="Suche",zU="Sekunden",UU="(Nach-)Mittag",WU="Sonnenaufgang",HU="Goldene Morgenstunde",VU="Sonnenuntergang",GU="Sonnenuntergang (Anfang)",KU="dann",JU="Besttigen",qU="Von",YU="Zuletzt gendert",XU="Qualitt",ZU="Zeitstempel",QU="Benutzer",eW="Wert",tW="zwei",nW="Aktualisieren",sW="Fgt Debug-Ausgaben fr viele Systembefehle zum Protokoll hinzu",rW="Ausfhrliche Protokollausgaben",iW="falls",oW="Assistent",aW={"%s not found":"%s nicht gefunden","()":"()","(at %s)":"(um %s)","(optional)":"(optional)","-":"-",".":".","AI code generator":"KI-Codegenerator",Ack:fF,Actions:mF,"Actual time of day":"Tatschliche Tageszeit",Add:bF,"Add new script":"Neues Skript hinzufgen",All:$F,"All files will be accepted":"Alle Dateien werden akzeptiert",Any:vF,"Any month":"Jeden Monat",Apply:yF,April:_F,"Are you sure?":"Wirklich sicher?",Ask:wF,Astronomical:CF,"Astronomical events today":"Astronomische Ereignisse heute",August:SF,"Blockly description":"Erstellen von Regeln durch Grafikblcke","Body:":"Krper:",Cancel:TF,"Cannot delete non empty item!":"Kann nicht gelscht werden, weil noch einige Elementen darin sind!","Change layout":"Layout ndern",'Change theme (actual "%s")':'Thema ndern (jetzt - "%s")',"Check blocks":"Blcke prfen","Check is not active, because javascript adapter is disabled":"Syntax-Check ist nicht aktiv, weil der Javascript Adapter nicht aktiv ist.","Clear search input":"Sucheingabe lschen","Click on this icon":"Auf dieses Symbol klicken",Close:kF,"Close all but current":"Alle anderen auer dem Aktiven schlieen","Collapse all":"Alles einklappen","Compares current time with astronomical event":"Vergleicht die aktuelle Zeit mit einem astronomischen Ereignis","Compares current time with the user specific time":"Vergleicht die aktuelle Zeit mit der benutzerspezifischen Zeit","Compares the state value with user defined value":"Vergleicht den Zustandswert mit dem benutzerdefinierten Wert",Condition:EF,Conditions:IF,"Configuration not saved.":"Die Konfiguration ist nicht gespeichert.",Console:xF,"Control or update some state":"Zustand steuern oder aktualisieren","Control or update some state with delay":"Zustand mit Verzgerung steuern oder aktualisieren","Convert blockly to javascript for ever.":"Blockly dauerhaft in Javascript konvertieren.",Copied:DF,"Copy script":"Skript kopieren","Copy to clipboard":"In die Zwischenablage kopieren","Create new":"Neu erstellen","Create new folder":"Neuen Ordner erstellen","Create new script":"Neues Skript erstellen","Create or edit CRON or time wizard":"CRON- oder Zeit-Assistenten erstellen oder bearbeiten","Dark Theme":"Dunkles Thema","Dark style":"Dunkler Stil",Date:"Datum","Debug instance":"Debug-Instanz","Debug options":"Debug-Optionen",December:AF,Default:OF,"Define cron...":"Cron definieren ...","Define schedule...":"Zeitplan definieren ...",Delay:RF,Delete:MF,"Delete %s":"Lschen %s...","Delete folder":"Ordner lschen","Delete script":"Skript lschen",Description:NF,"Deselect all":"Alles abwhlen","Discard changes for %s":"nderungen fr %s verwerfen",Done:LF,"Double click to write value":"Doppelklick zum Schreiben des Wertes","Download as file":"Download als Datei","Drop some files here or click...":"Dateien hier ablegen oder klicken ...","Duplicate name":"Doppelter Name","Edit script or just double click":"Skript bearbeiten oder einfach doppelklicken","Empty name is not allowed":"Leerer Name ist nicht zulssig","End search mode":"Suchmodus beenden","Enter your question":"Anfrage eingeben",Error:"Fehler","Error formatting code":"Fehler beim Formatieren des Codes","Error was found":"Fehler wurde gefunden","Every day":"Tglich",Exec:BF,"Executes some shell command":"Fhrt einen Shell-Befehl aus","Existing scripts will be overwritten.":"Vorhandene Skripte werden berschrieben.","Expand all":"Alle erweitern","Expert mode":"Expertenmodus",Explanation:PF,Export:jF,"Export all scripts":"Alle Skripte exportieren","Export blocks":"Blcke exportieren","Export selected blocks":"Ausgewhlte Blcke exportieren",Februar:FF,February:zF,Filter:UF,Folder:WF,Fr:HF,Friday:VF,Function:"Funktion","Function editor":"Funktions-Editor","Function: executed":"Funktion: ausgefhrt","Go to next line":"Gehe zur nchsten Zeile","HTTP Call":"HTTP-Aufruf","Hide logs":"Protokoll ausblenden",ID:GF,ID1:KF,ID2:JF,Import:qF,"Import blocks":"Blcke importieren","Import error":"Fehler beim Importieren","Import scripts":"Skripte importieren","Insert object ID":"Objekt-ID einfgen",Instance:YF,"Instance is disabled":"Instanz ist deaktiviert","Instance:":"Instanz:",Instances:XF,Instructions:ZF,"Invalid CRON":"Ungltiger CRON","It will not be possible to revert this operation.":"Dieser Vorgang kann nicht rckgngig gemacht werden.","JS description":"Regeln erstellen mit JavaScript",Januar:QF,January:ez,July:tz,June:nz,"Just check":"Einfach berprfen","Language:":"Sprache:","Learn More":"Mehr erfahren","Light style":"Heller Stil",Limit:sz,"Local time":"Lokale Zeit","Locate file":"Datei zeigen","Log outputs":"Protokoll","Log text":"Protokolltext","Log: %s":"Log: %s","Make a HTTP get request":"Eine HTTP-Abrufanforderung stellen","Make a pause between actions":"Eine Pause zwischen den Aktionen machen",March:rz,"March ":"Mrz ",May:iz,Menu:oz,Message:az,Mo:lz,Model:cz,Monday:uz,Month:dz,More:hz,Name:pz,"No Chat GPT Key found":"Kein Chat-GPT-Schlssel gefunden","No active host found":"Kein aktiver Host gefunden","Nothing found":"Nichts gefunden",November:gz,OK:fz,October:mz,Ok:bz,"On condition change":"Bei nderung des Ergebnis der Bedingung","On script save or adapter start":"Beim Speichern des Skripts oder beim Starten des Adapters","On weekdays":"An Wochentagen","Open configuration":"Konfiguration ffnen","Operate two states":"Zwei Zustnde operieren","Operations with two states":"Operationen mit zwei Zustnden","Paste your blocks here":"Fgen Sie Ihre Blcke hier ein",Pause:$z,"Pause execution":"Ausfhrung pausieren","Pause script":"Skript anhalten","Phone:":"Telefon:","Please select object ID...":"Objekt-ID auswhlen ...","Press Ctrl+Enter to get the answer":"Strg+Eingabetaste, um die Antwort zu erhalten","Prettify the script":"Verschnern Sie das Skript","Print some text in log":"Einen Text im Protokoll ausdrucken","Priority:":"Prioritt:",Pushover:vz,Pushsafer:yz,"Read only ID selected: %s":"Schreibgeschtzte ID ausgewhlt: %s",Rename:_z,"Reorder scripts in folders":"Skripte in Ordnern neu ordnen",Repeat:wz,Restart:Cz,Result:Sz,"Resume execution":"Ausfhrung fortsetzen","Root folder":"Root-Verzeichnis","Rules description":"Regeln erstellen mit WENN-, DANN- und SONST-Blcken","Run script":"Skript ausfhren",Sa:Tz,Saturday:kz,Save:Ez,"Save all":"Alle speichern","Say It":"Say It","Say some text via sayit adapter":"Einen Text ber den Sayit-Adapter sagen",Schedule:Iz,Script:xz,"Script %s was modified on disk":'Skript "%s" wurde auf der Festplatte gendert',"Script is not running":"Skript luft nicht","Search in scripts":"Suche in Skripten","Search...":"Suche...","Select all":"Alles auswhlen","Send email":"E-Mail senden","Sends an email":"Sendet eine E-Mail","Sends message via Pushsafer":"Sendet eine Nachricht ber Pushsafer","Sends message via pushover":"Sendet eine Nachricht per Pushover","Sends message via telegram":"Sendet eine Nachricht per telegram","Sends message via whatsapp-cmb":"Sendet eine Nachricht ber WhatsApp-Cmb",September:Dz,"Server time":"Server-Zeit","Set state action":"Zustand setzten","Set with delay":"Setzen mit Verzgerung","Shell command":"Shell-Befehl","Show astronomical events":"Astronomische Ereignisse anzeigen","Show javascript code":"Javascript-Code zeigen","Show logs":"Protokoll anzeigen","Show only paused scripts":"Nur angehaltene Skripte zeigen","Show only running scripts":"Nur laufende Skripte zeigen","Show only scripts with problems":"Nur Skripte mit Problemen zeigen",Simulate:Az,"Some files will be rejected":"Einige Dateien werden abgelehnt","Sound:":"Klang:",Stack:Oz,Start:Rz,"Start script":"Skript starten",State:Mz,"State condition":"Zustandsbedingung","Step into function":"Schritt in die Funktion","Step out from function":"Raus aus der Funktion","Stop on exception":"Bei Ausnahme anhalten",Su:Nz,"Subject:":"Gegenstand:",Sunday:Lz,"TS description":"Regeln erstellen mit TypeScript",Telegram:Bz,"Text:":"Text:",Th:Pz,"The script will be stopped and must be activated manually after debugging. Continue?":"Das Skript wird gestoppt und muss nach dem Debuggen manuell aktiviert werden. Fortsetzen?","This is advances option. You can write your own code here and it will be executed on trigger":"Dies ist eine erweiterte Option. Sie knnen hier Ihren eigenen Code schreiben, der beim Auslsen ausgefhrt wird",Thursday:jz,Time:Fz,"Time condition":"Zeitbedingung","Title:":"Titel:","To:":"Zu:","Trigger with value":"Trigger mit Wert",Triggered:zz,Triggers:Uz,"Triggers the on script saving or the javascript instance restart":"Lst das Speichern des Skripts oder den Neustart der Javascript-Instanz aus","Triggers the rule on update or change of some state":"Lst die Regel beim Aktualisieren oder ndern eines Zustands aus","Triggers the rule periodically or on some specific time":"Lst periodisch oder zu einem bestimmten Zeitpunkt aus",Tu:Wz,Tuesday:Hz,URL:Vz,"Unknown error":"Unbekannter Fehler","Unknown error!":"Unbekannter Fehler!","Use generated code":"Code verwenden","User function":"Benutzerfunktion","User:":"Benutzer:",Value:Gz,"Vibration:":"Vibration:",Volume:Kz,We:Jz,Wednesday:qz,"Whatsapp-cmb":"WhatsApp-cmb",Write:Yz,"Write your own code":"Eigenen Code schreiben",Yes:Xz,"Yet exists!":"Existiert schon!","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":"Sie knnen %s in der URL verwenden, um den aktuellen Triggerwert zu verwenden, %id, um die ausgelste Objekt-ID zu verwenden, %name, um den ID-Namen des ausgelsten Objekts anzuzeigen, oder %old, um den alten Triggerwert zu verwenden","You can use %s in the command to use current trigger value or %id to use the triggered object ID":"Sie knnen %s im Befehl verwenden, um den aktuellen Triggerwert zu verwenden, %id, um die ausgelste Objekt-ID zu verwenden, %name, um den ID-Namen des ausgelsten Objekts anzuzeigen, oder %old, um den alten Triggerwert zu verwenden","You can use %s in the text to display current trigger value or %id to display the triggered object ID":"Sie knnen %s im Text verwenden, um den aktuellen Triggerwert anzuzeigen, %id, um die ausgelste Objekt-ID zu verwenden, %name, um den ID-Namen des ausgelsten Objekts anzuzeigen, oder %old, um den alten Triggerwert zu verwenden","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":"Sie knnen %s im Wert verwenden, um den aktuellen Triggerwert zu verwenden, %id, um die ID des ausgelsten Objekts zu verwenden, %name, um den ID-Namen des ausgelsten Objekts anzuzeigen, oder %old, um den alten Triggerwert zu verwenden","You have to enter OpenAI API key in the configuration of javascript adapter.":"Sie mssen den OpenAI-API-Schlssel in der Konfiguration des Javascript-Adapters eingeben.","[equal]":"[gleich]","[greater or equal]":"[grer oder gleich]","[greater]":"[grer]","[hysteresis]":"[Hysterese]","[includes]":"[enthlt]","[less or equal]":"[kleiner oder gleich]","[less]":"[kleiner]","[not equal]":"[ungleich]",acknowledgment:Zz,all:Qz,and:eU,astro:tU,at:nU,"clear running":"laufende abbrechen",control:sU,copy:rU,cron:iU,dawn:oU,debug_help:aU,debug_label:lU,default:"Standard",dusk:cU,easy:uU,else:"sonst","equal to":"gleich",every:dU,"every hour at 0 minutes":"jede Stunde bei 0 Minuten",false:"falsch","file reading has failed: %s":"Das Lesen der Datei ist fehlgeschlagen: %s","file reading was aborted":"Das Lesen der Datei wurde abgebrochen",filter_func:hU,filter_id:pU,filter_name:gU,filter_role:fU,filter_room:mU,"for edit or create script":"zum Bearbeiten oder zum Erstellen eines neues Skripts","for professionals":"fr Profis","for programmers":"fr Programmierer",goldenHour:bU,goldenHourEnd:$U,"greater or equal":"grer oder gleich","greater or equal to":"grer oder gleich","greater than":"grer als",help_just_check:vU,help_on_change:yU,"high priority":"hohe Prioritt","high-priority":"hohe Prioritt","highest priority":"hchste Prioritt",hours:_U,includes:wU,interval:CU,"just check":"einfach prfen","less or equal":"kleiner oder gleich","less or equal to":"kleiner oder gleich","less than":"kleiner als","lower priority":"geringere Prioritt","lowest priority":"niedrigste Prioritt",magic:SU,milliseconds:TU,minutes:kU,ms:EU,nadir:IU,nauticalDawn:xU,nauticalDusk:DU,nextSunrise:AU,nextSunset:OU,night:RU,nightEnd:MU,"no blocks found":"Keine Blcke gefunden","no group":"KEINE GRUPPE",normal:NU,"normal priority":"normale Prioritt","not equal to":"ungleich","not properly connected":"Dieser Block ist mit anderen nicht richtig verbunden.",offset:LU,"on change":"bei nderung","on condition change":"bei Zustandsnderung","on update":"beim Aktualisieren",one:BU,or:PU,quiet:jU,"reset search":"Suche zurcksetzen",search:FU,seconds:zU,solarNoon:UU,"store in":"speichern in",sunrise:WU,sunriseEnd:HU,sunset:VU,sunsetStart:GU,then:KU,"toggle value":"Wert umschalten",tooltip_ack:JU,tooltip_from:qU,tooltip_lc:YU,tooltip_quality:XU,tooltip_ts:ZU,tooltip_user:QU,tooltip_value:eW,true:"wahr",two:tW,undefined:"nicht definiert",update:nW,"use seconds":"Sekunden verwenden","use trigger value":"Triggerwert benutzen",verbose_help:sW,verbose_label:rW,when:iW,with:"mit","with date":"mit Datum","with offset":"mit Versatz",wizard:oW},lW="Admitido",cW="Comportamiento",uW="Aadir",dW="Todos",hW="Alguna",pW="Apply",gW="abril",fW="Preguntar",mW="Astronmico",bW="agosto",$W="Cancelar",vW="Cerrar",yW="Condicin",_W="Condiciones",wW="Consola",CW="Copiado",SW="diciembre",TW="Defecto",kW="Demora",EW="Eliminar",IW="Descripcin",xW="Hecho",DW="Ejecutivo shell",AW="Explicacin",OW="Exportar",RW="Februar",MW="febrero",NW="Filtrar",LW="Carpeta",BW="P.",PW="viernes",jW="CARN DE IDENTIDAD",FW="ID1",zW="ID2",UW="Importar",WW="Ejemplo",HW="Instancias",VW="Instrucciones",GW="Enero",KW="enero",JW="julio",qW="junio",YW="Lmite",XW="marzo",ZW="Mayo",QW="Men",e3="Mensaje",t3="Mes",n3="Modelo",s3="lunes",r3="Mes",i3="Ms",o3="Nombre",a3="noviembre",l3="OK",c3="octubre",u3="Okay",d3="Pausa",h3="Persona fcil de convencer",p3="Pushsafer",g3="Rebautizar",f3="Repetir",m3="Reiniciar",b3="Resultado",$3="Sa",v3="sbado",y3="Salvar",_3="Calendario",w3="Guin",C3="septiembre",S3="Simular",T3="Stack",k3="Comienzo",E3="Expresar",I3="Su",x3="domingo",D3="Telegrama",A3="4",O3="jueves",R3="Tiempo",M3="Motivado",N3="Disparadores",L3="Tu",B3="martes",P3="URL",j3="Valor",F3="Volumen",z3="3",U3="mircoles",W3="Escribir",H3="s",V3="Reconocimiento",G3="todos",K3="y",J3="astro",q3="a",Y3="control",X3="Copiar",Z3="CRON",Q3="Amanecer",e5="Este es un modo especial en el que los estados y los objetos no cambiarn. Pero solo se mostrar informacin sobre cada cambio planificado en el protocolo.",t5="Depurar",n5="Oscuridad",s5="fcil",r5="cada",i5="Funcin",o5="CARN DE IDENTIDAD",a5="Nombre",l5="Papel",c5="Habitacin",u5="hora dorada",d5="Fin de la hora dorada",h5='El cdigo se ejecutar solo cada vez que la condicin sea verdadera. P.ej. si se activa en el valor del sensor de temperatura y la condicin es "si la temperatura es superior a 20  C", las acciones "entonces" se ejecutarn cada vez que el sensor enve la temperatura y supere los 20  C. Por 21  C, por 22  C y as sucesivamente.',p5='El cdigo se ejecutar solo si cambia el resultado de la condicin. P.ej. si se activa en el valor del sensor de temperatura y la condicin es "si la temperatura es superior a 20  C", las acciones "entonces" se ejecutarn una vez cuando la temperatura sea superior a 20. La prxima vez, las acciones "entonces" se ejecutarn cuando la temperatura falla por debajo de 20 y luego sube por encima de 20 nuevamente.',g5="horas",f5="incluye",m5="intervalo",b5="magia",$5="milisegundos",v5="minutos",y5="ms",_5="nadir",w5="Amanecer nutico",C5="Atardecer nutico",S5="prximo amanecer",T5="Prxima puesta de sol",k5="Noche",E5="Fin de la noche",I5="normal",x5="compensar",D5="uno",A5="o",O5="tranquilo",R5="buscar",M5="segundos",N5="Medioda solar",L5="amanecer",B5="Final del amanecer",P5="puesta de sol",j5="Inicio al atardecer",F5="entonces",z5="Reconocer",U5="De",W5="ltimo cambio",H5="Calidad",V5="Marca de tiempo",G5="Usuario",K5="Valor",J5="dos",q5="actualizar",Y5="Agrega salida de depuracin al registro para muchos comandos del sistema",X5="Salidas de registro detalladas",Z5="cuando",Q5="Wizard",eH={"%s not found":"%s no encontrado","()":"()","(at %s)":"(en %s)","(optional)":"(Opcional)","-":"-",".":".","AI code generator":"Generador de cdigo de IA",Ack:lW,Actions:cW,"Actual time of day":"Hora real del da",Add:uW,"Add new script":"Agregar nuevo script",All:dW,"All files will be accepted":"Todos los archivos sern aceptados.",Any:hW,"Any month":"Cualquier mes",Apply:pW,April:gW,"Are you sure?":"Ests seguro?",Ask:fW,Astronomical:mW,"Astronomical events today":"Eventos astronmicos hoy",August:bW,"Blockly description":"Crear reglas por bloques grficos","Body:":"Cuerpo:",Cancel:$W,"Cannot delete non empty item!":"No se puede eliminar un elemento no vaco!","Change layout":"Cambia el diseo",'Change theme (actual "%s")':'Cambiar tema (ahora - "%s")',"Check blocks":"Comprobar bloques","Check is not active, because javascript adapter is disabled":"La comprobacin no est activa porque el adaptador Javascript est desactivado","Clear search input":"Borrar entrada de bsqueda","Click on this icon":"Haga clic en este cono",Close:vW,"Close all but current":"Cerrar todo menos el actual","Collapse all":"Desplegar todo","Compares current time with astronomical event":"Compara la hora actual con un evento astronmico","Compares current time with the user specific time":"Compara la hora actual con la hora especfica del usuario","Compares the state value with user defined value":"Compara el valor del estado con el valor definido por el usuario",Condition:yW,Conditions:_W,"Configuration not saved.":"Configuracin no guardada.",Console:wW,"Control or update some state":"Controlar o actualizar algn estado","Control or update some state with delay":"Controlar o actualizar algn estado con retraso","Convert blockly to javascript for ever.":"Convierta instantneamente en bloque a Javascript.",Copied:CW,"Copy script":"Copiar guion","Copy to clipboard":"Copiar al portapapeles","Create new":"Crear nuevo","Create new folder":"Crear nueva carpeta","Create new script":"Crear nuevo script","Create or edit CRON or time wizard":"Crear o editar CRON o asistente de tiempo","Dark Theme":"Tema oscuro","Dark style":"Estilo oscuro",Date:"Fecha","Debug instance":"Instancia de depuracin","Debug options":"Opciones de depuracin",December:SW,Default:TW,"Define cron...":"Definir cron ...","Define schedule...":"Definir horario ...",Delay:kW,Delete:EW,"Delete %s":"Eliminar %s ...","Delete folder":"Eliminar carpeta","Delete script":"Eliminar guin",Description:IW,"Deselect all":"Deseleccionar todo","Discard changes for %s":"Descartar cambios para %s",Done:xW,"Double click to write value":"Doble clic para escribir el valor","Download as file":"Descargar como archivo","Drop some files here or click...":"Suelta algunos archivos aqu o haz clic ...","Duplicate name":"Nombre duplicado","Edit script or just double click":"Editar guin o simplemente hacer doble clic","Empty name is not allowed":"No se permite el nombre vaco","End search mode":"Fin del modo de bsqueda","Enter your question":"Ingrese su solicitud",Error:"Error","Error formatting code":"Cdigo de formato de error","Error was found":"Error encontrado","Every day":"Diario",Exec:DW,"Executes some shell command":"Ejecuta algn comando de shell","Existing scripts will be overwritten.":"Los guiones existentes se sobrescribirn.","Expand all":"Expandir todo","Expert mode":"Modo experto",Explanation:AW,Export:OW,"Export all scripts":"Exportar todos los scripts","Export blocks":"Exportar bloques","Export selected blocks":"Exportar bloques seleccionados",Februar:RW,February:MW,Filter:NW,Folder:LW,Fr:BW,Friday:PW,Function:"Funcin","Function editor":"Editor de funciones","Function: executed":"Funcin: ejecutada","Go to next line":"Ir a la siguiente lnea","HTTP Call":"Llamada HTTP","Hide logs":"Ocultar registros",ID:jW,ID1:FW,ID2:zW,Import:UW,"Import blocks":"Importar bloques","Import error":"Error de importacin","Import scripts":"Importar guiones","Insert object ID":"Insertar ID de objeto",Instance:WW,"Instance is disabled":"La instancia est deshabilitada","Instance:":"Ejemplo:",Instances:HW,Instructions:VW,"Invalid CRON":"CRON invlido","It will not be possible to revert this operation.":"No ser posible revertir esta operacin.","JS description":"Crear reglas escribiendo Javascript",Januar:GW,January:KW,July:JW,June:qW,"Just check":"Slo revisa","Language:":"Idioma:","Learn More":"Aprende ms","Light style":"Estilo ligero",Limit:YW,"Local time":"Hora local","Locate file":"Localizar el archivo","Log outputs":"Salidas de registro","Log text":"Texto de registro","Log: %s":"Log: %s","Make a HTTP get request":"Realizar una solicitud de obtencin HTTP","Make a pause between actions":"Hacer una pausa entre acciones",March:XW,"March ":"marzo",May:ZW,Menu:QW,Message:e3,Mo:t3,Model:n3,Monday:s3,Month:r3,More:i3,Name:o3,"No Chat GPT Key found":"No se ha encontrado ninguna clave GPT de chat","No active host found":"No se encontr un host activo","Nothing found":"Nada Encontrado",November:a3,OK:l3,October:c3,Ok:u3,"On condition change":"En condicin de cambio","On script save or adapter start":"Al guardar el script o al iniciar el adaptador","On weekdays":"De lunes a viernes","Open configuration":"Configuracin abierta","Operate two states":"Operar dos estados","Operations with two states":"Operaciones con dos estados","Paste your blocks here":"Pega tus bloques aqu",Pause:d3,"Pause execution":"Pausar ejecucin","Pause script":"Pausar guion","Phone:":"Telfono:","Please select object ID...":"Por favor, seleccione la ID del objeto ...","Press Ctrl+Enter to get the answer":"Presiona Ctrl+Enter para obtener la respuesta","Prettify the script":"Embellecer el guin","Print some text in log":"Imprime texto en el registro","Priority:":"Prioridad:",Pushover:h3,Pushsafer:p3,"Read only ID selected: %s":"ID de solo lectura seleccionado: %s",Rename:g3,"Reorder scripts in folders":"Reordenar guiones en carpetas",Repeat:f3,Restart:m3,Result:b3,"Resume execution":"Reanudar ejecucin","Root folder":"Carpeta raz","Rules description":"Crea reglas con bloques IF, THEN, ELSE","Run script":"Ejecutar guin",Sa:$3,Saturday:v3,Save:y3,"Save all":"Salvar a todos","Say It":"Say It","Say some text via sayit adapter":"Di un mensaje de texto a travs del adaptador sayit",Schedule:_3,Script:w3,"Script %s was modified on disk":"El script %s fue modificado en el disco","Script is not running":"El script no se est ejecutando","Search in scripts":"Buscar en guiones","Search...":"Buscar...","Select all":"Seleccionar todo","Send email":"Enviar correo electrnico","Sends an email":"Enva un correo electrnico","Sends message via Pushsafer":"Enva mensaje a travs de Pushsafer","Sends message via pushover":"Enva un mensaje a travs de un pushover","Sends message via telegram":"Enva mensaje por telegrama","Sends message via whatsapp-cmb":"Enva mensaje va whatsapp-cmb",September:C3,"Server time":"Tiempo del servidor","Set state action":"Establecer accin estatal","Set with delay":"Establecer con retraso","Shell command":"Comando de Shell","Show astronomical events":"Mostrar eventos astronmicos","Show javascript code":"Mostrar cdigo Javascript","Show logs":"Mostrar registros","Show only paused scripts":"Mostrar solo secuencias de comandos pausadas","Show only running scripts":"Mostrar solo scripts en ejecucin","Show only scripts with problems":"Mostrar solo guiones con problemas",Simulate:S3,"Some files will be rejected":"Algunos archivos sern rechazados","Sound:":"Sonido:",Stack:T3,Start:k3,"Start script":"Iniciar guion",State:E3,"State condition":"Condicin del estado","Step into function":"Entra en funcin","Step out from function":"Sal de la funcin","Stop on exception":"Detngase en excepcin",Su:I3,"Subject:":"Sujeto:",Sunday:x3,"TS description":"Crear reglas escribiendo el mecanografiado",Telegram:D3,"Text:":"Texto:",Th:A3,"The script will be stopped and must be activated manually after debugging. Continue?":"El script se detendr y deber activarse manualmente despus de la depuracin. Continuar?","This is advances option. You can write your own code here and it will be executed on trigger":"Esta es la opcin de avances. Puede escribir su propio cdigo aqu y se ejecutar en el disparador",Thursday:O3,Time:R3,"Time condition":"Condicin de tiempo","Title:":"Ttulo:","To:":"A:","Trigger with value":"Activar con valor",Triggered:M3,Triggers:N3,"Triggers the on script saving or the javascript instance restart":"Activa el guardado de la secuencia de comandos o el reinicio de la instancia de JavaScript","Triggers the rule on update or change of some state":"Activa la regla de actualizacin o cambio de algn estado","Triggers the rule periodically or on some specific time":"Activa la regla peridicamente o en un momento especfico",Tu:L3,Tuesday:B3,URL:P3,"Unknown error":"Error desconocido","Unknown error!":"Error desconocido!","Use generated code":"Usar cdigo generado","User function":"Funcin de usuario","User:":"Usuario:",Value:j3,"Vibration:":"Vibracin:",Volume:F3,We:z3,Wednesday:U3,"Whatsapp-cmb":"Whatsapp-cmb",Write:W3,"Write your own code":"Escribe tu propio cdigo",Yes:H3,"Yet exists!":"Sin embargo existe!","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":"Puede usar %s en la URL para usar el valor de activacin actual, %id para usar el ID de objeto activado, %name para mostrar el nombre de ID de objeto activado o %old para usar el valor de activacin antiguo","You can use %s in the command to use current trigger value or %id to use the triggered object ID":"Puede usar %s en el comando para usar el valor de activacin actual, %id para usar el ID de objeto activado, %name para mostrar el nombre de ID de objeto activado o %old para usar el valor de activacin anterior","You can use %s in the text to display current trigger value or %id to display the triggered object ID":"Puede usar %s en el texto para mostrar el valor de activacin actual, %id para usar el ID de objeto activado, %name para mostrar el nombre de ID de objeto activado o %old para usar el valor de activacin antiguo","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":"Puede usar %s en el valor para usar el valor de activacin actual, %id para usar el ID de objeto activado, %name para mostrar el nombre de ID de objeto activado o %old para usar el valor de activacin antiguo","You have to enter OpenAI API key in the configuration of javascript adapter.":"Debe ingresar la clave API de OpenAI en la configuracin del adaptador de JavaScript.","[equal]":"[igual]","[greater or equal]":"[mayor o igual]","[greater]":"[mayor que]","[hysteresis]":"[histresis]","[includes]":"[incluye]","[less or equal]":"[menor o igual]","[less]":"[menos]","[not equal]":"[no es igual]",acknowledgment:V3,all:G3,and:K3,astro:J3,at:q3,"clear running":"carrera clara",control:Y3,copy:X3,cron:Z3,dawn:Q3,debug_help:e5,debug_label:t5,default:"defecto",dusk:n5,easy:s5,else:"dems","equal to":"igual a",every:r5,"every hour at 0 minutes":"cada hora a los 0 minutos",false:"falso","file reading has failed: %s":"la lectura del archivo ha fallado: %s","file reading was aborted":"la lectura del archivo fue abortada",filter_func:i5,filter_id:o5,filter_name:a5,filter_role:l5,filter_room:c5,"for edit or create script":"para editar o crear un nuevo script","for professionals":"para profesionales","for programmers":"para programadores",goldenHour:u5,goldenHourEnd:d5,"greater or equal":"mayor o igual","greater or equal to":"mayor o igual a","greater than":"mas grande que",help_just_check:h5,help_on_change:p5,"high priority":"alta prioridad","high-priority":"alta prioridad","highest priority":"ms alta prioridad",hours:g5,includes:f5,interval:m5,"just check":"Slo revisa","less or equal":"menor o igual","less or equal to":"menor o igual a","less than":"menos que","lower priority":"prioridad ms baja","lowest priority":"prioridad ms baja",magic:b5,milliseconds:$5,minutes:v5,ms:y5,nadir:_5,nauticalDawn:w5,nauticalDusk:C5,nextSunrise:S5,nextSunset:T5,night:k5,nightEnd:E5,"no blocks found":"No se encontraron bloques","no group":"NO GRUPO",normal:I5,"normal priority":"prioridad normal","not equal to":"no igual a","not properly connected":"Este bloque no est conectado correctamente a otros bloques.",offset:x5,"on change":"en el cambio","on condition change":"con cambio de condicin","on update":"en actualizacin",one:D5,or:A5,quiet:O5,"reset search":"restablecer la bsqueda",search:R5,seconds:M5,solarNoon:N5,"store in":"almacenar en",sunrise:L5,sunriseEnd:B5,sunset:P5,sunsetStart:j5,then:F5,"toggle value":"alternar valor",tooltip_ack:z5,tooltip_from:U5,tooltip_lc:W5,tooltip_quality:H5,tooltip_ts:V5,tooltip_user:G5,tooltip_value:K5,true:"cierto",two:J5,undefined:"indefinido",update:q5,"use seconds":"usar segundos","use trigger value":"usar valor de activacin",verbose_help:Y5,verbose_label:X5,when:Z5,with:"con","with date":"con fecha","with offset":"con desplazamiento",wizard:Q5},tH="Reconnu",nH="Actions",sH="Ajouter",rH="Tout",iH="Tout",oH="Postuler",aH="avril",lH="Demander",cH="Astronomique",uH="aot",dH="Annuler",hH="proche",pH="tat",gH="Conditions",fH="Console",mH="Copi",bH="dcembre",$H="Dfaut",vH="Retard",yH="Effacer",_H="Description",wH="Termin",CH="Exec shell",SH="Explication",TH="Exportation",kH="Fvrier",EH="fvrier",IH="Filtre",xH="Dossier",DH="Fr",AH="Vendredi",OH="ID",RH="ID1",MH="ID2",NH="Importation",LH="Exemple",BH="Instances",PH="Instructions",jH="Janvier",FH="janvier",zH="juillet",UH="juin",WH="Limite",HH="Mars",VH="Mai",GH="M e n u",KH="Message",JH="Mo",qH="Modle",YH="Lundi",XH="Mois",ZH="Plus",QH="Nom",e4="novembre",t4="OK",n4="octobre",s4="D'accord",r4="Pause",i4="Pushover",o4="Pushsafer",a4="Renommer",l4="Rpter",c4="Redmarrer",u4="Rsultat",d4="Sa",h4="samedi",p4="sauver",g4="Horaire",f4="Scnario",m4="septembre",b4="Simuler",$4="Stack",v4="Dbut",y4="tat",_4="Su",w4="dimanche",C4="Tlgramme",S4="4",T4="Jeudi",k4="Temps",E4="Dclench",I4="Dclencheurs",x4="Tu",D4="Mardi",A4="URL",O4="Valeur",R4="Le volume",M4="3",N4="Mercredi",L4="crivez",B4="Oui",P4="reconnaissance",j4="tout",F4="et",z4="astro",U4="",W4="contrler",H4="copie",V4="CRON",G4="Aube",K4="Il s'agit d'un mode spcial dans lequel les tats et les objets ne changeront pas. Mais seules les informations sur chaque changement prvu seront affiches dans le protocole.",J4="Dboguer",q4="Crpuscule",Y4="facile",X4="chaque",Z4="Une fonction",Q4="ID",e8="Nom",t8="Rle",n8="Pice",s8="Heure d'or",r8="Fin de l'heure d'or",i8="Le code ne sera excut que chaque fois que la condition est vraie. Par exemple. si dclenchement sur la valeur du capteur de temprature et que la condition est si la temprature est suprieure  20  C, les actions alors seront excutes  chaque fois que le capteur envoie la temprature et qu'elle est suprieure  20  C.  21  C,  22  C et ainsi de suite.",o8="Le code ne sera excut que si le rsultat de la condition change. Par exemple. si le dclenchement sur la valeur du capteur de temprature et que la condition est si la temprature est suprieure  20  C, les actions alors seront excutes une fois lorsque la temprature est suprieure  20. La prochaine fois, les actions alors seront excutes lorsque la temprature choue sous 20 puis remonte au-dessus de 20.",a8="les heures",l8="comprend",c8="intervalle",u8="la magie",d8="millisecondes",h8="minutes",p8="ms",g8="nadir",f8="Aube nautique",m8="Crpuscule nautique",b8="Prochain lever de soleil",$8="Prochain coucher de soleil",v8="Nuit",y8="Fin de nuit",_8="Ordinaire",w8="dcalage",C8="une",S8="ou",T8="calmer",k8="chercher",E8="secondes",I8="Midi solaire",x8="lever du soleil",D8="Fin du lever du soleil",A8="le coucher du soleil",O8="Dbut du coucher du soleil",R8="alors",M8="Reconnatre",N8="De",L8="Dernire modification",B8="Qualit",P8="Horodatage",j8="Utilisateur",F8="Valeur",z8="deux",U8="mettre  jour",W8="Ajoute une sortie de dbogage au journal pour de nombreuses commandes systme",H8="Sorties de journal dtailles",V8="lorsque",G8="Wizard",K8={"%s not found":"%s non trouv","()":"()","(at %s)":"( %s)","(optional)":"(optionnel)","-":"-",".":".","AI code generator":"Gnrateur de code IA",Ack:tH,Actions:nH,"Actual time of day":"Heure relle de la journe",Add:sH,"Add new script":"Ajouter un nouveau script",All:rH,"All files will be accepted":"Tous les fichiers seront accepts",Any:iH,"Any month":"N'importe quel mois",Apply:oH,April:aH,"Are you sure?":"tes-vous sr?",Ask:lH,Astronomical:cH,"Astronomical events today":"vnements astronomiques aujourd'hui",August:uH,"Blockly description":"Cration de rgles par blocs graphiques","Body:":"Corps:",Cancel:dH,"Cannot delete non empty item!":"Impossible de supprimer un lment non vide!","Change layout":"Changer la disposition",'Change theme (actual "%s")':'Changer de thme (maintenant - "%s")',"Check blocks":"Vrifier les blocs","Check is not active, because javascript adapter is disabled":"La vrification n'est pas active, car l'adaptateur Javascript est dsactiv","Clear search input":"Effacer la recherche","Click on this icon":"Cliquez sur cette icne",Close:hH,"Close all but current":"Ferme tout sauf courant","Collapse all":"Rduire tout","Compares current time with astronomical event":"Compare l'heure actuelle avec un vnement astronomique","Compares current time with the user specific time":"Compare l'heure actuelle avec l'heure spcifique de l'utilisateur","Compares the state value with user defined value":"Compare la valeur d'tat avec la valeur dfinie par l'utilisateur",Condition:pH,Conditions:gH,"Configuration not saved.":"Configuration non enregistre.",Console:fH,"Control or update some state":"Contrler ou mettre  jour un tat","Control or update some state with delay":"Contrler ou mettre  jour un tat avec un dlai","Convert blockly to javascript for ever.":"Convertissez instantanment en Javascript.",Copied:mH,"Copy script":"Copier le script","Copy to clipboard":"Copier dans le presse-papier","Create new":"Crer un nouveau","Create new folder":"Crer un nouveau dossier","Create new script":"Crer un nouveau script","Create or edit CRON or time wizard":"Crer ou diter CRON ou un assistant de temps","Dark Theme":"Thme sombre","Dark style":"Style sombre",Date:"Date","Debug instance":"Instance de dbogage","Debug options":"Options de dbogage",December:bH,Default:$H,"Define cron...":"Dfinir le cron ...","Define schedule...":"Dfinir le calendrier ...",Delay:vH,Delete:yH,"Delete %s":"Supprimer %s ...","Delete folder":"Supprimer le dossier","Delete script":"Supprimer le script",Description:_H,"Deselect all":"Tout dselectionner","Discard changes for %s":"Ignorer les modifications pour %s",Done:wH,"Double click to write value":"Double clic pour crire la valeur","Download as file":"Tlcharger le fichier","Drop some files here or click...":"Dposer des fichiers ici ou cliquez sur ...","Duplicate name":"Nom en double","Edit script or just double click":"Modifiez le script ou double-cliquez simplement sur","Empty name is not allowed":"Le nom vide n'est pas autoris","End search mode":"Fin du mode de recherche","Enter your question":"Entrez votre demande",Error:"Erreur","Error formatting code":"Erreur lors du formatage du code","Error was found":"Une erreur a t trouve","Every day":"Tous les jours",Exec:CH,"Executes some shell command":"Excute une commande shell","Existing scripts will be overwritten.":"Les scripts existants seront crass.","Expand all":"Dvelopper tout","Expert mode":"Mode expert",Explanation:SH,Export:TH,"Export all scripts":"Exporter tous les scripts","Export blocks":"Blocs d'exportation","Export selected blocks":"Exporter les blocs slectionns",Februar:kH,February:EH,Filter:IH,Folder:xH,Fr:DH,Friday:AH,Function:"Fonction","Function editor":"diteur de fonction","Function: executed":"Fonction: excute","Go to next line":"Aller  la ligne suivante","HTTP Call":"Appel HTTP","Hide logs":"Masquer les journaux",ID:OH,ID1:RH,ID2:MH,Import:NH,"Import blocks":"Blocs d'importation","Import error":"Erreur d'importation","Import scripts":"Importer des scripts","Insert object ID":"Insrer un identifiant d'objet",Instance:LH,"Instance is disabled":"L'instance est dsactive","Instance:":"Exemple:",Instances:BH,Instructions:PH,"Invalid CRON":"CRON invalide","It will not be possible to revert this operation.":"Il ne sera pas possible de revenir sur cette opration.","JS description":"Crer des rgles en crivant du Javascript",Januar:jH,January:FH,July:zH,June:UH,"Just check":"Vrifiez simplement","Language:":"Langue:","Learn More":"Apprendre encore plus","Light style":"Style de lumire",Limit:WH,"Local time":"Heure locale","Locate file":"Localiser le fichier","Log outputs":"Journal des sorties","Log text":"Texte du journal","Log: %s":"Log: %s","Make a HTTP get request":"Faire une requte HTTP Get","Make a pause between actions":"Faites une pause entre les actions",March:HH,"March ":"mars",May:VH,Menu:GH,Message:KH,Mo:JH,Model:qH,Monday:YH,Month:XH,More:ZH,Name:QH,"No Chat GPT Key found":"Aucune cl GPT de chat trouve","No active host found":"Aucun hte actif trouv","Nothing found":"Rien n'a t trouv",November:e4,OK:t4,October:n4,Ok:s4,"On condition change":"En cas de changement de condition","On script save or adapter start":"Lors de l'enregistrement du script ou du dmarrage de l'adaptateur","On weekdays":"En semaine","Open configuration":"Configuration ouverte","Operate two states":"Oprer deux tats","Operations with two states":"Oprations  deux tats","Paste your blocks here":"Collez vos blocs ici",Pause:r4,"Pause execution":"Suspendre l'excution","Pause script":"Script de pause","Phone:":"Tlphone:","Please select object ID...":"Veuillez slectionner l'ID d'objet ...","Press Ctrl+Enter to get the answer":"Appuyez sur Ctrl+Entre pour obtenir la rponse","Prettify the script":"Embellir le scnario","Print some text in log":"Imprimer du texte dans le journal","Priority:":"Priorit:",Pushover:i4,Pushsafer:o4,"Read only ID selected: %s":"ID en lecture seule slectionn: %s",Rename:a4,"Reorder scripts in folders":"Rorganiser les scripts dans des dossiers",Repeat:l4,Restart:c4,Result:u4,"Resume execution":"Reprendre l'excution","Root folder":"Dossier racine","Rules description":"Crer des rgles avec des blocs IF, THEN, ELSE","Run script":"Script de lancement",Sa:d4,Saturday:h4,Save:p4,"Save all":"Sauver tous","Say It":"Say It","Say some text via sayit adapter":"Dites du texte via l'adaptateur sayit",Schedule:g4,Script:f4,"Script %s was modified on disk":"Le script %s a t modifi sur le disque","Script is not running":"Le script n'est pas en cours d'excution","Search in scripts":"Rechercher dans les scripts","Search...":"Chercher...","Select all":"Tout slectionner","Send email":"Envoyer un e-mail","Sends an email":"Envoie un e-mail","Sends message via Pushsafer":"Envoie un message via Pushsafer","Sends message via pushover":"Envoie un message via pushover","Sends message via telegram":"Envoie un message par tlgramme","Sends message via whatsapp-cmb":"Envoie un message via whatsapp-cmb",September:m4,"Server time":"Heure du serveur","Set state action":"Dfinir l'action de l'tat","Set with delay":"Set avec retard","Shell command":"Commande Shell","Show astronomical events":"Afficher les vnements astronomiques","Show javascript code":"Afficher le code Javascript","Show logs":"Afficher les journaux","Show only paused scripts":"Afficher uniquement les scripts en pause","Show only running scripts":"Afficher uniquement les scripts en cours d'excution","Show only scripts with problems":"Afficher uniquement les scripts avec des problmes",Simulate:b4,"Some files will be rejected":"Certains fichiers seront rejets","Sound:":"Sonner:",Stack:$4,Start:v4,"Start script":"Lancer le script",State:y4,"State condition":"tat condition","Step into function":"Entrez dans la fonction","Step out from function":"Sortez de la fonction","Stop on exception":"Arrt sur exception",Su:_4,"Subject:":"Sujet:",Sunday:w4,"TS description":"Crer des rgles en crivant des caractres dactylographis",Telegram:C4,"Text:":"Texte:",Th:S4,"The script will be stopped and must be activated manually after debugging. Continue?":"Le script sera arrt et doit tre activ manuellement aprs le dbogage. Continuez?","This is advances option. You can write your own code here and it will be executed on trigger":"C'est une option avance. Vous pouvez crire votre propre code ici et il sera excut au dclenchement",Thursday:T4,Time:k4,"Time condition":"Condition de temps","Title:":"Titre:","To:":":","Trigger with value":"Dclencheur avec valeur",Triggered:E4,Triggers:I4,"Triggers the on script saving or the javascript instance restart":"Dclenche l'enregistrement du script ou le redmarrage de l'instance javascript","Triggers the rule on update or change of some state":"Dclenche la rgle sur la mise  jour ou le changement d'un tat","Triggers the rule periodically or on some specific time":"Dclenche la rgle priodiquement ou  une heure prcise",Tu:x4,Tuesday:D4,URL:A4,"Unknown error":"Erreur inconnue","Unknown error!":"Erreur inconnue!","Use generated code":"Utiliser le code gnr","User function":"Fonction utilisateur","User:":"Utilisateur:",Value:O4,"Vibration:":"Vibration:",Volume:R4,We:M4,Wednesday:N4,"Whatsapp-cmb":"Whatsapp-cmb",Write:L4,"Write your own code":"crivez votre propre code",Yes:B4,"Yet exists!":"Pourtant existe!","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":"Vous pouvez utiliser %s dans l'URL pour utiliser la valeur de dclenchement actuelle, %id pour utiliser l'ID de l'objet dclench, %name pour afficher le nom de l'ID de l'objet dclench ou %old pour utiliser l'ancienne valeur de dclenchement","You can use %s in the command to use current trigger value or %id to use the triggered object ID":"Vous pouvez utiliser %s dans la commande pour utiliser la valeur de dclenchement actuelle, %id pour utiliser l'ID de l'objet dclench, %name pour afficher le nom de l'ID de l'objet dclench ou %old pour utiliser l'ancienne valeur de dclenchement","You can use %s in the text to display current trigger value or %id to display the triggered object ID":"Vous pouvez utiliser %s dans le texte pour afficher la valeur de dclenchement actuelle, %id pour utiliser l'ID de l'objet dclench, %name pour afficher le nom de l'ID de l'objet dclench ou %old pour utiliser l'ancienne valeur de dclenchement","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":"Vous pouvez utiliser %s dans la valeur pour utiliser la valeur de dclenchement actuelle, %id pour utiliser l'ID de l'objet dclench, %name pour afficher le nom de l'ID de l'objet dclench ou %old pour utiliser l'ancienne valeur de dclenchement","You have to enter OpenAI API key in the configuration of javascript adapter.":"Vous devez entrer la cl API OpenAI dans la configuration de l'adaptateur javascript.","[equal]":"[gal]","[greater or equal]":"[suprieur ou gal]","[greater]":"[plus grand]","[hysteresis]":"[hystrse]","[includes]":"[comprend]","[less or equal]":"[infrieur ou gal]","[less]":"[moins]","[not equal]":"[ingal]",acknowledgment:P4,all:j4,and:F4,astro:z4,at:U4,"clear running":"course claire",control:W4,copy:H4,cron:V4,dawn:G4,debug_help:K4,debug_label:J4,default:"dfaut",dusk:q4,easy:Y4,else:"autre","equal to":"gal ",every:X4,"every hour at 0 minutes":"toutes les heures  0 minute",false:"faux","file reading has failed: %s":"La lecture du fichier a chou: %s","file reading was aborted":"la lecture du fichier a t abandonne",filter_func:Z4,filter_id:Q4,filter_name:e8,filter_role:t8,filter_room:n8,"for edit or create script":"pour diter ou crer un nouveau script","for professionals":"pour les professionnels","for programmers":"pour les programmeurs",goldenHour:s8,goldenHourEnd:r8,"greater or equal":"suprieur ou gal","greater or equal to":"suprieur ou gal ","greater than":"plus grand que",help_just_check:i8,help_on_change:o8,"high priority":"haute priorit","high-priority":"haute priorit","highest priority":"priorit la plus leve",hours:a8,includes:l8,interval:c8,"just check":"Vrifiez simplement","less or equal":"infrieur ou gal","less or equal to":"infrieur ou gal ","less than":"moins que","lower priority":"priorit infrieure","lowest priority":"priorit la plus basse",magic:u8,milliseconds:d8,minutes:h8,ms:p8,nadir:g8,nauticalDawn:f8,nauticalDusk:m8,nextSunrise:b8,nextSunset:$8,night:v8,nightEnd:y8,"no blocks found":"Aucun bloc trouv","no group":"PAS DE GROUPE",normal:_8,"normal priority":"priorit normale","not equal to":"pas gal ","not properly connected":"Ce bloc n'est pas correctement connect  d'autres blocs.",offset:w8,"on change":"sur le changement","on condition change":"sur changement de condition","on update":"sur mise  jour",one:C8,or:S8,quiet:T8,"reset search":"Rinitialiser la recherche",search:k8,seconds:E8,solarNoon:I8,"store in":"stocker dans",sunrise:x8,sunriseEnd:D8,sunset:A8,sunsetStart:O8,then:R8,"toggle value":"valeur de bascule",tooltip_ack:M8,tooltip_from:N8,tooltip_lc:L8,tooltip_quality:B8,tooltip_ts:P8,tooltip_user:j8,tooltip_value:F8,true:"vrai",two:z8,undefined:"indfini",update:U8,"use seconds":"utiliser les secondes","use trigger value":"use trigger value",verbose_help:W8,verbose_label:H8,when:V8,with:"avec","with date":"avec date","with offset":"avec offset",wizard:G8},J8="Riconosciuto",q8="Azioni",Y8="Inserisci",X8="Tutti",Z8="Qualunque",Q8="Applica",eV="aprile",tV="Chiedere",nV="Astronomico",sV="agosto",rV="Annulla",iV="Vicino",oV="Condizione",aV="Condizioni",lV="Console",cV="Copiato",uV="dicembre",dV="Predefinito",hV="Ritardo",pV="Elimina",gV="Descrizione",fV="Fatto",mV="Execshell",bV="Spiegazione",$V="Esportare",vV="Februar",yV="febbraio",_V="Filtro",wV="Cartella",CV="P",SV="Venerd",TV="ID",kV="ID1",EV="ID2",IV="Importare",xV="Esempio",DV="istanze",AV="Istruzioni",OV="Januar",RV="gennaio",MV="luglio",NV="giugno",LV="Limite",BV="marzo",PV="Maggio",jV="Menu",FV="Messaggio",zV="Mo",UV="Modello",WV="Lunedi",HV="Mese",VV="Di pi",GV="Nome",KV="novembre",JV="OK",qV="ottobre",YV="Ok",XV="Pausa",ZV="Pushover",QV="Pushsafer",eG="Rinominare",tG="Ripetere",nG="Ricomincia",sG="Risultato",rG="Sa",iG="Sabato",oG="Salva",aG="Programma",lG="copione",cG="settembre",uG="Simulare",dG="Stack",hG="Cominciare",pG="Stato",gG="Su",fG="Domenica",mG="Telegramma",bG="4",$G="giovedi",vG="Tempo",yG="Innescato",_G="Trigger",wG="Tu",CG="marted",SG="URL",TG="Valore",kG="Volume",EG="3",IG="mercoled",xG="Scrivi",DG="s",AG="riconoscimento",OG="tutti",RG="e",MG="astro",NG="a",LG="controllo",BG="copia",PG="CRON",jG="alba",FG="Questa  una modalit speciale in cui gli stati e gli oggetti non cambieranno. Ma nel protocollo verranno visualizzate solo le informazioni su ogni modifica pianificata.",zG="Debug",UG="crepuscolo",WG="facile",HG="ogni",VG="Funzione",GG="ID",KG="Nome",JG="Ruolo",qG="Camera",YG="Ora d'oro",XG="Fine dell'ora d'oro",ZG='Il codice verr eseguito solo ogni volta che la condizione  vera. Per esempio. se si attiva il valore del sensore di temperatura e la condizione  "se la temperatura  maggiore di 20  C", le azioni "allora" verranno eseguite ogni volta che il sensore invia la temperatura e questa  superiore a 20  C. Di 21  C, di 22  C e cos via.',QG='Il codice verr eseguito solo se il risultato della condizione cambia. Per esempio. se si attiva il valore del sensore di temperatura e la condizione  "se la temperatura  maggiore di 20  C", le azioni "allora" verranno eseguite una volta quando la temperatura  superiore a 20. La prossima volta le azioni "allora" verranno eseguite quando la temperatura fallisce sotto 20 e poi sale di nuovo oltre 20.',e6="ore",t6="include",n6="intervallo",s6="Magia",r6="millisecondi",i6="minuti",o6="ms",a6="nadir",l6="Alba nautica",c6="Crepuscolo nautico",u6="Prossima alba",d6="Prossimo tramonto",h6="Notte",p6="Fine della notte",g6="normale",f6="compensare",m6="uno",b6="o",$6="silenzioso",v6="ricerca",y6="secondi",_6="Mezzogiorno solare",w6="Alba",C6="Fine dell'alba",S6="tramonto",T6="Inizio del tramonto",k6="poi",E6="Riconoscere",I6="A partire dal",x6="Ultima modifica",D6="Qualit",A6="timestamp",O6="Utente",R6="Valore",M6="Due",N6="aggiornare",L6="Aggiunge l'output di debug al registro per molti comandi di sistema",B6="Output di log dettagliati",P6="quando",j6="procedura guidata",F6={"%s not found":"%s non trovato","()":"()","(at %s)":"(a %s)","(optional)":"(opzionale)","-":"-",".":".","AI code generator":"Generatore di codice AI",Ack:J8,Actions:q8,"Actual time of day":"Ora effettiva della giornata",Add:Y8,"Add new script":"Aggiungi nuovo script",All:X8,"All files will be accepted":"Tutti i file saranno accettati",Any:Z8,"Any month":"Ogni mese",Apply:Q8,April:eV,"Are you sure?":"Sei sicuro?",Ask:tV,Astronomical:nV,"Astronomical events today":"Eventi astronomici oggi",August:sV,"Blockly description":"Creazione di regole tramite blocchi grafici","Body:":"Corpo:",Cancel:rV,"Cannot delete non empty item!":"Impossibile eliminare l'elemento non vuoto!","Change layout":"Cambia layout",'Change theme (actual "%s")':'Cambia tema (ora - "%s")',"Check blocks":"Controlla i blocchi","Check is not active, because javascript adapter is disabled":"Il controllo non  attivo perch l'adattatore Javascript  disabilitato","Clear search input":"Cancella input di ricerca","Click on this icon":"Clicca su questa icona",Close:iV,"Close all but current":"Chiudi tutto tranne corrente","Collapse all":"Comprimi tutto","Compares current time with astronomical event":"Confronta l'ora corrente con l'evento astronomico","Compares current time with the user specific time":"Confronta l'ora corrente con l'ora specifica dell'utente","Compares the state value with user defined value":"Confronta il valore dello stato con il valore definito dall'utente",Condition:oV,Conditions:aV,"Configuration not saved.":"Configurazione non salvata.",Console:lV,"Control or update some state":"Controlla o aggiorna uno stato","Control or update some state with delay":"Controlla o aggiorna uno stato con ritardo","Convert blockly to javascript for ever.":"Converti istantaneamente a blocchi in Javascript.",Copied:cV,"Copy script":"Copia script","Copy to clipboard":"Copia negli appunti","Create new":"Creare nuovo","Create new folder":"Crea una nuova cartella","Create new script":"Crea nuovo script","Create or edit CRON or time wizard":"Crea o modifica la procedura guidata CRON o time","Dark Theme":"Tema scuro","Dark style":"Stile scuro",Date:"Data","Debug instance":"Istanza di debug","Debug options":"Opzioni di debug",December:uV,Default:dV,"Define cron...":"Definisci cron ...","Define schedule...":"Definisci programma ...",Delay:hV,Delete:pV,"Delete %s":"Elimina %s ...","Delete folder":"Elimina cartella","Delete script":"Elimina script",Description:gV,"Deselect all":"Deselezionare tutto","Discard changes for %s":"Annulla modifiche per %s",Done:fV,"Double click to write value":"Doppio clic per scrivere il valore","Download as file":"Scarica come file","Drop some files here or click...":"Trascina alcuni file qui o fai clic su ...","Duplicate name":"Nome duplicato","Edit script or just double click":"Modifica lo script o fai doppio clic","Empty name is not allowed":"Il nome vuoto non  consentito","End search mode":"Termina la modalit di ricerca","Enter your question":"Inserisci la tua richiesta",Error:"Errore","Error formatting code":"Errore di formattazione del codice","Error was found":"Errore trovato","Every day":"Ogni giorno",Exec:mV,"Executes some shell command":"Esegue alcuni comandi della shell","Existing scripts will be overwritten.":"Gli script esistenti verranno sovrascritti.","Expand all":"Espandi tutto","Expert mode":"Modalit esperto",Explanation:bV,Export:$V,"Export all scripts":"Esporta tutti gli script","Export blocks":"Esporta blocchi","Export selected blocks":"Esporta i blocchi selezionati",Februar:vV,February:yV,Filter:_V,Folder:wV,Fr:CV,Friday:SV,Function:"Funzione","Function editor":"Editor di funzioni","Function: executed":"Funzione: eseguita","Go to next line":"Vai alla riga successiva","HTTP Call":"Chiamata HTTP","Hide logs":"Nascondi i registri",ID:TV,ID1:kV,ID2:EV,Import:IV,"Import blocks":"Importa blocchi","Import error":"Errore di importazione","Import scripts":"Importa script","Insert object ID":"Inserisci l'ID oggetto",Instance:xV,"Instance is disabled":"L'istanza  disabilitata","Instance:":"Esempio:",Instances:DV,Instructions:AV,"Invalid CRON":"CRON non valido","It will not be possible to revert this operation.":"Non sar possibile ripristinare questa operazione.","JS description":"Creare regole scrivendo Javascript",Januar:OV,January:RV,July:MV,June:NV,"Just check":"Controlla solamente","Language:":"Linguaggio:","Learn More":"Per saperne di pi","Light style":"Stile leggero",Limit:LV,"Local time":"Ora locale","Locate file":"Localizza file","Log outputs":"Registra le uscite","Log text":"Testo del registro","Log: %s":"Log: %s","Make a HTTP get request":"Effettua una richiesta get HTTP","Make a pause between actions":"Fai una pausa tra le azioni",March:BV,"March ":"marzo",May:PV,Menu:jV,Message:FV,Mo:zV,Model:UV,Monday:WV,Month:HV,More:VV,Name:GV,"No Chat GPT Key found":"Nessuna chiave GPT chat trovata","No active host found":"Nessun host attivo trovato","Nothing found":"Non abbiamo trovato nulla",November:KV,OK:JV,October:qV,Ok:YV,"On condition change":"A condizione che cambino","On script save or adapter start":"Al salvataggio dello script o all'avvio dell'adattatore","On weekdays":"Nei giorni della settimana","Open configuration":"Configurazione aperta","Operate two states":"Gestisci due stati","Operations with two states":"Operazioni con due stati","Paste your blocks here":"Incolla qui i tuoi blocchi",Pause:XV,"Pause execution":"Metti in pausa l'esecuzione","Pause script":"Metti in pausa lo script","Phone:":"Telefono:","Please select object ID...":"Seleziona l'ID oggetto ...","Press Ctrl+Enter to get the answer":"Premi Ctrl+Invio per ottenere la risposta","Prettify the script":"Abbellire la sceneggiatura","Print some text in log":"Stampa del testo nel registro","Priority:":"Priorit:",Pushover:ZV,Pushsafer:QV,"Read only ID selected: %s":"ID di sola lettura selezionato: %s",Rename:eG,"Reorder scripts in folders":"Riordina gli script nelle cartelle",Repeat:tG,Restart:nG,Result:sG,"Resume execution":"Riprendi esecuzione","Root folder":"Cartella root","Rules description":"Crea regole con i blocchi IF, THEN, ELSE","Run script":"Esegui script",Sa:rG,Saturday:iG,Save:oG,"Save all":"Salva tutto","Say It":"Say It","Say some text via sayit adapter":"Pronuncia del testo tramite l'adattatore sayit",Schedule:aG,Script:lG,"Script %s was modified on disk":"Lo script %s  stato modificato sul disco","Script is not running":"Lo script non  in esecuzione","Search in scripts":"Cerca negli script","Search...":"Ricerca...","Select all":"Seleziona tutto","Send email":"Invia una email","Sends an email":"Invia un'e-mail","Sends message via Pushsafer":"Invia messaggio tramite Pushsafer","Sends message via pushover":"Invia messaggio tramite pushover","Sends message via telegram":"Invia messaggio tramite telegramma","Sends message via whatsapp-cmb":"Invia messaggio tramite whatsapp-cmb",September:cG,"Server time":"Ora del server","Set state action":"Imposta l'azione dello stato","Set with delay":"Impostato con ritardo","Shell command":"Comando Shell","Show astronomical events":"Mostra eventi astronomici","Show javascript code":"Mostra codice Javascript","Show logs":"Mostra i log","Show only paused scripts":"Mostra solo script in pausa","Show only running scripts":"Mostra solo gli script in esecuzione","Show only scripts with problems":"Mostra solo script con problemi",Simulate:uG,"Some files will be rejected":"Alcuni file verranno rifiutati","Sound:":"Suono:",Stack:dG,Start:hG,"Start script":"Avvia script",State:pG,"State condition":"Condizione dello stato","Step into function":"Entra in funzione","Step out from function":"Esci dalla funzione","Stop on exception":"Ferma in caso di eccezione",Su:gG,"Subject:":"Soggetto:",Sunday:fG,"TS description":"Creare regole scrivendo dattiloscritto",Telegram:mG,"Text:":"Testo:",Th:bG,"The script will be stopped and must be activated manually after debugging. Continue?":"Lo script verr interrotto e dovr essere attivato manualmente dopo il debug. Continua?","This is advances option. You can write your own code here and it will be executed on trigger":"Questa  un'opzione anticipata. Puoi scrivere il tuo codice qui e verr eseguito al trigger",Thursday:$G,Time:vG,"Time condition":"Condizione temporale","Title:":"Titolo:","To:":"Per:","Trigger with value":"Trigger con valore",Triggered:yG,Triggers:_G,"Triggers the on script saving or the javascript instance restart":"Attiva il salvataggio dello script o il riavvio dell'istanza javascript","Triggers the rule on update or change of some state":"Attiva la regola in caso di aggiornamento o modifica di uno stato","Triggers the rule periodically or on some specific time":"Attiva la regola periodicamente o in un momento specifico",Tu:wG,Tuesday:CG,URL:SG,"Unknown error":"Errore sconosciuto","Unknown error!":"Errore sconosciuto!","Use generated code":"Usa il codice generato","User function":"Funzione utente","User:":"Utente:",Value:TG,"Vibration:":"Vibrazione:",Volume:kG,We:EG,Wednesday:IG,"Whatsapp-cmb":"Whatsapp-cmb",Write:xG,"Write your own code":"Scrivi il tuo codice",Yes:DG,"Yet exists!":"Esiste ancora!","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":" possibile utilizzare %s nell'URL per utilizzare il valore di trigger corrente, %id per utilizzare l'ID dell'oggetto attivato, %name per mostrare il nome dell'ID dell'oggetto attivato o %old per utilizzare il vecchio valore di trigger","You can use %s in the command to use current trigger value or %id to use the triggered object ID":" possibile utilizzare %s nel comando per utilizzare il valore di trigger corrente, %id per utilizzare l'ID dell'oggetto attivato, %name per mostrare il nome dell'ID dell'oggetto attivato o %old per utilizzare il vecchio valore di trigger","You can use %s in the text to display current trigger value or %id to display the triggered object ID":" possibile utilizzare %s nel testo per visualizzare il valore di trigger corrente, %id per utilizzare l'ID dell'oggetto attivato, %name per mostrare il nome dell'ID dell'oggetto attivato o %old per utilizzare il vecchio valore di trigger","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":" possibile utilizzare %s nel valore per utilizzare il valore di trigger corrente, %id per utilizzare l'ID dell'oggetto attivato, %name per mostrare il nome dell'ID dell'oggetto attivato o %old per utilizzare il vecchio valore di trigger","You have to enter OpenAI API key in the configuration of javascript adapter.":"Devi inserire la chiave API OpenAI nella configurazione dell'adattatore javascript.","[equal]":"[pari]","[greater or equal]":"[maggiore o uguale]","[greater]":"[maggiore]","[hysteresis]":"[isteresi]","[includes]":"[include]","[less or equal]":"[minore o uguale]","[less]":"[Di meno]","[not equal]":"[non uguale]",acknowledgment:AG,all:OG,and:RG,astro:MG,at:NG,"clear running":"chiara esecuzione",control:LG,copy:BG,cron:PG,dawn:jG,debug_help:FG,debug_label:zG,default:"predefinito",dusk:UG,easy:WG,else:"altro","equal to":"uguale a",every:HG,"every hour at 0 minutes":"ogni ora a 0 minuti",false:"falso","file reading has failed: %s":"lettura file non riuscita: %s","file reading was aborted":"la lettura del file  stata interrotta",filter_func:VG,filter_id:GG,filter_name:KG,filter_role:JG,filter_room:qG,"for edit or create script":"per modificare o creare un nuovo script","for professionals":"per i professionisti","for programmers":"per i programmatori",goldenHour:YG,goldenHourEnd:XG,"greater or equal":"maggiore o uguale","greater or equal to":"maggiore o uguale a","greater than":"pi grande di",help_just_check:ZG,help_on_change:QG,"high priority":"priorit alta","high-priority":"priorit alta","highest priority":"massima priorit",hours:e6,includes:t6,interval:n6,"just check":"controlla solamente","less or equal":"inferiore o uguale","less or equal to":"minore o uguale a","less than":"meno di","lower priority":"priorit inferiore","lowest priority":"priorit pi bassa",magic:s6,milliseconds:r6,minutes:i6,ms:o6,nadir:a6,nauticalDawn:l6,nauticalDusk:c6,nextSunrise:u6,nextSunset:d6,night:h6,nightEnd:p6,"no blocks found":"Nessun blocco trovato","no group":"NESSUN GRUPPO",normal:g6,"normal priority":"priorit normale","not equal to":"non uguale a","not properly connected":"Questo blocco non  correttamente collegato ad altri blocchi.",offset:f6,"on change":"sul cambiamento","on condition change":"a cambio di condizione","on update":"in aggiornamento",one:m6,or:b6,quiet:$6,"reset search":"resetta la ricerca",search:v6,seconds:y6,solarNoon:_6,"store in":"conservare in",sunrise:w6,sunriseEnd:C6,sunset:S6,sunsetStart:T6,then:k6,"toggle value":"alterna valore",tooltip_ack:E6,tooltip_from:I6,tooltip_lc:x6,tooltip_quality:D6,tooltip_ts:A6,tooltip_user:O6,tooltip_value:R6,true:"vero",two:M6,undefined:"non definito",update:N6,"use seconds":"usa i secondi","use trigger value":"usa il trigger",verbose_help:L6,verbose_label:B6,when:P6,with:"con","with date":"con data","with offset":"con offset",wizard:j6},z6="Erkend",U6="Acties",W6="Toevoegen",H6="Alle",V6="Ieder",G6="Solliciteer",K6="april",J6="Vragen",q6="Astronomisch",Y6="augustus",X6="annuleren",Z6="Dichtbij",Q6="Staat",e9="Voorwaarden",t9="Troosten",n9="Gekopieerd",s9="december",r9="Standaard",i9="Vertraging",o9="Verwijder",a9="Beschrijving",l9="Gedaan",c9="Exec shell",u9="Uitleg",d9="Exporteren",h9="Februari",p9="februari",g9="Filter",f9="Map",m9="Vr",b9="vrijdag",$9="ID kaart",v9="ID1",y9="ID2",_9="Importeren",w9="Voorbeeld",C9="Instanties",S9="Instructies",T9="Januar",k9="januari",E9="juli",I9="juni",x9="Begrenzing",D9="maart",A9="mei",O9="Menu",R9="Bericht",M9="Ma",N9="Model",L9="maandag",B9="Maand",P9="Meer",j9="Naam",F9="november",z9="OK",U9="oktober",W9="OK",H9="Pauze",V9="Pushover",G9="Duwijzer",K9="andere naam geven",J9="Herhaling",q9="Herstarten",Y9="Resultaat",X9="Za",Z9="zaterdag",Q9="Opslaan",e7="Schema",t7="Script",n7="september",s7="Simuleren",r7="Stack",i7="Begin",o7="Staat",a7="Zo",l7="zondag",c7="Telegram",u7="4",d7="donderdag",h7="Tijd",p7="Veroorzaakt",g7="Triggers",f7="Di",m7="dinsdag",b7="URL",$7="Waarde",v7="Volume",y7="3",_7="woensdag",w7="Schrijven",C7="Ja",S7="erkenning",T7="alle",k7="en",E7="astro",I7="Bij",x7="controle",D7="kopiren",A7="cron",O7="dageraad",R7="Dit is een speciale modus waarin toestanden en objecten niet veranderen. Maar alleen informatie over elke geplande wijziging wordt in het protocol weergegeven.",M7="Debuggen",N7="schemer",L7="eenvoudig",B7="elke",P7="Functie",j7="ID kaart",F7="Naam",z7="Rol",U7="Kamer",W7="gouden uur",H7="Einde van gouden uur",V7='De code wordt alleen uitgevoerd als de voorwaarde waar is. Bijv. als het triggeren op de temperatuursensorwaarde en de conditie is "als de temperatuur hoger is dan 20  C", zullen de "dan" acties worden uitgevoerd elke keer dat de sensor de temperatuur verzendt en deze hoger is dan 20  C. Bij 21  C, bij 22  C enzovoort.',G7='De code wordt alleen uitgevoerd als het conditieresultaat verandert. Bijv. als de temperatuursensor wordt geactiveerd en de conditie is "als de temperatuur hoger is dan 20  C", worden de "dan" -acties eenmaal uitgevoerd wanneer de temperatuur hoger is dan 20. De volgende keer worden de "dan" -acties uitgevoerd wanneer de temperatuur faalt onder de 20 en stijgt dan weer boven de 20.',K7="uren",J7="omvat",q7="interval",Y7="magie",X7="milliseconden",Z7="minuten",Q7="ms",eK="nadir",tK="Nautische dageraad",nK="Nautische schemering",sK="Volgende zonsopgang",rK="Volgende zonsondergang",iK="nacht",oK="Einde van de nacht",aK="normaal",lK="compensatie",cK="een",uK="of",dK="stil",hK="zoeken",pK="seconden",gK="Zonne-middag",fK="zonsopkomst",mK="Einde zonsopgang",bK="zonsondergang",$K="Begin van de zonsondergang",vK="vervolgens",yK="Erkennen",_K="Van",wK="Laatst gewijzigd",CK="Kwaliteit",SK="tijdstempel",TK="Gebruiker",kK="Waarde",EK="twee",IK="bijwerken",xK="Voegt foutopsporingsuitvoer toe aan het logboek voor veel systeemopdrachten",DK="Uitgebreide log-uitgangen",AK="wanneer",OK="tovenaar",RK={"%s not found":"%s niet gevonden","()":"()","(at %s)":"(op %s)","(optional)":"(optioneel)","-":"-",".":".","AI code generator":"AI-codegenerator",Ack:z6,Actions:U6,"Actual time of day":"Werkelijke tijd van de dag",Add:W6,"Add new script":"Nieuw script toevoegen",All:H6,"All files will be accepted":"Alle bestanden worden geaccepteerd",Any:V6,"Any month":"Elke maand",Apply:G6,April:K6,"Are you sure?":"Weet je zeker dat?",Ask:J6,Astronomical:q6,"Astronomical events today":"Astronomische gebeurtenissen vandaag",August:Y6,"Blockly description":"Regels maken door grafische blokken","Body:":"Lichaam:",Cancel:X6,"Cannot delete non empty item!":"Kan niet leeg item niet verwijderen!","Change layout":"Opmaak veranderen",'Change theme (actual "%s")':'Thema wijzigen (nu - "%s")',"Check blocks":"Controleer blokken","Check is not active, because javascript adapter is disabled":"Controle is niet actief, omdat Javascript-adapter is uitgeschakeld","Clear search input":"Zoekopdracht wissen","Click on this icon":"Klik op dit pictogram",Close:Z6,"Close all but current":"Alles sluiten behalve huidig","Collapse all":"Alles inklappen","Compares current time with astronomical event":"Vergelijkt huidige tijd met astronomische gebeurtenis","Compares current time with the user specific time":"Vergelijkt de huidige tijd met de gebruikerspecifieke tijd","Compares the state value with user defined value":"Vergelijkt de statuswaarde met de door de gebruiker gedefinieerde waarde",Condition:Q6,Conditions:e9,"Configuration not saved.":"Configuratie niet opgeslagen.",Console:t9,"Control or update some state":"Beheer of update een bepaalde staat","Control or update some state with delay":"Beheer of update een bepaalde staat met vertraging","Convert blockly to javascript for ever.":"Converteer direct blockly naar Javascript.",Copied:n9,"Copy script":"Kopieer script","Copy to clipboard":"Kopieer naar klembord","Create new":"Maak nieuw","Create new folder":"Maak een nieuwe map","Create new script":"Maak een nieuw script","Create or edit CRON or time wizard":"Creer of bewerk CRON of tijdwizard","Dark Theme":"Donker thema","Dark style":"Donkere stijl",Date:"Datum","Debug instance":"Debug-instantie","Debug options":"Foutopsporingsopties",December:s9,Default:r9,"Define cron...":"Definieer cron ...","Define schedule...":"Definieer schema ...",Delay:i9,Delete:o9,"Delete %s":"%s verwijderen ...","Delete folder":"Verwijder map","Delete script":"Script verwijderen",Description:a9,"Deselect all":"Deselecteer alles","Discard changes for %s":"Wijzigingen voor %s annuleren",Done:l9,"Double click to write value":"Dubbelklikken om waarde te schrijven","Download as file":"Download","Drop some files here or click...":"Zet hier enkele bestanden neer of klik op ...","Duplicate name":"Dubbele naam","Edit script or just double click":"Bewerk het script of dubbelklik erop","Empty name is not allowed":"Lege naam is niet toegestaan","End search mode":"Zoekmodus beindigen","Enter your question":"Voer uw verzoek in",Error:"Fout","Error formatting code":"Fout bij het opmaken van de code","Error was found":"Er is een fout gevonden","Every day":"Elke dag",Exec:c9,"Executes some shell command":"Voert een shell-commando uit","Existing scripts will be overwritten.":"Bestaande scripts worden overschreven.","Expand all":"Alles uitvouwen","Expert mode":"Expert modus",Explanation:u9,Export:d9,"Export all scripts":"Exporteer alle scripts","Export blocks":"Blokken exporteren","Export selected blocks":"Exporteer geselecteerde blokken",Februar:h9,February:p9,Filter:g9,Folder:f9,Fr:m9,Friday:b9,Function:"Functie","Function editor":"Functie-editor","Function: executed":"Functie: uitgevoerd","Go to next line":"Ga naar de volgende regel","HTTP Call":"HTTP-oproep","Hide logs":"Verberg logboeken",ID:$9,ID1:v9,ID2:y9,Import:_9,"Import blocks":"Blokken importeren","Import error":"Importfout","Import scripts":"Scripts importeren","Insert object ID":"Object-ID invoegen",Instance:w9,"Instance is disabled":"Exemplaar is uitgeschakeld","Instance:":"Voorbeeld:",Instances:C9,Instructions:S9,"Invalid CRON":"Ongeldige CRON","It will not be possible to revert this operation.":"Het is niet mogelijk om deze bewerking terug te zetten.","JS description":"Regels maken door Javascript te schrijven",Januar:T9,January:k9,July:E9,June:I9,"Just check":"Kijk maar","Language:":"Taal:","Learn More":"Leer meer","Light style":"Lichte stijl",Limit:x9,"Local time":"Lokale tijd","Locate file":"Vind het bestand","Log outputs":"Log uitgangen","Log text":"Log tekst","Log: %s":"Logboek: %s","Make a HTTP get request":"Maak een HTTP-ophaalverzoek","Make a pause between actions":"Pauzeer tussen acties",March:D9,"March ":"maart",May:A9,Menu:O9,Message:R9,Mo:M9,Model:N9,Monday:L9,Month:B9,More:P9,Name:j9,"No Chat GPT Key found":"Geen Chat GPT-sleutel gevonden","No active host found":"Geen actieve host gevonden","Nothing found":"Niets gevonden",November:F9,OK:z9,October:U9,Ok:W9,"On condition change":"Op voorwaarde verandering","On script save or adapter start":"Bij het opslaan van het script of het starten van de adapter","On weekdays":"Op weekdagen","Open configuration":"Configuratie openen","Operate two states":"Bedien twee toestanden:","Operations with two states":"Bewerkingen met twee toestanden","Paste your blocks here":"Plak hier je blokken",Pause:H9,"Pause execution":"Uitvoering pauzeren","Pause script":"Pauzeer script","Phone:":"Telefoon:","Please select object ID...":"Selecteer object-ID ...","Press Ctrl+Enter to get the answer":"Druk op Ctrl+Enter om het antwoord te krijgen","Prettify the script":"Maak het script mooier","Print some text in log":"Druk wat tekst af in het logboek","Priority:":"Prioriteit:",Pushover:V9,Pushsafer:G9,"Read only ID selected: %s":"Alleen-lezen ID geselecteerd: %s",Rename:K9,"Reorder scripts in folders":"Sorteer scripts in mappen opnieuw",Repeat:J9,Restart:q9,Result:Y9,"Resume execution":"Uitvoering hervatten","Root folder":"Hoofdmap","Rules description":"Maak regels met IF, THEN, ELSE blokken","Run script":"Voer script uit",Sa:X9,Saturday:Z9,Save:Q9,"Save all":"Sla alles op","Say It":"Say It","Say some text via sayit adapter":"Zeg wat tekst via de sayit-adapter",Schedule:e7,Script:t7,"Script %s was modified on disk":"Script %s is gewijzigd op schijf","Script is not running":"Script is niet actief","Search in scripts":"Zoeken in scripts","Search...":"Zoeken...","Select all":"Selecteer alles","Send email":"E-mail verzenden","Sends an email":"Stuurt een e-mail","Sends message via Pushsafer":"Stuurt bericht via Pushsafer","Sends message via pushover":"Stuurt bericht via pushover","Sends message via telegram":"Verzendt bericht via telegram","Sends message via whatsapp-cmb":"Stuurt bericht via whatsapp-cmb",September:n7,"Server time":"Servertijd","Set state action":"Stel statusactie in","Set with delay":"Met vertraging ingesteld","Shell command":"Shell-opdracht","Show astronomical events":"Laat astronomische gebeurtenissen zien","Show javascript code":"Javascript-code weergeven","Show logs":"Toon logboeken","Show only paused scripts":"Toon alleen onderbroken scripts","Show only running scripts":"Toon alleen actieve scripts","Show only scripts with problems":"Toon alleen scripts met problemen",Simulate:s7,"Some files will be rejected":"Sommige bestanden worden geweigerd","Sound:":"Geluid:",Stack:r7,Start:i7,"Start script":"Start het script",State:o7,"State condition":"Staat staat","Step into function":"Stap in functie","Step out from function":"Stap uit de functie","Stop on exception":"Stop bij uitzondering",Su:a7,"Subject:":"Onderwerpen:",Sunday:l7,"TS description":"Regels maken door Typescript te schrijven",Telegram:c7,"Text:":"Tekst:",Th:u7,"The script will be stopped and must be activated manually after debugging. Continue?":"Het script wordt gestopt en moet na het debuggen handmatig worden geactiveerd. Doorgaan met?","This is advances option. You can write your own code here and it will be executed on trigger":"Dit is een voorschotoptie. U kunt hier uw eigen code schrijven en deze wordt bij een trigger uitgevoerd",Thursday:d7,Time:h7,"Time condition":"Tijdsvoorwaarde","Title:":"Titel:","To:":"Naar:","Trigger with value":"Trigger met waarde",Triggered:p7,Triggers:g7,"Triggers the on script saving or the javascript instance restart":"Activeert het opslaan van het script of het opnieuw opstarten van de JavaScript-instantie","Triggers the rule on update or change of some state":"Activeert de regel voor het bijwerken of wijzigen van een bepaalde staat","Triggers the rule periodically or on some specific time":"Activeert de regel periodiek of op een specifieke tijd",Tu:f7,Tuesday:m7,URL:b7,"Unknown error":"Onbekende fout","Unknown error!":"Onbekende fout!","Use generated code":"Gebruik gegenereerde code","User function":"Gebruikersfunctie","User:":"Gebruiker:",Value:$7,"Vibration:":"Trilling:",Volume:v7,We:y7,Wednesday:_7,"Whatsapp-cmb":"Whatsapp-cmb",Write:w7,"Write your own code":"Schrijf je eigen code",Yes:C7,"Yet exists!":"Toch bestaat!","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":"U kunt %s in de URL gebruiken om de huidige triggerwaarde te gebruiken, %id om de geactiveerde object-ID te gebruiken, %name om de geactiveerde object-ID-naam te tonen of %old om de oude triggerwaarde te gebruiken","You can use %s in the command to use current trigger value or %id to use the triggered object ID":"U kunt %s in de opdracht gebruiken om de huidige triggerwaarde te gebruiken, %id om de getriggerde object-ID te gebruiken, %name om de getriggerde object-ID-naam te tonen of %old om de oude triggerwaarde te gebruiken","You can use %s in the text to display current trigger value or %id to display the triggered object ID":"U kunt %s in de tekst gebruiken om de huidige triggerwaarde weer te geven, %id om de geactiveerde object-ID te gebruiken, %name om de geactiveerde object-ID-naam weer te geven of %old om de oude triggerwaarde te gebruiken","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":"U kunt %s in de waarde gebruiken om de huidige triggerwaarde te gebruiken, %id om de geactiveerde object-ID te gebruiken, %name om de geactiveerde object-ID-naam te tonen of %old om de oude triggerwaarde te gebruiken","You have to enter OpenAI API key in the configuration of javascript adapter.":"U moet de OpenAI API-sleutel invoeren in de configuratie van de javascript-adapter.","[equal]":"[Gelijk]","[greater or equal]":"[groter of gelijk]","[greater]":"[groter]","[hysteresis]":"[hysterese]","[includes]":"[inclusief]","[less or equal]":"[minder of gelijk]","[less]":"[minder]","[not equal]":"[niet gelijk]",acknowledgment:S7,all:T7,and:k7,astro:E7,at:I7,"clear running":"duidelijk rennen",control:x7,copy:D7,cron:A7,dawn:O7,debug_help:R7,debug_label:M7,default:"standaard",dusk:N7,easy:L7,else:"anders","equal to":"gelijk aan",every:B7,"every hour at 0 minutes":"elk uur op 0 minuten",false:"false","file reading has failed: %s":"bestands lezen is mislukt: %s","file reading was aborted":"bestands lezen is afgebroken",filter_func:P7,filter_id:j7,filter_name:F7,filter_role:z7,filter_room:U7,"for edit or create script":"voor bewerken of een nieuw script maken","for professionals":"voor professionals","for programmers":"voor programmeurs",goldenHour:W7,goldenHourEnd:H7,"greater or equal":"groter of gelijk","greater or equal to":"groter of gelijk aan","greater than":"groter dan",help_just_check:V7,help_on_change:G7,"high priority":"hoge prioriteit","high-priority":"hoge prioriteit","highest priority":"hoogste prioriteit",hours:K7,includes:J7,interval:q7,"just check":"kijk maar","less or equal":"minder of gelijk","less or equal to":"minder of gelijk aan","less than":"minder dan","lower priority":"lagere prioriteit","lowest priority":"laagste prioriteit",magic:Y7,milliseconds:X7,minutes:Z7,ms:Q7,nadir:eK,nauticalDawn:tK,nauticalDusk:nK,nextSunrise:sK,nextSunset:rK,night:iK,nightEnd:oK,"no blocks found":"Geen blokken gevonden","no group":"GEEN GROEP",normal:aK,"normal priority":"normale prioriteit","not equal to":"niet gelijk aan","not properly connected":"Dit blok is niet correct verbonden met andere blokken.",offset:lK,"on change":"bij verandering","on condition change":"op voorwaarde verandering","on update":"bij update",one:cK,or:uK,quiet:dK,"reset search":"reset zoeken",search:hK,seconds:pK,solarNoon:gK,"store in":"opslaan in",sunrise:fK,sunriseEnd:mK,sunset:bK,sunsetStart:$K,then:vK,"toggle value":"schakelwaarde",tooltip_ack:yK,tooltip_from:_K,tooltip_lc:wK,tooltip_quality:CK,tooltip_ts:SK,tooltip_user:TK,tooltip_value:kK,true:"waar",two:EK,undefined:"ongedefinieerd",update:IK,"use seconds":"gebruik seconden","use trigger value":"triggerwaarde gebruiken",verbose_help:xK,verbose_label:DK,when:AK,with:"met","with date":"met datum","with offset":"met offset",wizard:OK},MK="Potwierdzony",NK="Dziaania",LK="Dodaj",BK="Wszystko",PK="Kady",jK="Zastosuj",FK="Kwiecie",zK="Zapyta",UK="Astronomiczny",WK="Sierpie",HK="Odwoaj",VK="Zamknij",GK="Stan",KK="Warunki",JK="Konsola",qK="Skopiowano",YK="Grudzie",XK="Domylna",ZK="Opnienie",QK="Usu",eJ="Opis",tJ="Gotowe",nJ="Uruchom shell",sJ="Wyjanienie",rJ="Eksport",iJ="Luty",oJ="Luty",aJ="Filtr",lJ="Folder",cJ="Pt",uJ="Pitek",dJ="ID",hJ="ID1",pJ="ID2",gJ="Import",fJ="Instancja",mJ="Instancje",bJ="Instrukcje",$J="Stycze",vJ="Stycze",yJ="Lipiec",_J="Czerwiec",wJ="Limit",CJ="Marzec",SJ="Maj",TJ="Menu",kJ="Wiadomo",EJ="Po",IJ="Model",xJ="Poniedziaek",DJ="Miesic",AJ="Wicej",OJ="Nazwa",RJ="Listopad",MJ="OK",NJ="Padziernik",LJ="Ok",BJ="Pauza",PJ="Pushover",jJ="Pushsafer",FJ="Przemianuj",zJ="Powtrz",UJ="Uruchom ponownie",WJ="Wynik",HJ="So",VJ="Sobota",GJ="Zapisz",KJ="Harmonogram",JJ="Skrypt",qJ="Wrzesie",YJ="Symulacja",XJ="Stos",ZJ="Pocztek",QJ="Stan",eq="Nd",tq="Niedziela",nq="Telegram",sq="Cz",rq="Czwartek",iq="Czas",oq="Wyzwolony",aq="Wyzwalacze",lq="Wt",cq="Wtorek",uq="URL",dq="Warto",hq="Wolumen",pq="r",gq="roda",fq="Pisa",mq="Tak",bq="potwierdzenie",$q="wszystko",vq="i",yq="Astro",_q="w",wq="kontrola",Cq="Kopiuj",Sq="CRON",Tq="wit",kq="Jest to specjalny tryb, w ktrym stany i obiekty si nie zmieniaj. Jednak w protokole bd wywietlane tylko informacje o kadej planowanej zmianie.",Eq="Odpluskwi",Iq="Zmierzch",xq="atwy",Dq="kady",Aq="Funkcja",Oq="ID",Rq="Nazwa",Mq="Rola",Nq="Pokj",Lq="Zota godzina",Bq="Koniec zotej godziny",Pq="Kod zostanie wykonany tylko za kadym razem, gdy warunek bdzie speniony. Na przykad. jeli wyzwalanie na warto czujnika temperatury i warunek to jeli temperatura jest wysza ni 20  C, to dziaania nastpnie bd wykonywane za kadym razem, gdy czujnik wyle temperatur i jest powyej 20  C. O 21  C, o 22  C i tak dalej.",jq="Kod zostanie wykonany tylko wtedy, gdy wynik warunku ulegnie zmianie. Na przykad. jeli wyzwalanie na warto czujnika temperatury i warunek jeli temperatura jest wysza ni 20  C, to akcje nastpnie zostan wykonane raz, gdy temperatura przekroczy 20. Nastpnym razem dziaania nastpnie zostan wykonane, gdy temperatura nie udaje si poniej 20, a nastpnie ponownie wzrasta powyej 20.",Fq="godziny",zq="zawiera",Uq="interwa",Wq="magia",Hq="milisekund",Vq="minuty",Gq="ms",Kq="Pnoc soneczna",Jq="eglarski wit",qq="eglarski zmierzch",Yq="Nastpny wschd soca",Xq="Nastpny zachd soca",Zq="Noc",Qq="Koniec nocy",eY="normalny",tY="przesunicie",nY="jeden",sY="lub",rY="cisza",iY="Szukaj",oY="sekundy",aY="Poudnie soneczne",lY="Wschd soca",cY="Koniec wschodu soca",uY="Zachd soca",dY="Pocztek zachodu soca",hY="nastpnie",pY="Akceptuj",gY="Od",fY="Ostatnia zmiana",mY="Jako",bY="Znacznik czasu",$Y="Uytkownik",vY="Warto",yY="dwa",_Y="aktualizacja",wY="Dodaje wyniki debugowania do dziennika dla wielu polece systemowych",CY="Pene dane wyjciowe dziennika",SY="gdy",TY="Wizard",kY={"%s not found":"%s nie znaleziono","()":"()","(at %s)":"(w %s)","(optional)":"(opcjonalny)","-":"-",".":".","AI code generator":"Generator kodu AI",Ack:MK,Actions:NK,"Actual time of day":"Aktualna pora dnia",Add:LK,"Add new script":"Dodaj nowy skrypt",All:BK,"All files will be accepted":"Wszystkie pliki zostan zaakceptowane",Any:PK,"Any month":"Dowolny miesic",Apply:jK,April:FK,"Are you sure?":"Jeste pewny?",Ask:zK,Astronomical:UK,"Astronomical events today":"Wydarzenia astronomiczne dzisiaj",August:WK,"Blockly description":"Tworzenie regu za pomoc blokw graficznych","Body:":"Tre:",Cancel:HK,"Cannot delete non empty item!":"Nie mona usun niepustego elementu!","Change layout":"Zmiana ukadu",'Change theme (actual "%s")':"Zmie motyw (obecnie - %s)","Check blocks":"Sprawd bloki","Check is not active, because javascript adapter is disabled":"Sprawdzanie nie jest aktywne, poniewa adapter Javascript jest wyczony","Clear search input":"Wyczy dane wyszukiwania","Click on this icon":"Kliknij t ikon",Close:VK,"Close all but current":"Zamknij wszystkie oprcz biecych","Collapse all":"Zwin wszystkie","Compares current time with astronomical event":"Porwnuje aktualny czas z wydarzeniem astronomicznym","Compares current time with the user specific time":"Porwnuje aktualny czas z czasem okrelonym przez uytkownika","Compares the state value with user defined value":"Porwnuje warto stanu z wartoci zdefiniowan przez uytkownika",Condition:GK,Conditions:KK,"Configuration not saved.":"Konfiguracja nie zostaa zapisana.",Console:JK,"Control or update some state":"Kontroluj lub aktualizuj stan","Control or update some state with delay":"Kontroluj lub aktualizuj jaki stan z opnieniem","Convert blockly to javascript for ever.":"Bezpowrotna konwersja Blockly na Javascript.",Copied:qK,"Copy script":"Skopiuj skrypt","Copy to clipboard":"Skopiuj do schowka","Create new":"Utwrz nowy","Create new folder":"Utwrz nowy folder","Create new script":"Utwrz nowy skrypt","Create or edit CRON or time wizard":"Utwrz lub edytuj CRON lub kreator czasu","Dark Theme":"Ciemny schemat","Dark style":"Ciemny styl",Date:"Data","Debug instance":"Debuguj instancj","Debug options":"Opcje debugowania",December:YK,Default:XK,"Define cron...":"Zdefiniuj CRON ...","Define schedule...":"Zdefiniuj harmonogram ...",Delay:ZK,Delete:QK,"Delete %s":"Usu %s ...","Delete folder":"Usu folder","Delete script":"Usu skrypt",Description:eJ,"Deselect all":"Odznacz wszystkie","Discard changes for %s":"Odrzu zmiany dla %s",Done:tJ,"Double click to write value":"Kliknij dwukrotnie, aby zapisa warto","Download as file":"Download jako plik plik","Drop some files here or click...":"Upu niektre pliki tutaj lub kliknij ...","Duplicate name":"Duplikat nazwy","Edit script or just double click":"Edytuj skrypt lub po prostu kliknij dwukrotnie","Empty name is not allowed":"Pusta nazwa jest niedozwolona","End search mode":"Zakocz tryb wyszukiwania","Enter your question":"Wpisz swoj prob",Error:"Bd","Error formatting code":"Bd formatowania kodu","Error was found":"Bd zosta znaleziony","Every day":"Codziennie",Exec:nJ,"Executes some shell command":"Wykonuje polecenie powoki","Existing scripts will be overwritten.":"Istniejce skrypty zostan zastpione.","Expand all":"Rozwi wszystkie","Expert mode":"Tryb ekspercki",Explanation:sJ,Export:rJ,"Export all scripts":"Wyeksportuj wszystkie skrypty","Export blocks":"Eksportuj bloki","Export selected blocks":"Eksportuj wybrane bloki",Februar:iJ,February:oJ,Filter:aJ,Folder:lJ,Fr:cJ,Friday:uJ,Function:"Funkcja","Function editor":"Edytor funkcji","Function: executed":"Funkcja: wykonywana","Go to next line":"Przejd do nastpnej linii","HTTP Call":"Poczenie HTTP","Hide logs":"Ukryj dzienniki",ID:dJ,ID1:hJ,ID2:pJ,Import:gJ,"Import blocks":"Importuj bloki","Import error":"Bd importowania","Import scripts":"Importuj skrypty","Insert object ID":"Wstaw identyfikator obiektu",Instance:fJ,"Instance is disabled":"Instancja jest wyczona","Instance:":"Instancja:",Instances:mJ,Instructions:bJ,"Invalid CRON":"Nieprawidowy CRON","It will not be possible to revert this operation.":"Cofnicie tej operacji nie bdzie moliwe.","JS description":"Tworzenie regu w Javascript",Januar:$J,January:vJ,July:yJ,June:_J,"Just check":"Po prostu sprawd","Language:":"Jzyk:","Learn More":"Ucz si wicej","Light style":"Lekki styl",Limit:wJ,"Local time":"Czas lokalny","Locate file":"Znajd plik","Log outputs":"Log dziennika","Log text":"Tekst dziennika","Log: %s":"Dziennik: %s","Make a HTTP get request":"Z danie HTTP get","Make a pause between actions":"Zrb przerw midzy czynnociami",March:CJ,"March ":"Marzec ",May:SJ,Menu:TJ,Message:kJ,Mo:EJ,Model:IJ,Monday:xJ,Month:DJ,More:AJ,Name:OJ,"No Chat GPT Key found":"Nie znaleziono klucza GPT czatu","No active host found":"Nie znaleziono aktywnego hosta","Nothing found":"Nic nie znaleziono",November:RJ,OK:MJ,October:NJ,Ok:LJ,"On condition change":"W przypadku zmiany warunkw","On script save or adapter start":"Podczas zapisywania skryptu lub uruchamiania adaptera","On weekdays":"W dni powszednie","Open configuration":"Otwarta konfiguracja","Operate two states":"Obsuguj dwa stany","Operations with two states":"Operacje z dwoma stanami","Paste your blocks here":"Wklej tutaj swoje bloki",Pause:BJ,"Pause execution":"Wstrzymaj wykonanie","Pause script":"Wstrzymaj skrypt","Phone:":"Telefon:","Please select object ID...":"Wybierz identyfikator obiektu ...","Press Ctrl+Enter to get the answer":"Nacinij klawisze Ctrl+Enter, aby uzyska odpowied","Prettify the script":"Upiksz skrypt","Print some text in log":"Wydrukuj tekst w dzienniku","Priority:":"Priorytet:",Pushover:PJ,Pushsafer:jJ,"Read only ID selected: %s":"Wybrano identyfikator tylko do odczytu: %s",Rename:FJ,"Reorder scripts in folders":"Zmie kolejno skryptw w folderach",Repeat:zJ,Restart:UJ,Result:WJ,"Resume execution":"Wznw wykonanie","Root folder":"Folder gwny","Rules description":"Twrz reguy z blokami IF, THEN, ELSE","Run script":"Uruchom skrypt",Sa:HJ,Saturday:VJ,Save:GJ,"Save all":"Zapisz wszystko","Say It":"Wypowiedz","Say some text via sayit adapter":"Powiedz tekst przez adapter sayit",Schedule:KJ,Script:JJ,"Script %s was modified on disk":"Skrypt %s zosta zmodyfikowany na dysku","Script is not running":"Skrypt nie dziaa","Search in scripts":"Szukaj w skryptach","Search...":"Szukaj...","Select all":"Zaznacz wszystko","Send email":"Wysa email","Sends an email":"Wysya e-mail","Sends message via Pushsafer":"Wysya wiadomo przez Pushsafer","Sends message via pushover":"Wysya wiadomo przez pushover","Sends message via telegram":"Wysya wiadomo telegramem","Sends message via whatsapp-cmb":"Wysya wiadomo przez WhatsApp-cmb",September:qJ,"Server time":"Czas serwera","Set state action":"Ustaw stan dziaania","Set with delay":"Ustaw z opnieniem","Shell command":"Polecenie powoki","Show astronomical events":"Poka wydarzenia astronomiczne","Show javascript code":"Poka kod JavaScript","Show logs":"Poka dzienniki","Show only paused scripts":"Poka tylko wstrzymane skrypty","Show only running scripts":"Poka tylko dziaajce skrypty","Show only scripts with problems":"Poka tylko skrypty z problemami",Simulate:YJ,"Some files will be rejected":"Niektre pliki zostan odrzucone","Sound:":"Dwik:",Stack:XJ,Start:ZJ,"Start script":"Uruchom skrypt",State:QJ,"State condition":"Warunek stanu","Step into function":"Wejd do funkcji","Step out from function":"Wyjd z funkcji","Stop on exception":"Zatrzymaj si na wyjtku",Su:eq,"Subject:":"Temat:",Sunday:tq,"TS description":"Tworzenie regu w Typescript",Telegram:nq,"Text:":"Tekst:",Th:sq,"The script will be stopped and must be activated manually after debugging. Continue?":"Skrypt zostanie zatrzymany i naley go aktywowa rcznie po debugowaniu. Kontyntynuj?","This is advances option. You can write your own code here and it will be executed on trigger":"To jest opcja zaawansowana. Moesz tutaj napisa wasny kod, ktry zostanie wykonany po wyzwoleniu",Thursday:rq,Time:iq,"Time condition":"Warunek czasowy","Title:":"Tytu:","To:":"Do:","Trigger with value":"Wyzwalacz z wartoci",Triggered:oq,Triggers:aq,"Triggers the on script saving or the javascript instance restart":"Uruchamia zapisywanie skryptu lub restart instancji javascript","Triggers the rule on update or change of some state":"Uruchamia regu przy aktualizacji lub zmianie jakiego stanu","Triggers the rule periodically or on some specific time":"Uruchamia regu okresowo lub w okrelonym czasie",Tu:lq,Tuesday:cq,URL:uq,"Unknown error":"Nieznany bd","Unknown error!":"Nieznany bd!","Use generated code":"Uyj wygenerowanego kodu","User function":"Funkcja uytkownika","User:":"Uytkownik:",Value:dq,"Vibration:":"Wibracja:",Volume:hq,We:pq,Wednesday:gq,"Whatsapp-cmb":"Whatsapp-cmb",Write:fq,"Write your own code":"Napisz swj wasny kod",Yes:mq,"Yet exists!":"A jednak istnieje!","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":"Moesz uy %s w adresie URL, aby uy biecej wartoci wyzwalacza, %id, aby uy wyzwalanego identyfikatora obiektu, %name, aby wywietli nazw identyfikatora wyzwalanego obiektu, lub %old, aby uy starej wartoci wyzwalacza","You can use %s in the command to use current trigger value or %id to use the triggered object ID":"Moesz uy %s w poleceniu, aby uy biecej wartoci wyzwalajcej, %id, aby uy identyfikatora wyzwalanego obiektu, %name, aby wywietli nazw identyfikatora wyzwalanego obiektu, lub %old, aby uy starej wartoci wyzwalajcej","You can use %s in the text to display current trigger value or %id to display the triggered object ID":"Moesz uy %s w tekcie, aby wywietli aktualn warto wyzwalajc, %id, aby uy identyfikatora wyzwolonego obiektu, %name, aby wywietli nazw identyfikatora wyzwolonego obiektu lub %old, aby uy starej wartoci wyzwalajcej","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":"Moesz uy %s w wartoci, aby uy biecej wartoci wyzwalacza, %id, aby uy identyfikatora wyzwalanego obiektu, %name, aby wywietli nazw identyfikatora wyzwalanego obiektu, lub %old, aby uy starej wartoci wyzwalacza","You have to enter OpenAI API key in the configuration of javascript adapter.":"Naley wprowadzi klucz OpenAI API w konfiguracji adaptera javascript.","[equal]":"[rwny]","[greater or equal]":"[wiksze lub rwne]","[greater]":"[wiksze]","[hysteresis]":"[histereza]","[includes]":"[obejmuje]","[less or equal]":"[mniejsze lub rwne]","[less]":"[mniejsze]","[not equal]":"[nie rwne]",acknowledgment:bq,all:$q,and:vq,astro:yq,at:_q,"clear running":"czyste uruchomienie",control:wq,copy:Cq,cron:Sq,dawn:Tq,debug_help:kq,debug_label:Eq,default:"domylna",dusk:Iq,easy:xq,else:"inaczej","equal to":"rwny",every:Dq,"every hour at 0 minutes":"co godzin po 0 minutach",false:"fasz","file reading has failed: %s":"odczyt pliku nie powid si: %s","file reading was aborted":"odczyt pliku zosta przerwany",filter_func:Aq,filter_id:Oq,filter_name:Rq,filter_role:Mq,filter_room:Nq,"for edit or create script":"do edycji lub utwrz nowy skrypt","for professionals":"dla profesjonalistw","for programmers":"dla programistw",goldenHour:Lq,goldenHourEnd:Bq,"greater or equal":"wiksze lub rwne","greater or equal to":"wicej lub rwno","greater than":"wicej ni",help_just_check:Pq,help_on_change:jq,"high priority":"wysoki priorytet","high-priority":"wysoki priorytet","highest priority":"najwyszy priorytet",hours:Fq,includes:zq,interval:Uq,"just check":"po prostu sprawd","less or equal":"mniejsze lub rwne","less or equal to":"mniej lub rwno","less than":"mniej ni","lower priority":"niszy priorytet","lowest priority":"najniszy priorytet",magic:Wq,milliseconds:Hq,minutes:Vq,ms:Gq,nadir:Kq,nauticalDawn:Jq,nauticalDusk:qq,nextSunrise:Yq,nextSunset:Xq,night:Zq,nightEnd:Qq,"no blocks found":"Nie znaleziono blokw","no group":"BRAK GRUPY",normal:eY,"normal priority":"normalny priorytet","not equal to":"nie rwna si","not properly connected":"Ten blok nie jest poprawnie podczony do innych blokw.",offset:tY,"on change":"na zmian","on condition change":"pod warunkiem zmiany warunkw","on update":"po aktualizacji",one:nY,or:sY,quiet:rY,"reset search":"zresetuj wyszukiwanie",search:iY,seconds:oY,solarNoon:aY,"store in":"przechowaj w",sunrise:lY,sunriseEnd:cY,sunset:uY,sunsetStart:dY,then:hY,"toggle value":"warto przeczania",tooltip_ack:pY,tooltip_from:gY,tooltip_lc:fY,tooltip_quality:mY,tooltip_ts:bY,tooltip_user:$Y,tooltip_value:vY,true:"prawda",two:yY,undefined:"nieokrelony",update:_Y,"use seconds":"uyj sekund","use trigger value":"uyj wartoci wyzwalajcej",verbose_help:wY,verbose_label:CY,when:SY,with:"z","with date":"z dat","with offset":"z przesuniciem",wizard:TY},EY="Reconhecido",IY="Aes",xY="Adicionar",DY="Todos",AY="Nenhum",OY="Aplique",RY="abril",MY="Perguntar",NY="Astronmico",LY="agosto",BY="Cancelar",PY="Fechar",jY="Doena",FY="Condies",zY="Console",UY="Copiado",WY="dezembro",HY="Predefinio",VY="Atraso",GY="Deletar",KY="Descrio",JY="Pronto",qY="Exec shell",YY="Explicao",XY="Exportao",ZY="Februar",QY="fevereiro",eX="Filtro",tX="Pasta",nX="Fr",sX="Sexta-feira",rX="ID",iX="ID1",oX="ID2",aX="Importar",lX="Instncia",cX="Instncias",uX="Instrues",dX="Januar",hX="janeiro",pX="julho",gX="junho",fX="Limite",mX="maro",bX="maio",$X="Menu",vX="mensagem",yX="Mo",_X="Modelo",wX="Segunda-feira",CX="Ms",SX="Mais",TX="Nome",kX="novembro",EX="OK",IX="outubro",xX="Ok",DX="Pausa",AX="Pushover",OX="Pushsafer",RX="Renomear",MX="Repetir",NX="Reiniciar",LX="Resultado",BX="S",PX="Sbado",jX="Salve",FX="Cronograma",zX="Script",UX="setembro",WX="Simular",HX="Pilha",VX="Comear",GX="Estado",KX="Su",JX="Domingo",qX="Telegrama",YX="4",XX="Quinta-feira",ZX="Tempo",QX="Provocado",eZ="Gatilhos",tZ="Tu",nZ="tera",sZ="URL",rZ="Valor",iZ="Volume",oZ="3",aZ="quarta",lZ="Escrever",cZ="sim",uZ="reconhecimento",dZ="todos",hZ="e",pZ="astro",gZ="no",fZ="ao controle",mZ="copiar",bZ="CRON",$Z="alvorecer",vZ="Este  um modo especial no qual estados e objetos no sero alterados. Mas apenas as informaes sobre cada mudana planejada sero exibidas no protocolo.",yZ="Depurar",_Z="Crepsculo",wZ="fcil",CZ="cada",SZ="Funo",TZ="ID",kZ="Nome",EZ="Tipo",IZ="Quarto",xZ="Hora dourada",DZ="Fim da hora de ouro",AZ='O cdigo ser executado apenas sempre que a condio for verdadeira. Por exemplo. se disparar no valor do sensor de temperatura e a condio for "se a temperatura for maior que 20  C", as aes "ento" sero executadas toda vez que o sensor enviar a temperatura e ela estiver acima de 20  C. Por 21  C, por 22  C e assim por diante.',OZ='O cdigo ser executado apenas se o resultado da condio mudar. Por exemplo. se disparar no valor do sensor de temperatura e a condio for "se a temperatura for maior que 20  C", as aes "ento" sero executadas uma vez quando a temperatura estiver acima de 20. Na prxima vez, as aes "ento" sero executadas quando a temperatura falha abaixo de 20 e sobe acima de 20 novamente.',RZ="horas",MZ="inclui",NZ="intervalo",LZ="Magia",BZ="milissegundos",PZ="minutos",jZ="ms",FZ="nadir",zZ="Madrugada nutica",UZ="Crepsculo nutico",WZ="prximo nascer do sol",HZ="Prximo pr do sol",VZ="Noite",GZ="Fim de noite",KZ="normal",JZ="Deslocamento",qZ="1",YZ="ou",XZ="quieto",ZZ="procurar",QZ="segundos",eQ="Meio-dia solar",tQ="nascer do sol",nQ="Fim do nascer do sol",sQ="pr do sol",rQ="Comeo do pr do sol",iQ="ento",oQ="reconhecer",aQ="de",lQ="ltima alterao",cQ="Qualidade",uQ="timestamp",dQ="usurio",hQ="valor",pQ="dois",gQ="atualizar",fQ="Adiciona sada de depurao ao log para muitos comandos do sistema",mQ="Sadas de log detalhadas",bQ="quando",$Q="Wizard",vQ={"%s not found":"%s no encontrado","()":"()","(at %s)":"(em %s)","(optional)":"(opcional)","-":"-",".":".","AI code generator":"Gerador de cdigo de IA",Ack:EY,Actions:IY,"Actual time of day":"Hora real do dia",Add:xY,"Add new script":"Adicionar novo script",All:DY,"All files will be accepted":"Todos os arquivos sero aceitos",Any:AY,"Any month":"Qualquer ms",Apply:OY,April:RY,"Are you sure?":"Voc tem certeza?",Ask:MY,Astronomical:NY,"Astronomical events today":"Eventos astronmicos hoje",August:LY,"Blockly description":"Criando regras por blocos grficos","Body:":"Corpo:",Cancel:BY,"Cannot delete non empty item!":"No pode ser deletar, porque no est vazio!","Change layout":"Alterar layout",'Change theme (actual "%s")':'Alterar tema (agora - "%s")',"Check blocks":"Verificar blocos","Check is not active, because javascript adapter is disabled":"A verificao de sintaxe no est ativa porque o adaptador javascript no est rodando.","Clear search input":"Limpar entrada de pesquisa","Click on this icon":"Clique neste cone",Close:PY,"Close all but current":"Fechar tudo, menos atual","Collapse all":"Recolher todos","Compares current time with astronomical event":"Compara o tempo atual com o evento astronmico","Compares current time with the user specific time":"Compara a hora atual com a hora especfica do usurio","Compares the state value with user defined value":"Compara o valor do estado com o valor definido pelo usurio",Condition:jY,Conditions:FY,"Configuration not saved.":"Configurao no esta salva.",Console:zY,"Control or update some state":"Controlar ou atualizar algum estado","Control or update some state with delay":"Controlar ou atualizar algum estado com atraso","Convert blockly to javascript for ever.":"Converter Blockly em Javascript permanentemente.",Copied:UY,"Copy script":"Copiar script","Copy to clipboard":"Copiar para rea de transferncia","Create new":"Crie um novo","Create new folder":"Criar nova pasta","Create new script":"Criar novo script","Create or edit CRON or time wizard":"Criar ou editar o assistente cron ou o assistente de horrio","Dark Theme":"Layout escuro","Dark style":"Estilo escuro",Date:"Encontro","Debug instance":"Instncia de depurao","Debug options":"Opes de depurao",December:WY,Default:HY,"Define cron...":"Definir cron...","Define schedule...":"Definir agendamento ...",Delay:VY,Delete:GY,"Delete %s":"Deletar %s...","Delete folder":"Deletar pasta","Delete script":"Deletar script",Description:KY,"Deselect all":"Desmarcar todos","Discard changes for %s":"Descartar alteraes para %s",Done:JY,"Double click to write value":"Clique duas vezes para escrever o valor","Download as file":"Baixar como arquivo","Drop some files here or click...":"Solte alguns arquivos aqui ou clique em...","Duplicate name":"Nome duplicado","Edit script or just double click":"Edite o script ou clique duas vezes","Empty name is not allowed":"Nome vazio no  permitido","End search mode":"Finalizar modo de pesquisa","Enter your question":"Digite sua solicitao",Error:"Erro","Error formatting code":"Erro de formatao de cdigo","Error was found":"Erro foi encontrado","Every day":"Todos os dias",Exec:qY,"Executes some shell command":"Executa algum comando shell","Existing scripts will be overwritten.":"Os scripts existentes sero substitudos.","Expand all":"Expandir todos","Expert mode":"Modo de especialista",Explanation:YY,Export:XY,"Export all scripts":"Exportar todos os scripts","Export blocks":"Exportar blocos","Export selected blocks":"Exportar blocos selecionados",Februar:ZY,February:QY,Filter:eX,Folder:tX,Fr:nX,Friday:sX,Function:"Funo","Function editor":"Editor de funes","Function: executed":"Funo: executado","Go to next line":"V para a prxima linha","HTTP Call":"Chamada HTTP","Hide logs":"Ocultar logs",ID:rX,ID1:iX,ID2:oX,Import:aX,"Import blocks":"Importar blocos","Import error":"Erro de importao","Import scripts":"Importar script","Insert object ID":"Inserir ID do objeto",Instance:lX,"Instance is disabled":"Instncia est desativada","Instance:":"Instncia:",Instances:cX,Instructions:uX,"Invalid CRON":"CRON invlido","It will not be possible to revert this operation.":"No ser possvel reverter esta operao.","JS description":"Criando regras escrevendo Javascript",Januar:dX,January:hX,July:pX,June:gX,"Just check":"Apenas verifique","Language:":"Lngua:","Learn More":"Aprender mais","Light style":"Estilo claro",Limit:fX,"Local time":"Hora local","Locate file":"Localize o arquivo","Log outputs":"Sadas de log","Log text":"Texto de registro","Log: %s":"Log: %s","Make a HTTP get request":"Faa uma solicitao HTTP get","Make a pause between actions":"Faa uma pausa entre as aes",March:mX,"March ":"Maro",May:bX,Menu:$X,Message:vX,Mo:yX,Model:_X,Monday:wX,Month:CX,More:SX,Name:TX,"No Chat GPT Key found":"Nenhuma chave GPT de bate-papo encontrada","No active host found":"Nenhum host ativo encontrado","Nothing found":"Nada encontrado",November:kX,OK:EX,October:IX,Ok:xX,"On condition change":"Na mudana de condio","On script save or adapter start":"Ao salvar o script ou iniciar o adaptador","On weekdays":"Nos dias teis","Open configuration":"Configurao aberta","Operate two states":"Operar dois estados","Operations with two states":"Operaes com dois estados","Paste your blocks here":"Cole seus blocos aqui",Pause:DX,"Pause execution":"Pausar a execuo","Pause script":"Pausar script","Phone:":"Telefone:","Please select object ID...":"Selecione o ID do objeto...","Press Ctrl+Enter to get the answer":"Pressione Ctrl+Enter para obter a resposta","Prettify the script":"Embeleze o roteiro","Print some text in log":"Imprimir algum texto no log","Priority:":"Prioridade:",Pushover:AX,Pushsafer:OX,"Read only ID selected: %s":"ID somente leitura selecionada: %s",Rename:RX,"Reorder scripts in folders":"Reordenar scripts em pastas",Repeat:MX,Restart:NX,Result:LX,"Resume execution":"Retomar execuo","Root folder":"Pasta principal","Rules description":"Crie regras com blocos IF, THEN, ELSE","Run script":"Executar script",Sa:BX,Saturday:PX,Save:jX,"Save all":"Salvar tudo","Say It":"Say It","Say some text via sayit adapter":"Diga algum texto atravs do adaptador sayit",Schedule:FX,Script:zX,"Script %s was modified on disk":'O script "%s" foi modificado no disco rgido',"Script is not running":"Script no est sendo executado","Search in scripts":"Pesquisa em scripts","Search...":"Procurar...","Select all":"Selecionar tudo","Send email":"Enviar email","Sends an email":"Envia um email","Sends message via Pushsafer":"Envia mensagem via Pushsafer","Sends message via pushover":"Envia mensagem via pushover","Sends message via telegram":"Envia mensagem via telegrama","Sends message via whatsapp-cmb":"Envia mensagem via whatsapp-cmb",September:UX,"Server time":"Tempo de servidor","Set state action":"Definir ao de estado","Set with delay":"Definido com atraso","Shell command":"Comando shell","Show astronomical events":"Mostrar eventos astronmicos","Show javascript code":"Mostrar cdigo Javascript","Show logs":"Mostrar logs","Show only paused scripts":"Mostrar apenas scripts pausados","Show only running scripts":"Mostrar apenas scripts em execuo","Show only scripts with problems":"Mostrar apenas scripts com problemas",Simulate:WX,"Some files will be rejected":"Alguns arquivos sero rejeitados","Sound:":"Som:",Stack:HX,Start:VX,"Start script":"Iniciar script",State:GX,"State condition":"Condio de estado","Step into function":"Entre na funo","Step out from function":"Saia da funo","Stop on exception":"Pare na exceo",Su:KX,"Subject:":"Sujeito:",Sunday:JX,"TS description":"Criando regras escrevendo Typecript",Telegram:qX,"Text:":"Texto:",Th:YX,"The script will be stopped and must be activated manually after debugging. Continue?":"O script ser interrompido e deve ser ativado manualmente aps a depurao. Continuar?","This is advances option. You can write your own code here and it will be executed on trigger":"Esta  a opo de avanos. Voc pode escrever seu prprio cdigo aqui e ele ser executado no gatilho",Thursday:XX,Time:ZX,"Time condition":"Condio de tempo","Title:":"Ttulo:","To:":"Para:","Trigger with value":"Trigger com valor",Triggered:QX,Triggers:eZ,"Triggers the on script saving or the javascript instance restart":"Aciona o salvamento do script ou a reinicializao da instncia javascript","Triggers the rule on update or change of some state":"Aciona a regra na atualizao ou mudana de algum estado","Triggers the rule periodically or on some specific time":"Aciona a regra periodicamente ou em algum momento especfico",Tu:tZ,Tuesday:nZ,URL:sZ,"Unknown error":"Erro desconhecido","Unknown error!":"Erro desconhecido!","Use generated code":"Usar cdigo gerado","User function":"Funo do usurio","User:":"Do utilizador:",Value:rZ,"Vibration:":"Vibrao:",Volume:iZ,We:oZ,Wednesday:aZ,"Whatsapp-cmb":"Whatsapp-cmb",Write:lZ,"Write your own code":"Escreva seu prprio cdigo",Yes:cZ,"Yet exists!":"Ainda existe!","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":"Voc pode usar %s na URL para usar o valor do gatilho atual, %id para usar o ID do objeto acionado, %name para mostrar o nome do ID do objeto acionado ou %old para usar o valor do gatilho antigo","You can use %s in the command to use current trigger value or %id to use the triggered object ID":"Voc pode usar %s no comando para usar o valor do acionador atual, %id para usar o ID do objeto acionado, %name para mostrar o nome do ID do objeto acionado ou %old para usar o valor do acionador antigo","You can use %s in the text to display current trigger value or %id to display the triggered object ID":"Voc pode usar %s no texto para exibir o valor do acionador atual, %id para usar o ID do objeto acionado, %name para mostrar o nome do ID do objeto acionado ou %old para usar o valor do acionador antigo","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":"Voc pode usar %s no valor para usar o valor do acionador atual, %id para usar o ID do objeto acionado, %name para mostrar o nome do ID do objeto acionado ou %old para usar o valor do acionador antigo","You have to enter OpenAI API key in the configuration of javascript adapter.":"Voc deve inserir a chave da API OpenAI na configurao do adaptador javascript.","[equal]":"[igual]","[greater or equal]":"[maior ou igual]","[greater]":"[maior]","[hysteresis]":"[histerese]","[includes]":"[inclui]","[less or equal]":"[menor ou igual]","[less]":"[menos]","[not equal]":"[no igual]",acknowledgment:uZ,all:dZ,and:hZ,astro:pZ,at:gZ,"clear running":"corrida limpa",control:fZ,copy:mZ,cron:bZ,dawn:$Z,debug_help:vZ,debug_label:yZ,default:"predefinio",dusk:_Z,easy:wZ,else:"outro","equal to":"igual a",every:CZ,"every hour at 0 minutes":"a cada hora em 0 minutos",false:"falso","file reading has failed: %s":"a leitura do arquivo falhou: %s","file reading was aborted":"a leitura do arquivo foi abortada",filter_func:SZ,filter_id:TZ,filter_name:kZ,filter_role:EZ,filter_room:IZ,"for edit or create script":"para editar ou criar um novo script","for professionals":"para profissionais","for programmers":"para programadores",goldenHour:xZ,goldenHourEnd:DZ,"greater or equal":"maior ou igual","greater or equal to":"maior ou igual a","greater than":"Maior que",help_just_check:AZ,help_on_change:OZ,"high priority":"prioridade mxima","high-priority":"prioridade mxima","highest priority":"Prioridade mxima",hours:RZ,includes:MZ,interval:NZ,"just check":"Apenas verifique","less or equal":"menor ou igual","less or equal to":"menor ou igual a","less than":"Menor que","lower priority":"prioridade mais baixa","lowest priority":"prioridade mais baixa",magic:LZ,milliseconds:BZ,minutes:PZ,ms:jZ,nadir:FZ,nauticalDawn:zZ,nauticalDusk:UZ,nextSunrise:WZ,nextSunset:HZ,night:VZ,nightEnd:GZ,"no blocks found":"Nenhum bloco encontrado","no group":"SEM GRUPO",normal:KZ,"normal priority":"prioridade normal","not equal to":"no  igual a","not properly connected":"Este bloco no est conectado corretamente com outros blocos.",offset:JZ,"on change":"em mudana","on condition change":"na mudana de condio","on update":"em atualizao",one:qZ,or:YZ,quiet:XZ,"reset search":"redefinir pesquisa",search:ZZ,seconds:QZ,solarNoon:eQ,"store in":"armazenar em",sunrise:tQ,sunriseEnd:nQ,sunset:sQ,sunsetStart:rQ,then:iQ,"toggle value":"valor de alternncia",tooltip_ack:oQ,tooltip_from:aQ,tooltip_lc:lQ,tooltip_quality:cQ,tooltip_ts:uQ,tooltip_user:dQ,tooltip_value:hQ,true:"verdade",two:pQ,undefined:"Indefinido",update:gQ,"use seconds":"use segundos","use trigger value":"use o gatilho",verbose_help:fQ,verbose_label:mQ,when:bQ,with:"com","with date":"com data","with offset":"com deslocamento",wizard:$Q},yQ="",_Q="",wQ="",CQ="",SQ="",TQ="",kQ="",EQ="",IQ="A",xQ="",DQ="",AQ="",OQ="",RQ="",MQ="",NQ="",LQ="",BQ="",PQ="",jQ="",FQ="",zQ="",UQ=" shell",WQ="",HQ="",VQ="",GQ="",KQ="",JQ="",qQ="",YQ="",XQ="ID",ZQ="ID1",QQ="ID2",eee="",tee="",nee="",see="",ree="",iee="",oee="",aee="",lee="",cee="",uee="",dee="",hee="",pee="",gee="",fee="",mee="",bee="",$ee="",vee="",yee="",_ee="",wee="Ok",Cee="",See="Pushover",Tee="Pushsafer",kee="",Eee="",Iee="",xee="",Dee="",Aee="",Oee="",Ree="",Mee="",Nee="",Lee="",Bee="Stack",Pee="",jee="",Fee="",zee="",Uee="Telegram",Wee="",Hee="",Vee="",Gee="",Kee="",Jee="",qee="",Yee="URL",Xee="",Zee="",Qee="",ete="",tte="",nte="",ste="",rte="",ite="",ote="",ate="",lte="",cte="",ute="CRON",dte="",hte="  ,        .           .",pte="",gte="",fte="",mte="()",bte="",$te="ID",vte="",yte="",_te="",wte=" ",Cte="  ",Ste="     ,   . .            20C,      ,     ,    20C.  21,  22   .",Tte="        . ,            20C,      ,    20C.       ,     20C,      20C.",kte="()",Ete="",Ite="",xte="",Dte="",Ate="()",Ote="",Rte="",Mte=" ",Nte=" ",Lte=" ",Bte=" ",Pte="",jte=" ",Fte="",zte="",Ute="",Wte="",Hte="",Vte="",Gte="",Kte=" ",Jte=" ",qte=" ",Yte=" ",Xte=" ",Zte="",Qte="",ene="",tne=" ",nne="",sne="",rne="",ine="",one="",ane="",lne="        .",cne=" ",une="",dne="",hne={"%s not found":"%s  ","()":"()","(at %s)":"( %s)","(optional)":"()","-":"-",".":".","AI code generator":"  ",Ack:yQ,Actions:_Q,"Actual time of day":"  ",Add:wQ,"Add new script":"  ",All:CQ,"All files will be accepted":"   ",Any:SQ,"Any month":"  ",Apply:TQ,April:kQ,"Are you sure?":" ?",Ask:EQ,Astronomical:IQ,"Astronomical events today":"  ",August:xQ,"Blockly description":"   ","Body:":":",Cancel:DQ,"Cannot delete non empty item!":"    !","Change layout":" ",'Change theme (actual "%s")':'  ( - "%s")',"Check blocks":" ","Check is not active, because javascript adapter is disabled":" ,    Javascript ","Clear search input":" ","Click on this icon":"   ",Close:AQ,"Close all but current":"   ","Collapse all":" ","Compares current time with astronomical event":"     ","Compares current time with the user specific time":"      ","Compares the state value with user defined value":"     ",Condition:OQ,Conditions:RQ,"Configuration not saved.":"  .",Console:MQ,"Control or update some state":"   - ","Control or update some state with delay":"   -   ","Convert blockly to javascript for ever.":" blockly  Javascript .",Copied:NQ,"Copy script":" ","Copy to clipboard":"   ","Create new":" ","Create new folder":"  ","Create new script":"  ","Create or edit CRON or time wizard":"   CRON   ","Dark Theme":" ","Dark style":" ",Date:"","Debug instance":" ","Debug options":" ",December:LQ,Default:BQ,"Define cron...":"  ...","Define schedule...":" ...",Delay:PQ,Delete:jQ,"Delete %s":" %s...","Delete folder":" ","Delete script":" ",Description:FQ,"Deselect all":"   ","Discard changes for %s":"   %s",Done:zQ,"Double click to write value":"    ","Download as file":"  ","Drop some files here or click...":"     ...","Duplicate name":" ","Edit script or just double click":"     ","Empty name is not allowed":"   ","End search mode":" ","Enter your question":"  ",Error:"","Error formatting code":"  ","Error was found":"  ","Every day":" ",Exec:UQ,"Executes some shell command":"   ","Existing scripts will be overwritten.":"   .","Expand all":" ","Expert mode":" ",Explanation:WQ,Export:HQ,"Export all scripts":"  ","Export blocks":" ","Export selected blocks":"  ",Februar:VQ,February:GQ,Filter:KQ,Folder:JQ,Fr:qQ,Friday:YQ,Function:"","Function editor":" ","Function: executed":": ","Go to next line":"   ","HTTP Call":"HTTP-","Hide logs":" ",ID:XQ,ID1:ZQ,ID2:QQ,Import:eee,"Import blocks":" ","Import error":" ","Import scripts":" ","Insert object ID":" ID ",Instance:tee,"Instance is disabled":" ","Instance:":":",Instances:nee,Instructions:see,"Invalid CRON":" CRON","It will not be possible to revert this operation.":"   .","JS description":"    Javascript",Januar:ree,January:iee,July:oee,June:aee,"Just check":" ","Language:":":","Learn More":" ","Light style":" ",Limit:lee,"Local time":" ","Locate file":"   ","Log outputs":"","Log text":" ","Log: %s":": %s","Make a HTTP get request":" HTTP-  ","Make a pause between actions":"   ",March:cee,"March ":" ",May:uee,Menu:dee,Message:hee,Mo:pee,Model:gee,Monday:fee,Month:mee,More:bee,Name:$ee,"No Chat GPT Key found":" GPT    ","No active host found":" host  ","Nothing found":"  ",November:vee,OK:yee,October:_ee,Ok:wee,"On condition change":"   ","On script save or adapter start":"     ","On weekdays":"  ","Open configuration":" ","Operate two states":"   ","Operations with two states":"   ","Paste your blocks here":"   ",Pause:Cee,"Pause execution":" ","Pause script":" ","Phone:":":","Please select object ID...":",  ID  ...","Press Ctrl+Enter to get the answer":" Ctrl+Enter,   ","Prettify the script":" ","Print some text in log":"   ","Priority:":":",Pushover:See,Pushsafer:Tee,"Read only ID selected: %s":"    : %s",Rename:kee,"Reorder scripts in folders":"   ",Repeat:Eee,Restart:Iee,Result:xee,"Resume execution":" ","Root folder":" ","Rules description":"    , , ","Run script":" ",Sa:Dee,Saturday:Aee,Save:Oee,"Save all":" ","Say It":"Say It","Say some text via sayit adapter":"    Sayit",Schedule:Ree,Script:Mee,"Script %s was modified on disk":' "%s"    ',"Script is not running":"  ","Search in scripts":"  ","Search...":"...","Select all":" ","Send email":" email","Sends an email":"  ","Sends message via Pushsafer":"   Pushsafer","Sends message via pushover":"   ","Sends message via telegram":"   ","Sends message via whatsapp-cmb":"   whatsapp-cmb",September:Nee,"Server time":" ","Set state action":" ","Set with delay":"  ","Shell command":" ","Show astronomical events":"  ","Show javascript code":"  Javascript","Show logs":" ","Show only paused scripts":"   ","Show only running scripts":"   ","Show only scripts with problems":"    ",Simulate:Lee,"Some files will be rejected":"   ","Sound:":":",Stack:Bee,Start:Pee,"Start script":" ",State:jee,"State condition":" ","Step into function":"  ","Step out from function":"  ","Stop on exception":"  ",Su:Fee,"Subject:":":",Sunday:zee,"TS description":"    Typescript",Telegram:Uee,"Text:":":",Th:Wee,"The script will be stopped and must be activated manually after debugging. Continue?":"C         . ?","This is advances option. You can write your own code here and it will be executed on trigger":"  .            ",Thursday:Hee,Time:Vee,"Time condition":" ","Title:":":","To:":":","Trigger with value":"  ",Triggered:Gee,Triggers:Kee,"Triggers the on script saving or the javascript instance restart":"       javascript","Triggers the rule on update or change of some state":"      - ","Triggers the rule periodically or on some specific time":"      ",Tu:Jee,Tuesday:qee,URL:Yee,"Unknown error":" ","Unknown error!":" !","Use generated code":"  ","User function":" ","User:":":",Value:Xee,"Vibration:":":",Volume:Zee,We:Qee,Wednesday:ete,"Whatsapp-cmb":"Whatsapp-cmb",Write:tte,"Write your own code":"  ",Yes:nte,"Yet exists!":"  !","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":"   %s  URL-,     , %id,     , %name,      ,  %old,     .","You can use %s in the command to use current trigger value or %id to use the triggered object ID":"   %s  ,     , %id,     , %name,      ,  %old,     .","You can use %s in the text to display current trigger value or %id to display the triggered object ID":"   %s       , %id     , %name        %old     .","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":"   %s  ,     , %id,     , %name,      ,  %old,     .","You have to enter OpenAI API key in the configuration of javascript adapter.":"    OpenAI API    javascript.","[equal]":"[]","[greater or equal]":"[  ]","[greater]":"[]","[hysteresis]":"[]","[includes]":"[]","[less or equal]":"[  ]","[less]":"[]","[not equal]":"[ ]",acknowledgment:ste,all:rte,and:ite,astro:ote,at:ate,"clear running":"  ",control:lte,copy:cte,cron:ute,dawn:dte,debug_help:hte,debug_label:pte,default:"",dusk:gte,easy:fte,else:"","equal to":"",every:mte,"every hour at 0 minutes":"   0 ",false:"false","file reading has failed: %s":"  : %s","file reading was aborted":"   ",filter_func:bte,filter_id:$te,filter_name:vte,filter_role:yte,filter_room:_te,"for edit or create script":"     ","for professionals":" ","for programmers":" ",goldenHour:wte,goldenHourEnd:Cte,"greater or equal":"  ","greater or equal to":"  ","greater than":" ",help_just_check:Ste,help_on_change:Tte,"high priority":" ","high-priority":"-","highest priority":" ",hours:kte,includes:Ete,interval:Ite,"just check":" ","less or equal":"  ","less or equal to":"  ","less than":", ","lower priority":"  ","lowest priority":"  ",magic:xte,milliseconds:Dte,minutes:Ate,ms:Ote,nadir:Rte,nauticalDawn:Mte,nauticalDusk:Nte,nextSunrise:Lte,nextSunset:Bte,night:Pte,nightEnd:jte,"no blocks found":" ","no group":" ",normal:Fte,"normal priority":" ","not equal to":" ","not properly connected":"         .",offset:zte,"on change":" ","on condition change":"   ","on update":" ",one:Ute,or:Wte,quiet:Hte,"reset search":"C ",search:Vte,seconds:Gte,solarNoon:Kte,"store in":" ",sunrise:Jte,sunriseEnd:qte,sunset:Yte,sunsetStart:Xte,then:Zte,"toggle value":"  ",tooltip_ack:Qte,tooltip_from:ene,tooltip_lc:tne,tooltip_quality:nne,tooltip_ts:sne,tooltip_user:rne,tooltip_value:ine,true:"true",two:one,undefined:"",update:ane,"use seconds":" ","use trigger value":"  ",verbose_help:lne,verbose_label:cne,when:une,with:"","with date":" ","with offset":" ",wizard:dne},pne="",gne="",fne="",mne="",bne="-",$ne="",vne="",yne="",_ne="",wne="",Cne="",Sne="",Tne="",kne="",Ene="",Ine="",xne="",Dne=" ",Ane="",One="",Rne="",Mne="",Nne=" ",Lne="",Bne="",Pne="",jne="",Fne="",zne="",Une="",Wne="'",Hne="ID",Vne="ID1",Gne="ID2",Kne="",Jne="",qne="",Yne="",Xne="",Zne="",Qne="",ese="",tse="",nse="",sse="",rse="",ise="",ose="",ase="",lse="",cse="",use="",dse="'",hse="",pse=" ",gse="",fse=" ",mse="",bse="Pushover",$se="Pushsafer",vse="",yse="",_se="",wse="",Cse="Sa",Sse="",Tse="",kse="",Ese="",Ise="",xse="",Dse="",Ase="",Ose="",Rse="",Mse="",Nse="",Lse="",Bse="",Pse="",jse="",Fse="",zse="",Use="",Wse="URL",Hse="",Vse="",Gse="",Kse="",Jse="",qse="",Yse="",Xse="",Zse="",Qse="",ere="",tre="",nre="",sre="CRON",rre="",ire="  ,     '  .          .",ore="",are="",lre="",cre="",ure="",dre="ID",hre="'",pre="",gre="",fre=" ",mre="  ",bre="    ,   .            20C,    ,    ,    20C.  21C,  22C   .",$re="        .            20C,      ,     20.      ,     20,      20.",vre="",yre="  ",_re="",wre="",Cre="",Sre="",Tre="",kre="",Ere=" ",Ire=" ",xre="  ",Dre="  ",Are="",Ore=" ",Rre="",Mre="",Nre="",Lre="",Bre="",Pre="",jre="",Fre=" ",zre=" ",Ure="  ",Wre=" ",Hre="  ",Vre="",Gre="",Kre="",Jre=" ",qre="",Yre=" ",Xre="",Zre="",Qre="",eie="",tie="         ",nie="  ",sie="",rie="",iie={"%s not found":"%s  ","()":"()","(at %s)":"( %s)","(optional)":"(')","-":"-",".":".","AI code generator":"  ",Ack:pne,Actions:gne,"Actual time of day":"  ",Add:fne,"Add new script":"  ",All:mne,"All files will be accepted":"   ",Any:bne,"Any month":"- ",Apply:$ne,April:vne,"Are you sure?":" ?",Ask:yne,Astronomical:_ne,"Astronomical events today":"  ",August:wne,"Blockly description":"    ","Body:":":",Cancel:Cne,"Cannot delete non empty item!":"   !","Change layout":" ",'Change theme (actual "%s")':'  ( - "%s")',"Check blocks":" ","Check is not active, because javascript adapter is disabled":"  ,   Javascript ","Clear search input":"  ","Click on this icon":"   ",Close:Sne,"Close all but current":" ,  ","Collapse all":" ","Compares current time with astronomical event":"     ","Compares current time with the user specific time":"      ","Compares the state value with user defined value":"      ",Condition:Tne,Conditions:kne,"Configuration not saved.":"  .",Console:Ene,"Control or update some state":"    ","Control or update some state with delay":"      ","Convert blockly to javascript for ever.":"  Blockly  Javascript.",Copied:Ine,"Copy script":" ","Copy to clipboard":"   ","Create new":" ","Create new folder":"  ","Create new script":"  ","Create or edit CRON or time wizard":"   CRON   ","Dark Theme":" ","Dark style":" ",Date:"","Debug instance":" ","Debug options":" ",December:xne,Default:Dne,"Define cron...":" cron...","Define schedule...":" ...",Delay:Ane,Delete:One,"Delete %s":" %s...","Delete folder":" ","Delete script":" ",Description:Rne,"Deselect all":"   ","Discard changes for %s":"   %s",Done:Mne,"Double click to write value":" ,   ","Download as file":" ","Drop some files here or click...":"     ...","Duplicate name":" '","Edit script or just double click":"     ","Empty name is not allowed":" '  ","End search mode":"  ","Enter your question":"  ",Error:"","Error formatting code":"  ","Error was found":" ","Every day":" ",Exec:Nne,"Executes some shell command":"   ","Existing scripts will be overwritten.":"   .","Expand all":" ","Expert mode":" ",Explanation:Lne,Export:Bne,"Export all scripts":"  ","Export blocks":" ","Export selected blocks":"  ",Februar:Pne,February:jne,Filter:Fne,Folder:zne,Fr:Une,Friday:Wne,Function:"","Function editor":" ","Function: executed":": ","Go to next line":"   ","HTTP Call":" HTTP","Hide logs":" ",ID:Hne,ID1:Vne,ID2:Gne,Import:Kne,"Import blocks":" ","Import error":" ","Import scripts":" ","Insert object ID":" ID '",Instance:Jne,"Instance is disabled":" ","Instance:":":",Instances:qne,Instructions:Yne,"Invalid CRON":" CRON","It will not be possible to revert this operation.":"    .","JS description":"    Javascript",Januar:Xne,January:Zne,July:Qne,June:ese,"Just check":" ","Language:":":","Learn More":" ","Light style":" ",Limit:tse,"Local time":" ","Locate file":" ","Log outputs":" ","Log text":" ","Log: %s":": %s","Make a HTTP get request":" HTTP-  ","Make a pause between actions":"   ",March:nse,"March ":"",May:sse,Menu:rse,Message:ise,Mo:ose,Model:ase,Monday:lse,Month:cse,More:use,Name:dse,"No Chat GPT Key found":" GPT    ","No active host found":"   ","Nothing found":"  ",November:hse,OK:pse,October:gse,Ok:fse,"On condition change":"   ","On script save or adapter start":"      ","On weekdays":"  ","Open configuration":" ","Operate two states":"  ","Operations with two states":"   ","Paste your blocks here":"   ",Pause:mse,"Pause execution":" ","Pause script":" ","Phone:":":","Please select object ID...":"  '...","Press Ctrl+Enter to get the answer":" Ctrl+Enter,   ","Prettify the script":" ","Print some text in log":"   ","Priority:":":",Pushover:bse,Pushsafer:$se,"Read only ID selected: %s":"    : %s",Rename:vse,"Reorder scripts in folders":"    ",Repeat:yse,Restart:_se,Result:wse,"Resume execution":" ","Root folder":" ","Rules description":"    IF, THEN, ELSE","Run script":" ",Sa:Cse,Saturday:Sse,Save:Tse,"Save all":" ","Say It":" ","Say some text via sayit adapter":"    sayit",Schedule:kse,Script:Ese,"Script %s was modified on disk":" %s   ","Script is not running":"  ","Search in scripts":"  ","Search...":"...","Select all":" ","Send email":" ","Sends an email":"  ","Sends message via Pushsafer":"   Pushsafer","Sends message via pushover":"   pushover","Sends message via telegram":"   ","Sends message via whatsapp-cmb":"   whatsapp-cmb",September:Ise,"Server time":" ","Set state action":"  ","Set with delay":"  ","Shell command":" ","Show astronomical events":"  ","Show javascript code":"  Javascript","Show logs":" ","Show only paused scripts":"   ","Show only running scripts":"   ","Show only scripts with problems":"    ",Simulate:xse,"Some files will be rejected":"   ","Sound:":":",Stack:Dse,Start:Ase,"Start script":" ",State:Ose,"State condition":" ","Step into function":"  ","Step out from function":"  ","Stop on exception":"  ",Su:Rse,"Subject:":":",Sunday:Mse,"TS description":"    Typescript",Telegram:Nse,"Text:":":",Th:Lse,"The script will be stopped and must be activated manually after debugging. Continue?":"  ,       . ?","This is advances option. You can write your own code here and it will be executed on trigger":"  .       ,      ",Thursday:Bse,Time:Pse,"Time condition":" ","Title:":":","To:":":","Trigger with value":"  ",Triggered:jse,Triggers:Fse,"Triggers the on script saving or the javascript instance restart":"      JavaScript","Triggers the rule on update or change of some state":"       ","Triggers the rule periodically or on some specific time":"      ",Tu:zse,Tuesday:Use,URL:Wse,"Unknown error":" ","Unknown error!":" !","Use generated code":"  ","User function":" ","User:":":",Value:Hse,"Vibration:":":",Volume:Vse,We:Gse,Wednesday:Kse,"Whatsapp-cmb":"Whatsapp-cmb",Write:Jse,"Write your own code":"  ",Yes:qse,"Yet exists!":"  !","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":"   %s  URL-,     , %id,     , %name,      ,  %old,     ","You can use %s in the command to use current trigger value or %id to use the triggered object ID":"   %s  ,     , %id,     , %name,      ,  %old,     ","You can use %s in the text to display current trigger value or %id to display the triggered object ID":"   %s       , %id     , %name        %old     ","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":"   %s  ,     , %id,     , %name,      ,  %old,     ","You have to enter OpenAI API key in the configuration of javascript adapter.":"    OpenAI API    JavaScript.","[equal]":"[]","[greater or equal]":"[  ]","[greater]":"[]","[hysteresis]":"[]","[includes]":"[]","[less or equal]":"[  ]","[less]":"[]","[not equal]":"[ ]",acknowledgment:Yse,all:Xse,and:Zse,astro:Qse,at:ere,"clear running":" ",control:tre,copy:nre,cron:sre,dawn:rre,debug_help:ire,debug_label:ore,default:" ",dusk:are,easy:lre,else:"","equal to":"",every:cre,"every hour at 0 minutes":"  0 ",false:"","file reading has failed: %s":"   : %s","file reading was aborted":"   ",filter_func:ure,filter_id:dre,filter_name:hre,filter_role:pre,filter_room:gre,"for edit or create script":"     ","for professionals":" ","for programmers":" ",goldenHour:fre,goldenHourEnd:mre,"greater or equal":"  ","greater or equal to":"  ","greater than":", ,  ,  ",help_just_check:bre,help_on_change:$re,"high priority":" ","high-priority":" ","highest priority":" ",hours:vre,includes:yre,interval:_re,"just check":" ","less or equal":"  ","less or equal to":"  ","less than":" ","lower priority":" ","lowest priority":" ",magic:wre,milliseconds:Cre,minutes:Sre,ms:Tre,nadir:kre,nauticalDawn:Ere,nauticalDusk:Ire,nextSunrise:xre,nextSunset:Dre,night:Are,nightEnd:Ore,"no blocks found":"  ","no group":" ",normal:Rre,"normal priority":" ","not equal to":" ","not properly connected":"      .",offset:Mre,"on change":" ","on condition change":"  ","on update":" ",one:Nre,or:Lre,quiet:Bre,"reset search":" ",search:Pre,seconds:jre,solarNoon:Fre,"store in":" ",sunrise:zre,sunriseEnd:Ure,sunset:Wre,sunsetStart:Hre,then:Vre,"toggle value":" ",tooltip_ack:Gre,tooltip_from:Kre,tooltip_lc:Jre,tooltip_quality:qre,tooltip_ts:Yre,tooltip_user:Xre,tooltip_value:Zre,true:"",two:Qre,undefined:"",update:eie,"use seconds":" ","use trigger value":"  ",verbose_help:tie,verbose_label:nie,when:sie,with:"","with date":" ","with offset":" ",wizard:rie},oie="",aie="",lie="",cie="",uie="",die="",hie="",pie="",gie="",fie="",mie="",bie="",$ie="",vie="",yie="",_ie="",wie="",Cie="",Sie="",Tie="",kie="",Eie="",Iie="",xie="",Die="",Aie="",Oie="",Rie="",Mie="",Nie="r",Lie="",Bie="ID",Pie="ID1",jie="ID2",Fie="",zie="",Uie="",Wie="",Hie="",Vie="",Gie="",Kie="",Jie="",qie="",Yie="",Xie="",Zie="",Qie="",eoe="",toe="",noe="",soe="",roe="",ioe="",ooe="",aoe="",loe="",coe="",uoe="",doe="",hoe="",poe="",goe="",foe="",moe="",boe="",$oe="",voe="",yoe="",_oe="",woe="",Coe="",Soe="",Toe="",koe="",Eoe="",Ioe="",xoe="4",Doe="",Aoe="",Ooe="",Roe="",Moe="",Noe="",Loe="",Boe="",Poe="",joe="3",Foe="",zoe="",Uoe="",Woe="",Hoe="",Voe="",Goe="",Koe="",Joe="",qoe="",Yoe="",Xoe="",Zoe="",Qoe="",eae="",tae="",nae="",sae="",rae="ID",iae="",oae="",aae="",lae="",cae="",uae="20C20C 21C22C",dae="20C20202020",hae="",pae="",gae="",fae="",mae="",bae="",$ae="",vae="",yae="",_ae="",wae="",Cae="",Sae="",Tae="",kae="",Eae="",Iae="",xae="",Dae="",Aae="",Oae="",Rae="",Mae="",Nae="",Lae="",Bae="",Pae="",jae="",Fae="",zae="",Uae="",Wae="",Hae="",Vae="",Gae="",Kae="",Jae="",qae="",Yae="",Xae="",Zae={"%s not found":"%s ","()":"()","(at %s)":" %s","(optional)":"","-":"-",".":".","AI code generator":"AI",Ack:oie,Actions:aie,"Actual time of day":"",Add:lie,"Add new script":"",All:cie,"All files will be accepted":"",Any:uie,"Any month":"",Apply:die,April:hie,"Are you sure?":"",Ask:pie,Astronomical:gie,"Astronomical events today":"",August:fie,"Blockly description":"","Body:":"",Cancel:mie,"Cannot delete non empty item!":"","Change layout":"",'Change theme (actual "%s")':"%s","Check blocks":"","Check is not active, because javascript adapter is disabled":"Javascript","Clear search input":"","Click on this icon":"",Close:bie,"Close all but current":"","Collapse all":"","Compares current time with astronomical event":"","Compares current time with the user specific time":"","Compares the state value with user defined value":"",Condition:$ie,Conditions:vie,"Configuration not saved.":"",Console:yie,"Control or update some state":"","Control or update some state with delay":"","Convert blockly to javascript for ever.":"blocklyJavascript",Copied:_ie,"Copy script":"","Copy to clipboard":"","Create new":"","Create new folder":"","Create new script":"","Create or edit CRON or time wizard":"","Dark Theme":"","Dark style":"",Date:"","Debug instance":"","Debug options":"",December:wie,Default:Cie,"Define cron...":"...","Define schedule...":"......",Delay:Sie,Delete:Tie,"Delete %s":"%s...","Delete folder":"","Delete script":"",Description:kie,"Deselect all":"","Discard changes for %s":"%s",Done:Eie,"Double click to write value":"Double click to write value","Download as file":"","Drop some files here or click...":"......","Duplicate name":"","Edit script or just double click":"","Empty name is not allowed":"","End search mode":"","Enter your question":"",Error:"","Error formatting code":"","Error was found":"","Every day":"",Exec:Iie,"Executes some shell command":"shell","Existing scripts will be overwritten.":"","Expand all":"","Expert mode":"",Explanation:xie,Export:Die,"Export all scripts":"","Export blocks":"","Export selected blocks":"",Februar:Aie,February:Oie,Filter:Rie,Folder:Mie,Fr:Nie,Friday:Lie,Function:"","Function editor":"","Function: executed":"","Go to next line":"","HTTP Call":"HTTP","Hide logs":"",ID:Bie,ID1:Pie,ID2:jie,Import:Fie,"Import blocks":"","Import error":"","Import scripts":"","Insert object ID":"ID",Instance:zie,"Instance is disabled":"","Instance:":"",Instances:Uie,Instructions:Wie,"Invalid CRON":"","It will not be possible to revert this operation.":"","JS description":"Javascript",Januar:Hie,January:Vie,July:Gie,June:Kie,"Just check":"","Language:":"","Learn More":"","Light style":"",Limit:Jie,"Local time":"","Locate file":"","Log outputs":"","Log text":"","Log: %s":":%s","Make a HTTP get request":"HTTP","Make a pause between actions":"",March:qie,"March ":"",May:Yie,Menu:Xie,Message:Zie,Mo:Qie,Model:eoe,Monday:toe,Month:noe,More:soe,Name:roe,"No Chat GPT Key found":" GPT ","No active host found":"","Nothing found":"",November:ioe,OK:ooe,October:aoe,Ok:loe,"On condition change":"","On script save or adapter start":"","On weekdays":"","Open configuration":"","Operate two states":"","Operations with two states":"","Paste your blocks here":"",Pause:coe,"Pause execution":"","Pause script":"","Phone:":"","Please select object ID...":"ID...","Press Ctrl+Enter to get the answer":" Ctrl+Enter ","Prettify the script":"","Print some text in log":"","Priority:":"",Pushover:uoe,Pushsafer:doe,"Read only ID selected: %s":"ID%s",Rename:hoe,"Reorder scripts in folders":"",Repeat:poe,Restart:goe,Result:foe,"Resume execution":"","Root folder":"","Rules description":"IFTHENELSE","Run script":"",Sa:moe,Saturday:boe,Save:$oe,"Save all":"","Say It":"Say It","Say some text via sayit adapter":"sayit",Schedule:voe,Script:yoe,"Script %s was modified on disk":"%s","Script is not running":"","Search in scripts":"","Search...":"...","Select all":"","Send email":"","Sends an email":"","Sends message via Pushsafer":"Pushsafer","Sends message via pushover":"","Sends message via telegram":"","Sends message via whatsapp-cmb":"whatsapp-cmb",September:_oe,"Server time":"","Set state action":"","Set with delay":"","Shell command":"Shell","Show astronomical events":"","Show javascript code":"Javascript","Show logs":"","Show only paused scripts":"","Show only running scripts":"","Show only scripts with problems":"",Simulate:woe,"Some files will be rejected":"","Sound:":"",Stack:Coe,Start:Soe,"Start script":"",State:Toe,"State condition":"","Step into function":"","Step out from function":"","Stop on exception":"",Su:koe,"Subject:":"",Sunday:Eoe,"TS description":"Typescript",Telegram:Ioe,"Text:":"",Th:xoe,"The script will be stopped and must be activated manually after debugging. Continue?":"","This is advances option. You can write your own code here and it will be executed on trigger":"",Thursday:Doe,Time:Aoe,"Time condition":"","Title:":"","To:":"","Trigger with value":"",Triggered:Ooe,Triggers:Roe,"Triggers the on script saving or the javascript instance restart":"javascript","Triggers the rule on update or change of some state":"","Triggers the rule periodically or on some specific time":"",Tu:Moe,Tuesday:Noe,URL:Loe,"Unknown error":"","Unknown error!":"","Use generated code":"","User function":"","User:":"",Value:Boe,"Vibration:":"",Volume:Poe,We:joe,Wednesday:Foe,"Whatsapp-cmb":"Whatsappcmb",Write:zoe,"Write your own code":"",Yes:Uoe,"Yet exists!":"","You can use %s in the URL to use current trigger value or %id to use the triggered object ID":" URL  %s %id  ID%name  ID  %old ","You can use %s in the command to use current trigger value or %id to use the triggered object ID":" %s %id  ID%name  ID  %old ","You can use %s in the text to display current trigger value or %id to display the triggered object ID":" %s %id  ID%name  ID  %old ","You can use %s in the value to use the current trigger value or %id to display the triggered object ID":" %s %id  ID%name  ID  %old ","You have to enter OpenAI API key in the configuration of javascript adapter.":" javascript  OpenAI API ","[equal]":"[]","[greater or equal]":"[]","[greater]":"[]","[hysteresis]":"[]","[includes]":"[]","[less or equal]":"[]","[less]":"[]","[not equal]":"[]",acknowledgment:Woe,all:Hoe,and:Voe,astro:Goe,at:Koe,"clear running":"",control:Joe,copy:qoe,cron:Yoe,dawn:Xoe,debug_help:Zoe,debug_label:Qoe,default:"",dusk:eae,easy:tae,else:"","equal to":"",every:nae,"every hour at 0 minutes":"0",false:"","file reading has failed: %s":"%s","file reading was aborted":"",filter_func:sae,filter_id:rae,filter_name:iae,filter_role:oae,filter_room:aae,"for edit or create script":"","for professionals":"","for programmers":"",goldenHour:lae,goldenHourEnd:cae,"greater or equal":"","greater or equal to":"","greater than":"...",help_just_check:uae,help_on_change:dae,"high priority":"","high-priority":"","highest priority":"",hours:hae,includes:pae,interval:gae,"just check":"","less or equal":"","less or equal to":"","less than":"","lower priority":"","lowest priority":"",magic:fae,milliseconds:mae,minutes:bae,ms:$ae,nadir:vae,nauticalDawn:yae,nauticalDusk:_ae,nextSunrise:wae,nextSunset:Cae,night:Sae,nightEnd:Tae,"no blocks found":"","no group":"",normal:kae,"normal priority":"","not equal to":"","not properly connected":"",offset:Eae,"on change":"","on condition change":"","on update":"",one:Iae,or:xae,quiet:Dae,"reset search":"",search:Aae,seconds:Oae,solarNoon:Rae,"store in":"",sunrise:Mae,sunriseEnd:Nae,sunset:Lae,sunsetStart:Bae,then:Pae,"toggle value":"",tooltip_ack:jae,tooltip_from:Fae,tooltip_lc:zae,tooltip_quality:Uae,tooltip_ts:Wae,tooltip_user:Hae,tooltip_value:Vae,true:"",two:Gae,undefined:"",update:Kae,"use seconds":"","use trigger value":"",verbose_help:Jae,verbose_label:qae,when:Yae,with:"","with date":"","with offset":"",wizard:Xae},lf={root:{flexGrow:1,display:"flex",width:"100%",height:"100%"},mainDiv:{width:"100%",height:"100%",overflow:"hidden"},content:o=>({width:"100%",height:"100%",backgroundColor:o.palette.background&&o.palette.background.default,position:"relative"}),menuOpenCloseButton:o=>({position:"absolute",left:0,borderRadius:"0 5px 5px 0",top:6,pt:1,cursor:"pointer",zIndex:1,height:25,width:20,background:o.palette.secondary.main,color:o.palette.primary.main,pl:"3px","&:hover":{color:"white"}}),showLogButton:o=>({position:"absolute",right:3,borderRadius:"5px 5px 0 0",bottom:0,pt:"3px",cursor:"pointer",zIndex:10,height:20,width:25,background:o.palette.secondary.main,color:o.palette.primary.main,pl:1,"&:hover":{color:"white"}})};class Qae extends I.GenericApp{hosts=[];importFile=null;scripts={};confirmCallback=null;constructor(n){super(n,{Connection:I.AdminConnection,translations:{en:gF,de:aW,es:eH,fr:K8,it:F6,nl:RK,pl:kY,pt:vQ,ru:hne,uk:iie,"zh-cn":Zae},bottomButtons:!1,socket:{autoSubscribeLog:!0},sentryDSN:window.sentryDSN});const s=window.localStorage.getItem("JS.logSizes");let i=[80,20];if(s)try{i=JSON.parse(s)}catch{}const a=window.localStorage.getItem("JS.splitSizes");let c=[20,80];if(a)try{c=JSON.parse(a)}catch{}Object.assign(this.state,{splitSizes:c,logSizes:i}),window.alert=h=>{console.error(h),this.showJsError(h.toString())}}onScriptsChanged=(n,s)=>{if(!n)return;let i=!1;const a={};n.startsWith("script.js.")&&(s?JSON.stringify(this.scripts[n])!==JSON.stringify(s)&&(this.scripts[n]=s,i=!0,a.scriptsHash=this.state.scriptsHash+1):this.scripts[n]&&(delete this.scripts[n],i=!0,a.scriptsHash=this.state.scriptsHash+1)),i&&this.setState(a)};onInstanceChanged=(n,s)=>{var c;if(!n)return;let i=!1;const a={};if(n.match(/^system\.adapter\.[-_\w\d]+\$/)){if(n.startsWith(`system.adapter.${this.adapterName}.`)){const h=parseInt(n.split(".").pop()||"0",10)||0;if((s==null?void 0:s.type)==="instance")this.state.instances.includes(h)||(a.instances=[...this.state.instances],a.instances.push(h),a.instances.sort(),i=!0,this.socket.subscribeState(`${s._id}.alive`,this.onInstanceAliveChange));else if(!s&&this.state.instances.includes(h)){this.socket.unsubscribeState(`${n}.alive`,this.onInstanceAliveChange),a.instances=[...this.state.instances];const g=a.instances.indexOf(h);a.instances.splice(g,1),i=!0}}(c=s==null?void 0:s.common)!=null&&c.blockly&&(this.confirmCallback=h=>h&&window.location.reload(),a.confirm=I.I18n.t("Some blocks were updated. Reload admin?"),i=!0)}i&&this.setState(a)};onHostChanged=(n,s)=>{if(n&&n.startsWith("system.host.")){if((s==null?void 0:s.type)==="host")this.hosts.includes(n)||(this.hosts.push(n),this.hosts.sort());else if(!s&&this.hosts.includes(n)){const i=this.hosts.indexOf(n);this.hosts.splice(i,1)}}};onConnectionReady(){window.systemLang=this.socket.systemLang,this.setState({ready:!1,scriptsHash:0,instances:[],updating:!1,resizing:!1,selected:null,logMessage:{},editing:[],menuOpened:window.localStorage.getItem("App.menuOpened")!=="false",menuSelectId:"",expertMode:window.localStorage.getItem("App.expertMode")==="true",logHorzLayout:window.localStorage.getItem("App.logHorzLayout")==="true",runningInstances:{},confirm:"",importFile:!1,message:"",searchText:"",hideLog:window.localStorage.getItem("App.hideLog")==="true",debugMode:!1,debugInstance:null,splitSizes:[20,80]},async()=>{const n={},s=await this.subscribeOnInstances();n.instances=s.instances,n.runningInstances=s.runningInstances,await this.readAdaptersWithBlockly();const i=await this.socket.getHosts();this.hosts=i.map(h=>h._id);const a=await this.readAllScripts();window.localStorage.getItem("App.expertMode")!=="true"&&window.localStorage.getItem("App.expertMode")!=="false"&&Object.keys(a).find(h=>h.startsWith("script.js.global.")&&a[h].type==="script")&&(n.expertMode=!0),this.scripts=a;let c=this.state.scriptsHash;this.compareScripts(a)&&c++,n.scriptsHash=c,n.ready=!0,this.setState(n),await this.socket.subscribeObject("script.*",this.onScriptsChanged),await this.socket.subscribeObject("system.adapter.*",this.onInstanceChanged),await this.socket.subscribeObject("system.host.*",this.onHostChanged)})}async subscribeOnInstances(){const s=(await this.socket.getAdapterInstances(this.adapterName)).map(a=>parseInt(a._id.split(".").pop()||"0")).sort(),i={};s.forEach(a=>i[`system.adapter.${this.adapterName}.${a}`]=!1);for(let a=0;a<s.length;a++){const c=`system.adapter.${this.adapterName}.${s[a]}`,h=`${c}.alive`,g=await this.socket.getState(h);i[c]=g?!!g.val:!1,await this.socket.subscribeState(h,this.onInstanceAliveChange)}return{instances:s,runningInstances:i}}async readAllScripts(){const n=await this.socket.getObjectViewSystem("channel","script.js.","script.js."),s=await this.socket.getObjectViewSystem("script","script.js.","script.js.");return Object.keys(s).forEach(i=>n[i]=s[i]),n}async readAdaptersWithBlockly(){const n=await this.socket.getObjectViewSystem("adapter","system.adapter.","system.adapter.");return new Promise(s=>dn.loadCustomBlockly(n,()=>s()))}onInstanceAliveChange=(n,s)=>{if(n&&(n=n?n.substring(0,n.length-6):"",this.state.runningInstances[n]!==(s?s.val:!1))){const i=JSON.parse(JSON.stringify(this.state.runningInstances));i[n]=s?!!s.val:!1,this.setState({runningInstances:i})}};onToggleExpertMode(n){this.onExpertModeChange(n)}compareScripts(n){const s=Object.keys(this.scripts),i=Object.keys(n);if(s.length!==i.length)return this.scripts=n,!0;if(JSON.stringify(s)!==JSON.stringify(i))return this.scripts=n,!0;for(let a=0;a<s.length;a++){const c=this.scripts[s[a]].common,h=n[s[a]].common;if(c.name!==h.name)return this.scripts=n,!0;if(c.engine!==h.engine)return this.scripts=n,!0;if(c.engineType!==h.engineType)return this.scripts=n,!0;if(c.enabled!==h.enabled)return this.scripts=n,!0}return!1}async onRename(n,s,i,a){var c;s.trim().endsWith(".")&&(s=s.replace(/\.\s*$/,"_")),console.log(`Rename ${n} => ${s}`),this.setState({updating:!0});try{if(((c=this.scripts[n])==null?void 0:c.type)==="script"){const h=JSON.parse(JSON.stringify(this.scripts[n].common));h.name=i||h.name,a!==void 0&&(h.engine=`system.adapter.javascript.${a}`);const g=s.split(".");g.pop();const b=g.join(".");this.scripts[b]&&this.scripts[b].type==="script"&&(g.pop(),s=`${g.join(".")}.${s.split(".").pop()}`),await this.updateScript(n,s,h)}else await this.renameGroup(n,s,i)}catch(h){h.toString().includes("canceled")||this.showJsError(h)}this.setState({updating:!1})}async renameGroup(n,s,i,a){if(a){if(a.length){let c=a.pop();if(c){const h=await this.socket.getObject(c);if(h){try{await this.socket.delObject(c)}catch{}c=s+c.substring(n.length),h._id=c,h.common=h.common||{},h.common.expert=!0,await this.socket.setObject(c,h),await this.renameGroup(n,s,i,a)}}}}else{a=[],a=Object.keys(this.scripts).filter(h=>h.startsWith(`${n}.`));let c=await this.socket.getObject(n);c=c||{common:{},type:"channel"},c.common.name=i||c.common.name||n.split(".").pop()||"",c._id=s;try{await this.socket.delObject(n)}catch{}try{await this.socket.setObject(s,c),await this.renameGroup(n,s,i,a)}catch(h){console.log(h);const g={_id:s,type:"channel",common:{name:i||n.split(".").pop()||"",expert:!0},native:{}};await this.socket.setObject(s,g),await this.renameGroup(n,s,i,a)}}}onUpdateScript(n,s){this.scripts[n]&&this.scripts[n].type==="script"&&this.updateScript(n,n,s).then(()=>{}).catch(i=>!i.toString().includes("canceled")&&this.showJsError(i))}onSelect(n){this.scripts[n]&&this.scripts[n].common&&this.scripts[n].type==="script"&&this.setState({selected:n,menuSelectId:n},()=>setTimeout(()=>this.setState({menuSelectId:""}),300))}onExpertModeChange(n){this.state.expertMode!==n&&(window.localStorage.setItem("App.expertMode",n?"true":"false"),this.setState({expertMode:n}))}showJsError(n){this.setState({errorText:n?n.toString():""})}showMessage(n){this.setState({message:n?n.toString():""})}onDelete(n){this.socket.delObject(n).catch(s=>this.showJsError(s))}onEdit(n){this.state.selected!==n&&this.setState({selected:n})}onAddNew(n,s,i,a,c,h){const g=new RegExp(`^${n}\\.`);if(Object.keys(this.scripts).find(b=>n===b||g.test(n)))return this.showJsError(I.I18n.t("Yet exists!"));i?this.socket.setObject(n,{_id:n,type:"channel",common:{name:s,expert:!0},native:{}}).then(()=>setTimeout(()=>this.setState({menuSelectId:n},()=>setTimeout(()=>this.setState({menuSelectId:""}),300)),1e3)).catch(b=>this.showJsError(b)):(c==="Blockly"&&!h&&(h=`
//${btoa(encodeURIComponent('<xml xmlns="https://developers.google.com/blockly/xml"></xml>'))}`),this.socket.setObject(n,{_id:n,type:"script",common:{name:s,expert:!0,engineType:c||"Javascript/js",enabled:!1,engine:`system.adapter.javascript.${a||0}`,source:h||"",debug:!1,verbose:!1},native:{}}).then(()=>setTimeout(()=>this.onSelect(n),1e3)).catch(b=>this.showJsError(b)))}async updateScript(n,s,i){let a=await this.socket.getObject(n);const c={common:{}};if(i.engine!==void 0&&(c.common.engine=i.engine),i.enabled!==void 0&&(c.common.enabled=i.enabled),i.source!==void 0&&(c.common.source=i.source),i.debug!==void 0&&(c.common.debug=i.debug),i.verbose!==void 0&&(c.common.verbose=i.verbose),c.from="system.adapter.admin.0",n===s&&(a!=null&&a.common)&&i.name===a.common.name)return(!i.engineType||i.engineType!==a.common.engineType)&&i.engineType!==void 0&&(c.common.engineType=i.engineType||"Javascript/js"),c.type="script",this.socket.extendObject(n,c);if(a!=null&&a.common){a.common.engineType=i.engineType||a.common.engineType||"Javascript/js",await this.socket.delObject(n),c.common.engine!==void 0&&(a.common.engine=c.common.engine),c.common.enabled!==void 0&&(a.common.enabled=c.common.enabled),c.common.source!==void 0&&(a.common.source=c.common.source),c.common.name!==void 0&&(a.common.name=c.common.name),c.common.debug!==void 0&&(a.common.debug=c.common.debug),c.common.verbose!==void 0&&(a.common.verbose=c.common.verbose),a._rev!==void 0&&delete a._rev,a.common.name=i.name,a.common.expert=!0,a.type="script",a._id=s,await this.socket.setObject(s,a);return}return a=c,a.common.name=i.name,a.common.expert=!0,a.type="script",a._id=s,this.socket.setObject(s,a)}onEnableDisable(n,s){var i;if(((i=this.scripts[n])==null?void 0:i.type)==="script"){const a=this.scripts[n].common;a.enabled=s,a.expert=!0,this.updateScript(n,n,a).catch(c=>c!=="canceled"&&this.showJsError(c))}}async getLiveHost(){for(let n=0;n<this.hosts.length;n++){const s=this.hosts[n],i=await this.socket.getState(`${s}.alive`);if(i&&(i!=null&&i.val))return s}}async onExport(){const n=await this.getLiveHost();if(!n){this.showJsError(I.I18n.t("No active host found"));return}const s=new Date;let i=s.getFullYear().toString(),a=s.getMonth()+1;a<10&&(a=`0${a}`),i+=`-${a}`,a=s.getDate(),a<10&&(a=`0${a}`),i+=`-${a}-`,this.socket.getRawSocket().emit("sendToHost",n,"readObjectsAsZip",{adapter:"javascript",id:"script.js",link:`${i}scripts.zip`,fileStorageNamespace:`admin.${this.instance}`},c=>{if(typeof c=="string"){const h=document.createElement("a");h.href=`../../files/${c}`,document.body.appendChild(h),h.click(),h.remove()}else if(c.error&&this.showJsError(c.error),c.data){const h=document.createElement("a");h.href=`data: application/zip;base64,${c.data}`,h.download=`${i}scripts.zip`,document.body.appendChild(h),h.click(),h.remove()}})}onImport(n){this.importFile=n||null,n?(this.confirmCallback=this.onImportConfirmed.bind(this),this.setState({importFile:!1,confirm:I.I18n.t("Existing scripts will be overwritten.")})):this.setState({importFile:!1})}async onImportConfirmed(n){let s=this.importFile;if(this.importFile=null,n&&s){s=s.split(",")[1];const i=await this.getLiveHost();if(!i){this.showJsError(I.I18n.t("No active host found"));return}this.socket.getRawSocket().emit("sendToHost",i,"writeObjectsAsZip",{data:s,adapter:"javascript",id:"script.js"},a=>{a==="permissionError"?this.showJsError(I.I18n.t(a)):!a||a.error?this.showJsError(a?I.I18n.t(a.error||""):I.I18n.t("Unknown error")):this.showMessage(I.I18n.t("Done"))})}}toggleLogLayout(){window.localStorage.setItem("App.logHorzLayout",this.state.logHorzLayout?"false":"true"),this.setState({logHorzLayout:!this.state.logHorzLayout})}renderEditor(){const n=Object.keys(this.scripts).reduce((s,i)=>s+(this.scripts[i].common.engineType==="Rules"?1:0),0);return f.jsx(kh,{debugMode:this.state.debugMode,onDebugModeChange:s=>{s?this.setState({debugMode:!0}):this.setState({debugMode:!1,debugInstance:null})},visible:!this.state.resizing,socket:this.socket,adapterName:this.adapterName,onLocate:s=>this.setState({menuSelectId:s}),runningInstances:this.state.runningInstances,menuOpened:this.state.menuOpened,searchText:this.state.searchText,themeType:this.state.themeType,themeName:this.state.themeName,theme:this.state.theme,expertMode:this.state.expertMode,onChange:(s,i)=>this.onUpdateScript(s,i),isAnyRulesExists:n,debugInstance:this.state.debugInstance,onSelectedChange:(s,i)=>{const a={};let c=!1;s!==this.state.selected&&(c=!0,a.selected=s),JSON.stringify(i)!==JSON.stringify(this.state.editing)&&(c=!0,a.editing=JSON.parse(JSON.stringify(i))),c&&this.setState(a)},onRestart:s=>this.socket.extendObject(s,{common:{enabled:!0}}),selected:this.state.selected&&this.scripts[this.state.selected]&&this.scripts[this.state.selected].type==="script"?this.state.selected:"",objects:this.scripts,resizing:this.state.resizing},"editor")}showLogButton(){return f.jsx(D.Box,{title:I.I18n.t("Show logs"),sx:lf.showLogButton,onClick:()=>{window.localStorage.setItem("App.hideLog","false"),this.setState({hideLog:!1,resizing:!0}),setTimeout(()=>this.setState({resizing:!1}),300)},children:f.jsx(ux,{})},"showLog")}renderErrorDialog(){return this.state.errorText?f.jsx(Hf,{onClose:()=>this.setState({errorText:""}),text:this.state.errorText},"dialogError"):null}renderMain(){let n;return this.state.debugMode||this.state.hideLog?n=f.jsxs(f.Fragment,{children:[!this.state.debugMode&&this.state.hideLog?this.showLogButton():void 0,this.renderEditor()]}):n=f.jsxs(J$,{direction:this.state.logHorzLayout?Bn.Horizontal:Bn.Vertical,initialSizes:this.state.logSizes,minWidths:[500,100],minHeights:[150,50],onResizeStarted:()=>this.setState({resizing:!0}),onResizeFinished:(s,i)=>{this.setState({logSizes:i,resizing:!1}),window.localStorage.setItem("JS.logSizes",JSON.stringify(i))},gutterClassName:this.state.themeType==="dark"?"Dark visGutter":"Light visGutter",children:[this.renderEditor(),f.jsx(pw,{verticalLayout:!this.state.logHorzLayout,onLayoutChange:()=>this.toggleLogLayout(),editing:this.state.editing,socket:this.socket,selected:this.state.selected,onHideLog:()=>{window.localStorage.setItem("App.hideLog","true"),this.setState({hideLog:!0,resizing:!0}),setTimeout(()=>this.setState({resizing:!1}),300)}},"log")]}),[this.state.message?f.jsx(I.Message,{onClose:()=>this.setState({message:""}),text:this.state.message},"dialogMessage"):null,this.renderErrorDialog(),this.state.importFile?f.jsx(rC,{onClose:s=>this.onImport(s)},"dialogImportFile"):null,this.state.confirm?f.jsx(I.Confirm,{onClose:s=>{this.state.confirm&&this.setState({confirm:""}),this.confirmCallback&&this.confirmCallback(s),this.confirmCallback=null},text:this.state.confirm},"dialogConfirm"):null,f.jsxs(D.Box,{sx:lf.content,className:"iobVerticalSplitter",children:[f.jsx(D.Box,{sx:lf.menuOpenCloseButton,onClick:()=>{window.localStorage.setItem("App.menuOpened",this.state.menuOpened?"false":"true"),this.setState({menuOpened:!this.state.menuOpened,resizing:!0}),setTimeout(()=>this.setState({resizing:!1}),300)},children:this.state.menuOpened?f.jsx(dx,{}):f.jsx(hx,{})},"closeMenu"),n]},"main")]}render(){if(!this.state.ready)return f.jsx(UC,{injectFirst:!0,children:f.jsx(WC,{theme:this.state.theme,children:f.jsx(I.Loader,{themeType:this.state.themeType})})});let n;return this.state.menuOpened?n=f.jsxs(J$,{direction:Bn.Horizontal,initialSizes:this.state.splitSizes,minWidths:[270,400],onResizeFinished:(s,i)=>{this.setState({splitSizes:i}),window.localStorage.setItem("JS.splitSizes",JSON.stringify(i))},gutterClassName:this.state.themeType==="dark"?"Dark visGutter":"Light visGutter",children:[f.jsx("div",{style:lf.mainDiv,children:f.jsx(Ha,{debugMode:this.state.debugMode,onDebugInstance:s=>this.setState({debugInstance:s,debugMode:!!s}),scripts:this.scripts,scriptsHash:this.state.scriptsHash,instances:this.state.instances,onRename:this.onRename.bind(this),socket:this.socket,selectId:this.state.menuSelectId,onEdit:this.onEdit.bind(this),expertMode:this.state.expertMode,themeName:this.state.themeName,onThemeChange:s=>{I.Utils.setThemeName(s);const i=I.Utils.getThemeType(s);this.setState({themeName:s,themeType:i},()=>this.toggleTheme(s))},runningInstances:this.state.runningInstances,onExpertModeChange:this.onExpertModeChange.bind(this),onDelete:this.onDelete.bind(this),onAddNew:this.onAddNew.bind(this),onEnableDisable:this.onEnableDisable.bind(this),onExport:this.onExport.bind(this),width:500,onImport:()=>this.setState({importFile:!0}),onSearch:s=>this.setState({searchText:s}),version:this.props.version},"sidemenu")},"menu"),this.renderMain()]}):n=this.renderMain(),f.jsx(UC,{injectFirst:!0,children:f.jsx(WC,{theme:this.state.theme,children:f.jsx("div",{style:lf.root,children:f.jsx(YN,{socket:this.socket,children:n})})})})}}window.location.hostname==="localhost"||window.location.hostname==="[::1]"||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/);function ele(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(o=>{o.unregister()})}const tle="9.0.3",cI={version:tle};var Ql;(function(o){o.mouse="mouse",o.touch="touch",o.keyboard="keyboard"})(Ql||(Ql={}));class nle{get delay(){var n;return(n=this.args.delay)!==null&&n!==void 0?n:0}get scrollAngleRanges(){return this.args.scrollAngleRanges}get getDropTargetElementsAtPoint(){return this.args.getDropTargetElementsAtPoint}get ignoreContextMenu(){var n;return(n=this.args.ignoreContextMenu)!==null&&n!==void 0?n:!1}get enableHoverOutsideTarget(){var n;return(n=this.args.enableHoverOutsideTarget)!==null&&n!==void 0?n:!1}get enableKeyboardEvents(){var n;return(n=this.args.enableKeyboardEvents)!==null&&n!==void 0?n:!1}get enableMouseEvents(){var n;return(n=this.args.enableMouseEvents)!==null&&n!==void 0?n:!1}get enableTouchEvents(){var n;return(n=this.args.enableTouchEvents)!==null&&n!==void 0?n:!0}get touchSlop(){return this.args.touchSlop||0}get delayTouchStart(){var n,s,i,a;return(a=(i=(n=this.args)===null||n===void 0?void 0:n.delayTouchStart)!==null&&i!==void 0?i:(s=this.args)===null||s===void 0?void 0:s.delay)!==null&&a!==void 0?a:0}get delayMouseStart(){var n,s,i,a;return(a=(i=(n=this.args)===null||n===void 0?void 0:n.delayMouseStart)!==null&&i!==void 0?i:(s=this.args)===null||s===void 0?void 0:s.delay)!==null&&a!==void 0?a:0}get window(){if(this.context&&this.context.window)return this.context.window;if(typeof window<"u")return window}get document(){var n;if(!((n=this.context)===null||n===void 0)&&n.document)return this.context.document;if(this.window)return this.window.document}get rootElement(){var n;return((n=this.args)===null||n===void 0?void 0:n.rootElement)||this.document}constructor(n,s){this.args=n,this.context=s}}function sle(o,n,s,i){return Math.sqrt(Math.pow(Math.abs(s-o),2)+Math.pow(Math.abs(i-n),2))}function rle(o,n,s,i,a){if(!a)return!1;const c=Math.atan2(i-n,s-o)*180/Math.PI+180;for(let h=0;h<a.length;++h){const g=a[h];if(g&&(g.start==null||c>=g.start)&&(g.end==null||c<=g.end))return!0}return!1}const ile={Left:1},ole={Left:0};function h_(o){return o.button===void 0||o.button===ole.Left}function ale(o){return o.buttons===void 0||(o.buttons&ile.Left)===0}function uI(o){return!!o.targetTouches}const lle=1;function cle(o){const n=o.nodeType===lle?o:o.parentElement;if(!n)return;const{top:s,left:i}=n.getBoundingClientRect();return{x:i,y:s}}function ule(o,n){if(o.targetTouches.length===1)return kv(o.targetTouches[0]);if(n&&o.touches.length===1&&o.touches[0].target===n.target)return kv(o.touches[0])}function kv(o,n){return uI(o)?ule(o,n):{x:o.clientX,y:o.clientY}}const M0=(()=>{let o=!1;try{addEventListener("test",()=>{},Object.defineProperty({},"passive",{get(){return o=!0,!0}}))}catch{}return o})(),cf={[Ql.mouse]:{start:"mousedown",move:"mousemove",end:"mouseup",contextmenu:"contextmenu"},[Ql.touch]:{start:"touchstart",move:"touchmove",end:"touchend"},[Ql.keyboard]:{keydown:"keydown"}};class If{profile(){var n;return{sourceNodes:this.sourceNodes.size,sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,targetNodes:this.targetNodes.size,dragOverTargetIds:((n=this.dragOverTargetIds)===null||n===void 0?void 0:n.length)||0}}get document(){return this.options.document}setup(){const n=this.options.rootElement;n&&(Gt(!If.isSetUp,"Cannot have two Touch backends at the same time."),If.isSetUp=!0,this.addEventListener(n,"start",this.getTopMoveStartHandler()),this.addEventListener(n,"start",this.handleTopMoveStartCapture,!0),this.addEventListener(n,"move",this.handleTopMove),this.addEventListener(n,"move",this.handleTopMoveCapture,!0),this.addEventListener(n,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.addEventListener(n,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.addEventListener(n,"keydown",this.handleCancelOnEscape,!0))}teardown(){const n=this.options.rootElement;n&&(If.isSetUp=!1,this._mouseClientOffset={},this.removeEventListener(n,"start",this.handleTopMoveStartCapture,!0),this.removeEventListener(n,"start",this.handleTopMoveStart),this.removeEventListener(n,"move",this.handleTopMoveCapture,!0),this.removeEventListener(n,"move",this.handleTopMove),this.removeEventListener(n,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.removeEventListener(n,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.removeEventListener(n,"keydown",this.handleCancelOnEscape,!0),this.uninstallSourceNodeRemovalObserver())}addEventListener(n,s,i,a=!1){const c=M0?{capture:a,passive:!1}:a;this.listenerTypes.forEach(function(h){const g=cf[h][s];g&&n.addEventListener(g,i,c)})}removeEventListener(n,s,i,a=!1){const c=M0?{capture:a,passive:!1}:a;this.listenerTypes.forEach(function(h){const g=cf[h][s];g&&n.removeEventListener(g,i,c)})}connectDragSource(n,s){const i=this.handleMoveStart.bind(this,n);return this.sourceNodes.set(n,s),this.addEventListener(s,"start",i),()=>{this.sourceNodes.delete(n),this.removeEventListener(s,"start",i)}}connectDragPreview(n,s,i){return this.sourcePreviewNodeOptions.set(n,i),this.sourcePreviewNodes.set(n,s),()=>{this.sourcePreviewNodes.delete(n),this.sourcePreviewNodeOptions.delete(n)}}connectDropTarget(n,s){const i=this.options.rootElement;if(!this.document||!i)return()=>{};const a=c=>{if(!this.document||!i||!this.monitor.isDragging())return;let h;switch(c.type){case cf.mouse.move:h={x:c.clientX,y:c.clientY};break;case cf.touch.move:var g,b;h={x:((g=c.touches[0])===null||g===void 0?void 0:g.clientX)||0,y:((b=c.touches[0])===null||b===void 0?void 0:b.clientY)||0};break}const $=h!=null?this.document.elementFromPoint(h.x,h.y):void 0,y=$&&s.contains($);if($===s||y)return this.handleMove(c,n)};return this.addEventListener(this.document.body,"move",a),this.targetNodes.set(n,s),()=>{this.document&&(this.targetNodes.delete(n),this.removeEventListener(this.document.body,"move",a))}}getTopMoveStartHandler(){return!this.options.delayTouchStart&&!this.options.delayMouseStart?this.handleTopMoveStart:this.handleTopMoveStartDelay}installSourceNodeRemovalObserver(n){this.uninstallSourceNodeRemovalObserver(),this.draggedSourceNode=n,this.draggedSourceNodeRemovalObserver=new MutationObserver(()=>{n&&!n.parentElement&&(this.resurrectSourceNode(),this.uninstallSourceNodeRemovalObserver())}),!(!n||!n.parentElement)&&this.draggedSourceNodeRemovalObserver.observe(n.parentElement,{childList:!0})}resurrectSourceNode(){this.document&&this.draggedSourceNode&&(this.draggedSourceNode.style.display="none",this.draggedSourceNode.removeAttribute("data-reactid"),this.document.body.appendChild(this.draggedSourceNode))}uninstallSourceNodeRemovalObserver(){this.draggedSourceNodeRemovalObserver&&this.draggedSourceNodeRemovalObserver.disconnect(),this.draggedSourceNodeRemovalObserver=void 0,this.draggedSourceNode=void 0}constructor(n,s,i){this.getSourceClientOffset=a=>{const c=this.sourceNodes.get(a);return c&&cle(c)},this.handleTopMoveStartCapture=a=>{h_(a)&&(this.moveStartSourceIds=[])},this.handleMoveStart=a=>{Array.isArray(this.moveStartSourceIds)&&this.moveStartSourceIds.unshift(a)},this.handleTopMoveStart=a=>{if(!h_(a))return;const c=kv(a);c&&(uI(a)&&(this.lastTargetTouchFallback=a.targetTouches[0]),this._mouseClientOffset=c),this.waitingForDelay=!1},this.handleTopMoveStartDelay=a=>{if(!h_(a))return;const c=a.type===cf.touch.start?this.options.delayTouchStart:this.options.delayMouseStart;this.timeout=setTimeout(this.handleTopMoveStart.bind(this,a),c),this.waitingForDelay=!0},this.handleTopMoveCapture=()=>{this.dragOverTargetIds=[]},this.handleMove=(a,c)=>{this.dragOverTargetIds&&this.dragOverTargetIds.unshift(c)},this.handleTopMove=a=>{if(this.timeout&&clearTimeout(this.timeout),!this.document||this.waitingForDelay)return;const{moveStartSourceIds:c,dragOverTargetIds:h}=this,g=this.options.enableHoverOutsideTarget,b=kv(a,this.lastTargetTouchFallback);if(!b)return;if(this._isScrolling||!this.monitor.isDragging()&&rle(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,b.x,b.y,this.options.scrollAngleRanges)){this._isScrolling=!0;return}if(!this.monitor.isDragging()&&this._mouseClientOffset.hasOwnProperty("x")&&c&&sle(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,b.x,b.y)>(this.options.touchSlop?this.options.touchSlop:0)&&(this.moveStartSourceIds=void 0,this.actions.beginDrag(c,{clientOffset:this._mouseClientOffset,getSourceClientOffset:this.getSourceClientOffset,publishSource:!1})),!this.monitor.isDragging())return;const $=this.sourceNodes.get(this.monitor.getSourceId());this.installSourceNodeRemovalObserver($),this.actions.publishDragSource(),a.cancelable&&a.preventDefault();const y=(h||[]).map(E=>this.targetNodes.get(E)).filter(E=>!!E),w=this.options.getDropTargetElementsAtPoint?this.options.getDropTargetElementsAtPoint(b.x,b.y,y):this.document.elementsFromPoint(b.x,b.y),T=[];for(const E in w){if(!w.hasOwnProperty(E))continue;let k=w[E];for(k!=null&&T.push(k);k;)k=k.parentElement,k&&T.indexOf(k)===-1&&T.push(k)}const C=T.filter(E=>y.indexOf(E)>-1).map(E=>this._getDropTargetId(E)).filter(E=>!!E).filter((E,k,A)=>A.indexOf(E)===k);if(g)for(const E in this.targetNodes){const k=this.targetNodes.get(E);if($&&k&&k.contains($)&&C.indexOf(E)===-1){C.unshift(E);break}}C.reverse(),this.actions.hover(C,{clientOffset:b})},this._getDropTargetId=a=>{const c=this.targetNodes.keys();let h=c.next();for(;h.done===!1;){const g=h.value;if(a===this.targetNodes.get(g))return g;h=c.next()}},this.handleTopMoveEndCapture=a=>{if(this._isScrolling=!1,this.lastTargetTouchFallback=void 0,!!ale(a)){if(!this.monitor.isDragging()||this.monitor.didDrop()){this.moveStartSourceIds=void 0;return}a.cancelable&&a.preventDefault(),this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.drop(),this.actions.endDrag()}},this.handleCancelOnEscape=a=>{a.key==="Escape"&&this.monitor.isDragging()&&(this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.endDrag())},this.options=new nle(i,s),this.actions=n.getActions(),this.monitor=n.getMonitor(),this.sourceNodes=new Map,this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.targetNodes=new Map,this.listenerTypes=[],this._mouseClientOffset={},this._isScrolling=!1,this.options.enableMouseEvents&&this.listenerTypes.push(Ql.mouse),this.options.enableTouchEvents&&this.listenerTypes.push(Ql.touch),this.options.enableKeyboardEvents&&this.listenerTypes.push(Ql.keyboard)}}const dle=function(n,s={},i={}){return new If(n,s,i)};window.GenericBlock=yn;window.adapterName="javascript";window.sentryDSN="https://504499a725eb4898930d3b9e9da95740@sentry.iobroker.net/56";console.log(`iobroker.${window.adapterName}@${cI.version}`);const hle=window.innerWidth<600,N0=document.getElementById("root");N0&&V0(N0).render(f.jsx(oT,{backend:hle?dle:yT,children:f.jsx(Qae,{version:cI.version})}));ele();const D$=window.loadDynamicScript;D$&&D$(window.location.port==="3000"?`${window.location.protocol}//${window.location.hostname}:8081/lib/js/socket.io.js`:"./../../lib/js/socket.io.js",()=>D$("vs/loader.js",()=>D$("vs/configure.js",()=>typeof window.socketLoadedHandler=="function"&&window.socketLoadedHandler())));
